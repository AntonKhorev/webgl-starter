!function t(e,n,a){function r(i,s){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return r(n?n:t)},u,u.exports,t,e,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(t,e,n){e.exports=function(t,e){function n(e){return t[e].toFixed(3)}function a(t){return n(t+".r")+","+n(t+".g")+","+n(t+".b")}function r(t,e){return e.map(function(e){return Array(t+1).join("	")+e})}function o(t,e){var n=t.pop(),a=/^\s*/.exec(n)[0];e.forEach(function(e,r){0==r?t.push(n+e):t.push(a+e)})}function i(){return[].concat.apply([],t.inputOptions.filter(function(e){return t[e.name+".input"]}).map(function(t){return["<div>","	<label for='"+t.name+"'>"+e("options."+t.name)+":</label>","	"+t.availableValues[0]+" <input type='range' id='"+t.name+"' min='"+t.availableValues[0]+"' max='"+t.availableValues[1]+"' step='any' value='"+n(t.name)+"'> "+t.availableValues[1],"</div>"]}))}function s(){function e(){var e=t.getOnlyInputFor("fragmentColor");null===e?a.push("[].forEach.call(document.querySelectorAll('[id^=\"fragmentColor.\"]'),function(el){","	el"):a.push("document.getElementById('"+e.name+"')"),"rotation"==t.animation?o(a,[".addEventListener('change',updateFragmentColor);"]):o(a,[".addEventListener('change',function(){","	updateFragmentColor();","	updateCanvas();","});"]),null===e&&a.push("});")}var a=[];return t.hasInputsFor("fragmentColor")&&(a.push("var fragmentColorLoc=gl.getUniformLocation(program,'fragmentColor');","function updateFragmentColor() {"),t.hasAllInputsFor("fragmentColor")?a.push("	gl.uniform3fv(fragmentColorLoc,['r','g','b'].map(function(c){","		return parseFloat(document.getElementById('fragmentColor.'+c).value);","	}));"):a.push("	gl.uniform3fv(fragmentColorLoc,["+["r","g","b"].map(function(e){var a="fragmentColor."+e;return t[a+".input"]?"parseFloat(document.getElementById('"+a+"').value)":n(a)}).join()+"]);"),a.push("}","updateFragmentColor();"),e()),a.length&&a.push("	"),a}function l(){function e(){var e=[];return"solid"==t.background&&e.push("gl.clear(gl.COLOR_BUFFER_BIT);"),"rotation"==t.animation&&e.push("gl.uniform1f(rotationAngleLoc,(time-startTime)*360/5000);"),"square"==t.shape?e.push("gl.drawArrays(gl.TRIANGLE_FAN,0,nVertices);"):e.push("gl.drawArrays(gl.TRIANGLES,0,nVertices);"),e}var n=[];"rotation"==t.animation&&n.push("var startTime=performance.now();");var a="rotation"==t.animation||t.hasInputs();return a?(n.push("function updateCanvas(time) {"),n=n.concat(r(1,e())),"rotation"==t.animation&&n.push("	requestAnimationFrame(updateCanvas);"),n.push("}"),"rotation"==t.animation?n.push("requestAnimationFrame(updateCanvas);"):n.push("updateCanvas();")):n=n.concat(e()),n}return[].concat(["<!DOCTYPE html>","<html lang='en'>","<head>","<meta charset='utf-8' />","<title>Generated code</title>"],t.hasInputs()?["<style>","	label {","		display: inline-block;","		width: 15em;","		text-align: right;","	}","</style>"]:[],["<script id='myVertexShader' type='x-shader/x-vertex'>"],"rotation"==t.animation?["	uniform float rotationAngle;","	attribute vec2 position;","	void main() {","		float c=cos(radians(rotationAngle));","		float s=sin(radians(rotationAngle));","		gl_Position=vec4(mat2(","			 c, s,","			-s, c","		)*position,0,1);","	}"]:["	attribute vec4 position;","	void main() {","		gl_Position=position;","	}"],["</script>","<script id='myFragmentShader' type='x-shader/x-fragment'>","	precision mediump float;"],t.hasInputsFor("fragmentColor")?["	uniform vec3 fragmentColor;","	void main() {","		gl_FragColor=vec4(fragmentColor,1.0);","	}"]:["	void main() {","		gl_FragColor=vec4("+a("fragmentColor")+",1.0);","	}"],["</script>","</head>","<body>","<div>","	<canvas id='myCanvas' width='512' height='512'></canvas>","</div>"],i(),["<script>","	function makeProgram(vertexShaderSrc,fragmentShaderSrc) {","		var vertexShader=gl.createShader(gl.VERTEX_SHADER);","		gl.shaderSource(vertexShader,vertexShaderSrc);","		gl.compileShader(vertexShader);","		if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));","		var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);","		gl.shaderSource(fragmentShader,fragmentShaderSrc);","		gl.compileShader(fragmentShader);","		if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));","		var program=gl.createProgram();","		gl.attachShader(program,vertexShader);","		gl.attachShader(program,fragmentShader);","		gl.linkProgram(program);","		return program;","	}","	","	var canvas=document.getElementById('myCanvas');","	var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');"],"solid"==t.background?["	gl.clearColor(1.0,1.0,1.0,1.0);"]:[],["	var program=makeProgram(","		document.getElementById('myVertexShader').text,","		document.getElementById('myFragmentShader').text","	);","	gl.useProgram(program);","	"],"square"==t.shape?["	var nVertices=4;","	var vertices=new Float32Array([","		-0.5,-0.5,","		+0.5,-0.5,","		+0.5,+0.5,","		-0.5,+0.5,","	]);"]:[],"triangle"==t.shape?["	var nVertices=3;","	var vertices=new Float32Array([","		-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI),","		-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI),","		-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI),","	]);"]:[],"gasket"==t.shape?["	var gasketDepth=6;","	var nVertices=Math.pow(3,gasketDepth)*3;","	var vertices=new Float32Array(nVertices*2);","	function storeGasketVertices() {","		var iv=0;","		function pushVertex(v) {","			vertices[iv++]=v[0]; vertices[iv++]=v[1];","		}","		function mix(a,b,m) {","			return [","				a[0]*(1-m)+b[0]*m,","				a[1]*(1-m)+b[1]*m,","			];","		}","		function triangle(depth,a,b,c) {","			if (depth<=0) {","				pushVertex(a);","				pushVertex(b);","				pushVertex(c);","			} else {","				var ab=mix(a,b,0.5);","				var bc=mix(b,c,0.5);","				var ca=mix(c,a,0.5);","				triangle(depth-1,a,ab,ca);","				triangle(depth-1,b,bc,ab);","				triangle(depth-1,c,ca,bc);","			}","		}","		triangle(","			gasketDepth,","			[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],","			[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],","			[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]","		);","	}","	storeGasketVertices();"]:[],["	","	var buffer=gl.createBuffer();","	gl.bindBuffer(gl.ARRAY_BUFFER,buffer);","	gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);","	","	var positionLoc=gl.getAttribLocation(program,'position');","	gl.vertexAttribPointer(positionLoc,2,gl.FLOAT,false,0,0);","	gl.enableVertexAttribArray(positionLoc);","	"],r(1,s()),"rotation"==t.animation?["	var rotationAngleLoc=gl.getUniformLocation(program,'rotationAngle');","	"]:[],r(1,l()),["</script>","</body>","</html>"]).join("\n")}},{}],2:[function(t,e,n){function a(){return"webgl-starter-id-"+o++}function r(t){return"data:text/html;charset=utf-8,"+encodeURIComponent(t)}var o=0,i=t("./options.js"),s=t("./code.js"),l=function(t){return{"message.hljs":"<a href='https://highlightjs.org/'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.","options.general":"General options","options.background":"Background","options.background.none":"None (transparent)","options.background.solid":"Solid color","options.shape":"Shape to draw","options.shape.square":"Square","options.shape.triangle":"Triangle","options.shape.gasket":"Sierpinski gasket","options.animation":"Animation","options.animation.none":"None","options.animation.rotation":"Rotation around z axis","options.input":"Input options","options.fragmentColor.r":"Fragment color red component","options.fragmentColor.g":"Fragment color green component","options.fragmentColor.b":"Fragment color blue component","options.*.input":"Make this input available to users"}[t]};$(function(){$(".webgl-starter").each(function(){function t(){o.text(s(u,l)),window.hljs&&hljs.highlightBlock(o[0])}function e(e){var n=a();return $("<div>").append("<label for='"+n+"'>"+l("options."+e.name)+":</label>").append(" ").append($("<select id='"+n+"'>").append(e.availableValues.map(function(t){return $("<option>").val(t).html(l("options."+e.name+"."+t))})).val(u[e.name]).change(function(){u[e.name]=this.value,t()}))}function n(e){var n=a(),r=a();return $("<div>").append("<label for='"+n+"'>"+l("options."+e.name)+":</label>").append(" "+e.availableValues[0]+" ").append($("<input type='range' id='"+n+"' step='any'>").attr("min",e.availableValues[0]).attr("max",e.availableValues[1]).val(u[e.name]).change(function(){u[e.name]=parseFloat(this.value),t()})).append(" "+e.availableValues[1]+" ").append($("<input type='checkbox' id='"+r+"'>").prop("checked",u[e.name+".input"]).change(function(){u[e.name+".input"]=$(this).prop("checked"),t()})).append(" ").append("<label for='"+r+"'>"+l("options.*.input")+"</label>")}var o,p=$(this),u=new i;p.empty().append($("<fieldset>").append("<legend>"+l("options.general")+"</legend>").append(u.generalOptions.map(e))).append($("<fieldset>").append("<legend>"+l("options.input")+"</legend>").append(u.inputOptions.map(n))).append($("<pre>").append(o=$("<code>").text(s(u,l)))),window.hljs?hljs.highlightBlock(o[0]):p.append("<p>"+l("message.hljs")+"</p>"),p.append($("<div>").append($("<button type='button'>Run in new window</button>").click(function(){window.open(r(o.text()),"generatedCode")})).append(" running in new window doesn't work in Internet Explorer"))})})},{"./code.js":1,"./options.js":3}],3:[function(t,e,n){Option=function(t,e,n){this.name=t,this.availableValues=e,void 0===n?this.defaultValue=e[0]:this.defaultValue=n};var a=function(){this.reset()};a.prototype.generalOptions=[new Option("background",["none","solid"]),new Option("shape",["square","triangle","gasket"]),new Option("animation",["none","rotation"])],a.prototype.inputOptions=[new Option("fragmentColor.r",[0,1],1),new Option("fragmentColor.g",[0,1]),new Option("fragmentColor.b",[0,1])],a.prototype.reset=function(){this.generalOptions.forEach(function(t){this[t.name]=t.defaultValue},this),this.inputOptions.forEach(function(t){this[t.name]=t.defaultValue,this[t.name+".input"]=!1},this)},a.prototype.hasInputs=function(){return this.inputOptions.some(function(t){return this[t.name+".input"]},this)},a.prototype.hasInputsFor=function(t){return this.inputOptions.filter(function(e){return 0===e.name.indexOf(t+".")},this).some(function(t){return this[t.name+".input"]},this)},a.prototype.hasAllInputsFor=function(t){return this.inputOptions.filter(function(e){return 0===e.name.indexOf(t+".")},this).every(function(t){return this[t.name+".input"]},this)},a.prototype.getOnlyInputFor=function(t){var e=this.inputOptions.filter(function(e){return 0===e.name.indexOf(t+".")&&this[e.name+".input"]},this);return 1==e.length?e[0]:null},e.exports=a},{}]},{},[2]);
//# sourceMappingURL=index.js.map