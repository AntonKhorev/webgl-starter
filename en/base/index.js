!function e(t,r,n){function a(i,s){if(!r[i]){if(!t[i]){var p="function"==typeof require&&require;if(!s&&p)return p(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return a(r?r:e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){var n=e("./listeners.js"),a=e("./shapes.js"),o=e("./lines.js");t.exports=function(e,t){function r(t){return parseInt(e[t])}function i(t){return e[t].toFixed(3)}function s(e){return i(e+".r")+","+i(e+".g")+","+i(e+".b")+","+i(e+".a")}function p(e){var t=i(e+".r"),r=i(e+".g"),n=i(e+".b"),a=i(e+".a");return t==a&&r==a&&n==a?a:t+","+r+","+n+","+a}function l(t){return["mousemovex","mousemovey"].indexOf(e[t+".input"])>=0}function c(){var t=e.shape.charAt(0).toUpperCase()+e.shape.slice(1),n=e.getInputOptionsFor("shape").map(function(t){return"constant"==e[t.name+".input"]?{value:r(t.name),changes:!1,min:r(t.name),max:r(t.name)}:{value:r(t.name),changes:!0,min:t.getMin(),max:t.getMax()}}),o=[null,parseInt(e.elements),e.shader].concat(n);return new(Function.prototype.bind.apply(a[t],o))}function u(){var t=new o;return e.hasSliderInputs()&&t.a("label {","	display: inline-block;","	width: 15em;","	text-align: right;","}",".min {","	display: inline-block;","	width: 3em;","	text-align: right;","}",".max {","	display: inline-block;","	width: 3em;","	text-align: left;","}"),t.wrapIfNotEmpty("<style>","</style>")}function h(){function t(){var t=new o;return["x","y","z"].forEach(function(r){var n=r.toUpperCase(),a="rotate."+r,o="rotate"+n;e.needsTransform(a)&&(e.needsUniform("rotate."+r)?t.a("float c"+r+"=cos(radians("+o+"));","float s"+r+"=sin(radians("+o+"));"):t.a("float c"+r+"=cos(radians("+i(a)+"));","float s"+r+"=sin(radians("+i(a)+"));"))}),s&&t.a("float aspect="+r("canvas.width")+".0/"+r("canvas.height")+".0;"),"perspective"==e.projection&&t.a("float fovy=45.0;","float near=1.0/tan(radians(fovy)/2.0);","float far=near+2.0;"),p?t.a("vec4 transformedPosition="):t.a("gl_Position="),n?t.t("vec4(position*mat2(","	cz, -sz,","	sz,  cz","),0,1)"):(t.t("position"),e.transformOrder.forEach(function(r){e.needsTransform(r)&&t.t({"rotate.x":["*mat4(","	1.0, 0.0, 0.0, 0.0,","	0.0,  cx, -sx, 0.0,","	0.0,  sx,  cx, 0.0,","	0.0, 0.0, 0.0, 1.0",")"],"rotate.y":["*mat4(","	 cy, 0.0,  sy, 0.0,","	0.0, 1.0, 0.0, 0.0,","	-sy, 0.0,  cy, 0.0,","	0.0, 0.0, 0.0, 1.0",")"],"rotate.z":["*mat4(","	 cz, -sz, 0.0, 0.0,","	 sz,  cz, 0.0, 0.0,","	0.0, 0.0, 1.0, 0.0,","	0.0, 0.0, 0.0, 1.0",")"]}[r])}),"perspective"==e.projection&&t.t("*mat4( // move center of coords inside view","	1.0, 0.0, 0.0, 0.0,","	0.0, 1.0, 0.0, 0.0,","	0.0, 0.0, 1.0, -(near+far)/2.0,","	0.0, 0.0, 0.0, 1.0",")")),p&&(t.t(";"),t.a("gl_Position=transformedPosition")),"ortho"==e.projection?a||s?t.t("*vec4(1.0/aspect,1.0,-1.0,1.0)"):b.dim>2&&t.t("*vec4(1.0,1.0,-1.0,1.0)"):"perspective"==e.projection&&(a||s?t.t("*mat4(","	near/aspect, 0.0,  0.0,                   0.0,","	0.0,         near, 0.0,                   0.0,","	0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,         0.0,  -1.0,                  0.0",")"):t.t("*mat4(","	near, 0.0,  0.0,                   0.0,","	0.0,  near, 0.0,                   0.0,","	0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,  0.0,  -1.0,                  0.0",")")),t.t(";"),"light"==e.shader&&("perspective"==e.projection&&t.a("interpolatedView=-vec3(transformedPosition);"),b.dim>2?t.a("interpolatedNormal=normal"):t.a("interpolatedNormal=vec3(0.0,0.0,1.0)"),e.transformOrder.forEach(function(r){e.needsTransform(r)&&t.t({"rotate.x":["*mat3(","	1.0, 0.0, 0.0,","	0.0,  cx, -sx,","	0.0,  sx,  cx",")"],"rotate.y":["*mat3(","	 cy, 0.0,  sy,","	0.0, 1.0, 0.0,","	-sy, 0.0,  cy",")"],"rotate.z":["*mat3(","	 cz, -sz, 0.0,","	 sz,  cz, 0.0,","	0.0, 0.0, 1.0",")"]}[r])}),t.t(";")),("vertex"==e.shader||"face"==e.shader)&&t.a("interpolatedColor=color;"),t}var n=2==b.dim&&!e.needsTransform("rotate.x")&&!e.needsTransform("rotate.y")&&e.needsTransform("rotate.z"),a=e.hasInputsFor("canvas"),s=!a&&e["canvas.width"]!=e["canvas.height"],p="light"==e.shader&&"perspective"==e.projection,l=new o;return a&&l.a("uniform float aspect;"),["x","y","z"].forEach(function(t){var r=t.toUpperCase(),n="rotate."+t,a="rotate"+r;e.needsUniform(n)&&l.a("uniform float "+a+";")}),n?l.a("attribute vec2 position;"):l.a("attribute vec4 position;"),"light"==e.shader&&("perspective"==e.projection&&l.a("varying vec3 interpolatedView;"),b.dim>2&&l.a("attribute vec3 normal;"),l.a("varying vec3 interpolatedNormal;")),("vertex"==e.shader||"face"==e.shader)&&l.a("attribute vec4 color;","varying vec4 interpolatedColor;"),l.a("void main() {",t().indent(),"}"),l}function d(){var t=new o;return t.a("precision mediump float;"),"single"==e.shader?e.hasInputsFor("shader.single.color")?t.a("uniform vec4 color;","void main() {","	gl_FragColor=color;","}"):t.a("void main() {","	gl_FragColor=vec4("+p("shader.single.color")+");","}"):"vertex"==e.shader||"face"==e.shader?t.a("varying vec4 interpolatedColor;","void main() {","	gl_FragColor=interpolatedColor;","}"):"light"==e.shader&&("perspective"==e.projection&&t.a("varying vec3 interpolatedView;"),t.a("varying vec3 interpolatedNormal;","void main() {","	vec3 ambientColor=vec3(0.2,0.2,0.2);","	vec3 diffuseColor=vec3(0.4,0.4,0.4);","	vec3 specularColor=vec3(0.4,0.4,0.4);","	float shininess=100.0;"),"ortho"==e.projection?t.a("	vec3 V=vec3( 0.0, 0.0,+1.0);"):"perspective"==e.projection&&t.a("	vec3 V=normalize(interpolatedView);"),t.a("	vec3 N=normalize(interpolatedNormal);"),b.twoSided&&t.a("	if (!gl_FrontFacing) N=-N;"),t.a("	vec3 L=normalize(vec3(-1.0,+1.0,+1.0));","	vec3 H=normalize(L+V);","	gl_FragColor=vec4(","		ambientColor","		+diffuseColor*max(0.0,dot(L,N))","		+specularColor*pow(max(0.0,dot(H,N)),shininess)","	,1.0);","}")),t}function f(){function r(r){r.filter(function(e){return l(e.name)}).forEach(function(r){n.a("<li>"+t("controls.type."+e[r.name+".input"])+" "+t("controls.to")+" <strong>"+t("options."+r.name)+"</strong></li>")})}var n=new o;return r(e.inputOptions),r(e.transformOptions),n.wrapIfNotEmpty("<ul>","</ul>")}function m(){function n(n){n.filter(function(t){return"slider"==e[t.name+".input"]}).forEach(function(e){a.a("<div>","	<label for='"+e.name+"'>"+t("options."+e.name)+":</label>"),"shape.lodShape.lod"!=e.name?(a.a("	<span class='min'>"+e.getMinLabel()+"</span> "),1==e.getStep()?a.t("<input type='range' id='"+e.name+"' min='"+e.getMin()+"' max='"+e.getMax()+"' value='"+r(e.name)+"' />"):a.t("<input type='range' id='"+e.name+"' min='"+e.getMin()+"' max='"+e.getMax()+"' step='"+e.getStep()+"' value='"+i(e.name)+"' />"),a.t(" <span class='max'>"+e.getMaxLabel()+"</span>")):(a.a("	<span class='min'>"+e.getMinLabel(b.lod.min)+"</span> "),a.t("<input type='range' id='"+e.name+"' min='"+b.lod.min+"' max='"+b.lod.max+"' value='"+b.lod.value+"' />"),a.t(" <span class='max'>"+e.getMaxLabel(b.lod.max)+"</span>")),a.t("</div>")})}var a=new o;return n(e.inputOptions),n(e.transformOptions),a}function v(){var t=new o;return t.a("var vertexShader=gl.createShader(gl.VERTEX_SHADER);","gl.shaderSource(vertexShader,vertexShaderSrc);","gl.compileShader(vertexShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));"),t.a("var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);","gl.shaderSource(fragmentShader,fragmentShaderSrc);","gl.compileShader(fragmentShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));"),t.a("var program=gl.createProgram();","gl.attachShader(program,vertexShader);","gl.attachShader(program,fragmentShader);","gl.linkProgram(program);","return program;"),t.wrap("function makeProgram(vertexShaderSrc,fragmentShaderSrc) {","}")}function g(){var t=new o;return t.a("var canvas=document.getElementById('myCanvas');","var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');"),"32"==e.elements&&t.a("gl.getExtension('OES_element_index_uint');"),"solid"!=e.background||e.hasInputsFor("background.solid.color")||0==e["background.solid.color.r"]&&0==e["background.solid.color.g"]&&0==e["background.solid.color.b"]&&0==e["background.solid.color.a"]||t.a("gl.clearColor("+s("background.solid.color")+");"),b.dim>2&&t.a("gl.enable(gl.DEPTH_TEST);"),t.a("var program=makeProgram(","	document.getElementById('myVertexShader').text,","	document.getElementById('myFragmentShader').text",");","gl.useProgram(program);"),t}function y(){function t(t){f.a(t.write(!e.isAnimated(),e.debugInputs))}function r(){f.a("function updateAspect() {","	gl.viewport(0,0,canvas.width,canvas.height);","	gl.uniform1f(aspectLoc,canvas.width/canvas.height);","}","updateAspect();")}function a(r){var a="canvas."+r;if("slider"==e[a+".input"]){var o=new n.SliderListener(a);o.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("canvas."+r+"=parseInt(this.value);").post("updateAspect();"),t(o)}}function s(e,t,r){["r","g","b","a"].forEach(function(t){var n=e+"."+t;l(n)&&f.a("var "+r+t.toUpperCase()+"="+i(n)+";")})}function p(t,r,n,a,o,s,p){f.a("function "+r+"() {"),e.hasAllSliderInputsFor(t)?f.a("	"+a+"['r','g','b','a'].map(function(c){","		return parseFloat(document.getElementById('"+t+".'+c).value);","	})"+o):f.a("	"+s+["r","g","b","a"].map(function(r){var a=t+"."+r;return"slider"==e[a+".input"]?"parseFloat(document.getElementById('"+a+"').value)":l(a)?n+r.toUpperCase():i(a)}).join()+p),f.a("}",r+"();")}function c(r,a,o){var i,s=e.getOnlyInputFor(r);i=null===s?new n.MultipleSliderListener('[id^="'+r+'."]'):new n.SliderListener(s.name),i.enter().log("console.log(this.id,'input value:',parseFloat(this.value));").post(a+"();"),t(i)}function u(r,a,o){["r","g","b","a"].forEach(function(i){var s=r+"."+i,p=o+i.toUpperCase();if("slider"==e[s+".input"]){var c=new n.SliderListener(s);c.enter().log("console.log(this.id,'input value:',parseFloat(this.value));").post(a+"();"),t(c)}else l(s)&&m.enter().prexy(e[s+".input"],p+"=(ev.clientX-rect.left)/(rect.width-1);",p+"=(rect.bottom-1-ev.clientY)/(rect.height-1);").log("console.log('"+s+" input value:',"+p+");").post(a+"();")})}function h(t,r,n){var a=["r","g","b","a"].every(function(r){var n=e[t+"."+r+".input"];return"constant"==n||"slider"==n});a?c(t,r,n):u(t,r,n)}function d(e,t,r,n,a,o,i){s(e,t,r),p(e,t,r,n,a,o,i),h(e,t,r)}var f=new o,m=new n.CanvasMousemoveListener;return e.hasInputsFor("canvas")&&(f.a("var aspectLoc=gl.getUniformLocation(program,'aspect');"),r(),a("width"),a("height")),e.hasInputsFor("background.solid.color")&&d("background.solid.color","updateClearColor","clearColor","gl.clearColor.apply(gl,",");","gl.clearColor(",");"),e.hasInputsFor("shader.single.color")&&(f.a("var colorLoc=gl.getUniformLocation(program,'color');"),d("shader.single.color","updateColor","color","gl.uniform4fv(colorLoc,",");","gl.uniform4fv(colorLoc,[","]);")),e.getInputsFor("shape").forEach(function(r){function a(e){var t=r.name.lastIndexOf("."),n=r.name.substring(t+1),a=n.charAt(0).toUpperCase()+n.slice(1);return void 0!==e?e+"Shape"+a:"shape"+a}if("slider"==e[r.name+".input"]){var o=new n.SliderListener(r.name);o.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("storeShape(parseInt(this.value));"),t(o)}else l(r.name)&&m.enter().prexy(e[r.name+".input"],"var "+a("new")+"=Math.floor("+a("min")+"+("+a("max")+"-"+a("min")+"+1)*(ev.clientX-rect.left)/rect.width);","var "+a("new")+"=Math.floor("+a("min")+"+("+a("max")+"-"+a("min")+"+1)*(rect.bottom-1-ev.clientY)/rect.height);").cond(a("new")+"!="+a()).log("console.log('"+r.name+" input value:',"+a("new")+");").post("storeShape("+a("new")+");")}),["x","y","z"].forEach(function(r){var a=r.toUpperCase(),o="rotate."+r,s="rotate"+a,p="updateRotate"+a;if("slider"==e[o+".input"]){var c=new n.SliderListener(o),u=c.enter().log("console.log(this.id,'input value:',parseFloat(this.value));");0==e[o+".speed"]&&"constant"==e[o+".speed.input"]&&(f.a("var "+s+"Loc=gl.getUniformLocation(program,'"+s+"');","function "+p+"() {","	gl.uniform1f("+s+"Loc,parseFloat(document.getElementById('"+o+"').value));","};",p+"();"),u.post(p+"();")),t(c)}else l(o)&&(0==e[o+".speed"]&&"constant"==e[o+".speed.input"]?(f.a("var "+s+"Loc=gl.getUniformLocation(program,'"+s+"');","gl.uniform1f("+s+"Loc,"+i(o)+");"),m.enter().prexy(e[o+".input"],"var "+s+"=180*(-1+2*(ev.clientX-rect.left)/(rect.width-1));","var "+s+"=180*(-1+2*(rect.bottom-1-ev.clientY)/(rect.height-1));").log("console.log('"+o+" input value:',"+s+");").post("gl.uniform1f("+s+"Loc,"+s+");")):m.enter().state("var "+s+"="+i(o)+";").prexy(e[o+".input"],s+"=180*(-1+2*(ev.clientX-rect.left)/(rect.width-1));",s+"=180*(-1+2*(rect.bottom-1-ev.clientY)/(rect.height-1));").log("console.log('"+o+" input value:',"+s+");"));if("slider"==e[o+".speed.input"]){var c=new n.SliderListener(o+".speed");c.enter().log("console.log(this.id,'input value:',parseFloat(this.value));"),t(c)}else l(o+".speed")&&m.enter().state("var "+s+"Speed="+i(o+".speed")+";").prexy(e[o+".speed.input"],s+"Speed=360*(-1+2*(ev.clientX-rect.left)/(rect.width-1));",s+"Speed=360*(-1+2*(rect.bottom-1-ev.clientY)/(rect.height-1));").log("console.log('"+o+".speed input value:',"+s+"Speed);")}),t(m),f}function x(){function t(){function t(){var t=new o;return["x","y","z"].forEach(function(o){var s=o.toUpperCase(),p="rotate."+o,l="rotate"+s;(0!=e[p+".speed"]||"constant"!=e[p+".speed.input"])&&("constant"==e[p+".speed.input"]&&"constant"==e[p+".input"]?(r=!0,t.a("var "+l+"="+(e[p]?i(p)+"+":"")+i(p+".speed")+"*(time-startTime)/1000;")):(n=!0,"slider"==e[p+".input"]&&t.a("var "+l+"Input=document.getElementById('"+p+"');","var "+l+"=parseFloat("+l+"Input.value);"),"slider"==e[p+".speed.input"]&&t.a("var "+l+"SpeedInput=document.getElementById('"+p+".speed');","var "+l+"Speed=parseFloat("+l+"SpeedInput.value);"),t.a(l+"+="+("constant"==e[p+".speed.input"]?i(p+".speed"):l+"Speed")+"*(time-prevTime)/1000;"),"slider"==e[p+".input"]&&(a=!0,t.a(l+"=wrap("+l+",180);",l+"Input.value="+l+";"))),t.a("gl.uniform1f("+l+"Loc,"+l+");"))}),t}var a=!1,s=t(),p=new o;return a&&p.a("function wrap(v,maxAbsV) {","	v%=maxAbsV*2;","	if (Math.abs(v)<=maxAbsV) return v;","	return v-(v>0?1:-1)*maxAbsV*2;","}"),"solid"==e.background&&p.a("gl.clear(gl.COLOR_BUFFER_BIT);"),p.a(s,b.writeDraw()),p}var r=!1,n=!1,a=new o,s=t();return e.isAnimated()&&(["x","y","z"].forEach(function(t){var r=t.toUpperCase(),n="rotate."+t,o="rotate"+r;e.needsUniform(n)&&("slider"!=e[n+".input"]&&!l(n)||0!=e[n+".speed"]||"constant"!=e[n+".speed.input"])&&a.a("var "+o+"Loc=gl.getUniformLocation(program,'"+o+"');"),"constant"!=e[n+".speed.input"]&&"constant"==e[n+".input"]&&a.a("var "+o+"="+i(n)+";")}),r&&n?a.a("var startTime=performance.now();","var prevTime=startTime;"):r?a.a("var startTime=performance.now();"):n&&a.a("var prevTime=performance.now();")),e.isAnimated()?(a.a("function renderFrame(time) {",s.indent()),n&&a.a("	prevTime=time;"),a.a("	requestAnimationFrame(renderFrame);","}","requestAnimationFrame(renderFrame);")):e.hasInputs()?a.a("var frameId=null;","function renderFrame() {",s.indent(),"	frameId=null;","}","function scheduleFrame() {","	if (frameId===null) {","		frameId=requestAnimationFrame(renderFrame);","	}","}","scheduleFrame();"):a.a(s),a}var b=c(),w=new o;w.interleave(v(),g(),b.writeInit(e.debugArrays),y(),x()).wrap("<script>","</script>");var j=new o;return j.a("<!DOCTYPE html>","<html lang='en'>","<head>","<meta charset='utf-8' />","<title>Generated code</title>",u(),"<script id='myVertexShader' type='x-shader/x-vertex'>",h().indent(),"</script>","<script id='myFragmentShader' type='x-shader/x-fragment'>",d().indent(),"</script>","</head>","<body>","<div>","	<canvas id='myCanvas' width='"+r("canvas.width")+"' height='"+r("canvas.height")+"'></canvas>","</div>",f(),m(),w,"</body>","</html>"),j.join("tab"==e.indent?"	":Array(parseInt(e.indent)+1).join(" "))}},{"./lines.js":3,"./listeners.js":4,"./shapes.js":7}],2:[function(e,t,r){t.exports=function(e){return{"message.hljs":"<a href='https://highlightjs.org/'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.","message.elements":"choosing 8- or 16-bit index may limit available shape detail levels","options.general":"General options","options.background":"Background","options.background.none":"None (transparent)","options.background.solid":"Solid color","options.shader":"Shader","options.shader.single":"Single color","options.shader.vertex":"One color per vertex","options.shader.face":"One color per face","options.shader.light":"Directional light","options.shape":"Shape to draw","options.shape.square":"Square","options.shape.triangle":"Triangle","options.shape.gasket":"Sierpinski gasket","options.shape.cube":"Cube","options.shape.hat":"Mexican hat function","options.shape.terrain":"Diamond-square fractal terrain","options.elements":"Element array","options.elements.0":"not used","options.elements.8":"with 8-bit index","options.elements.16":"with 16-bit index","options.elements.32":"with 32-bit index","options.projection":"Projection","options.projection.ortho":"Orthogonal","options.projection.perspective":"Perspective","options.input":"Input options","options.canvas.width":"Canvas width","options.canvas.height":"Canvas height","options.background.solid.color.r":"Background color red component","options.background.solid.color.g":"Background color green component","options.background.solid.color.b":"Background color blue component","options.background.solid.color.a":"Background color alpha component","options.shader.single.color.r":"Fragment color red component","options.shader.single.color.g":"Fragment color green component","options.shader.single.color.b":"Fragment color blue component","options.shader.single.color.a":"Fragment color alpha component","options.shape.lodShape.lod":"Shape detail level","options.*.input":"This value is","options.*.input.constant":"kept constant","options.*.input.slider":"updated with a slider","options.*.input.mousemovex":"updated by moving the mouse horizontally","options.*.input.mousemovey":"updated by moving the mouse vertically","options.*.input.animated":"animated","options.transform":"Transforms","options.rotate.x":"Angle of rotation around x axis","options.rotate.x.speed":"Speed of rotation around x axis","options.rotate.y":"Angle of rotation around y axis","options.rotate.y.speed":"Speed of rotation around y axis","options.rotate.z":"Angle of rotation around z axis","options.rotate.z.speed":"Speed of rotation around z axis","options.debug":"Debug options","options.debugShaders":"Log shader compilation errors","options.debugArrays":"Log allocated array sizes","options.debugInputs":"Log input values","options.formatting":"Code formatting options","options.indent":"Indent","options.indent.tab":"Tab","options.indent.2":"2 spaces","options.indent.4":"4 spaces","options.indent.8":"8 spaces","controls.type.mousemovex":"Move the mouse pointer horizontally over the canvas","controls.type.mousemovey":"Move the mouse pointer vertically over the canvas","controls.to":"to update"}[e]}},{}],3:[function(e,t,r){var n=function(){this.data=[],this.addFlattenedArgs(this.flattenArgs(arguments))};n.prototype.flattenArgs=function(e){for(var t=[],r=0;r<e.length;r++)"string"==typeof e[r]?t.push(e[r]):Array.isArray(e[r])?Array.prototype.push.apply(t,e[r]):e[r]instanceof n&&Array.prototype.push.apply(t,e[r].data);return t},n.prototype.addFlattenedArgs=function(e){Array.prototype.push.apply(this.data,e)},n.prototype.a=function(){return this.addFlattenedArgs(this.flattenArgs(arguments)),this},n.prototype.t=function(){var e=this.data.pop(),t=this.flattenArgs(arguments);return t[0]=e+t[0],this.addFlattenedArgs(t),this},n.prototype.indent=function(e){return void 0===e&&(e=1),this.data=this.data.map(function(t){return Array(e+1).join("	")+t}),this},n.prototype.isEmpty=function(){return this.data.length<=0},n.prototype.interleave=function(){for(var e=!0,t=0;t<arguments.length;t++){var r=this.flattenArgs([arguments[t]]);r.length>0&&(e?e=!1:this.data.push(""),this.addFlattenedArgs(r))}return this},n.prototype.wrap=function(e,t){return this.indent(),this.data.unshift(e),this.data.push(t),this},n.prototype.wrapIfNotEmpty=function(e,t){return this.isEmpty()||this.wrap(e,t),this},n.prototype.join=function(e){return this.data.map(function(t){return t.replace(/^(\t)+/,function(t){return Array(t.length+1).join(e)})}).join("\n")},t.exports=n},{}],4:[function(e,t,r){var n=e("./lines.js"),a=function(){this.entries=[]};a.prototype.enter=function(){function e(e){return function(){for(var t=0;t<arguments.length;t++)e.push(arguments[t]);return r}}var t={state:[],pre:[],cond:null,log:[],post:[]};this.entries.push(t);var r={state:e(t.state),pre:e(t.pre),cond:function(e){return t.cond=e,r},log:e(t.log),post:e(t.post)};return r},a.prototype.innerPrependedLines=function(){return[]},a.prototype.bracketFnArg=function(){return""},a.prototype.wrapCall=function(e){return e},a.prototype.write=function(e,t){function r(e,t){var r;r=e in s?s[e]:s[e]={prevs:[],conds:[],mark:c},null!==r.conds&&(null===t?r.conds=null:r.conds.push(t)),null!==l&&r.prevs.push(l),l=e}function a(){null!==l&&p.push(l),l=null}function o(){function e(e,t){var r=null;null!==t.conds&&(r=t.conds.join(" || ")),r!=o&&(null!==o&&a.push("}"),o=r,null!==o&&a.push("if ("+o+") {")),null!==o?a.push("	"+e):a.push(e)}function t(t,n){n.mark=u,r(n.prevs),n.mark=h,e(t,n)}function r(e){e.forEach(function(e){s[e].mark==c&&t(e,s[e])})}var a=[],o=null;return r(p),null!==o&&a.push("}"),new n(a)}var i=new n,s={},p=[],l=null,c=0,u=1,h=2;this.entries.forEach(function(n){i.a(n.state),n.pre.forEach(function(e){r(e,null)}),t&&n.log.forEach(function(e){r(e,n.cond)}),n.post.forEach(function(e){r(e,n.cond)}),e&&r("scheduleFrame();",n.cond),a()});var d=this.bracketListener(),f=o();if(f.isEmpty()||(f=new n(this.innerPrependedLines(),f)),1==f.data.length){var m=/^(\w+)\(\);$/.exec(f.data[0]);if(m)return i.a(this.wrapCall(new n(d[0]+m[1]+d[1])))}return f.data.length?i.a(this.wrapCall(f.wrap(d[0]+"function("+this.bracketFnArg()+"){","}"+d[1]))):i};var o=function(e){a.call(this),this.id=e};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.bracketListener=function(){return["document.getElementById('"+this.id+"').addEventListener('change',",");"]};var i=function(e){a.call(this),this.query=e};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.wrapCall=function(e){return e.wrap("[].forEach.call(document.querySelectorAll('"+this.query+"'),function(el){","});")},i.prototype.bracketListener=function(){return["el.addEventListener('change',",");"]};var s=function(){a.call(this)};s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.enter=function(){var e=a.prototype.enter.call(this);return e.prexy=function(t,r,n){return"mousemovex"==t?e.pre(r):"mousemovey"==t?e.pre(n):e},e},s.prototype.bracketListener=function(){return["canvas.addEventListener('mousemove',",");"]},s.prototype.bracketFnArg=function(){return"ev"},s.prototype.innerPrependedLines=function(){return["var rect=this.getBoundingClientRect();"]},r.SliderListener=o,r.MultipleSliderListener=i,r.CanvasMousemoveListener=s},{"./lines.js":3}],5:[function(e,t,r){function n(){return"webgl-starter-id-"+o++}function a(e){return"data:text/html;charset=utf-8,"+encodeURIComponent(e)}var o=0,i=e("./i18n.js"),s=e("./options.js"),p=e("./code.js");$(function(){$(".webgl-starter").each(function(){function e(e,t){f.find("[data-option^='"+e.getSuboptionScopePrefix()+"']").show().not("[data-option^='"+e.getSuboptionHitPrefix(t)+"']").hide()}function t(){clearTimeout(y),y=setTimeout(function(){m.text(p(g.fix(),i)),window.hljs&&hljs.highlightBlock(m[0])},x)}function r(r){var a=n(),o=$("<div>").append("<label for='"+a+"'>"+i("options."+r.name)+":</label>").append(" ").append($("<select id='"+a+"'>").append(r.availableValues.map(function(e){return $("<option>").val(e).html(i("options."+r.name+"."+e))})).val(g[r.name]).change(function(){g[r.name]=this.value,e(r,this.value),t()}));return"elements"==r.name&&o.append(" "+i("message.elements")),o}function o(e){function r(r){this.checkValidity()&&(r.val(this.value),g[e.name]=parseFloat(this.value),t())}var a,o,s=n(),p=n();return $("<div data-option='"+e.name+"'>").append("<label for='"+s+"'>"+i("options."+e.name)+":</label>").append(" <span class='min'>"+e.getMinLabel()+"</span> ").append(a=$("<input type='range' id='"+s+"'>").attr("min",e.getMin()).attr("max",e.getMax()).attr("step",e.getSetupStep()).val(g[e.name]).on("input change",function(){r.call(this,o)})).append(" <span class='max'>"+e.getMaxLabel()+"</span> ").append(o=$("<input type='number' required>").attr("min",e.getMin()).attr("max",e.getMax()).attr("step",e.getSetupStep()).val(g[e.name]).on("input change",function(){r.call(this,a)})).append(" ").append($("<button type='button'>Reset</button>").click(function(){a.val(e.defaultValue).change()})).append(" ").append("<label for='"+p+"'>"+i("options.*.input")+"</label> ").append($("<select id='"+p+"'>").append(e.availableInputTypes.map(function(e){return $("<option>").val(e).html(i("options.*.input."+e))})).val(g[e.name+".input"]).change(function(){g[e.name+".input"]=this.value,t()}))}function l(e){var r=n();return $("<div>").append($("<input type='checkbox' id='"+r+"'>").prop("checked",g[e.name]).change(function(){g[e.name]=$(this).prop("checked"),t()})).append(" <label for='"+r+"'>"+i("options."+e.name)+"</label>")}function c(e,t){var r=null;e.children().prepend($("<div draggable='true' tabindex='0' title='Drag or press up/down while in focus to reorder transforms'>").on("dragstart",function(e){r=$(this).parent(),e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("Text",name),e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(r[0],0,0),setTimeout(function(){r.addClass("ghost")},0)}).keydown(function(e){var r=$(this),n=r.parent();return 38==e.keyCode?(n.prev().before(n),r.focus(),t(),!1):40==e.keyCode?(n.next().after(n),r.focus(),t(),!1):void 0})).on("dragover",function(e){e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move";var n=$(this);r&&(n.nextAll().is(r)?(n.before(r),t()):n.prevAll().is(r)&&(n.after(r),t()))}).on("drop",function(e){e.preventDefault()}).on("dragend",function(e){e.preventDefault(),r&&(r.removeClass("ghost"),r=null)})}function u(){var e,n=$("<div>").append($("<fieldset>").append("<legend>"+i("options.general")+"</legend>").append(g.generalOptions.map(r))).append($("<fieldset>").append("<legend>"+i("options.input")+"</legend>").append(g.inputOptions.map(o))).append($("<fieldset>").append("<legend>"+i("options.transform")+"</legend>").append(e=$("<div>").append(g.transforms.map(function(e){return $("<div class='transform' data-transform='"+e.name+"'>").append(e.options.map(o))})))).append($("<fieldset>").append("<legend>"+i("options.debug")+"</legend>").append(g.debugOptions.map(l))).append($("<fieldset>").append("<legend>"+i("options.formatting")+"</legend>").append(g.formattingOptions.map(r)));return c(e,function(){g.transformOrder=e.children().map(function(){return $(this).attr("data-transform")}).get(),t()}),n}function h(){g.generalOptions.forEach(function(t){e(t,g[t.name])})}function d(){return $("<div>").append($("<a download='source.html'><button type='button'>Save source code</button></a>").click(function(){$(this).attr("href",a(m.text()))})).append(" ").append($("<button type='button'>Run in new window</button>").click(function(){window.open(a(m.text()),"generatedCode")})).append(" these buttons don't work in Internet Explorer, copy-paste the code manually")}var f,m,v=$(this),g=new s,y=null,x=200;v.empty().append(f=u()),h(),v.append(d()).append($("<pre>").append(m=$("<code>").text(p(g.fix(),i)))),window.hljs?hljs.highlightBlock(m[0]):v.append("<p>"+i("message.hljs")+"</p>"),v.append(d())})})},{"./code.js":1,"./i18n.js":2,"./options.js":6}],6:[function(e,t,r){var n=function(e,t,r){this.name=e,this.availableValues=t,void 0===r?this.defaultValue=t[0]:this.defaultValue=r};n.prototype.getSuboptionScopePrefix=function(){return this.name+"."},n.prototype.getSuboptionHitPrefix=function(e){return"shape"==this.name&&["gasket","hat","terrain"].indexOf(e)>=0&&(e="lodShape"),this.getSuboptionScopePrefix()+e+"."},n.prototype.doesValueHideOption=function(e,t){function r(e){return 0===t.name.indexOf(e)}return r(this.getSuboptionScopePrefix())&&!r(this.getSuboptionHitPrefix(e))};var a=function(e,t,r){n.call(this,e,t,r)};a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.availableInputTypes=["constant","slider","mousemovex","mousemovey"],a.prototype.getMin=function(){return this.availableValues[0]},a.prototype.getMax=function(){return this.availableValues[1]},a.prototype.getMinLabel=function(e){return void 0===e&&(e=this.getMin()),e.toString().replace("-","−")},a.prototype.getMaxLabel=function(e){return void 0===e&&(e=this.getMax()),e.toString().replace("-","−")};var o=function(e,t,r){a.call(this,e,t,r)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.getStep=function(){return"any"},o.prototype.getSetupStep=function(){return this.getMax()>=100?"0.1":this.getMax()>=10?"0.01":"0.001"};var i=function(e,t,r){a.call(this,e,t,r)};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.getStep=function(){return 1},i.prototype.getSetupStep=function(){return 1};var s=function(e,t,r){i.call(this,e,t,r)};s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.availableInputTypes=["constant","slider"];var p=function(e,t){n.call(this,e,[!1,!0],t)};p.prototype=Object.create(n.prototype),p.prototype.constructor=p;var l=function(){this.reset()};l.prototype.generalOptions=[new n("background",["none","solid"]),new n("shader",["single","vertex","face","light"]),new n("shape",["square","triangle","gasket","cube","hat","terrain"]),new n("elements",["0","8","16","32"]),new n("projection",["ortho","perspective"])],l.prototype.inputOptions=[new s("canvas.width",[1,1024],512),new s("canvas.height",[1,1024],512),new o("background.solid.color.r",[0,1],1),new o("background.solid.color.g",[0,1],1),new o("background.solid.color.b",[0,1],1),new o("background.solid.color.a",[0,1],1),new o("shader.single.color.r",[0,1],1),new o("shader.single.color.g",[0,1]),new o("shader.single.color.b",[0,1]),new o("shader.single.color.a",[0,1],1),new i("shape.lodShape.lod",[0,10],6)],l.prototype.transformOptions=[],l.prototype.transforms=[],["rotate.x","rotate.y","rotate.z"].forEach(function(e){var t=new o(e,[-180,180],0),r=new o(e+".speed",[-360,360],0);l.prototype.transformOptions.push(t),l.prototype.transformOptions.push(r),l.prototype.transforms.push({name:e,options:[t,r]})}),l.prototype.debugOptions=[new p("debugShaders",!0),new p("debugArrays"),new p("debugInputs")],l.prototype.formattingOptions=[new n("indent",["tab","2","4","8"])],l.prototype.groupNames=["generalOptions","inputOptions","transformOptions","debugOptions","formattingOptions"],l.prototype.reset=function(){this.groupNames.forEach(function(e){this[e].forEach(function(t){this[t.name]=t.defaultValue,("inputOptions"==e||"transformOptions"==e)&&(this[t.name+".input"]="constant")},this)},this),this.transformOrder=this.transforms.map(function(e){return e.name})},l.prototype.fix=function(){return new c(this)};var c=function(e){e.groupNames.forEach(function(t){this[t]=[],e[t].forEach(function(r){var n=e.generalOptions.some(function(t){return t.doesValueHideOption(e[t.name],r)});n||(this[t].push(r),this[r.name]=e[r.name],("inputOptions"==t||"transformOptions"==t)&&(this[r.name+".input"]=e[r.name+".input"]))},this)},this),this.transformOrder=e.transformOrder};c.prototype.getInputOptionsFor=function(e){
return this.inputOptions.filter(function(t){return 0===t.name.indexOf(e+".")},this)},c.prototype.getInputsFor=function(e){return this.inputOptions.filter(function(t){return 0===t.name.indexOf(e+".")&&"constant"!=this[t.name+".input"]},this)},c.prototype.getOnlyInputFor=function(e){var t=this.getInputsFor(e);return 1==t.length?t[0]:null},c.prototype.hasInputs=function(){return this.inputOptions.some(function(e){return"constant"!=this[e.name+".input"]},this)||this.transformOptions.some(function(e){return"constant"!=this[e.name+".input"]},this)},c.prototype.hasSliderInputs=function(){return this.inputOptions.some(function(e){return"slider"==this[e.name+".input"]},this)||this.transformOptions.some(function(e){return"slider"==this[e.name+".input"]},this)},c.prototype.hasInputsFor=function(e){return this.getInputsFor(e).length>0},c.prototype.hasAllSliderInputsFor=function(e){return this.getInputOptionsFor(e).every(function(e){return"slider"==this[e.name+".input"]},this)},c.prototype.isAnimated=function(){function e(e,t){return-1!==e.indexOf(t,e.length-t.length)}return this.transformOptions.some(function(t){return e(t.name,".speed")&&(0!=this[t.name]||"constant"!=this[t.name+".input"])},this)},c.prototype.needsUniform=function(e){return"constant"!=this[e+".input"]||0!=this[e+".speed"]||"constant"!=this[e+".speed.input"]},c.prototype.needsTransform=function(e){return this.needsUniform(e)||0!=this[e]},t.exports=l},{}],7:[function(e,t,r){r.Square=e("./shapes/square.js"),r.Triangle=e("./shapes/triangle.js"),r.Gasket=e("./shapes/gasket.js"),r.Cube=e("./shapes/cube.js"),r.Hat=e("./shapes/hat.js"),r.Terrain=e("./shapes/terrain.js")},{"./shapes/cube.js":8,"./shapes/gasket.js":9,"./shapes/hat.js":10,"./shapes/square.js":14,"./shapes/terrain.js":15,"./shapes/triangle.js":16}],8:[function(e,t,r){var n=e("../lines.js"),a=e("./shape.js"),o=function(e,t){a.call(this,e,t)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.dim=3,o.prototype.twoSided=!1,o.prototype.writeArrays=function(e,t){function r(e,t,r){d.a(o[t]),"light"==this.shaderType&&d.t(l[e]),"vertex"==this.shaderType&&d.t(i[t]),"face"==this.shaderType&&d.t(c[e]),r&&d.t(" // "+p[e]+" face")}var a=8,o=["-0.5,-0.5,-0.5,","+0.5,-0.5,-0.5,","-0.5,+0.5,-0.5,","+0.5,+0.5,-0.5,","-0.5,-0.5,+0.5,","+0.5,-0.5,+0.5,","-0.5,+0.5,+0.5,","+0.5,+0.5,+0.5,"],i=[" 0.0, 0.0, 0.0,"," 1.0, 0.0, 0.0,"," 0.0, 1.0, 0.0,"," 1.0, 1.0, 0.0,"," 0.0, 0.0, 1.0,"," 1.0, 0.0, 1.0,"," 0.0, 1.0, 1.0,"," 1.0, 1.0, 1.0,"],s=6,p=["left","right","bottom","top","back","front"],l=["-1.0, 0.0, 0.0,","+1.0, 0.0, 0.0,"," 0.0,-1.0, 0.0,"," 0.0,+1.0, 0.0,"," 0.0, 0.0,-1.0,"," 0.0, 0.0,+1.0,"],c=[" 1.0, 0.0, 0.0,"," 0.0, 1.0, 0.0,"," 1.0, 1.0, 0.0,"," 0.0, 0.0, 1.0,"," 1.0, 0.0, 1.0,"," 0.0, 1.0, 1.0,"],u=[[4,6,0,2],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[5,7,4,6]],h=[0,1,2,2,1,3],d=new n;if(d.a("// x    y    z"),"light"==this.shaderType&&d.t("  n.x  n.y  n.z"),e&&d.t("    r    g    b"),this.usesElements()){if("face"==this.shaderType||"light"==this.shaderType){for(var f=0;s>f;f++)u[f].forEach(function(e,t){r.call(this,f,e,0==t)},this);return new n(d.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;","var elements=new "+this.getElementIndexJsArray()+"([","	 0,  1,  2,  2,  1,  3, // left face","	 4,  5,  6,  6,  5,  7, // right face","	 8,  9, 10, 10,  9, 11, // bottom face","	12, 13, 14, 14, 13, 15, // top face","	16, 17, 18, 18, 17, 19, // back face","	20, 21, 22, 22, 21, 23, // front face","]);")}for(var f=0;a>f;f++)d.a(o[f]),e&&d.t(i[f]);for(var m=new n,f=0;s>f;f++)m.a(""),h.forEach(function(e){m.t(u[f][e]+", ")}),m.t("// "+p[f]+" face");return new n(d.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;",m.wrap("var elements=new "+this.getElementIndexJsArray()+"([","]);"))}for(var f=0;s>f;f++)h.forEach(function(e,t){r.call(this,f,u[f][e],0==t)},this);return new n("var nVertices=36;",d.wrap("var vertices=new Float32Array([","]);"))},t.exports=o},{"../lines.js":3,"./shape.js":13}],9:[function(e,t,r){var n=e("../lines.js"),a=e("./lodshape.js"),o=function(e,t,r){a.call(this,e,t,r)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.getDistinctVertexCount=function(e){return"(Math.pow(3,"+e+"+1)+3)/2"},o.prototype.getFaceVertexCount=function(e){return"Math.pow(3,"+e+")*3"},o.prototype.getTotalVertexCount=function(e){return"Math.pow(3,"+e+")*3"},o.prototype.writeStoreShapeWithElements=function(e,t){function r(){var t=new n;return t.a("vertices[nextIndexIntoVertices++]=p[0];","vertices[nextIndexIntoVertices++]=p[1];"),e&&("face"==this.shaderType?t.a("var c=colors[nextIndexIntoColors];"):t.a("var c=colors[nextElement%colors.length];"),t.a("vertices[nextIndexIntoVertices++]=c[0];","vertices[nextIndexIntoVertices++]=c[1];","vertices[nextIndexIntoVertices++]=c[2];")),t.a("return nextElement++;"),t.wrap("function pushVertex(p) {","}")}function a(){var e=new n;return e.a("if (depth<=0) {"),"face"==this.shaderType?e.a("	pushElement(pushVertex(p0));","	pushElement(pushVertex(p1));","	pushElement(pushVertex(p2));","	nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"):e.a("	if (es[0]===null) es[0]=pushVertex(p0);","	if (es[1]===null) es[1]=pushVertex(p1);","	if (es[2]===null) es[2]=pushVertex(p2);","	pushElement(es[0]);","	pushElement(es[1]);","	pushElement(es[2]);","	return es;"),e.a("} else {","	var p01=mix(p0,p1);","	var p12=mix(p1,p2);","	var p20=mix(p2,p0);"),"face"==this.shaderType?e.a("	var es0=triangle(depth-1,p0,p01,p20);","	var es1=triangle(depth-1,p1,p12,p01);","	var es2=triangle(depth-1,p2,p20,p12);"):e.a("	var es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);","	var es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);","	var es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);","	return [es0[0],es1[0],es2[0]];"),e.a("}"),"face"==this.shaderType?e.wrap("function triangle(depth,p0,p1,p2) {","}"):e.wrap("function triangle(depth,p0,p1,p2,es) {","}")}function o(){var e=new n;return e.a("shapeLod,","[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],","[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],","[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]"),"face"!=this.shaderType&&e.t(",","[null,null,null]"),e.wrap("triangle(",");")}var i=new n;return i.a("var nextIndexIntoVertices=0;","var nextIndexIntoElements=0;","var nextElement=0;"),e?(i.a("// p = position, c = color, e = element, es = elements","var colors=[","	[1.0, 0.0, 0.0],","	[0.0, 1.0, 0.0],","	[0.0, 0.0, 1.0],","	[1.0, 1.0, 0.0],","];"),"face"==this.shaderType&&i.a("var nextIndexIntoColors=0;")):i.a("// p = position, e = element, es = elements"),i.a(r.call(this),"function pushElement(e) {","	elements[nextIndexIntoElements++]=e;","}","function mix(pa,pb) {","	return [","		(pa[0]+pb[0])/2,","		(pa[1]+pb[1])/2,","	];","}",a.call(this),o.call(this)),i},o.prototype.writeStoreShapeWithoutElements=function(e,t){var r=new n;return r.a("var iv=0;"),"face"==this.shaderType&&r.a("var ic=0;","var colors=[","	[1.0, 0.0, 0.0],","	[0.0, 1.0, 0.0],","	[0.0, 0.0, 1.0],","	[1.0, 1.0, 0.0],","];"),"vertex"==this.shaderType?r.a("function pushVertex(v,r,g,b) {","	vertices[iv++]=v[0]; vertices[iv++]=v[1];","	vertices[iv++]=r; vertices[iv++]=g; vertices[iv++]=b;","}"):"face"==this.shaderType?r.a("function pushVertex(v,c) {","	vertices[iv++]=v[0]; vertices[iv++]=v[1];","	vertices[iv++]=c[0]; vertices[iv++]=c[1]; vertices[iv++]=c[2];","}"):r.a("function pushVertex(v) {","	vertices[iv++]=v[0]; vertices[iv++]=v[1];","}"),r.a("function mix(a,b,m) {","	return [","		a[0]*(1-m)+b[0]*m,","		a[1]*(1-m)+b[1]*m,","	];","}","function triangle(depth,a,b,c) {","	if (depth<=0) {"),"vertex"==this.shaderType?r.a("		pushVertex(a,1.0,0.0,0.0);","		pushVertex(b,0.0,1.0,0.0);","		pushVertex(c,0.0,0.0,1.0);"):"face"==this.shaderType?r.a("		pushVertex(a,colors[ic]);","		pushVertex(b,colors[ic]);","		pushVertex(c,colors[ic]);","		ic=(ic+1)%colors.length;"):r.a("		pushVertex(a);","		pushVertex(b);","		pushVertex(c);"),r.a("	} else {","		var ab=mix(a,b,0.5);","		var bc=mix(b,c,0.5);","		var ca=mix(c,a,0.5);","		triangle(depth-1,a,ab,ca);","		triangle(depth-1,b,bc,ab);","		triangle(depth-1,c,ca,bc);","	}","}","triangle(","	shapeLod,","	[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],","	[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],","	[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]",");"),r},o.prototype.writeStoreShape=function(e,t){return this.usesElements()?this.writeStoreShapeWithElements(e,t):this.writeStoreShapeWithoutElements(e,t)},t.exports=o},{"../lines.js":3,"./lodshape.js":11}],10:[function(e,t,r){var n=e("../lines.js"),a=e("./mesh.js"),o=function(e,t,r){a.call(this,e,t,r)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.writeMeshInit=function(){return new n("var xyRange=4;","var xyScale=1/(4*Math.sqrt(2));")},o.prototype.writeMeshVertex=function(e,t){var r=new n;return r.a("var r2=(x*x+y*y)/2;","var A=Math.exp(-r2)/Math.PI;","var z=A*(1-r2);","vertices[vertexOffset+0]=x*xyScale;","vertices[vertexOffset+1]=y*xyScale;","vertices[vertexOffset+2]=z;"),this.getNumbersPerNormal()?r.a("var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);","vertices[vertexOffset+3]=normal[0];","vertices[vertexOffset+4]=normal[1];","vertices[vertexOffset+5]=normal[2];"):e&&r.a(this.usesElements()||"face"==this.shaderType?"var ic=(i&1)*2+(j&1);":"var ic=((i+di)&1)*2+((j+dj)&1);","vertices[vertexOffset+3]=colors[ic][0];","vertices[vertexOffset+4]=colors[ic][1];","vertices[vertexOffset+5]=colors[ic][2];"),r},t.exports=o},{"../lines.js":3,"./mesh.js":12}],11:[function(require,module,exports){var Lines=require("../lines.js"),Shape=require("./shape.js"),LodShape=function(e,t,r){Shape.call(this,e,t),this.lod=r;var n=this.getMaxPossibleLod();this.lod.value>n&&(this.lod.value=n),this.lod.max>n&&(this.lod.max=n)};LodShape.prototype=Object.create(Shape.prototype),LodShape.prototype.constructor=LodShape,LodShape.prototype.getMaxPossibleLod=function(){if(!this.usesElements()||this.elementIndexBits>=31)return this.lod.max;for(var nVerticesFn="face"==this.shaderType?this.getFaceVertexCount:this.getDistinctVertexCount,indexLimit=1<<this.elementIndexBits,m=this.lod.max;m>=0;m--){var n=eval(nVerticesFn(m));if(indexLimit>=n)return m}},LodShape.prototype.writeArraysAndBufferData=function(e,t,r){var n="face"==this.shaderType?this.getFaceVertexCount:this.getDistinctVertexCount,a=new Lines;return this.lod.changes?(a.a("var minShapeLod="+this.lod.min+";","var maxShapeLod="+this.lod.max+";"),this.usesElements()?a.a("var nMaxVertices="+n("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");","var nMaxElements="+this.getTotalVertexCount("maxShapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nMaxElements);",this.writeDebug(e),"var shapeLod,nVertices,nElements;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+n("shapeLod")+";","	nElements="+this.getTotalVertexCount("shapeLod")+";"):a.a("var nMaxVertices="+this.getTotalVertexCount("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"var shapeLod,nVertices;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+this.getTotalVertexCount("shapeLod")+";")):(a.a("var shapeLod="+this.lod.value+";"),this.usesElements()?a.a("var nVertices="+n("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");","var nElements="+this.getTotalVertexCount("shapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nElements);",this.writeDebug(e),"function storeShape() {"):a.a("var nVertices="+this.getTotalVertexCount("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"function storeShape() {")),a.a(this.writeStoreShape(t,r).indent(),this.writeBufferData().indent(),"}"),this.lod.changes?a.a("storeShape("+this.lod.value+");"):a.a("storeShape();"),a},module.exports=LodShape},{"../lines.js":3,"./shape.js":13}],12:[function(e,t,r){var n=e("../lines.js"),a=e("./lodshape.js"),o=function(e,t,r){a.call(this,e,t,r)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.dim=3,o.prototype.getDistinctVertexCount=function(e){return"Math.pow((1<<"+e+")+1,2)"},o.prototype.getFaceVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*4"},o.prototype.getTotalVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*6"},o.prototype.writeStoreShape=function(e,t){var r=new n;return r.a("var res=(1<<shapeLod);"),this.usesElements()?"face"==this.shaderType?r.a("function vertexElement(i,j,k) {","	return (i*res+j)*4+k;","}"):r.a("function vertexElement(i,j) {","	return i*(res+1)+j;","}"):r.a("function vertexElement(i,j,k) {","	return (i*res+j)*6+k;","}"),this.getNumbersPerNormal()&&r.a("function normalize(v) {","	var l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);","	return [v[0]/l,v[1]/l,v[2]/l];","}"),e&&r.a("var colors=[","	[1.0, 1.0, 0.0],","	[1.0, 0.0, 0.0],","	[0.0, 1.0, 0.0],","	[0.0, 0.0, 1.0],","];"),r.a(this.writeMeshInit()),this.usesElements()?"face"==this.shaderType?r.a("var i,j;","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		for (var k=0;k<4;k++) {","			var di=[0,0,1,1][k];","			var dj=[0,1,0,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex(e,t).indent(3),"		}","	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i,j,0);","		elements[elementOffset+1]=vertexElement(i,j,1);","		elements[elementOffset+2]=vertexElement(i,j,2);","		elements[elementOffset+3]=vertexElement(i,j,2);","		elements[elementOffset+4]=vertexElement(i,j,1);","		elements[elementOffset+5]=vertexElement(i,j,3);","	}","}"):r.a("var i,j;","for (i=0;i<=res;i++) {","	var y=i/res*xyRange*2-xyRange;","	for (j=0;j<=res;j++) {","		var x=j/res*xyRange*2-xyRange;","		var vertexOffset=vertexElement(i,j)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex(e,t).indent(2),"	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i+0,j+0);","		elements[elementOffset+1]=vertexElement(i+0,j+1);","		elements[elementOffset+2]=vertexElement(i+1,j+0);","		elements[elementOffset+3]=vertexElement(i+1,j+0);","		elements[elementOffset+4]=vertexElement(i+0,j+1);","		elements[elementOffset+5]=vertexElement(i+1,j+1);","	}","}"):r.a("for (var i=0;i<res;i++) {","	for (var j=0;j<res;j++) {","		for (var k=0;k<6;k++) {","			var di=[0,0,1,1,0,1][k];","			var dj=[0,1,0,0,1,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex(e,t).indent(3),"		}","	}","}"),r},t.exports=o},{"../lines.js":3,"./lodshape.js":11}],13:[function(e,t,r){var n=e("../lines.js"),a=function(e,t){this.elementIndexBits=e,this.shaderType=t};a.prototype.dim=2,a.prototype.twoSided=!0,a.prototype.glPrimitive="TRIANGLES",a.prototype.usesElements=function(){return this.elementIndexBits>0},a.prototype.getNumbersPerPosition=function(){return this.dim},a.prototype.getNumbersPerNormal=function(){return"light"==this.shaderType&&3==this.dim?3:0},a.prototype.getNumbersPerColor=function(){return"vertex"==this.shaderType||"face"==this.shaderType?3:0},a.prototype.getNumbersPerVertex=function(){return this.getNumbersPerPosition()+this.getNumbersPerNormal()+this.getNumbersPerColor()},a.prototype.getElementIndexJsArray=function(){return"Uint"+this.elementIndexBits+"Array"},a.prototype.getElementIndexGlType=function(){return 8==this.elementIndexBits?"gl.UNSIGNED_BYTE":16==this.elementIndexBits?"gl.UNSIGNED_SHORT":32==this.elementIndexBits?"gl.UNSIGNED_INT":void 0},a.prototype.writeDebug=function(e){var t=new n;return e&&(t.a("console.log('vertex array byte length:',vertices.byteLength);"),this.usesElements()&&(t.a("console.log('element array byte length:',elements.byteLength);"),t.a("console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);"))),t},a.prototype.writeBufferData=function(){var e=new n;return e.a("gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);"),this.usesElements()&&e.a("gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);"),e},a.prototype.writeArraysAndBufferData=function(e,t,r){return new n(this.writeArrays(t,r),this.writeDebug(e),this.writeBufferData())},a.prototype.writeInit=function(e){var t="vertex"==this.shaderType||"face"==this.shaderType,r="vertex"==this.shaderType,a=new n;return a.a("gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());"),this.usesElements()&&a.a("gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());"),a.a(this.writeArraysAndBufferData(e,t,r),"var positionLoc=gl.getAttribLocation(program,'position');"),t?a.a("gl.vertexAttribPointer(","	positionLoc,"+this.dim+",gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*"+(this.dim+3)+",","	Float32Array.BYTES_PER_ELEMENT*0",");","gl.enableVertexAttribArray(positionLoc);","var colorLoc=gl.getAttribLocation(program,'color');","gl.vertexAttribPointer(","	colorLoc,3,gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*"+(this.dim+3)+",","	Float32Array.BYTES_PER_ELEMENT*"+this.dim,");","gl.enableVertexAttribArray(colorLoc);"):this.dim>2&&"light"==this.shaderType?a.a("gl.vertexAttribPointer(","	positionLoc,"+this.dim+",gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*"+(this.dim+3)+",","	Float32Array.BYTES_PER_ELEMENT*0",");","gl.enableVertexAttribArray(positionLoc);","var normalLoc=gl.getAttribLocation(program,'normal');","gl.vertexAttribPointer(","	normalLoc,3,gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*"+(this.dim+3)+",","	Float32Array.BYTES_PER_ELEMENT*"+this.dim,");","gl.enableVertexAttribArray(normalLoc);"):a.a("gl.vertexAttribPointer(positionLoc,"+this.dim+",gl.FLOAT,false,0,0);","gl.enableVertexAttribArray(positionLoc);"),a},a.prototype.writeDraw=function(){return new n(this.usesElements()?"gl.drawElements(gl."+this.glPrimitive+",nElements,"+this.getElementIndexGlType()+",0);":"gl.drawArrays(gl."+this.glPrimitive+",0,nVertices);")},t.exports=a},{"../lines.js":3}],14:[function(e,t,r){var n=e("../lines.js"),a=e("./shape.js"),o=function(e,t){a.call(this,e,t)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.glPrimitive="TRIANGLE_FAN",o.prototype.writeArrays=function(e,t){var r=new n("var nVertices=4;","var vertices=new Float32Array([","	// x    y"+(e?"    r    g    b":""),"	-0.5,-0.5,"+(e?" 1.0, 0.0, 0.0,":""),"	+0.5,-0.5,"+(e?t?" 0.0, 1.0, 0.0,":" 1.0, 0.0, 0.0,":""),"	+0.5,+0.5,"+(e?t?" 0.0, 0.0, 1.0,":" 1.0, 0.0, 0.0,":""),"	-0.5,+0.5,"+(e?t?" 1.0, 1.0, 0.0,":" 1.0, 0.0, 0.0,":""),"]);");return this.usesElements()&&r.a("var nElements=4;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2,3]);"),r},t.exports=o},{"../lines.js":3,"./shape.js":13}],15:[function(e,t,r){var n=e("../lines.js"),a=e("./mesh.js"),o=function(e,t,r){a.call(this,e,t,r)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.writeMeshInit=function(){var e=this.usesElements()&&"face"!=this.shaderType,t=new n;return t.a("var xyRange=1/Math.sqrt(2);","var zRange=xyRange;","var mask=res-1;","function zOffset(i,j) {","	return vertexElement(i,j"+(e?"":",0")+")*"+this.getNumbersPerVertex()+"+2;","}","function noise(depth) {","	var r=zRange/Math.pow(2,shapeLod-depth-1);","	return Math.random()*2*r-r;","}","vertices[2]=0.0;","var i0,i1,i2,i3;","var j0,j1,j2,j3;","for (var depth=shapeLod-1;depth>=0;depth--) {","	var d=1<<depth;","	// diamond step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i1=i2-d;","			j1=j2-d;","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j2)]=(","				vertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+","				vertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]","			)/4+noise(depth);","		}","	}","	// square step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i0=(i2-2*d)&mask;","			j0=(j2-2*d)&mask;","			i1=(i2-d);","			j1=(j2-d);","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j1)]=(","				vertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]","			)/4+noise(depth);","			vertices[zOffset(i1,j2)]=(","				vertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]","			)/4+noise(depth);","		}","	}","}"),e&&t.a("for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];","for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];","vertices[zOffset(res,res)]=vertices[zOffset(0,0)];"),t},o.prototype.writeMeshVertex=function(e,t){var r=this.usesElements()&&"face"!=this.shaderType,a=new n;return a.a("vertices[vertexOffset+0]=x;","vertices[vertexOffset+1]=y;",r?"// vertices[vertexOffset+2] already written":"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];"),this.getNumbersPerNormal()?a.a("var d=4*xyRange/res;","var normal=normalize([",r?"	(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,":"	(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,",r?"	(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,":"	(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,","1]);","vertices[vertexOffset+3]=normal[0];","vertices[vertexOffset+4]=normal[1];","vertices[vertexOffset+5]=normal[2];"):e&&a.a(this.usesElements()||"face"==this.shaderType?"var ic=(i&1)*2+(j&1);":"var ic=((i+di)&1)*2+((j+dj)&1);","vertices[vertexOffset+3]=colors[ic][0];","vertices[vertexOffset+4]=colors[ic][1];","vertices[vertexOffset+5]=colors[ic][2];"),a},t.exports=o},{"../lines.js":3,"./mesh.js":12}],16:[function(e,t,r){var n=e("../lines.js"),a=e("./shape.js"),o=function(e,t){a.call(this,e,t)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.writeArrays=function(e,t){var r=new n("var nVertices=3;","var vertices=new Float32Array([","	//                   x                      y"+(e?"    r    g    b":""),"	-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),"+(e?" 1.0, 0.0, 0.0,":""),"	-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),"+(e?t?" 0.0, 1.0, 0.0,":" 1.0, 0.0, 0.0,":""),"	-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),"+(e?t?" 0.0, 0.0, 1.0,":" 1.0, 0.0, 0.0,":""),"]);");return this.usesElements()&&r.a("var nElements=3;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2]);"),r},t.exports=o},{"../lines.js":3,"./shape.js":13}]},{},[5]);
//# sourceMappingURL=index.js.map