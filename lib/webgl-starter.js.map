{"version":3,"sources":["node_modules/browser-pack/_prelude.js","webgl-starter.js","node_modules/crnx-base/array-option-output.js","node_modules/crnx-base/code-output-i18n.js","node_modules/crnx-base/code-output.js","node_modules/crnx-base/code-section.js","node_modules/crnx-base/details-polyfill.js","node_modules/crnx-base/fake-lodash/camelcase.js","node_modules/crnx-base/fake-lodash/capitalize.js","node_modules/crnx-base/fake-lodash/debounce.js","node_modules/crnx-base/fake-lodash/escape.js","node_modules/crnx-base/format-number.js","node_modules/crnx-base/format-numbers.js","node_modules/crnx-base/group-option-output.js","node_modules/crnx-base/i18n-expand-curly.js","node_modules/crnx-base/i18n-link-wikipedia.js","node_modules/crnx-base/i18n.js","node_modules/crnx-base/indent-lines.js","node_modules/crnx-base/interleave-lines.js","node_modules/crnx-base/js-lines.js","node_modules/crnx-base/lines.js","node_modules/crnx-base/nose-wrap-lines.js","node_modules/crnx-base/option-classes.js","node_modules/crnx-base/options-output-i18n.js","node_modules/crnx-base/options-output.js","node_modules/crnx-base/options.js","node_modules/crnx-base/tip.js","node_modules/crnx-base/web-code.js","node_modules/crnx-base/wrap-lines.js","node_modules/crnx-build/babel-helpers/string-prototype-repeat.es5","node_modules/crnx-build/babel-helpers/arraylike-prototype-includes.es5","src/background.js","src/call-vector.js","src/canvas.js","src/code.js","src/colorgen.js","src/feature-context.js","src/feature.js","src/glsl-vector.js","src/i18n.js","src/illumination.js","src/input-classes.js","src/int-feature.js","src/listener-classes.js","src/main.js","src/numeric-feature.js","src/option-classes.js","src/options-output.js","src/options.js","src/shape-classes.js","src/shapes/cube.js","src/shapes/gasket.js","src/shapes/hat.js","src/shapes/lodshape.js","src/shapes/mesh.js","src/shapes/shape.js","src/shapes/square.js","src/shapes/terrain.js","src/shapes/triangle.js","src/transforms.js","src/vector-component.js","src/vector.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","ArrayOptionOutput","option","writeOption","i18n","generateId","_this","this","___babelHelper___classCallCheck","$dragged","$entries","$","append","entries","map","subOption","writeDraggableSubOption","$buttons","availableTypes","forEach","type","html","fullName","click","makeEntry","updateArrayEntries","$output","prototype","canDeleteEntry","$entry","children","data","get","_this2","moveUp","$moved","prev","before","moveDown","next","after","attemptDelete","remove","This","on","ev","parent","originalEvent","dataTransfer","effectAllowed","setData","name","setDragImage","setTimeout","addClass","$sorted","h","height","offset","top","y","touches","pageY","$prev","$next","removeClass","keydown","$handle","keyCode","focus","preventDefault","dropEffect","$target","is","dh","nextAll","th","_dh","_y","prevAll",2,"lang","strings","additionalStringsPrefix","additionalStrings","en","save","run","open.codepen","open.jsfiddle","open.plunker","section.html","section.css","section.js","embedded","mode.full","mode.body","mode.embed","mode.paste","mode.file","formatting","formatting.indent","formatting.indentNumber","formatting.jsSemicolons","warning.no-hljs","ru","id",3,"debounce","detailsPolyfill","getHtmlDataUri","encodeURIComponent","makeObjectWithSetters","values","setCallback","obj","_loop","prop","Object","defineProperty","set","v","CodeOutput","generateCode","defaultFormatting","update","flush","applyUpdatedCode","sectionModes","css","js","_code","initDomProps","writeFormattingControls","$indentCheckbox","undefined","$indentNumber","updateIndent","indent","checkValidity","Number","val","change","jsSemicolons","checked","each","writeSection","sectionName","writeSectionSummary","$sectionCode","writeButtons","window","hljs","$saveButtons","sections","extractSections","empty","$code","getHtml","join","highlightBlock","postData","url","target","$form","attr","appendTo","submit","navigator","msSaveOrOpenBlob","w","open","document","write","close","getSection","JSON","stringify","title","wrap","_postData","filename","$summary","mode","value","section","blob","Blob","mimeType","$a","download","href","URL","createObjectURL","___babelHelper___createClass","key","29","5","8",4,"CodeSection","lines","detailsSupported","createElement","$details","toggleOpen","removeAttr","keyCodeEnter","keyCodeSpace","handleEvent","closest",6,"capitalize","split","7","charAt","toUpperCase","slice","func","wait","timeoutId","debounced","clearTimeout",9,"entityMap","&","<",">","\"","'","String","replace","m",10,"formatNumbers","formatNumber","number","precision","glsl","11","formatNumbersInternal","numbers","keepDot","noPlus","maxPrecision","hasNegative","p","toFixed","match","ss","Array","isArray","_i","_number","_s",12,"GroupOptionOutput",13,"inStrings","expandIdAndString","string","idMatch","expandRegexp","exec","idStart","idMidsStr","idEnd","idMids","stringMatch","stringStart","stringMidsStr","stringEnd","stringMids","idMid","stringMid",14,"p1","link","text","indexOf",15,"escape","langStrings","defaultLang","has","pluralSuffix","ns","nn","Math","abs","teen","plural","haveToAttachUnit","unit","test","expandedUnit","abbrFn","abbr","expansion","numberWithUnits","numberWithoutUnits","numberUnits","28",16,"Lines","IndentLines","_Lines","level","___babelHelper___possibleConstructorReturn","___babelHelper___inherits","doGet","indentStr","19",17,"InterleaveLines","apply","arguments","out","first","fp","push","_arr","item","subOut",18,"JsLines","processStringInGet","TO","TypeError","isDataEmpty","isEmpty","addTo","_arr2","_i2","pop","shift","b","_arguments","makeLines","Function","bind","concat","ae","ba","_b","be","bae","_b2","count","_arguments2","reduce",20,"WrapLines","NoseWrapLines","_WrapLines","27",21,"Option","Base","_class","settings","visibilityManager","updateCallbacks","_$","isVisible","register","visibilityData","visibilityDataLogic","testName","options","declareAffectedBy","make","nScalars","nArrays","nObjects","scalarArg","arrayArg","objectArg","_len","rest","_key","arg","optionClass","collectArgs","updateVisibility","toggle","updateCallback","addUpdateCallback","shortenExport","dataKeys","keys","shortenExportAssign","parentData","Input","_Option$Base","_class2","defaultValue","_value","create","export","Boolean","_Option$Input","_class3","fix","NonBoolean","_Option$Input2","_class4","valueOf","toString","Factor","_Option$NonBoolean","_class5","_this4","availableValues","_Option$NonBoolean2","_class6","_this5","availableMin","availableMax","fixed","Struct","_Option$Base2","_class7","_this6","descriptions","x","subName","subData","entry","fixedEntries","_i3","Collection","_Option$Base3","_class8","_this7","availableConstructors","Map","enterCollection","_arr3","_i4","ctor","exitCollection","typePropertyName","subDatas","defaultType","indexedEntries","subType","subCtor","populateEntries","fn","getElementsPropertyName","setElementExportData","element","setElementFixData","_this8","getEntryFromElement","_ref","_this9","subFixed","types","_","Void","_Option$Base4","_class9","Checkbox","_Option$Boolean","_class10","Select","_Option$Factor","_class11","Text","_Option$Factor2","_class12","Int","_Option$Number","_class13","_class14","_Option$Number2","_this15","Float","Root","_Option$Struct","_class15","datas","Group","_Option$Struct2","_class16","_Option$Collection","_class17","_entries","filter",22,"writeTip","reset","drag","drag.tip","delete","delete.tip",23,"OptionsOutput","optionProto","getPrototypeOf","optionClassWriter","optionClassWriters","constructor","setOptionClassWriters","root","getLeadLabel","valueId","valueInfoId","$select","availableValue","some","$tip","handler","find","listId","setInputAttrs","$input","min","max","step","pow","setInputAttrsAndListeners","$that","parseFloat","$sliderInput","$numberInput","fmt","infoId","25","inCollection","OptionVisibilityManager","affects","updateVisibilityAffectedBy","byFullName","Options","optionClasses","description","_Option$className","className","makeArgs","entriesDescription","tipClass","tipContent","popupTimeoutId","popupLevel","handlePopup","dLevel","delay","mouseenter","focusin",26,"_templateObject","___babelHelper___taggedTemplateLiteralLoose","_templateObject2","cachedStyleLines","_templateObject3","WebCode","getLines","stylePlaceLines","styleExtractLines","getSectionPasteComment","basename","scriptPlaceLines","cachedScriptLines","scriptExtractLines","htmlExtractLines","getBodyHtmlSectionLines","getFullHtmlSectionLines","cachedHeadLines","cachedBodyLines","_styleLines","styleLines","_headLines","headLines","_bodyLines","bodyLines","_scriptLines","scriptLines","wrappers","pushWrapper","haystack","needle","start","includes","isSolid","repeat",30,"Feature","CallVector","Background","_Feature","features","color","getJsLoopLines","featureContext","31","36","modeConstant","components","Vector","_Vector","calledFn","calledFnDefaultArgs","dotIndex","getJsUpdateLines","componentValue","nValueSliders","component","input","every","lastIndexOf","suffixArray","suffix","addPostToListenerEntryAfterComponents","post","60",32,"Listener","IntFeature","Canvas","width","needAspectConstant","getHtmlCanvasLines","getGlslVertexDeclarationLines","hasInputs","getGlslVertexOutputLines","providesAspect","getJsInitLines","canvasUpdater","canvasListener","wh","listener","Slider","enter","log","getListenerLines","canvas","Shape","FeatureContext","Transforms","Illumination","BaseWebCode","Code","_BaseWebCode","debug","background","transforms","illumination","material","light","makeShape","shape","scope","getColorAttrs","featureNames","feature","requestFeatureContext","hasSliders","getVertexShaderLines","needTransformedPosition","wantsTransformedPosition","eyeAtInfinity","dim","hasNormals","getGlslVertexNormalTransformLines","getFragmentShaderLines","getGlslFragmentDeclarationLines","getGlslFragmentOutputLines","twoSided","_NoseWrapLines$b","_this3","getHtmlControlMessageLines","getHtmlInputLines","getMakeProgramLines","debugShaders","addWithCommentIfNotEmpty","featureLines","comment","getJsAfterInitLines","getJsInnerLoopLines","hasClampFn","hasWrapFn","pollsGamepad","hasStartTime","hasPrevTime","isAnimated","hasTime","35","39","48","58",34,"colorgenCounter","SingleColorgen","weight","noise","baseColors","defaultBaseColors","colorgenNumber","nextIndex","getNextColorString","baseColor","ci","sin","co","Colorgen","colorAttrs","singleColorgens","getHeaderString","singleColorgen","debugOptions","canvasMousemoveListener","CanvasMousemove","inputs","42","getRecursiveLines","method","args",37,"GlslVector","wrapRange","getGlslDeclarationLines","modeFloats","nVars","varName","_ret","variable","getGlslValue","getGlslComponentsValue","selectedComponents","results","j","c","componentsBySuffix","modeVector","prevResult","allSuffixString","allSameConstant","cmp","result","showResult","getGlslMapDeclarationLines","mapName","mapFn","getGlslMapComponentValue","selectedComponent","getJsDeclarationLines","varNameLoc","addPostToListenerEntryForComponent","vs","options.canvas","options.canvas.{width,height}","options.background","options.background.type","options.background.type.none","options.background.type.solid","options.background.color","options.background.color.{r,g,b,a}","options.background.color.{r,g,b,a}.speed","options.material","options.material.scope","options.material.scope.global","options.material.scope.vertex","options.material.scope.face","options.material.data","options.material.data.one","options.material.data.sda","options.material.color","options.material.color.{r,g,b,a}","options.material.color.{r,g,b,a}.speed","options.material.{specular,diffuse,ambient}Color","options.material.{specular,diffuse,ambient}Color.{r,g,b}","options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed","options-info.material.data.sda","options.light","options.light.type","options.light.type.off","options.light.type.phong","options.light.type.blinn","options.light.direction","options.light.direction.{x,y,z}","options.light.direction.{x,y,z}.speed","options-info.light.type.phong","options-info.light.type.blinn","options.shape","options.shape.type","options.shape.type.square","options.shape.type.triangle","options.shape.type.gasket","options.shape.type.cube","options.shape.type.hat","options.shape.type.terrain","options.shape.elements","options.shape.elements.0","options.shape.elements.{8,16,32}","options.shape.lod","options-info.shape.type.gasket","options-info.shape.type.hat","options-info.shape.type.terrain","options-info.shape.elements.{8,16}","options.transforms","options.transforms.projection","options.transforms.projection.ortho","options.transforms.projection.perspective","options.transforms.model","options.transforms.model.rotate.{x,y,z}.add","options.transforms.model.rotate.{x,y,z}","options.transforms.model.rotate.{x,y,z}.speed","options-info.transforms.projection.ortho","options-info.transforms.projection.perspective","options.debug","options.debug.shaders","options.debug.arrays","options.debug.inputs","options.debug.animations","options-output.inputs","options-output.inputs.constant","options-output.inputs.slider","options-output.inputs.mousemove{x,y}","options-output.inputs.gamepad{0,1,2,3}","options-output.range","options-output.addSpeed","controls.type.mousemove{x,y}","controls.to","units.pixel.a","units.pixel.{1,2}","units.°/second.a","units.°/second.{1,2}","units.second.a","units.1/second.{1,2}","options.material.specularColor.{r,g,b}","options.material.diffuseColor.{r,g,b}","options.material.ambientColor.{r,g,b}","options.material.specularColor.{r,g,b}.speed","options.material.diffuseColor.{r,g,b}.speed","options.material.ambientColor.{r,g,b}.speed","units.pixel.{1,2,5}","units.°/second.{1,2,5}","units.1/second.{1,2,5}","colorVector","specularColorVector","specularColor","diffuseColorVector","diffuseColor","ambientColorVector","ambientColor","LiveFloat","lightDirectionVector","direction","enabled","hasNormalAttr","normalTransformLines","colorRGB","colorA","colorRGBA","vector","specularDotArgs","shininessCorrection","45",40,"createFromString","str","constant","Constant","slider","mousemovex","MouseMove","mousemovey","gamepad0","Gamepad","gamepad1","gamepad2","gamepad3","_str","_Base","Variable","_Base2","_Variable","_Variable2","axis","_Variable3","41","NumericFeature","_NumericFeature","getHtmlControlMessageForValue","getHtmlSliderLines","44","makePushArgs","where","proxy","pre","cond","prependedStatements","bracketFnArg","wrapCall","haveToUpdateCanvas","haveToLogInput","statementsGraph","statementsRoot","statementsPrev","WHITE","GRAY","BLACK","addStatement","statement","vertex","prevs","conds","mark","closeEntryStatements","getStatements","statements","currentCond","writeStatement","newCond","recVertex","recPrevs","br","bracketListener","MultipleSlider","query","_Base3","inputType","floatHelper","minMaxFlag","varFlag","minValue","maxValue","VarName","dest","prexy","xStatement","yStatement","minMaxFloat","minMaxVarFloat","newVarInt",43,"idCounter","i18ns","$container","codeOutput","optionsOutput",33,38,"46","47","opName","htmlName","fmtAttrs","fmtLabels","minMax","FixedLiveNumber","src","setToDefault","LiveNumber","dataValue","dataMin","dataMax","dataInput","_min","_max","_input","_$range","updateInternalVisibility","exportHelper","$range","LiveInt","_Option$LiveNumber","CanvasLiveInt","_Option$LiveInt","_Option$LiveNumber2","speed","dataSpeedValue","dataSpeedMin","dataSpeedMax","dataSpeedInput","_speedAvailableMin","_speedAvailableMax","_speedValue","_speedMin","_speedMax","_speedInput","_addSpeed","_speed$","_speed$range","_$addSpeed","notGamepad","addSpeed","availableInputTypes","$addSpeed","LiveColor","_Option$Group","componentDefaultValues","cs","BaseOptionsOutput","_BaseOptionsOutput","writeSubOption","writeMinMaxInput","minOrMax","$inputSelect","$rangeMinInput","$rangeMaxInput","availableInputType","BaseOptions","_BaseOptions","background.type","material.scope","material.data","light.type","shape.type",24,"square","triangle","gasket","cube","hat","terrain","49","50","51","55","56","57","Cube","_Shape","writeArrays","colorgen","hasColorsPerFace","nCubeVertices","cubeColors","cubeVertexPositions","nCubeFaces","cubeFaceNames","cubeFaceNormals","cubeFaceVertices","quadToTriangleMap","vertexCtor","appendVertex","iFace","iVertex","firstInFace","hasColorsPerVertex","wrapVertices","usesElements","k","_loop2","getElementIndexJsArray","_ret3","elementCtor","_loop3","wrapElements","54","LodShape","Gasket","_LodShape","getDistinctVertexCount","lodSymbol","getFaceVertexCount","getTotalVertexCount","writeStoreShape","writePushVertex","writeTriangle","writeInitialTriangleCall","writeColorData","52","Mesh","Hat","_Mesh","writeMeshInit","writeMeshVertex","iv","writeMeshVertexColors","53","hasReflections","maxLod","getMaxPossibleLod","lod","cap","requestedMaxLod","elementIndexBits","nVerticesFn","indexLimit","eval","writeArraysAndBufferData","debugArrays","getNumbersPerVertex","writeDebug","writeBufferData","parseInt","elements","getElementIndexGlType","writeVertexAttribArrays","attrs","cmpSize","allSameSize","size","allEnabled","arrayLines","foreachEnableLines","foreachLines","arrays","glPrimitive","Square","colorDataForFace","Terrain","noFaces","Triangle","rotateVectorEntries","transformSequence","model","possibleComponents","rotate","tr","iTr","trData","transform","index","nLayers","isInGap","isStraight","lastStraightIndex","makeVector","names","i18nId","storeSequenceElement","_j","_j2","_has","_vector","use2dTransform","flatShape","getTransformMatricesLines","maxSuffixLength","pad","mat","rows","row","ts","projection","rve","receivesAspect",59,"camelCase","VectorComponent","vectorName","hasSpeed","hasInput","hasInputClass","inputClass","usesStartTime","usesPrevTime","wrapReady","wrapped","clamped","makeInitialComponentValue","makeUpdatedComponentValue","getSliderListenerLines","doUpdate","getManyListenersLines","writeListener","updateFnName","getOneListenerLines","manyListenersLines","oneListenerLines","someSpeeds","someValueSliders","someGamepads","writeVarLines","sfmt","snumbers","writes","swrites","varNameSpeed","add","needUpdate","writeGamepad","dotSuffix","varSuffix","minVarName","maxVarName","limitFn","dx","capped","incrementLine","base","dt","varNameInput","animations"],"mappings":"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","file":"webgl-starter.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"'use strict'\r\n\r\nclass ArrayOptionOutput {\r\n\tconstructor(option,writeOption,i18n,generateId) {\r\n\t\tthis.option=option\r\n\t\tthis.$dragged=null\r\n\t\tthis.$entries=$(\"<div class='entries'>\").append(\r\n\t\t\toption.entries.map(subOption=>this.writeDraggableSubOption(subOption,writeOption,i18n))\r\n\t\t)\r\n\t\tconst $buttons=$(\"<div class='buttons'>\")\r\n\t\toption.availableTypes.forEach((type,i)=>{\r\n\t\t\tif (i) $buttons.append(\" \")\r\n\t\t\t$buttons.append(\r\n\t\t\t\t$(\"<button type='button'>\").html(\r\n\t\t\t\t\ti18n('options.'+option.fullName+'.'+type+'.add')\r\n\t\t\t\t).click(()=>{\r\n\t\t\t\t\tthis.$entries.append(\r\n\t\t\t\t\t\tthis.writeDraggableSubOption(option.makeEntry(type),writeOption,i18n)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tthis.updateArrayEntries()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t\tthis.$output=option.$=$(\"<fieldset class='option'>\").append(\r\n\t\t\t\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\",\r\n\t\t\tthis.$entries,\r\n\t\t\t$buttons\r\n\t\t)\r\n\t}\r\n\tcanDeleteEntry($entry) {\r\n\t\treturn true\r\n\t}\r\n\tupdateArrayEntries() {\r\n\t\tthis.option.entries=this.$entries.children().map(function(){\r\n\t\t\treturn $(this).data('option')\r\n\t\t}).get()\r\n\t}\r\n\twriteDraggableSubOption(subOption,writeOption,i18n) {\r\n\t\t// have to make drag handler 'draggable', not the whole item\r\n\t\t// because inputs and labels don't like to be inside 'draggable'\r\n\t\t// http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\r\n\t\tconst moveUp=$moved=>{\r\n\t\t\t$moved.prev().before($moved)\r\n\t\t\tthis.updateArrayEntries()\r\n\t\t}\r\n\t\tconst moveDown=$moved=>{\r\n\t\t\t$moved.next().after($moved)\r\n\t\t\tthis.updateArrayEntries()\r\n\t\t}\r\n\t\tconst attemptDelete=$entry=>{\r\n\t\t\tif (this.canDeleteEntry($entry)) {\r\n\t\t\t\t$entry.remove()\r\n\t\t\t\tthis.updateArrayEntries()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst This=this\r\n\t\treturn $(\"<div class='draggable-with-handle'>\").data('option',subOption).append(\r\n\t\t\twriteOption(subOption),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<span draggable='true' tabindex='0' title='\"+i18n('options-output.drag.tip')+\"'>\").append(\r\n\t\t\t\t\"<span>\"+i18n('options-output.drag')+\"</span>\"\r\n\t\t\t).on('dragstart',function(ev){\r\n\t\t\t\tThis.$dragged=$(this).parent()\r\n\t\t\t\tev.originalEvent.dataTransfer.effectAllowed='move'\r\n\t\t\t\tev.originalEvent.dataTransfer.setData('Text',name)\r\n\t\t\t\tif (ev.originalEvent.dataTransfer.setDragImage) { // doesn't work in IE\r\n\t\t\t\t\tev.originalEvent.dataTransfer.setDragImage(This.$dragged[0],0,0)\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\tThis.$dragged.addClass('ghost')\r\n\t\t\t\t},0)\r\n\t\t\t}).on('touchstart',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\t$sorted.addClass('ghost')\r\n\t\t\t\treturn false // disable touch panning on Firefox\r\n\t\t\t}).on('touchmove',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\tconst h=$sorted.height()\r\n\t\t\t\tconst t=$sorted.offset().top\r\n\t\t\t\tconst y=ev.originalEvent.touches[0].pageY // TODO test if length of touches is 1\r\n\t\t\t\tconst $prev=$sorted.prev()\r\n\t\t\t\tif ($prev.length && y<t && y-$prev.offset().top<h) {\r\n\t\t\t\t\tmoveUp($sorted)\r\n\t\t\t\t}\r\n\t\t\t\tconst $next=$sorted.next()\r\n\t\t\t\tif ($next.length && y>t+h && y-$next.offset().top>$next.height()-h) {\r\n\t\t\t\t\tmoveDown($sorted)\r\n\t\t\t\t}\r\n\t\t\t\treturn false // disable touch panning\r\n\t\t\t}).on('touchend touchcancel',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\t$sorted.removeClass('ghost')\r\n\t\t\t}).keydown(function(ev){\r\n\t\t\t\tconst $handle=$(this)\r\n\t\t\t\tconst $sorted=$handle.parent()\r\n\t\t\t\tif (ev.keyCode==38) {\r\n\t\t\t\t\tmoveUp($sorted)\r\n\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\treturn false\r\n\t\t\t\t} else if (ev.keyCode==40) {\r\n\t\t\t\t\tmoveDown($sorted)\r\n\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button class='delete' title='\"+i18n('options-output.delete.tip')+\"'>\").append(\r\n\t\t\t\t\"<span>\"+i18n('options-output.delete')+\"</span>\"\r\n\t\t\t).click(function(){\r\n\t\t\t\tattemptDelete($(this).parent())\r\n\t\t\t}).keydown(function(ev){\r\n\t\t\t\tif (ev.keyCode==13 || ev.keyCode==32) {\r\n\t\t\t\t\tattemptDelete($(this).parent())\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t).on('dragover',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t\tev.originalEvent.dataTransfer.dropEffect='move'\r\n\t\t\tconst $target=$(this)\r\n\t\t\tif (This.$dragged) {\r\n\t\t\t\tif ($target.next().is(This.$dragged)) {\r\n\t\t\t\t\tconst dh=This.$dragged.height()\r\n\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\tif (y<dh) {\r\n\t\t\t\t\t\tmoveUp(This.$dragged)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ($target.nextAll().is(This.$dragged)) {\r\n\t\t\t\t\tmoveUp(This.$dragged)\r\n\t\t\t\t} else if ($target.prev().is(This.$dragged)) {\r\n\t\t\t\t\tconst th=$target.height()\r\n\t\t\t\t\tconst dh=This.$dragged.height()\r\n\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\tif (y>th-dh) {\r\n\t\t\t\t\t\tmoveDown(This.$dragged)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ($target.prevAll().is(This.$dragged)) {\r\n\t\t\t\t\tmoveDown(This.$dragged)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).on('drop',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t}).on('dragend',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t\tif (This.$dragged) {\r\n\t\t\t\tThis.$dragged.removeClass('ghost')\r\n\t\t\t\tThis.$dragged=null\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=ArrayOptionOutput\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='code-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'save': \"Save source code\",\r\n\t\t\t'run': \"Run in new window\",\r\n\t\t\t'open.codepen': \"Open in CodePen\",\r\n\t\t\t'open.jsfiddle': \"Open in JSFiddle\",\r\n\t\t\t'open.plunker': \"Open in Plunker\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"embedded in HTML source code\",\r\n\t\t\t'mode.full': \"complete HTML\",\r\n\t\t\t'mode.body': \"only HTML body\",\r\n\t\t\t'mode.embed': \"embed in HTML\",\r\n\t\t\t'mode.paste': \"extract to paste into HTML later\",\r\n\t\t\t'mode.file': \"extract to load as external resource\",\r\n\t\t\t'formatting': \"Formatting\",\r\n\t\t\t'formatting.indent': \"indent with tabs\",\r\n\t\t\t'formatting.indentNumber': \"spaces per indent\",\r\n\t\t\t'formatting.jsSemicolons': \"JavaScript semicolons\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (hosted on <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) is not loaded. Syntax highlighting is disabled.\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'save': \"Сохранить исходный код\",\r\n\t\t\t'run': \"Запустить в новом окне\",\r\n\t\t\t'open.codepen': \"Открыть в CodePen\",\r\n\t\t\t'open.jsfiddle': \"Открыть в JSFiddle\",\r\n\t\t\t'open.plunker': \"Открыть в Plunker\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"встроен в код HTML\",\r\n\t\t\t'mode.full': \"полностью\",\r\n\t\t\t'mode.body': \"только <code>body</code>\",\r\n\t\t\t'mode.embed': \"встроить в HTML\",\r\n\t\t\t'mode.paste': \"извлечь для последующей вставки в HTML\",\r\n\t\t\t'mode.file': \"извлечь для загрузки в качестве внешнего ресурса\",\r\n\t\t\t'formatting': \"Форматирование\",\r\n\t\t\t'formatting.indent': \"отступы с помощью tab\",\r\n\t\t\t'formatting.indentNumber': \"пробелов в отступе\",\r\n\t\t\t'formatting.jsSemicolons': \"<code>;</code> в JavaScript\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (с сервера <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) не загружен. Подсветка синтаксиса отключена.\",\r\n\t\t},\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst debounce=require('./fake-lodash/debounce')\r\nconst detailsPolyfill=require('./details-polyfill')\r\n\r\nconst getHtmlDataUri=(html)=>'data:text/html;charset=utf-8,'+encodeURIComponent(html)\r\n\r\nconst makeObjectWithSetters=(values,setCallback)=>{\r\n\tconst obj={}\r\n\tfor (let prop in values) {\r\n\t\tObject.defineProperty(obj,prop,{\r\n\t\t\tget: ()=>values[prop],\r\n\t\t\tset: v=>{\r\n\t\t\t\tvalues[prop]=v\r\n\t\t\t\tsetCallback()\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\treturn obj\r\n}\r\n\r\nclass CodeOutput {\r\n\tconstructor(generateCode,i18n) {\r\n\t\tthis.formatting=makeObjectWithSetters(\r\n\t\t\tthis.defaultFormatting,\r\n\t\t\t()=>{\r\n\t\t\t\tthis.update.flush()\r\n\t\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t\t}\r\n\t\t)\r\n\t\tthis.sectionModes=makeObjectWithSetters(\r\n\t\t\t{html:'full',css:'embed',js:'embed'},\r\n\t\t\t()=>{\r\n\t\t\t\tthis.update.flush()\r\n\t\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t\t}\r\n\t\t)\r\n\t\tthis._code=generateCode()\r\n\t\tthis.update=debounce(()=>{\r\n\t\t\tthis._code=generateCode()\r\n\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t},200)\r\n\r\n\t\tthis.initDomProps()\r\n\t\tconst writeFormattingControls=()=>{\r\n\t\t\tconst This=this\r\n\t\t\tlet $indentCheckbox,$indentNumber\r\n\t\t\tconst updateIndent=()=>{\r\n\t\t\t\tlet indent='\\t'\r\n\t\t\t\tif (!$indentCheckbox.prop('checked')) {\r\n\t\t\t\t\tlet n=4\r\n\t\t\t\t\tif ($indentNumber[0].checkValidity()) {\r\n\t\t\t\t\t\tn=Number($indentNumber.val())\r\n\t\t\t\t\t}\r\n\t\t\t\t\tindent=' '.repeat(n)\r\n\t\t\t\t}\r\n\t\t\t\tthis.formatting.indent=indent\r\n\t\t\t}\r\n\t\t\treturn $(\"<details>\").append(\r\n\t\t\t\t\"<summary>\"+i18n('code-output.formatting')+\"</summary>\",\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentCheckbox=$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t.prop('checked',this.formatting.indent=='\\t')\r\n\t\t\t\t\t\t\t.change(updateIndent),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indent')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentNumber=$(\"<input type='number' min='0' max='32' required>\")\r\n\t\t\t\t\t\t\t.val(this.formatting.indent=='\\t'?4:this.formatting.indent.length)\r\n\t\t\t\t\t\t\t.on('input change',updateIndent),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indentNumber')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t.prop('checked',this.formatting.jsSemicolons)\r\n\t\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\t\tThis.formatting.jsSemicolons=this.checked\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.jsSemicolons')\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t).each(detailsPolyfill)\r\n\t\t}\r\n\t\tconst writeSection=(sectionName)=>{\r\n\t\t\treturn $(\"<details open>\").append(\r\n\t\t\t\tthis.writeSectionSummary(sectionName,i18n),\r\n\t\t\t\tthis.$sectionCode[sectionName]=$(\"<div class='code'>\")\r\n\t\t\t).each(detailsPolyfill)\r\n\t\t}\r\n\t\tconst $output=$(\"<div class='code-output'>\").append(this.writeButtons(i18n)).append(\r\n\t\t\twriteFormattingControls(),\r\n\t\t\twriteSection('html'),\r\n\t\t\twriteSection('css'),\r\n\t\t\twriteSection('js')\r\n\t\t)\r\n\t\tif (!window.hljs) {\r\n\t\t\t$output.append(\"<p>\"+i18n('code-output.warning.no-hljs')+\"</p>\")\r\n\t\t}\r\n\t\t$output.append(this.writeButtons(i18n))\r\n\t\tthis.applyUpdatedCode(i18n)\r\n\r\n\t\t// public interface:\r\n\t\t// this.update\r\n\t\tthis.$output=$output\r\n\t}\r\n\r\n\t// private interface:\r\n\tget code() {\r\n\t\tthis.update.flush()\r\n\t\treturn this._code\r\n\t}\r\n\r\n\t// extend/override fns:\r\n\tget defaultFormatting() {\r\n\t\treturn {\r\n\t\t\tindent: '\\t',\r\n\t\t\tjsSemicolons: false,\r\n\t\t}\r\n\t}\r\n\tinitDomProps() {\r\n\t\tthis.$sectionCode={}\r\n\t\tthis.$saveButtons={}\r\n\t}\r\n\tapplyUpdatedCode(i18n) { // TODO pass code to avoid recursion on accessing this.code... or not b/c reading this.sectionModes and like\r\n\t\tconst sections=this.code.extractSections(this.sectionModes)\r\n\t\tfor (let sectionName in sections) {\r\n\t\t\tif (this.sectionModes[sectionName]=='embed') {\r\n\t\t\t\tthis.$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\"<p>\"+i18n('code-output.embedded')+\"</p>\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tlet $code\r\n\t\t\t\tthis.$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t$(\"<pre>\").append(\r\n\t\t\t\t\t\t$code=$(\"<code class='\"+sectionName+\"'>\")\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\t$code.html(\r\n\t\t\t\t\tsections[sectionName].getHtml(this.formatting).join(\"\\n\")\r\n\t\t\t\t)\r\n\t\t\t\tif (window.hljs) {\r\n\t\t\t\t\thljs.highlightBlock($code[0])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (sectionName!='html') { // extractable section\r\n\t\t\t\tthis.$saveButtons[sectionName].prop('disabled',this.sectionModes[sectionName]=='embed')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\twriteButtons(i18n) {\r\n\t\tconst This=this\r\n\t\tconst postData=(url,target,data)=>{\r\n\t\t\tconst $form=$(`<form method='post' action='${url}' target='${target}'>`)\r\n\t\t\tfor (let name in data) {\r\n\t\t\t\t$form.append(\r\n\t\t\t\t\t$(\"<input type='hidden'>\").attr('name',name).val(data[name])\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t$form.appendTo('body').submit().remove()\r\n\t\t}\r\n\t\treturn $(\"<div>\").append(\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.run')+\"</button>\").click(function(){\r\n\t\t\t\tconst html=This.code.get(This.formatting).join(\"\\n\")\r\n\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * Firefox and Chrome have trouble showing the source\r\n\t\t\t\t\t// * weird bug in Firefox:\r\n\t\t\t\t\t//   in webgl-starter: add z-rotation, slider input, add speed, slider input, run, change rotation range, run again\r\n\t\t\t\t\t// * Firefox shows url of a generator page\r\n\t\t\t\t\tconst w=window.open(\"\",\"generatedCode\")\r\n\t\t\t\t\tw.document.open()\r\n\t\t\t\t\tw.document.write(html)\r\n\t\t\t\t\tw.document.close()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * doesn't work in IE b/c they decided it's security risk\r\n\t\t\t\t\t// * long url\r\n\t\t\t\t\twindow.open(getHtmlDataUri(html),\"generatedCode\")\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.codepen')+\"</button>\").click(function(){\r\n\t\t\t\t// http://blog.codepen.io/documentation/api/prefill/\r\n\t\t\t\tconst sections=This.code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://codepen.io/pen/define/','codepenGeneratedCode',{\r\n\t\t\t\t\tdata: JSON.stringify({\r\n\t\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\t\ttitle: This.code.title, // doesn't work?\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.jsfiddle')+\"</button>\").click(function(){\r\n\t\t\t\t// http://doc.jsfiddle.net/api/post.html\r\n\t\t\t\tconst sections=This.code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://jsfiddle.net/api/post/library/pure/','jsfiddleGeneratedCode',{\r\n\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\ttitle: This.code.title,\r\n\t\t\t\t\twrap: 'b',\r\n\t\t\t\t})\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.plunker')+\"</button>\").click(function(){\r\n\t\t\t\t// https://github.com/angular/angular.js/blob/489835dd0b36a108bedd5ded439a186aca4fa739/docs/app/src/examples.js#L139-L157\r\n\t\t\t\tconst sections=This.code.extractSections({html:'full',css:'file',js:'file'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://plnkr.co/edit/?p=preview','plunkerGeneratedCode',{\r\n\t\t\t\t\t//['files['+sections['html'].filename+']']: getSection('html'), // wants index.html\r\n\t\t\t\t\t['files[index.html]']: getSection('html'),\r\n\t\t\t\t\t['files['+sections['css'].filename+']']: getSection('css'),\r\n\t\t\t\t\t['files['+sections['js'].filename+']']: getSection('js'),\r\n\t\t\t\t\t'private': true,\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t)\r\n\t}\r\n\twriteSectionSummary(sectionName,i18n) {\r\n\t\tconst This=this\r\n\t\tconst $summary=$(\"<summary>\"+i18n('code-output.section.'+sectionName)+\"</summary>\")\r\n\t\t$summary.append(\r\n\t\t\t\" \",\r\n\t\t\t$(\"<select>\").append(\r\n\t\t\t\t(sectionName=='html'\r\n\t\t\t\t\t? ['full','body']\r\n\t\t\t\t\t: ['embed','paste','file']\r\n\t\t\t\t).map(mode=>\r\n\t\t\t\t\t$(\"<option>\").val(mode).html(i18n('code-output.mode.'+mode))\r\n\t\t\t\t)\r\n\t\t\t).val(this.sectionModes[sectionName]).change(function(){\r\n\t\t\t\tThis.sectionModes[sectionName]=this.value\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t// doesn't work in IE\r\n\t\t\t//$(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n\t\t\t//\t// yes I want a button, but download attr is only available for links\r\n\t\t\t//\t$(this).attr('href',getHtmlDataUri(\r\n\t\t\t//\t\tsection.get(this.formatting).join(\"\\n\")\r\n\t\t\t//\t))\r\n\t\t\t//})\r\n\t\t\tthis.$saveButtons[sectionName]=$(\"<button type='button'>\"+i18n('code-output.save')+\"</button>\").click(function(){\r\n\t\t\t\tconst section=This.code.extractSections(This.sectionModes)[sectionName]\r\n\t\t\t\t// http://stackoverflow.com/a/24354303\r\n\t\t\t\tconst blob=new Blob(\r\n\t\t\t\t\t[section.get(This.formatting).join(\"\\n\")],\r\n\t\t\t\t\t{type:section.mimeType}\r\n\t\t\t\t)\r\n\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob,section.filename)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst $a=$(\"<a>\").attr({\r\n\t\t\t\t\t\tdownload: section.filename,\r\n\t\t\t\t\t\thref: URL.createObjectURL(blob),\r\n\t\t\t\t\t}).appendTo('body')\r\n\t\t\t\t\t$a.get(0).click()\r\n\t\t\t\t\t$a.remove()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t)\r\n\t\treturn $summary\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput\r\n","'use strict'\r\n\r\nclass CodeSection {\r\n\tconstructor(filename,mimeType,lines) {\r\n\t\tthis.filename=filename\r\n\t\tthis.mimeType=mimeType\r\n\t\tthis.lines=lines\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.lines.get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.lines.getHtml(formatting)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeSection\r\n","'use strict'\r\n\r\nconst detailsSupported=('open' in document.createElement('details')) // http://thenewcode.com/680/Feature-Detection-and-Styling-For-The-HTML5-details-Element\r\n\r\nmodule.exports=function(){ // to be called in .each()\r\n\tconst $details=$(this)\r\n\t$details.on('click','summary :input, summary a[href]',function(ev){ // firefox lets those events through\r\n\t\tev.preventDefault()\r\n\t})\r\n\tif (detailsSupported) return\r\n\tconst toggleOpen=()=>{\r\n\t\tif (!$details.attr('open')) {\r\n\t\t\t$details.attr('open','')\r\n\t\t} else {\r\n\t\t\t$details.removeAttr('open')\r\n\t\t}\r\n\t}\r\n\tconst keyCodeEnter=13\r\n\tconst keyCodeSpace=32\r\n\tconst handleEvent=ev=>$(ev.target).closest('summary, :input, a[href]').is('summary') // check if event target is not an input/link, also check its ancestors (jQuery doesn't include <option> in :input selector)\r\n\t$details.addClass('polyfill').children('summary').attr('tabindex',0).click(function(ev){\r\n\t\tif (handleEvent(ev)) {\r\n\t\t\ttoggleOpen()\r\n\t\t}\r\n\t}).keydown(function(ev){\r\n\t\tif (handleEvent(ev) && (ev.keyCode==keyCodeEnter || ev.keyCode==keyCodeSpace)) {\r\n\t\t\ttoggleOpen()\r\n\t\t\treturn false\r\n\t\t}\r\n\t})\r\n}\r\n","// assumes string is dot-separated, like this: \"some.html.id\"\r\nvar capitalize=require('./capitalize')\r\nmodule.exports=function(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('')\r\n}\r\n","// assumes string is lowercase\r\nmodule.exports=function(s){\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1)\r\n}\r\n","// no options\r\nmodule.exports=function(func,wait){\r\n\tvar timeoutId=null\r\n\tvar debounced=function(){\r\n\t\tclearTimeout(timeoutId)\r\n\t\ttimeoutId=setTimeout(function(){\r\n\t\t\ttimeoutId=null\r\n\t\t\tfunc()\r\n\t\t},wait)\r\n\t}\r\n\tdebounced.flush=function(){\r\n\t\tif (timeoutId) {\r\n\t\t\ttimeoutId=null\r\n\t\t\tfunc()\r\n\t\t}\r\n\t}\r\n\treturn debounced\r\n}\r\n","module.exports=function(s){\r\n\tvar entityMap={\r\n\t\t'&': '&amp;',\r\n\t\t'<': '&lt;',\r\n\t\t'>': '&gt;',\r\n\t\t'\"': '&quot;',\r\n\t\t\"'\": '&#39;',\r\n\t\t// lodash also escapes `\r\n\t}\r\n\treturn String(s).replace(/[&<>\"']/g,m=>entityMap[m])\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbers=require('./format-numbers')\r\n\r\nconst formatNumber=(number,precision)=>formatNumbers     ([number],precision)[0]\r\nformatNumber.html =(number,precision)=>formatNumbers.html([number],precision)[0]\r\nformatNumber.js   =(number,precision)=>formatNumbers.js  ([number],precision)[0]\r\nformatNumber.glsl =(number,precision)=>formatNumbers.glsl([number],precision)[0]\r\n\r\nmodule.exports=formatNumber\r\n","'use strict'\r\n\r\nconst formatNumbersInternal=(numbers,precision,keepDot,noPlus)=>{\r\n\tlet maxPrecision=0\r\n\tif (keepDot) {\r\n\t\tmaxPrecision=1\r\n\t}\r\n\tlet hasNegative=false\r\n\tfor (let i in numbers) {\r\n\t\tlet p\r\n\t\tif (precision!==undefined) {\r\n\t\t\tp=precision\r\n\t\t} else if (numbers[i].precision!==undefined) {\r\n\t\t\tp=numbers[i].precision\r\n\t\t} else {\r\n\t\t\tthrow new Error('formatNumbers received no precision')\r\n\t\t}\r\n\t\tconst number=Number(numbers[i])\r\n\t\tlet s=number.toFixed(p)\r\n\t\tif (Number(s)<0) { // protects against negative zero\r\n\t\t\thasNegative=true\r\n\t\t}\r\n\t\tif (p>0) {\r\n\t\t\tp-=s.match(/0*$/)[0].length\r\n\t\t}\r\n\t\tif (p>maxPrecision) {\r\n\t\t\tmaxPrecision=p\r\n\t\t}\r\n\t}\r\n\tconst ss=Array.isArray(numbers)?[]:{}\r\n\tfor (let i in numbers) {\r\n\t\tconst number=Number(numbers[i])\r\n\t\tlet s=number.toFixed(maxPrecision)\r\n\t\tif (Number(s)>=0 && s.charAt(0)=='-') {  // protects against negative zero\r\n\t\t\ts=s.slice(1)\r\n\t\t}\r\n\t\tif (!noPlus && hasNegative && number>0) {\r\n\t\t\ts='+'+s\r\n\t\t}\r\n\t\tss[i]=s\r\n\t}\r\n\treturn ss\r\n}\r\n\r\nconst formatNumbers=(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.html =(number,precision)=>formatNumbersInternal(number,precision,false,true)\r\nformatNumbers.js   =(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.glsl =(number,precision)=>formatNumbersInternal(number,precision,true)\r\n\r\nmodule.exports=formatNumbers\r\n","'use strict'\r\n\r\nclass GroupOptionOutput {\r\n\tconstructor(option,writeOption,i18n,generateId) {\r\n\t\tthis.option=option\r\n\t\tthis.$output=option.$=$(\"<fieldset class='option'>\").append(\r\n\t\t\t\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\",\r\n\t\t\toption.entries.map(writeOption)\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=GroupOptionOutput\r\n","'use strict'\r\n\r\nmodule.exports=function(inStrings){\r\n\tconst strings={}\r\n\tconst expandRegexp=/^([^{]*)\\{([^}]*)\\}(.*)$/\r\n\tfunction expandIdAndString(id,string) {\r\n\t\tconst idMatch=expandRegexp.exec(id)\r\n\t\tif (idMatch) {\r\n\t\t\tconst [,idStart,idMidsStr,idEnd]=idMatch\r\n\t\t\tconst idMids=idMidsStr.split(',')\r\n\t\t\tconst stringMatch=expandRegexp.exec(string)\r\n\t\t\tif (stringMatch) {\r\n\t\t\t\tconst [,stringStart,stringMidsStr,stringEnd]=stringMatch\r\n\t\t\t\tconst stringMids=stringMidsStr.split(',')\r\n\t\t\t\tidMids.forEach((idMid,i)=>{\r\n\t\t\t\t\tif (stringMidsStr!='') {\r\n\t\t\t\t\t\tconst stringMid=stringMids[i]\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+stringMid+stringEnd)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+idMid+stringEnd)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tidMids.forEach(idMid=>{\r\n\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,string)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tstrings[id]=string\r\n\t\t}\r\n\t}\r\n\tfor (let id in inStrings) {\r\n\t\texpandIdAndString(id,inStrings[id])\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tfor (let id in strings) {\r\n\t\tstrings[id]=strings[id].replace(/\\[\\[(.*?)\\]\\]/g,(match,p1)=>{\r\n\t\t\tlet link,text;\r\n\t\t\tconst i=p1.indexOf('|');\r\n\t\t\tif (i<0) {\r\n\t\t\t\tlink=p1;\r\n\t\t\t\ttext=p1;\r\n\t\t\t} else {\r\n\t\t\t\tlink=p1.slice(0,i);\r\n\t\t\t\ttext=p1.slice(i+1);\r\n\t\t\t}\r\n\t\t\treturn \"<a href='https://\"+lang+\".wikipedia.org/wiki/\"+link.replace(/ /g,'_')+\"'>\"+text+\"</a>\";\r\n\t\t});\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\n\r\nmodule.exports=langStrings=>lang=>{\r\n\tconst defaultLang='en'\r\n\tlang=lang||defaultLang\r\n\tlang=lang.split('-')[0]  // get primary language subtag\r\n\tlet strings=langStrings[lang]\r\n\tif (strings===undefined) {\r\n\t\tlang=defaultLang\r\n\t\tstrings=langStrings[lang]\r\n\t}\r\n\tconst i18n=function(id){\r\n\t\tif (strings[id]!==undefined) {\r\n\t\t\treturn strings[id]\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"undefined string \"+id)\r\n\t\t}\r\n\t}\r\n\ti18n.lang=lang\r\n\ti18n.has=id=>strings[id]!==undefined\r\n\tif (lang=='en') {\r\n\t\ti18n.number=(n)=>String(n).replace('-','−')\r\n\t\ti18n.pluralSuffix=(n)=>{\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns/*:string*/.includes('.')) {\r\n\t\t\t\treturn '2'\r\n\t\t\t} else {\r\n\t\t\t\tconst nn=Number(n)\r\n\t\t\t\tif (Math.abs(nn)==1) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (lang=='ru') {\r\n\t\ti18n.number=(n)=>String(n).replace('-','−').replace('.',',')\r\n\t\ti18n.pluralSuffix=(n)=>{\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns/*:string*/.includes('.')) {\r\n\t\t\t\treturn '2'\r\n\t\t\t} else {\r\n\t\t\t\tconst teen=ns.slice(-2,-1)==='1'\r\n\t\t\t\tif (ns.slice(-1)==='1' && !teen) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else if ('234'.includes(ns.slice(-1)) && !teen) {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '5'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\ti18n.plural=(n,id)=>i18n(id+'.'+i18n.pluralSuffix(n))\r\n\tconst haveToAttachUnit=unit=>(unit.length==1 && /^\\W/.test(unit))\r\n\tconst expandedUnit=(n,unit,abbrFn)=>{\r\n\t\tif (abbrFn===undefined) { // codegen needs its own fn\r\n\t\t\tabbrFn=(abbr,expansion)=>\"<abbr title='\"+escape(expansion)+\"'>\"+abbr+\"</abbr>\" // expansion is html for stuff like s^(-1)\r\n\t\t}\r\n\t\tlet abbr\r\n\t\tif (unit=='1/second') {\r\n\t\t\tabbr=i18n('units.second.a')+\"<sup>−1</sup>\"\r\n\t\t} else {\r\n\t\t\tabbr=i18n('units.'+unit+'.a')\r\n\t\t}\r\n\t\tconst expansion=i18n.plural(n,'units.'+unit)\r\n\t\treturn abbrFn(abbr,expansion)\r\n\t}\r\n\ti18n.numberWithUnits=(n,unit,abbrFn)=>{\r\n\t\tlet s=i18n.number(n)\r\n\t\tif (unit===undefined) {\r\n\t\t\treturn s\r\n\t\t} else if (haveToAttachUnit(unit)) {\r\n\t\t\treturn s+unit\r\n\t\t} else {\r\n\t\t\treturn s+' '+expandedUnit(n,unit,abbrFn)\r\n\t\t}\r\n\t}\r\n\t// example:\r\n\t// 1 .. 4 seconds = (1)(4)(seconds)\r\n\t// 1% .. 4% = (1%)(4%)()\r\n\t// made with 3 calls: (numberWithoutUnits)(numberWithoutUnits)(numberUnits)\r\n\ti18n.numberWithoutUnits=function(n,unit){\r\n\t\tlet s=i18n.number(n)\r\n\t\tif (unit!==undefined && haveToAttachUnit(unit)) {\r\n\t\t\treturn s+unit\r\n\t\t} else {\r\n\t\t\treturn s\r\n\t\t}\r\n\t}\r\n\ti18n.numberUnits=function(n,unit,abbrFn){\r\n\t\tif (unit!==undefined && !haveToAttachUnit(unit)) {\r\n\t\t\treturn expandedUnit(n,unit,abbrFn)\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t}\r\n\treturn i18n\r\n}\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\n\r\nclass IndentLines extends Lines {\r\n\tconstructor(data,level) {\r\n\t\tsuper(data)\r\n\t\tif (level!==undefined) {\r\n\t\t\tthis.level=level\r\n\t\t} else {\r\n\t\t\tthis.level=1\r\n\t\t}\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst indentStr=indent/*:string*/.repeat(this.level)\r\n\t\treturn super.doGet(formatting,html).map(s=>indentStr+s)\r\n\t}\r\n}\r\n\r\nmodule.exports=IndentLines\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass InterleaveLines extends Lines {\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet first=true\r\n\t\tconst fp=()=>{\r\n\t\t\tif (first) {\r\n\t\t\t\tfirst=false\r\n\t\t\t} else {\r\n\t\t\t\tout.push('')\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const item of this.data) {\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (subOut.length>0) {\r\n\t\t\t\t\tfp()\r\n\t\t\t\t\tout.push(...subOut)\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tfp()\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=InterleaveLines\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\n\r\nclass JsLines extends Lines {\r\n\tprocessStringInGet(s,formatting) {\r\n\t\tif (formatting.jsSemicolons) {\r\n\t\t\treturn s.replace(/^;/,'')\r\n\t\t} else {\r\n\t\t\treturn s.replace(/;$/,'')\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=JsLines\r\n","'use strict'\r\n\r\n/*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\r\n\r\nconst escape=require('./fake-lodash/escape')\r\n\r\nconst TO={} // TODO Symbol\r\n\r\nclass Lines {\r\n\t// lines private interface:\r\n\tconstructor(data) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError(\"attempted to construct Lines with non-array data argument\")\r\n\t\t}\r\n\t\tthis.data=data\r\n\t}\r\n\tisDataEmpty() {\r\n\t\tfor (const item of this.data) {\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tif (!item.isEmpty()) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\tprocessStringInGet(s,formatting) {\r\n\t\treturn s\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet addTo=false\r\n\t\tfor (const item of this.data) {\r\n\t\t\tif (item===TO) {\r\n\t\t\t\taddTo=true\r\n\t\t\t} else if (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (addTo && subOut.length>0) {\r\n\t\t\t\t\tout.push(out.pop()+subOut.shift())\r\n\t\t\t\t}\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t\taddTo=false\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tlet s=this.processStringInGet(item,formatting)\r\n\t\t\t\tif (formatting.indent!==undefined && formatting.indent!='\\t') {\r\n\t\t\t\t\ts=s.replace(/^(\\t)+/,match=>formatting.indent/*:string*/.repeat(match.length))\r\n\t\t\t\t}\r\n\t\t\t\ts=(html ? escape(s) : s)\r\n\t\t\t\tif (addTo) {\r\n\t\t\t\t\tout.push(out.pop()+s)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout.push(s)\r\n\t\t\t\t}\r\n\t\t\t\taddTo=false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n\r\n\t// lines public interface:\r\n\tstatic b() {\r\n\t\tconst data=[]\r\n\t\tconst makeLines=()=>new this(data,...arguments)\r\n\t\tconst a=function(){\r\n\t\t\treturn a.a(...arguments)\r\n\t\t}\r\n\t\ta.a=function(){\r\n\t\t\tdata.push(...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.t=function(){\r\n\t\t\tdata.push(TO,...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.e=makeLines\r\n\t\ta.ae=function(){\r\n\t\t\treturn this.a(...arguments).e()\r\n\t\t}\r\n\t\treturn a\r\n\t}\r\n\tstatic ba() {\r\n\t\treturn this.b().a(...arguments)\r\n\t}\r\n\tstatic be() {\r\n\t\treturn this.b().e()\r\n\t}\r\n\tstatic bae() {\r\n\t\treturn this.b().a(...arguments).e()\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tget(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,false)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,true)\r\n\t}\r\n\tcount() {\r\n\t\treturn this.doGet({},false).length // can be faster b/c don't need to output stuff\r\n\t}\r\n\r\n\t// TODO make HtmlLines\r\n\tstatic html(strings/*,...values*/) {\r\n\t\t// html template tag\r\n\t\t// usage example for attributes: Lines.html`<input type=text value=${value}>`\r\n\t\t// usage example for elements: Lines.html`<option>${option}</option>`\r\n\t\treturn strings.reduce((r,s,i)=>{\r\n\t\t\tlet v=arguments[i]\r\n\t\t\tswitch (r.slice(-1)) {\r\n\t\t\tcase '=':\r\n\t\t\t\tif (v===false) {\r\n\t\t\t\t\treturn r.replace(/\\s+[a-zA-Z0-9-]+=$/,'')+s // TODO more permitting attr name regexp\r\n\t\t\t\t} else if (v===true) {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t}\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;')\r\n\t\t\t\tif (v=='') {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t} else if (!/[\\s\"'=<>`]/.test(v)) {\r\n\t\t\t\t\treturn r+v+s\r\n\t\t\t\t} else if (!/'/.test(v)) {\r\n\t\t\t\t\treturn r+\"'\"+v+\"'\"+s\r\n\t\t\t\t} else {\r\n\t\t\t\t\tv=v.replace(/\"/g,'&quot;')\r\n\t\t\t\t\treturn r+'\"'+v+'\"'+s\r\n\t\t\t\t}\r\n\t\t\tcase '>':\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;').replace(/</g,'&lt;')\r\n\t\t\t\treturn r+v+s\r\n\t\t\t}\r\n\t\t\tthrow new Error(\"invalid character before substitution\")\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=Lines\r\n","'use strict'\r\n\r\nconst WrapLines=require('./wrap-lines')\r\n\r\nclass NoseWrapLines extends WrapLines {\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tif (this.isEmpty()) {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\treturn super.doGet(formatting,html)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=NoseWrapLines\r\n","'use strict'\r\n\r\n/*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for structs\r\n\t\t'entries' array of suboptions for struct and array\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\r\n\r\nconst Option={}\r\n\r\n// abstract classes\r\n\r\nOption.Base = class {\r\n\tstatic make(name,...rest) {\r\n\t\tlet nScalars=0, nArrays=0, nObjects=0\r\n\t\tlet scalarArg, arrayArg=[], objectArg={}\r\n\t\tfor (const arg of rest) {\r\n\t\t\tif (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\r\n\t\t\t\tif (nScalars++==0) scalarArg=arg\r\n\t\t\t} else if (Array.isArray(arg)) {\r\n\t\t\t\tif (nArrays++==0) arrayArg=arg\r\n\t\t\t} else if (arg instanceof Object) {\r\n\t\t\t\tif (nObjects++==0) objectArg=arg\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst optionClass=this\r\n\t\tconst settings=this.collectArgs(scalarArg,arrayArg,objectArg)\r\n\t\treturn function(data,parent,visibilityManager,makeEntry){\r\n\t\t\treturn new optionClass(name,settings,data,parent,visibilityManager,makeEntry)\r\n\t\t}\r\n\t}\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn settings\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tthis.parent=parent\r\n\t\tthis.name=name\r\n\t\tthis.fullName=name\r\n\t\tif (parent && parent.fullName!==null) {\r\n\t\t\tthis.fullName=parent.fullName+'.'+name\r\n\t\t}\r\n\t\tthis.updateCallbacks=[]\r\n\t\tthis._$=null\r\n\t\t// visibility and callbacks\r\n\t\tthis.isVisible=()=>true\r\n\t\tif (visibilityManager) {\r\n\t\t\tvisibilityManager.register(this)\r\n\t\t\tif (settings.visibilityData!==undefined) {\r\n\t\t\t\tif (settings.visibilityDataLogic!='or') {\r\n\t\t\t\t\tthis.isVisible=()=>{\r\n\t\t\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\t\t\tconst value=visibilityManager.options[testName].value\r\n\t\t\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)<0) {\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isVisible=()=>{\r\n\t\t\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\t\t\tconst value=visibilityManager.options[testName].value\r\n\t\t\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)>=0) {\r\n\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\tvisibilityManager.declareAffectedBy(this,testName)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $() {\r\n\t\treturn this._$\r\n\t}\r\n\tset $($) {\r\n\t\tthis._$=$\r\n\t\tthis.updateVisibility()\r\n\t}\r\n\tupdateVisibility() {\r\n\t\tif (this.$) this.$.toggle(this.isVisible())\r\n\t}\r\n\tupdate() {\r\n\t\tthis.updateCallbacks.forEach(updateCallback=>{\r\n\t\t\tupdateCallback()\r\n\t\t})\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.update()\r\n\t\t}\r\n\t}\r\n\taddUpdateCallback(updateCallback) {\r\n\t\tthis.updateCallbacks.push(updateCallback)\r\n\t}\r\n\tshortenExport(data) { // used by parent\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\treturn data.value\r\n\t\t} else {\r\n\t\t\treturn data\r\n\t\t}\r\n\t}\r\n\tshortenExportAssign(data,parentData,name) {\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\tparentData[name]=data.value\r\n\t\t} else if (dataKeys.length>0) {\r\n\t\t\tparentData[name]=data\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Input = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.defaultValue===undefined) settings.defaultValue=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.defaultValue=settings.defaultValue\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdata=data.value\r\n\t\t}\r\n\t\tif (data!==undefined) {\r\n\t\t\tthis._value=data\r\n\t\t} else {\r\n\t\t\tthis._value=this.defaultValue\r\n\t\t}\r\n\t}\r\n\tget value() {\r\n\t\treturn this._value\r\n\t}\r\n\tset value(value) {\r\n\t\tthis._value=value\r\n\t\tthis.update()\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value\r\n\t\treturn data\r\n\t}\r\n}\r\n\r\nOption.Boolean = class extends Option.Input {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn super.collectArgs(!!scalarArg,arrayArg,settings)\r\n\t}\r\n\tfix() {\r\n\t\treturn this.value\r\n\t}\r\n}\r\n\r\nOption.NonBoolean = class extends Option.Input {\r\n\tfix() {\r\n\t\tconst value=this.value\r\n\t\treturn { // can't use fixed value in boolean context\r\n\t\t\tname: this.name,\r\n\t\t\tvalue,\r\n\t\t\tvalueOf() { return value },\r\n\t\t\ttoString() { return String(value) },\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Factor = class extends Option.NonBoolean {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableValues===undefined) settings.availableValues=arrayArg\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableValues[0]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableValues=settings.availableValues\r\n\t}\r\n}\r\n\r\nOption.Number = class extends Option.NonBoolean { // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableMin===undefined) settings.availableMin=arrayArg[0]\r\n\t\tif (settings.availableMax===undefined) settings.availableMax=arrayArg[1]\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableMin\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableMin=settings.availableMin\r\n\t\tthis.availableMax=settings.availableMax\r\n\t\tthis.unit=settings.unit\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tfixed.precision=this.precision\r\n\t\tfixed.unit=this.unit\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.Struct = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.entries=settings.descriptions.map(x=>{\r\n\t\t\tconst subName=x[1]\r\n\t\t\tlet subData\r\n\t\t\tif (typeof data == 'object') subData=data[subName]\r\n\t\t\treturn makeEntry(x,subData,this,visibilityManager) // nested option\r\n\t\t})\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tfor (const entry of this.entries) {\r\n\t\t\tentry.shortenExportAssign(entry.export(),data,entry.name)\r\n\t\t}\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixedEntries=[]\r\n\t\tconst fixed={\r\n\t\t\tname: this.name,\r\n\t\t\tentries: fixedEntries,\r\n\t\t}\r\n\t\tfor (const entry of this.entries) {\r\n\t\t\tfixedEntries.push(fixed[entry.name]=entry.fix())\r\n\t\t}\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.Collection = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\tif (settings.typePropertyName===undefined) settings.typePropertyName=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableConstructors=new Map\r\n\t\tif (visibilityManager) visibilityManager.enterCollection()\r\n\t\tfor (const x of settings.descriptions) { // TODO test array inside array\r\n\t\t\tconst type=x[1]\r\n\t\t\tconst ctor=subData=>makeEntry(x,subData,this,visibilityManager)\r\n\t\t\tthis.availableConstructors.set(type,ctor)\r\n\t\t}\r\n\t\tif (visibilityManager) visibilityManager.exitCollection()\r\n\t\tif (settings.typePropertyName!==undefined) {\r\n\t\t\tthis.typePropertyName=settings.typePropertyName\r\n\t\t} else {\r\n\t\t\tthis.typePropertyName='type'\r\n\t\t}\r\n\t\t// populate array entries from data:\r\n\t\tlet subDatas=[]\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tsubDatas=data\r\n\t\t} else if (typeof data == 'object') {\r\n\t\t\tsubDatas=data.value\r\n\t\t}\r\n\t\tconst defaultType=this.availableTypes[0]\r\n\t\tconst indexedEntries=subDatas.map(subData=>{ // can contain nulls for faulty entries, this._entries can't contain them\r\n\t\t\tlet subType=defaultType\r\n\t\t\tif (typeof subData == 'object' && subData[this.typePropertyName]!==undefined) {\r\n\t\t\t\tsubType=subData[this.typePropertyName]\r\n\t\t\t}\r\n\t\t\tconst subCtor=this.availableConstructors.get(subType)\r\n\t\t\tif (subCtor) { // can't throw an exception b/c have to be resistant to invalid data\r\n\t\t\t\treturn subCtor(subData)\r\n\t\t\t} else {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.populateEntries(subDatas,indexedEntries)\r\n\t}\r\n\t// protected\r\n\t//getElementsPropertyName() {}\r\n\t//populateEntries(datas,entries) {}\r\n\tmap(fn) {\r\n\t\treturn this[this.getElementsPropertyName()].map(fn)\r\n\t}\r\n\t//getEntryFromElement(element)\r\n\tsetElementExportData(element,data) {}\r\n\tsetElementFixData(element,fixed) {}\r\n\t// public\r\n\tget availableTypes() {\r\n\t\tconst types=[]\r\n\t\tthis.availableConstructors.forEach((_,type)=>{\r\n\t\t\ttypes.push(type)\r\n\t\t})\r\n\t\treturn types\r\n\t}\r\n\tmakeEntry(type,data) {\r\n\t\treturn this.availableConstructors.get(type)(data)\r\n\t}\r\n\texport() {\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\treturn {\r\n\t\t\tvalue: this.map(element=>{\r\n\t\t\t\tconst entry=this.getEntryFromElement(element)\r\n\t\t\t\tconst subData=entry.export()\r\n\t\t\t\tconst subType=entry.name\r\n\t\t\t\tif (subType!=defaultType) subData[this.typePropertyName]=subType\r\n\t\t\t\tthis.setElementExportData(element,subData)\r\n\t\t\t\treturn entry.shortenExport(subData)\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t\t[this.getElementsPropertyName()]: this.map(element=>{\r\n\t\t\t\tconst entry=this.getEntryFromElement(element)\r\n\t\t\t\tconst subFixed=entry.fix()\r\n\t\t\t\tif (typeof subFixed == 'object') {\r\n\t\t\t\t\tsubFixed[this.typePropertyName]=entry.name\r\n\t\t\t\t\tthis.setElementFixData(element,subFixed)\r\n\t\t\t\t}\r\n\t\t\t\treturn subFixed\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.Void = class extends Option.Base { // useful as array entry w/o settings\r\n\texport() {\r\n\t\treturn {}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Checkbox = class extends Option.Boolean {}\r\n\r\nOption.Select = class extends Option.Factor {}\r\n\r\nOption.Text = class extends Option.Factor {}\r\n\r\nOption.Int = class extends Option.Number {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n}\r\n\r\nOption.Float = class extends Option.Number {\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Root = class extends Option.Struct {}\r\n\r\nOption.Group = class extends Option.Struct {}\r\n\r\nOption.Array = class extends Option.Collection {\r\n\tgetElementsPropertyName() {\r\n\t\treturn 'entries'\r\n\t}\r\n\tpopulateEntries(datas,entries) {\r\n\t\tthis._entries=entries.filter(entry=>!!entry)\r\n\t}\r\n\tgetEntryFromElement(entry) {\r\n\t\treturn entry\r\n\t}\r\n\tget entries() {\r\n\t\treturn this._entries\r\n\t}\r\n\tset entries(entries) {\r\n\t\tthis._entries=entries\r\n\t\tthis.update()\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='options-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'reset': \"Reset\",\r\n\t\t\t'drag': \"Drag\",\r\n\t\t\t'drag.tip': \"Drag or press ↑/↓ while in focus to reorder items\",\r\n\t\t\t'delete': \"Delete\",\r\n\t\t\t'delete.tip': \"Delete item\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'reset': \"Сбросить\",\r\n\t\t\t'drag': \"Перетащить\",\r\n\t\t\t'drag.tip': \"Перетаскивайте или нажимайте ↑/↓, пока элемент в фокусе, чтобы изменить порядок элементов\",\r\n\t\t\t'delete': \"Удалить\",\r\n\t\t\t'delete.tip': \"Удалить элемент\",\r\n\t\t}\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbers=require('./format-numbers')\r\nconst writeTip=require('./tip')\r\nconst Option=require('./option-classes')\r\nconst GroupOptionOutput=require('./group-option-output')\r\n\r\n/*\r\n\tmatching css is:\r\n\t\t.options-output fieldset.option\r\n\t\t\tcan contain suboptions (fieldset.option and div.option)\r\n\t\t\tchildren have to be matched with > to aviod style collisions with other option-output hierarchies\r\n\t\t.options-output div.option\r\n\t\t\tcan't contain suboptions\r\n*/\r\nclass OptionsOutput {\r\n\tconstructor(options,generateId,i18n) {\r\n\t\tconst optionClassWriters=new Map\r\n\t\tthis.setOptionClassWriters(optionClassWriters)\r\n\t\tfunction writeOption(option) {\r\n\t\t\tlet optionProto=option\r\n\t\t\twhile (optionProto=Object.getPrototypeOf(optionProto)) {\r\n\t\t\t\tconst optionClassWriter=optionClassWriters.get(optionProto.constructor)\r\n\t\t\t\tif (optionClassWriter) {\r\n\t\t\t\t\treturn optionClassWriter(option,writeOption,i18n,generateId)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// public prop:\r\n\t\tthis.$output=writeOption(options.root)\r\n\t}\r\n\tgetLeadLabel(id,i18n,option) {\r\n\t\treturn \"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label><span class='space'> </span>\"\r\n\t}\r\n\t// override this fn for custom writers\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\toptionClassWriters.set(Option.Root,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='options-output'>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Group,function(){\r\n\t\t\treturn new GroupOptionOutput(...arguments).$output\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Void,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\")\r\n\t\t\t\t.html(i18n('options.'+option.fullName))\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Checkbox,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\").append(\r\n\t\t\t\t$(\"<input type='checkbox' id='\"+id+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.value)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.value=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\"</label>\"\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst valueId=value=>'options.'+option.fullName+'.'+value\r\n\t\t\tconst valueInfoId=value=>'options-info.'+option.fullName+'.'+value\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $select\r\n\t\t\toption.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$select=$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>\r\n\t\t\t\t\t\t$(\"<option>\").val(availableValue).html(i18n(valueId(availableValue)))\r\n\t\t\t\t\t)\r\n\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\toption.value=this.value\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tif (option.availableValues.some(availableValue=>i18n.has(valueInfoId(availableValue)))) {\r\n\t\t\t\tconst $tip=writeTip('info',\"\")\r\n\t\t\t\toption.$.append(\" \",$tip)\r\n\t\t\t\tconst handler=function(){\r\n\t\t\t\t\tif (i18n.has(valueInfoId(this.value))) {\r\n\t\t\t\t\t\t$tip.find('.tip-content').html(i18n(valueInfoId(this.value)))\r\n\t\t\t\t\t\t$tip.css('display','') // $tip.show() won't work right with inline-block\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$tip.css('display','none')\r\n\t\t\t\t\t\t$tip.find('.tip-content').empty()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\thandler.call($select[0])\r\n\t\t\t\t$select.change(handler)\r\n\t\t\t}\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Text,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst listId=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$(\"<input type='text' id='\"+id+\"' list='\"+listId+\"'>\")\r\n\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\toption.value=this.value\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<datalist id='\"+listId+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>$(\"<option>\").text(availableValue))\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Number,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst setInputAttrs=$input=>$input.attr({\r\n\t\t\t\tmin: option.availableMin,\r\n\t\t\t\tmax: option.availableMax,\r\n\t\t\t\tstep: Math.pow(0.1,p).toFixed(p),\r\n\t\t\t})\r\n\t\t\tconst setInputAttrsAndListeners=($input,$that)=>setInputAttrs($input)\r\n\t\t\t\t.val(option.value)\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\t$that.val(this.value)\r\n\t\t\t\t\t\toption.value=parseFloat(this.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst $sliderInput=$(\"<input type='range' id='\"+id+\"'>\")\r\n\t\t\tconst $numberInput=$(\"<input type='number' required>\")\r\n\t\t\tconst fmt=formatNumbers({\r\n\t\t\t\tmin: option.availableMin,\r\n\t\t\t\tmax: option.availableMax\r\n\t\t\t},option.precision)\r\n\t\t\toption.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$(\"<span class='nowrap'>\").append(\r\n\t\t\t\t\t\"<span class='min'>\"+i18n.numberWithUnits(fmt.min,option.unit)+\"</span> \",\r\n\t\t\t\t\tsetInputAttrsAndListeners($sliderInput,$numberInput),\r\n\t\t\t\t\t\" <span class='max'>\"+i18n.numberWithUnits(fmt.max,option.unit)+\"</span>\"\r\n\t\t\t\t),\r\n\t\t\t\t\" \",\r\n\t\t\t\tsetInputAttrsAndListeners($numberInput,$sliderInput),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t$sliderInput.val(option.defaultValue).change()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tconst infoId='options-info.'+option.fullName\r\n\t\t\tif (i18n.has(infoId)) {\r\n\t\t\t\toption.$.append(\" \",writeTip('info',i18n(infoId)))\r\n\t\t\t}\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nclass OptionVisibilityManager {\r\n\tconstructor() {\r\n\t\tthis.options={}\r\n\t\tthis.affects={}\r\n\t\tthis.inCollection=0\r\n\t}\r\n\tregister(option) {\r\n\t\tif (!this.inCollection) {\r\n\t\t\tthis.options[option.fullName]=option\r\n\t\t\toption.addUpdateCallback(()=>{\r\n\t\t\t\tthis.updateVisibilityAffectedBy(option.fullName)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tdeclareAffectedBy(option,byFullName) {\r\n\t\tif (this.affects[byFullName]===undefined) {\r\n\t\t\tthis.affects[byFullName]=[]\r\n\t\t}\r\n\t\tthis.affects[byFullName].push(option)\r\n\t}\r\n\tupdateVisibilityAffectedBy(byFullName) {\r\n\t\tif (this.affects[byFullName]!==undefined) {\r\n\t\t\tthis.affects[byFullName].forEach(option=>{\r\n\t\t\t\toption.updateVisibility()\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tenterCollection() {\r\n\t\tthis.inCollection+=1\r\n\t}\r\n\texitCollection() {\r\n\t\tthis.inCollection-=1\r\n\t}\r\n}\r\n\r\nclass Options {\r\n\tconstructor(data) { // data = imported values, import is done in ctor to avoid calling updateCallback later\r\n\t\tconst Option=this.optionClasses\r\n\t\tconst makeEntry=(description,data,parent,visibilityManager)=>{\r\n\t\t\tconst className=description[0]\r\n\t\t\tif (Option[className]===undefined) {\r\n\t\t\t\tthrow new Error(`invalid option type '${className}'`)\r\n\t\t\t}\r\n\t\t\tconst makeArgs=description.slice(1)\r\n\t\t\treturn Option[className].make(...makeArgs)(\r\n\t\t\t\tdata,parent,visibilityManager,makeEntry\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.root=Option.Root.make(null,this.entriesDescription)(\r\n\t\t\tdata,null,new OptionVisibilityManager,makeEntry\r\n\t\t)\r\n\t}\r\n\t// methods to be redefined by subclasses\r\n\t// TODO make them static?\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn []\r\n\t}\r\n\t// public methods\r\n\taddUpdateCallback(updateCallback) {\r\n\t\tthis.root.addUpdateCallback(updateCallback)\r\n\t}\r\n\texport() {\r\n\t\treturn this.root.shortenExport(this.root.export())\r\n\t}\r\n\tfix() {\r\n\t\treturn this.root.fix()\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nmodule.exports=(tipClass,tipContent)=>{\r\n\tconst $tip=$(`<span class='tip-${tipClass}' tabindex='0'><span class='tip-content'>${tipContent}</span></span>`)\r\n\tlet popupTimeoutId=null\r\n\tlet popupLevel=0\r\n\tconst handlePopup=(dLevel,delay)=>{\r\n\t\tif (delay===undefined) {\r\n\t\t\tdelay=200\r\n\t\t}\r\n\t\tif (dLevel==+1 && popupLevel==0) {\r\n\t\t\tclearTimeout(popupTimeoutId)\r\n\t\t\tpopupTimeoutId=setTimeout(()=>{ // sort of hoverintent, simple delay will do b/c tip icon is small\r\n\t\t\t\t$tip.addClass('open')\r\n\t\t\t},delay)\r\n\t\t} else if (dLevel==-1 && popupLevel==1) {\r\n\t\t\tclearTimeout(popupTimeoutId)\r\n\t\t\tpopupTimeoutId=setTimeout(()=>{\r\n\t\t\t\t$tip.removeClass('open')\r\n\t\t\t},delay)\r\n\t\t}\r\n\t\tpopupLevel+=dLevel\r\n\t}\r\n\t$tip.mouseenter(function(){\r\n\t\thandlePopup(+1)\r\n\t}).focusin(function(){\r\n\t\thandlePopup(+1,0) // need immediate popup on focusin\r\n\t}).on('mouseleave focusout',function(){\r\n\t\thandlePopup(-1)\r\n\t})\r\n\treturn $tip\r\n}\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\nconst NoseWrapLines=require('./nose-wrap-lines')\r\nconst CodeSection=require('./code-section')\r\n\r\nclass WebCode {\r\n\t// public:\r\n\tget filename() {\r\n\t\treturn this.basename+'.html'\r\n\t}\r\n\tget mimeType() {\r\n\t\treturn 'text/html'\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.getLines().get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.getLines().getHtml(formatting)\r\n\t}\r\n\textractSections(sectionModes) {\r\n\t\tif (sectionModes===undefined) {\r\n\t\t\tsectionModes={}\r\n\t\t}\r\n\t\tlet stylePlaceLines=NoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines)\r\n\t\tlet styleExtractLines=Lines.be()\r\n\t\tif (sectionModes.css=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tstylePlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tstylePlaceLines=Lines.bae(\"<!-- <style> \"+this.getSectionPasteComment('css')+\" </style> -->\")\r\n\t\t\t}\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t} else if (sectionModes.css=='file') {\r\n\t\t\tstylePlaceLines=Lines.bae(Lines.html`<link rel=stylesheet href=${this.basename+'.css'}>`)\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t}\r\n\t\tlet scriptPlaceLines=NoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\tlet scriptExtractLines=Lines.be()\r\n\t\tif (sectionModes.js=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tscriptPlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tscriptPlaceLines=Lines.bae(\"<!-- <script> \"+this.getSectionPasteComment('js')+\" </script> -->\")\r\n\t\t\t}\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t} else if (sectionModes.js=='file') {\r\n\t\t\tscriptPlaceLines=Lines.bae(Lines.html`<script src=${this.basename+'.js'}></script>`)\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t}\r\n\t\tlet htmlExtractLines\r\n\t\tif (sectionModes.html=='body') {\r\n\t\t\thtmlExtractLines=this.getBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t} else {\r\n\t\t\thtmlExtractLines=this.getFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t}\r\n\t\tconst type=sectionName=>'text/'+(sectionName=='js'?'javascript':sectionName)\r\n\t\treturn {\r\n\t\t\thtml: new CodeSection(this.filename,type('html'),htmlExtractLines),\r\n\t\t\tcss:  new CodeSection(this.basename+'.css',type('css'),styleExtractLines),\r\n\t\t\tjs:   new CodeSection(this.basename+'.js',type('js'),scriptExtractLines),\r\n\t\t}\r\n\t}\r\n\t// get title()\r\n\r\n\t// private:\r\n\tgetLines() {\r\n\t\treturn this.getFullHtmlSectionLines(\r\n\t\t\tNoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines),\r\n\t\t\tNoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\t)\r\n\t}\r\n\tgetFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\tconst a=Lines.b()\r\n\t\ta(\"<!DOCTYPE html>\")\r\n\t\tif (this.lang!==null) {\r\n\t\t\ta(Lines.html`<html lang=${this.lang}>`)\r\n\t\t} else {\r\n\t\t\ta(\"<html>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"<head>\",\r\n\t\t\t\"<meta charset=utf-8>\"\r\n\t\t)\r\n\t\tif (this.title!==null) {\r\n\t\t\ta(\"<title>\"+this.title+\"</title>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\t\"</head>\",\r\n\t\t\t\"<body>\",\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines,\r\n\t\t\t\"</body>\",\r\n\t\t\t\"</html>\"\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n\tgetBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\treturn Lines.bae(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines\r\n\t\t)\r\n\t}\r\n\tget cachedStyleLines()  { if (!this._styleLines)  this._styleLines =this.styleLines;  return this._styleLines  }\r\n\tget cachedHeadLines()   { if (!this._headLines)   this._headLines  =this.headLines;   return this._headLines   }\r\n\tget cachedBodyLines()   { if (!this._bodyLines)   this._bodyLines  =this.bodyLines;   return this._bodyLines   }\r\n\tget cachedScriptLines() { if (!this._scriptLines) this._scriptLines=this.scriptLines; return this._scriptLines }\r\n\r\n\t// to be redefined in subclasses:\r\n\tget basename() { // filename base\r\n\t\treturn 'source'\r\n\t}\r\n\tget lang() { // language tag for <html lang=xx> or null to skip it - likely read from i18n\r\n\t\treturn null\r\n\t}\r\n\tget title() { // page title or null to skip it\r\n\t\treturn null\r\n\t}\r\n\tget styleLines() { // contents of <style>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget headLines() { // contents of <head> following <style>, goes to <body> in html body mode\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget bodyLines() { // contents of <body> preceding <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget scriptLines() { // contents of <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetSectionPasteComment(sectionName) { // section placeholder comment in paste mode - likely to be overridden with i18n\r\n\t\treturn sectionName+\" goes here\"\r\n\t}\r\n}\r\n\r\nmodule.exports=WebCode\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass WrapLines extends Lines {\r\n\tconstructor(data,...wrappers) {\r\n\t\tsuper(data)\r\n\t\tthis.wrappers=wrappers\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn false\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst out=[]\r\n\t\tlet i=0\r\n\t\tconst pushWrapper=()=>{\r\n\t\t\tconst item=this.wrappers[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\tpushWrapper()\r\n\t\tfor (const item of this.data) {\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut.map(s=>indent+s))\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(indent+s)\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.wrappers.length==2) {\r\n\t\t\tpushWrapper()\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=WrapLines\r\n","module.exports = function(s){\r\n\treturn function(n){\r\n\t\tif (\r\n\t\t\t(s!=null && s.repeat!==undefined) ||\r\n\t\t\t(typeof s !== 'string')\r\n\t\t) {\r\n\t\t\treturn s.repeat(n)\r\n\t\t} else {\r\n\t\t\treturn Array(n+1).join(s)\r\n\t\t}\r\n\t}\r\n}\r\n","module.exports = function(haystack){\r\n\treturn function(needle,start){\r\n\t\tif (\r\n\t\t\t(haystack!=null && haystack.includes!==undefined) ||\r\n\t\t\t!((typeof haystack === 'string') || (Array.isArray(haystack)))\r\n\t\t) {\r\n\t\t\treturn haystack.includes(needle,start)\r\n\t\t} else {\r\n\t\t\treturn haystack.indexOf(needle,start) !== -1\r\n\t\t}\r\n\t}\r\n}\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Feature=require('./feature')\r\nconst CallVector=require('./call-vector')\r\n\r\nclass Background extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.isSolid=(options.type=='solid')\r\n\t\tif (this.isSolid) {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tnew CallVector('background.color',options.color.entries,'gl.clearColor',[0,0,0,0])\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.isSolid) {\r\n\t\t\ta(\"gl.clear(gl.COLOR_BUFFER_BIT);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Background\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass CallVector extends Vector {\r\n\tconstructor(name,values,calledFn,calledFnDefaultArgs) {\r\n\t\tsuper(name,values)\r\n\t\tthis.calledFn=calledFn\r\n\t\tthis.calledFnDefaultArgs=calledFnDefaultArgs\r\n\t}\r\n\t// private:\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet nValueSliders=0\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tnValueSliders+=component.value.input=='slider'\r\n\t\t})\r\n\t\tif (this.modeConstant && this.components.every((component,i)=>component.value==this.calledFnDefaultArgs[i])) {\r\n\t\t\t// equal to default values, don't do anything\r\n\t\t} else if (nValueSliders<=1) {\r\n\t\t\ta(this.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\")\r\n\t\t} else if (this.components.every(component=>component.value.input=='slider')) {\r\n\t\t\tlet obj=this.calledFn\r\n\t\t\tconst dotIndex=obj.lastIndexOf('.')\r\n\t\t\tif (dotIndex>=0) {\r\n\t\t\t\tobj=obj.slice(0,dotIndex)\r\n\t\t\t}\r\n\t\t\tconst suffixArray=\"[\"+this.components.map(component=>\"'\"+component.suffix+\"'\").join(\",\")+\"]\"\r\n\t\t\ta(\r\n\t\t\t\tthis.calledFn+\".apply(\"+obj+\",\"+suffixArray+\".map(function(c){\",\r\n\t\t\t\t\"\treturn parseFloat(document.getElementById('\"+this.name+\".'+c).value);\",\r\n\t\t\t\t\"}));\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(this.calledFn+\"(\")\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i>0) {\r\n\t\t\t\t\ta.t(\",\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\ta(\r\n\t\t\t\t\");\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tentry.post(\r\n\t\t\tthis.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\"\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CallVector\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Listener=require('./listener-classes')\r\nconst Feature=require('./feature')\r\nconst IntFeature=require('./int-feature')\r\n\r\nclass Canvas extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.width=options.width\r\n\t\tthis.height=options.height\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('canvas.width' ,options.width),\r\n\t\t\tnew IntFeature('canvas.height',options.height)\r\n\t\t)\r\n\t}\r\n\tgetHtmlCanvasLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\t\"<div>\",\r\n\t\t\tLines.html`\t<canvas id=myCanvas width=${this.width} height=${this.height}></canvas>`,\r\n\t\t\t\"</div>\"\r\n\t\t)\r\n\t}\r\n\tgetGlslVertexDeclarationLines() {\r\n\t\tif (this.hasInputs()) {\r\n\t\t\treturn Lines.bae(\"uniform float aspect;\")\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tgetGlslVertexOutputLines() {\r\n\t\tconst needAspectConstant=!this.hasInputs() && Number(this.width)!=Number(this.height)\r\n\t\tif (needAspectConstant) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float aspect=\"+this.width+\".0/\"+this.height+\".0;\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tprovidesAspect() {\r\n\t\treturn this.hasInputs() || Number(this.width)!=Number(this.height)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tconst canvasUpdater=()=>{\r\n\t\t\ta(\r\n\t\t\t\t\"function updateAspect() {\",\r\n\t\t\t\t\"\tgl.viewport(0,0,canvas.width,canvas.height);\",\r\n\t\t\t\t\"\tgl.uniform1f(aspectLoc,canvas.width/canvas.height);\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"updateAspect();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst canvasListener=wh=>{\r\n\t\t\tif (this[wh].input=='slider') {\r\n\t\t\t\tconst listener=new Listener.Slider('canvas.'+wh)\r\n\t\t\t\tlistener.enter()\r\n\t\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t\t.post(\"canvas.\"+wh+\"=parseInt(this.value);\")\r\n\t\t\t\t\t.post(\"updateAspect();\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.hasInputs()) {\r\n\t\t\ta(\"var aspectLoc=gl.getUniformLocation(program,'aspect');\")\r\n\t\t\tcanvasUpdater()\r\n\t\t\tcanvasListener('width')\r\n\t\t\tcanvasListener('height')\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Canvas\r\n","'use strict'\r\n\r\nconst Shape=require('./shape-classes')\r\nconst FeatureContext=require('./feature-context')\r\nconst Canvas=require('./canvas')\r\nconst Background=require('./background')\r\nconst Transforms=require('./transforms')\r\nconst Illumination=require('./illumination')\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst BaseWebCode=require('crnx-base/web-code')\r\n\r\nclass Code extends BaseWebCode {\r\n\tconstructor(options,i18n) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.i18n=i18n\r\n\t\tthis.featureContext=new FeatureContext(options.debug)\r\n\t\tthis.canvas=new Canvas(options.canvas)\r\n\t\tthis.background=new Background(options.background)\r\n\t\tthis.transforms=new Transforms(options.transforms)\r\n\t\tthis.illumination=new Illumination(options.material,options.light)\r\n\t\tconst makeShape=()=>{\r\n\t\t\treturn new Shape[String(options.shape.type)](\r\n\t\t\t\toptions.shape,\r\n\t\t\t\toptions.light.type!='off',\r\n\t\t\t\toptions.material.scope=='vertex',\r\n\t\t\t\toptions.material.scope=='face',\r\n\t\t\t\tthis.illumination.getColorAttrs()\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.shape=makeShape()\r\n\t\tthis.features=[\r\n\t\t\tthis.canvas,\r\n\t\t\tthis.background,\r\n\t\t\tthis.transforms,\r\n\t\t\tthis.illumination,\r\n\t\t\tthis.shape,\r\n\t\t]\r\n\t\tthis.featureNames=[\r\n\t\t\t'canvas',\r\n\t\t\t'background',\r\n\t\t\t'transforms',\r\n\t\t\t'illumination',\r\n\t\t\t'shape',\r\n\t\t]\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(this.featureContext)\r\n\t\t})\r\n\t}\r\n\tget basename() {\r\n\t\treturn 'webgl'\r\n\t}\r\n\tget lang() {\r\n\t\treturn 'en'\r\n\t}\r\n\tget title() {\r\n\t\treturn \"WebGL example - Generated code\"\r\n\t}\r\n\tget styleLines() {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.featureContext.hasSliders) {\r\n\t\t\ta(\r\n\t\t\t\t\"label {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 15em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".min {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".max {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: left;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tget headLines() {\r\n\t\tconst getVertexShaderLines=()=>{\r\n\t\t\tconst needTransformedPosition=this.illumination.wantsTransformedPosition(this.transforms.eyeAtInfinity)\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\tthis.canvas.getGlslVertexDeclarationLines(),\r\n\t\t\t\tthis.transforms.getGlslVertexDeclarationLines(this.shape.dim==2),\r\n\t\t\t\tthis.illumination.getGlslVertexDeclarationLines(this.transforms.eyeAtInfinity,this.shape.dim>2),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.canvas.getGlslVertexOutputLines(),\r\n\t\t\t\t\tthis.transforms.getGlslVertexOutputLines(this.shape.dim==2,this.canvas.providesAspect(),needTransformedPosition),\r\n\t\t\t\t\tthis.illumination.getGlslVertexOutputLines(this.transforms.eyeAtInfinity,this.shape.hasNormals,this.transforms.getGlslVertexNormalTransformLines())\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst getFragmentShaderLines=()=>{\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"precision mediump float;\",\r\n\t\t\t\tthis.illumination.getGlslFragmentDeclarationLines(this.transforms.eyeAtInfinity),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.illumination.getGlslFragmentOutputLines(this.transforms.eyeAtInfinity,this.shape.twoSided)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn Lines.bae(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myVertexShader type=x-shader/x-vertex>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetVertexShaderLines()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myFragmentShader type=x-shader/x-fragment>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetFragmentShaderLines()\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\tget bodyLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\tthis.canvas.getHtmlCanvasLines(),\r\n\t\t\tNoseWrapLines.b(\r\n\t\t\t\t\"<ul>\",\r\n\t\t\t\t\"</ul>\"\r\n\t\t\t).ae(\r\n\t\t\t\t...this.features.map(feature=>feature.getHtmlControlMessageLines(this.i18n))\r\n\t\t\t),\r\n\t\t\t...this.features.map(feature=>feature.getHtmlInputLines(this.i18n))\r\n\t\t)\r\n\t}\r\n\tget scriptLines() {\r\n\t\tconst getMakeProgramLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"var vertexShader=gl.createShader(gl.VERTEX_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(vertexShader,vertexShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(vertexShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(fragmentShader,fragmentShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(fragmentShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var program=gl.createProgram();\",\r\n\t\t\t\t\"gl.attachShader(program,vertexShader);\",\r\n\t\t\t\t\"gl.attachShader(program,fragmentShader);\",\r\n\t\t\t\t\"gl.linkProgram(program);\",\r\n\t\t\t\t\"return program;\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInitLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function makeProgram(vertexShaderSrc,fragmentShaderSrc) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tgetMakeProgramLines()\r\n\t\t\t\t),\r\n\t\t\t\t\"var canvas=document.getElementById('myCanvas');\",\r\n\t\t\t\t\"var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');\",\r\n\t\t\t\t\"var program=makeProgram(\",\r\n\t\t\t\t\"\tdocument.getElementById('myVertexShader').text,\",\r\n\t\t\t\t\"\tdocument.getElementById('myFragmentShader').text\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.useProgram(program);\"\r\n\t\t\t)\r\n\t\t\tconst addWithCommentIfNotEmpty=(featureLines,comment)=>{\r\n\t\t\t\tif (featureLines.count()>0) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\",\r\n\t\t\t\t\t\t\"// \"+comment, // TODO i18n\r\n\t\t\t\t\t\tfeatureLines\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.features.forEach((feature,i)=>{\r\n\t\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\t\tfeature.getJsInitLines(this.featureContext),\r\n\t\t\t\t\t\"init \"+this.featureNames[i]\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\tthis.featureContext.getJsAfterInitLines(),\r\n\t\t\t\t\"init mousemove listener\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInnerLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasClampFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function clamp(v,min,max) {\",\r\n\t\t\t\t\t\"\treturn Math.min(Math.max(v,min),max);\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.hasWrapFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function wrap(v,maxAbs) {\",\r\n\t\t\t\t\t\"\tv%=maxAbs*2;\",\r\n\t\t\t\t\t\"\tif (Math.abs(v)<=maxAbs) return v;\",\r\n\t\t\t\t\t\"\treturn v-(v>0?1:-1)*maxAbs*2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.pollsGamepad) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var gamepad;\",\r\n\t\t\t\t\t\"var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);\",\r\n\t\t\t\t\t\"for (var i=0;i<gamepads.length;i++) {\",\r\n\t\t\t\t\t\"\tif (gamepads[i]) {\",\r\n\t\t\t\t\t\"\t\tgamepad=gamepads[i];\",\r\n\t\t\t\t\t\"\t\tbreak;\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t...this.features.map(feature=>feature.getJsLoopLines(this.featureContext))\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasStartTime && this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t\ta(\"var prevTime=startTime;\")\r\n\t\t\t} else if (this.featureContext.hasStartTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t} else if (this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var prevTime=performance.now();\")\r\n\t\t\t}\r\n\t\t\t// wrap inner render lines in function if needed\r\n\t\t\tif (this.featureContext.isAnimated) {\r\n\t\t\t\tif (this.featureContext.hasTime) {\r\n\t\t\t\t\ta(\"function renderFrame(time) {\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"function renderFrame() {\")\r\n\t\t\t\t}\r\n\t\t\t\ta(IndentLines.bae(getJsInnerLoopLines()))\r\n\t\t\t\tif (this.featureContext.hasPrevTime) {\r\n\t\t\t\t\ta(\"\tprevTime=time;\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\trequestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"requestAnimationFrame(renderFrame);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.featureContext.hasInputs) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var frameId=null;\",\r\n\t\t\t\t\t\"function renderFrame() {\",\r\n\t\t\t\t\tIndentLines.bae(getJsInnerLoopLines()),\r\n\t\t\t\t\t\"\tframeId=null;\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"function scheduleFrame() {\",\r\n\t\t\t\t\t\"\tif (frameId===null) {\",\r\n\t\t\t\t\t\"\t\tframeId=requestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"scheduleFrame();\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(getJsInnerLoopLines())\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\treturn InterleaveLines.bae(\r\n\t\t\tgetJsInitLines(),\r\n\t\t\tgetJsLoopLines()\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=Code","var colorgenCounter=0;\r\n\r\nvar SingleColorgen=function(weight,noise,baseColors){\r\n\tthis.weight=weight;\r\n\tthis.noise=noise;\r\n\tif (noise===undefined) this.noise=0.4;\r\n\tthis.baseColors=baseColors||this.defaultBaseColors;\r\n\tthis.colorgenNumber=colorgenCounter++;\r\n\tthis.nextIndex=0;\r\n};\r\nSingleColorgen.prototype.defaultBaseColors=[\r\n\t[1.0, 0.0, 0.0], // TODO 'cube' color order, when cube is not ugly\r\n\t[0.0, 1.0, 0.0],\r\n\t[0.0, 0.0, 1.0],\r\n\t[1.0, 1.0, 0.0],\r\n\t[1.0, 0.0, 1.0],\r\n\t[0.0, 1.0, 1.0],\r\n];\r\nSingleColorgen.prototype.getNextColorString=function(){\r\n\tvar baseColor=this.baseColors[this.nextIndex];\r\n\tthis.nextIndex=(this.nextIndex+1)%this.baseColors.length;\r\n\treturn baseColor.map(function(ci,i){\r\n\t\tvar s=Math.sin(this.colorgenNumber*9000+this.nextIndex*400+i*100);\r\n\t\tvar co=(ci*(1-this.noise)+s*s*this.noise)*this.weight;\r\n\t\treturn \" \"+co.toFixed(1)+\",\";\r\n\t},this).join(\"\");\r\n};\r\n\r\nvar Colorgen=function(colorAttrs,noise,baseColors){\r\n\tthis.colorAttrs=colorAttrs;\r\n\tthis.singleColorgens=this.colorAttrs.map(function(attr){\r\n\t\treturn new SingleColorgen(attr.weight,noise,baseColors);\r\n\t});\r\n};\r\nColorgen.prototype.getHeaderString=function(){\r\n\treturn this.colorAttrs.map(function(){\r\n\t\treturn \"    r    g    b\";\r\n\t}).join(\"\");\r\n};\r\nColorgen.prototype.getNextColorString=function(){\r\n\treturn this.singleColorgens.map(function(singleColorgen){\r\n\t\treturn singleColorgen.getNextColorString();\r\n\t}).join(\"\");\r\n};\r\n\r\nmodule.exports=Colorgen;\r\n","'use strict'\r\n\r\nconst Listener=require('./listener-classes')\r\n\r\nclass FeatureContext {\r\n\tconstructor(debugOptions) {\r\n\t\tthis.debugOptions=debugOptions\r\n\t\tthis.canvasMousemoveListener=new Listener.CanvasMousemove()\r\n\t\t//// to be set by features:\r\n\t\t// for html:\r\n\t\tthis.hasSliders=false\r\n\t\t// for js:\r\n\t\tthis.hasInputs=false // must have renderFrame()\r\n\t\tthis.hasStartTime=false\r\n\t\tthis.hasPrevTime=false\r\n\t\tthis.pollsGamepad=false\r\n\t\tthis.hasClampFn=false\r\n\t\tthis.hasWrapFn=false\r\n\t}\r\n\tget hasTime() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime\r\n\t}\r\n\tget isAnimated() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime || this.pollsGamepad\r\n\t}\r\n\tgetJsAfterInitLines() {\r\n\t\treturn this.canvasMousemoveListener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n\tgetListenerLines(listener) {\r\n\t\treturn listener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n}\r\n\r\nmodule.exports=FeatureContext\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\n\r\nclass Feature {\r\n\tconstructor() {\r\n\t\tthis.features=[]\r\n\t}\r\n\t// private:\r\n\tgetRecursiveLines(method,args) {\r\n\t\treturn Lines.bae(...this.features.map(feature=>feature[method](...args)))\r\n\t}\r\n\t// methods to be redefined:\r\n\thasInputs() {\r\n\t\treturn this.features.some(feature=>feature.hasInputs())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(featureContext)\r\n\t\t})\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlInputLines',arguments)\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlControlMessageLines',arguments)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsInitLines',arguments)\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsLoopLines',arguments)\r\n\t}\r\n}\r\n\r\nmodule.exports=Feature\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass GlslVector extends Vector {\r\n\tconstructor(name,values,wrapRange) {\r\n\t\tsuper(name,values,wrapRange)\r\n\t}\r\n\t// public:\r\n\tgetGlslDeclarationLines() {\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn Lines.be()\r\n\t\t} else if (this.modeFloats) {\r\n\t\t\tconst a=Lines.b()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"uniform float \"+component.varName+\";\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn a.e()\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"uniform vec\"+this.nVars+\" \"+this.varName+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslValue() {\r\n\t\treturn this.getGlslComponentsValue(this.components.map(component=>component.suffix).join(''))\r\n\t}\r\n\tgetGlslComponentsValue(selectedComponents) {\r\n\t\tconst numbers={}\r\n\t\tconst results=[] // [[isConstant,componentName]]\r\n\t\tfor (let j=0;j<selectedComponents.length;j++) {\r\n\t\t\tconst c=selectedComponents.charAt(j)\r\n\t\t\tif (!this.componentsBySuffix[c].variable) {\r\n\t\t\t\tnumbers[c]=this.componentsBySuffix[c].value\r\n\t\t\t\tresults.push([true,c])\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector && results.length>0) {\r\n\t\t\t\t\tconst prevResult=results.pop()\r\n\t\t\t\t\tif (prevResult[0]) {\r\n\t\t\t\t\t\tresults.push(prevResult,[false,c]) // prev is constant, don't merge\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresults.push([prevResult[0],prevResult[1]+c]) // merge\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresults.push([false,c])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst fmt=formatNumbers.glsl(numbers)\r\n\t\tconst allSuffixString=this.components.map(component=>component.suffix).slice(0,this.nVars).join('')\r\n\t\tconst allSameConstant=()=>{\r\n\t\t\tif (!results[0][0]) return false\r\n\t\t\tconst cmp=fmt[results[0][1]]\r\n\t\t\treturn results.every(result=>(result[0] && fmt[result[1]]==cmp))\r\n\t\t}\r\n\t\tconst showResult=result=>{\r\n\t\t\tif (result[0]) {\r\n\t\t\t\treturn fmt[result[1]]\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector) {\r\n\t\t\t\t\tif (result[1]==allSuffixString) {\r\n\t\t\t\t\t\treturn this.varName\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn this.varName+\".\"+result[1]\r\n\t\t\t\t\t}\r\n \t\t\t\t} else {\r\n\t\t\t\t\treturn this.componentsBySuffix[result[1]].varName\r\n \t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (results.length==1) {\r\n\t\t\tif (this.modeVector && selectedComponents==allSuffixString) {\r\n\t\t\t\treturn this.varName\r\n\t\t\t} else {\r\n\t\t\t\treturn showResult(results[0])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (allSameConstant()) {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+showResult(results[0])+\")\" // see OpenGL ES SL section 5.4.2\r\n\t\t\t} else {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+results.map(showResult).join(\",\")+\")\"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tgetGlslMapDeclarationLines(mapName,mapFn) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"vec\"+this.components.length+\" \"+mapName+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float \"+mapName+this.components[0].suffix+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslMapComponentValue(mapName,selectedComponent) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn mapName+\".\"+selectedComponent\r\n\t\t} else {\r\n\t\t\treturn mapName+selectedComponent\r\n\t\t}\r\n\t}\r\n\t// private:\r\n\tgetJsDeclarationLines() {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tif (this.modeFloats) {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"var \"+component.varNameLoc+\"=gl.getUniformLocation(program,'\"+component.varName+\"');\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\ta(\"var \"+this.varName+\"Loc=gl.getUniformLocation(program,'\"+this.varName+\"');\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeVector) {\r\n\t\t\ta(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc\")\r\n\t\t\tif (this.components.every(component=>component.value.input!='slider')) { // all values are short, no getElement... queries\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\",\"+componentValue(component))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta.t(\");\")\r\n\t\t\t} else {\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\r\n\t\t\t\t\t\t\t\",\",\r\n\t\t\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta(\");\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"gl.uniform1f(\"+component.varNameLoc+\",\"+componentValue(component)+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryForComponent(entry,component) {\r\n\t\tif (this.modeVector) {\r\n\t\t\t// written at the end as a vector\r\n\t\t} else {\r\n\t\t\tentry.post(\"gl.uniform1f(\"+component.varNameLoc+\",\"+component.varName+\");\")\r\n\t\t}\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tif (this.modeVector) {\r\n\t\t\tconst vs=[]\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i<this.nVars) {\r\n\t\t\t\t\tvs.push(component.varName)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tentry.post(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc,\"+vs.join(\",\")+\");\")\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=GlslVector\r\n","'use strict'\r\n\r\nconst langStrings={\r\n\ten:{\r\n\t\t'options.canvas': \"Canvas\",\r\n\t\t'options.canvas.{width,height}': \"Canvas {}\",\r\n\r\n\t\t'options.background': \"Background\",\r\n\t\t'options.background.type': \"Background type\",\r\n\t\t'options.background.type.none': \"none (transparent)\",\r\n\t\t'options.background.type.solid': \"solid color\",\r\n\t\t'options.background.color': \"Background color\",\r\n\t\t'options.background.color.{r,g,b,a}': 'Background color {red,green,blue,alpha} component',\r\n\t\t'options.background.color.{r,g,b,a}.speed': 'Background color {red,green,blue,alpha} speed',\r\n\r\n\t\t'options.material': \"Material\",\r\n\t\t'options.material.scope': \"Set material color for objects\",\r\n\t\t'options.material.scope.global': \"entire scene\",\r\n\t\t'options.material.scope.vertex': \"shape vertices\",\r\n\t\t'options.material.scope.face': \"shape faces\",\r\n\t\t'options.material.data': \"For each object have\",\r\n\t\t'options.material.data.one': \"one color\",\r\n\t\t'options.material.data.sda': \"specular/diffuse/ambient colors\",\r\n\t\t'options.material.color': \"Material color\",\r\n\t\t'options.material.color.{r,g,b,a}': \"Material color {red,green,blue,alpha} component\",\r\n\t\t'options.material.color.{r,g,b,a}.speed': \"Material color {red,green,blue,alpha} speed\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color': \"Material {} color\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}': \"{Specular,Diffuse,Ambient} color {red,green,blue} component\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed': \"Material {} color {red,green,blue,alpha} speed\",\r\n\t\t'options-info.material.data.sda': \"for use with Phong/Blinn–Phong shading models selected by <em>light type</em>\",\r\n\r\n\t\t'options.light': \"Light\",\r\n\t\t'options.light.type': \"Light type\",\r\n\t\t'options.light.type.off': \"off\",\r\n\t\t'options.light.type.phong': \"on with Phong reflections\",\r\n\t\t'options.light.type.blinn': \"on with Blinn–Phong reflections\",\r\n\t\t'options.light.direction': \"Light direction\",\r\n\t\t'options.light.direction.{x,y,z}': \"Light direction {} component\",\r\n\t\t'options.light.direction.{x,y,z}.speed': \"Light direction {} speed\",\r\n\t\t'options-info.light.type.phong': \"[[Shading#Directional_lighting|directional light]] with [[Phong reflection model]]\",\r\n\t\t'options-info.light.type.blinn': \"[[Shading#Directional_lighting|directional light]] with [[Blinn–Phong shading model|Blinn–Phong reflection model]]\",\r\n\r\n\t\t'options.shape': \"Shape\",\r\n\t\t'options.shape.type': \"Shape to draw\",\r\n\t\t'options.shape.type.square': \"square\",\r\n\t\t'options.shape.type.triangle': \"triangle\",\r\n\t\t'options.shape.type.gasket': \"Sierpinski gasket\",\r\n\t\t'options.shape.type.cube': \"cube\",\r\n\t\t'options.shape.type.hat': \"Mexican hat function\",\r\n\t\t'options.shape.type.terrain': \"diamond-square fractal terrain\",\r\n\t\t'options.shape.elements': \"Element array\",\r\n\t\t'options.shape.elements.0': \"not used\",\r\n\t\t'options.shape.elements.{8,16,32}': \"with {}-bit index\",\r\n\t\t'options.shape.lod': \"Shape detail level\", // recursion depth for fractal shapes\r\n\t\t'options-info.shape.type.gasket': \"[[Sierpinski triangle]]\",\r\n\t\t'options-info.shape.type.hat': \"[[Mexican hat wavelet]]\",\r\n\t\t'options-info.shape.type.terrain': \"generated with the [[Diamond-square algorithm|diamond-square algorithm]]\",\r\n\t\t'options-info.shape.elements.{8,16}': \"choosing 8- or 16-bit index may limit available shape detail levels\",\r\n\r\n\t\t'options.transforms': \"Transforms\",\r\n\t\t'options.transforms.projection': \"Projection\",\r\n\t\t'options.transforms.projection.ortho': \"orthogonal\",\r\n\t\t'options.transforms.projection.perspective': \"perspective\",\r\n\t\t'options.transforms.model': \"Model transform\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.add': \"Add rotation around {} axis\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}': \"Angle of rotation around {} axis\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.speed': \"Speed of rotation around {} axis\",\r\n\t\t'options-info.transforms.projection.ortho': \"[[Orthographic projection|orthographic projection]]\",\r\n\t\t'options-info.transforms.projection.perspective': \"[[Transformation_matrix#Perspective_projection|perspective projection]]\",\r\n\r\n\t\t'options.debug': \"Debug options\",\r\n\t\t'options.debug.shaders': \"Log shader compilation errors\",\r\n\t\t'options.debug.arrays': \"Log allocated array sizes\",\r\n\t\t'options.debug.inputs': \"Log input values\",\r\n\t\t'options.debug.animations': \"Log animated values\",\r\n\r\n\t\t'options-output.inputs': \"Input method\",\r\n\t\t'options-output.inputs.constant': \"none\",\r\n\t\t'options-output.inputs.slider': \"slider\",\r\n\t\t'options-output.inputs.mousemove{x,y}': \"mouse {} axis\",\r\n\t\t'options-output.inputs.gamepad{0,1,2,3}': \"gamepad {} axis\",\r\n\t\t'options-output.range': \"with range\",\r\n\t\t'options-output.addSpeed': \"Add speed\",\r\n\r\n\t\t'controls.type.mousemove{x,y}': \"Move the mouse pointer {horizontally,vertically} over the canvas\",\r\n\t\t'controls.to': \"to update\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2}': \"pixel{,s}\",\r\n\t\t'units.°/second.a': \"°/s\",\r\n\t\t'units.°/second.{1,2}': \"degree{,s} per second\",\r\n\t\t'units.second.a': \"s\",\r\n\t\t'units.1/second.{1,2}': \"unit{,s} per second\",\r\n\t},\r\n\tru:{\r\n\t\t'options.canvas': \"Элемент <code>canvas</code>\",\r\n\t\t'options.canvas.{width,height}': \"{Ширина,Высота} элемента <code>canvas</code>\",\r\n\r\n\t\t'options.background': \"Фон\",\r\n\t\t'options.background.type': \"Тип фона\",\r\n\t\t'options.background.type.none': \"прозрачный\",\r\n\t\t'options.background.type.solid': \"закрашенный\",\r\n\t\t'options.background.color': \"Цвет фона\",\r\n\t\t'options.background.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал фона',\r\n\t\t'options.background.color.{r,g,b,a}.speed': 'Скорость {красного ,зелёного ,синего ,альфа-}канала фона',\r\n\r\n\t\t'options.material': \"Материал\",\r\n\t\t'options.material.scope': \"Задавать цвета данных объектов\",\r\n\t\t'options.material.scope.global': \"всей сцены\",\r\n\t\t'options.material.scope.vertex': \"вершин фигур\",\r\n\t\t'options.material.scope.face': \"граней фигур\",\r\n\t\t'options.material.data': \"Задавать для каждого объекта\",\r\n\t\t'options.material.data.one': \"один цвет\",\r\n\t\t'options.material.data.sda': \"бликовую/рассеянную/фоновую составляющие\",\r\n\t\t'options.material.color': \"Цвет материала\",\r\n\t\t'options.material.color.{r,g,b,a}': \"{Красный ,Зелёный ,Синий ,Альфа-}канал материала\",\r\n\t\t'options.material.color.{r,g,b,a}.speed': \"Скорость {красного ,зелёного ,синего ,альфа-}канала материала\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color': \"{Бликовая,Рассеянная,Фоновая} составляющая цвета материала\",\r\n\t\t'options.material.specularColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал бликовой составляющей\",\r\n\t\t'options.material.diffuseColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал рассеянной составляющей\",\r\n\t\t'options.material.ambientColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал фоновой составляющей\",\r\n\t\t'options.material.specularColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала бликовой составляющей\",\r\n\t\t'options.material.diffuseColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала рассеянной составляющей\",\r\n\t\t'options.material.ambientColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала фоновой составляющей\",\r\n\t\t'options-info.material.data.sda': \"для использования с моделями освещения Фонга/Блинна-Фонга, задаваемыми <em>типом света</em>\",\r\n\r\n\t\t'options.light': \"Свет\",\r\n\t\t'options.light.type': \"Тип света\",\r\n\t\t'options.light.type.off': \"отключен\",\r\n\t\t'options.light.type.phong': \"включен с отражениями по Фонгу\",\r\n\t\t'options.light.type.blinn': \"включен с отражениями по Блинну-Фонгу\",\r\n\t\t'options.light.direction': \"Направление света\",\r\n\t\t'options.light.direction.{x,y,z}': \"{}-компонент направления света\",\r\n\t\t'options.light.direction.{x,y,z}.speed': \"скорость {}-компонента направления света\",\r\n\t\t'options-info.light.type.phong': \"направленный свет с [[Затенение_по_Фонгу#.D0.9C.D0.BE.D0.B4.D0.B5.D0.BB.D1.8C_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F|моделью освещения Фонга]]\",\r\n\t\t'options-info.light.type.blinn': \"направленный свет с моделью освещения Блинна-Фонга\",\r\n\r\n\t\t'options.shape': \"Фигура\",\r\n\t\t'options.shape.type': \"Рисовать фигуру\",\r\n\t\t'options.shape.type.square': \"квадрат\",\r\n\t\t'options.shape.type.triangle': \"треугольник\",\r\n\t\t'options.shape.type.gasket': \"салфетка Серпинского\",\r\n\t\t'options.shape.type.cube': \"куб\",\r\n\t\t'options.shape.type.hat': \"Mexican hat function\",\r\n\t\t'options.shape.type.terrain': \"фрактальный ландшафт\",\r\n\t\t'options.shape.elements': \"Element array\",\r\n\t\t'options.shape.elements.0': \"не используется\",\r\n\t\t'options.shape.elements.{8,16,32}': \"с {}-битным индексом\",\r\n\t\t'options.shape.lod': \"Уровень детализации\", // recursion depth for fractal shapes\r\n\t\t'options-info.shape.type.gasket': \"[[Треугольник Серпинского|треугольник Серпинского]]\",\r\n\t\t'options-info.shape.type.terrain': \"сгенерирован [[Алгоритм Diamond-Square|алгоритмом diamond-square]]\",\r\n\t\t'options-info.shape.elements.{8,16}': \"выбор 8- или 16-битного индекса может ограничить доступные уровни детализации\",\r\n\r\n\t\t'options.transforms': \"Преобразования\",\r\n\t\t'options.transforms.projection': \"Проекция\",\r\n\t\t'options.transforms.projection.ortho': \"ортогональная\",\r\n\t\t'options.transforms.projection.perspective': \"перспективная\",\r\n\t\t'options.transforms.model': \"Преобразование модели\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.add': \"Добавить вращение вокруг оси {}\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}': \"Угол поворота вокруг оси {}\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.speed': \"Скорость поворота вокруг оси {}\",\r\n\r\n\t\t'options.debug': \"Отладка\",\r\n\t\t'options.debug.shaders': \"Выводить ошибки компиляции шейдеров\",\r\n\t\t'options.debug.arrays': \"Выводить размеры выделенных массивов\",\r\n\t\t'options.debug.inputs': \"Выводить значения вводов\",\r\n\t\t'options.debug.animations': \"Выводить анимированные значения\",\r\n\r\n\t\t'options-output.inputs': \"Способ ввода\",\r\n\t\t'options-output.inputs.constant': \"нет\",\r\n\t\t'options-output.inputs.slider': \"ползунок\",\r\n\t\t'options-output.inputs.mousemove{x,y}': \"ось {} мыши\",\r\n\t\t'options-output.inputs.gamepad{0,1,2,3}': \"ось {} геймпада\",\r\n\t\t'options-output.range': \"с диапазоном\",\r\n\t\t'options-output.addSpeed': \"Добавить скорость\",\r\n\r\n\t\t'controls.type.mousemove{x,y}': \"Перемещайте указатель мыши над элементом <code>canvas</code> в {горизонтальном,вертикальном} направлении,\",\r\n\t\t'controls.to': \"чтобы изменить\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2,5}': \"пиксел{ь,я,ей}\",\r\n\t\t'units.°/second.a': \"°/с\",\r\n\t\t'units.°/second.{1,2,5}': \"градус{,а,ов} в секунду\",\r\n\t\t'units.second.a': \"с\",\r\n\t\t'units.1/second.{1,2,5}': \"единиц{а,ы,} в секунду\",\r\n\t}\r\n}\r\n\r\nfor (let lang in langStrings) {\r\n\tlet strings=langStrings[lang]\r\n\tstrings=require('crnx-base/i18n-expand-curly')(strings)\r\n\tstrings=require('crnx-base/i18n-link-wikipedia')(lang)(strings)\r\n\tstrings=require('crnx-base/options-output-i18n')(lang)(strings)\r\n\tstrings=require('crnx-base/code-output-i18n')(lang)(strings)\r\n\tlangStrings[lang]=strings\r\n}\r\n\r\nmodule.exports=require('crnx-base/i18n')(langStrings)\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Illumination extends Feature {\r\n\tconstructor(material,light) {\r\n\t\tsuper()\r\n\t\tthis.material=material\r\n\t\tthis.light=light\r\n\t\t// possible options checks:\r\n\t\t// material.scope=='global': constant or user input -> uniform\r\n\t\t// material.scope!='global': colors in model data -> attribute\r\n\t\t// material.data=='one': one color\r\n\t\t// material.data!='one': s/d/a colors\r\n\t\t// light.type=='off'\r\n\t\t// light.type!='off'\r\n\t\t// light.type=='blinn'\r\n\t\tif (material.scope=='global') {\r\n\t\t\tif (material.data=='one') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.colorVector=new GlslVector('material.color',material.color.entries)\r\n\t\t\t\t)\r\n\t\t\t} else if (light.type!='off') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.specularColorVector=new GlslVector('material.specularColor',material.specularColor.entries),\r\n\t\t\t\t\tthis.diffuseColorVector =new GlslVector('material.diffuseColor' ,material.diffuseColor.entries),\r\n\t\t\t\t\tthis.ambientColorVector =new GlslVector('material.ambientColor' ,material.ambientColor.entries)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.ambientColorVector=new GlslVector('material.ambientColor',[\r\n\t\t\t\t\t\t...material.ambientColor.entries, Option.LiveFloat.make('a',[0,1,-1,+1],1)().fix()\r\n\t\t\t\t\t])\r\n\t\t\t\t)\r\n\t\t\t\t// TODO consider extendind .specularColor and .diffuseColor, b/c they would be present if vertex scope is chosen\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (light.type!='off') {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tthis.lightDirectionVector=new GlslVector('light.direction',light.direction.entries)\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetColorAttrs() {\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"color\",enabled:true,weight:1.0}\r\n\t\t\t\t]\r\n\t\t\t} else {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"specularColor\",enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"diffuseColor\" ,enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"ambientColor\" ,enabled:true                  ,weight:0.2}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\twantsTransformedPosition(eyeAtInfinity) {\r\n\t\treturn !eyeAtInfinity && this.light.type!='off' && this.material.data!='one'\r\n\t}\r\n\tgetGlslVertexDeclarationLines(eyeAtInfinity,hasNormalAttr) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta(\"attribute vec3 normal;\")\r\n\t\t\t}\r\n\t\t\ta(\"varying vec3 interpolatedNormal;\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"attribute vec4 color;\")\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"attribute vec4 ambientColor;\")\r\n\t\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"attribute vec3 specularColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 diffuseColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 ambientColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(eyeAtInfinity,hasNormalAttr,normalTransformLines) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"interpolatedView=-transformedPosition.xyz;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\"interpolatedNormal=\")\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta.t(\"normal\")\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\"vec3(0.0,0.0,1.0)\")\r\n\t\t\t}\r\n\t\t\ta.t(normalTransformLines)\r\n\t\t\ta.t(\";\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"interpolatedColor=color;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"interpolatedColor=ambientColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"interpolatedSpecularColor=specularColor;\",\r\n\t\t\t\t\t\t\"interpolatedDiffuseColor=diffuseColor;\",\r\n\t\t\t\t\t\t\"interpolatedAmbientColor=ambientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentDeclarationLines(eyeAtInfinity) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\r\n\t\t\t\tthis.lightDirectionVector.getGlslDeclarationLines(),\r\n\t\t\t\t\"varying vec3 interpolatedNormal;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(this.colorVector.getGlslDeclarationLines())\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type!='off') {\r\n\t\t\t\t\ta(this.specularColorVector.getGlslDeclarationLines())\r\n\t\t\t\t\ta(this.diffuseColorVector.getGlslDeclarationLines())\r\n\t\t\t\t}\r\n\t\t\t\ta(this.ambientColorVector.getGlslDeclarationLines())\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one' || this.light.type=='off') {\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentOutputLines(eyeAtInfinity,twoSided) {\r\n\t\tconst a=Lines.b()\r\n\t\tlet colorRGB,colorA,colorRGBA\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tconst vector=(this.material.data=='one'\r\n\t\t\t\t? this.colorVector\r\n\t\t\t\t: this.ambientColorVector\r\n\t\t\t)\r\n\t\t\tcolorRGB =()=>vector.getGlslComponentsValue('rgb')\r\n\t\t\tcolorA   =()=>vector.getGlslComponentsValue('a')\r\n\t\t\tcolorRGBA=()=>vector.getGlslValue()\r\n\t\t} else {\r\n\t\t\tcolorRGB =()=>\"interpolatedColor.rgb\" // TODO don't pass it as vec4 if light is on\r\n\t\t\tcolorA   =()=>\"interpolatedColor.a\"\r\n\t\t\tcolorRGBA=()=>\"interpolatedColor\"\r\n\t\t}\r\n\t\tif (this.light.type=='off') {\r\n\t\t\ta(\"gl_FragColor=\"+colorRGBA()+\";\")\r\n\t\t} else {\r\n\t\t\ta(\"vec3 N=normalize(interpolatedNormal);\")\r\n\t\t\tif (twoSided) {\r\n\t\t\t\ta(\"if (!gl_FrontFacing) N=-N;\")\r\n\t\t\t}\r\n\t\t\ta(\"vec3 L=normalize(\"+this.lightDirectionVector.getGlslValue()+\");\")\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"gl_FragColor=vec4(\"+colorRGB()+\"*max(0.0,dot(L,N)),\"+colorA()+\");\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\t\t\ta(\"vec3 V=normalize(interpolatedView);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 V=vec3(0.0,0.0,1.0);\")\r\n\t\t\t\t}\r\n\t\t\t\tlet specularDotArgs=\"H,N\"\r\n\t\t\t\tlet shininessCorrection=\"\"\r\n\t\t\t\tif (this.light.type=='blinn') {\r\n\t\t\t\t\ta(\"vec3 H=normalize(L+V);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 R=reflect(-L,N);\")\r\n\t\t\t\t\tspecularDotArgs=\"R,V\"\r\n\t\t\t\t\tshininessCorrection=\"/4.0\"\r\n\t\t\t\t}\r\n\t\t\t\ta(\"float shininess=100.0;\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\t\"gl_FragColor=vec4(\",\r\n\t\t\t\t\t\t\",1.0);\"\r\n\t\t\t\t\t).ae(this.material.scope=='global'\r\n\t\t\t\t\t\t? Lines.bae(\r\n\t\t\t\t\t\t\t\"+\"+this.specularColorVector.getGlslValue()+\"*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+\"+this.diffuseColorVector.getGlslValue()+\"*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+\"+this.ambientColorVector.getGlslValue()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: Lines.bae(\r\n\t\t\t\t\t\t\t\"+interpolatedSpecularColor*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+interpolatedDiffuseColor*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+interpolatedAmbientColor\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Illumination\r\n","'use strict'\r\n\r\nclass Base {\r\n\tconstructor(str) {\r\n\t\tthis._str=str\r\n\t}\r\n\ttoString() {\r\n\t\treturn this._str\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this._str\r\n\t}\r\n}\r\n\r\nclass Constant extends Base {\r\n}\r\n\r\nclass Variable extends Base {\r\n}\r\n\r\nclass Slider extends Variable {\r\n}\r\n\r\nclass MouseMove extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=str.slice(-1)\r\n\t}\r\n}\r\n\r\nclass Gamepad extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=Number(str.slice(-1))\r\n\t}\r\n}\r\n\r\nfunction createFromString(str) {\r\n\treturn new {\r\n\t\t'constant':   Constant,\r\n\t\t'slider':     Slider,\r\n\t\t'mousemovex': MouseMove,\r\n\t\t'mousemovey': MouseMove,\r\n\t\t'gamepad0':   Gamepad,\r\n\t\t'gamepad1':   Gamepad,\r\n\t\t'gamepad2':   Gamepad,\r\n\t\t'gamepad3':   Gamepad,\r\n\t}[str](str)\r\n}\r\n\r\nexports.Base=Base\r\nexports.Constant=Constant\r\nexports.Variable=Variable\r\nexports.Slider=Slider\r\nexports.MouseMove=MouseMove\r\nexports.Gamepad=Gamepad\r\nexports.createFromString=createFromString\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Lines=require('crnx-base/lines')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass IntFeature extends NumericFeature {\r\n\tconstructor(name,value) {\r\n\t\tsuper()\r\n\t\tthis.name=name\r\n\t\tthis.value=value\r\n\t}\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.value.input!='constant'\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tif (this.value.input!='constant') {\r\n\t\t\tfeatureContext.hasInputs=true\r\n\t\t}\r\n\t\tif (this.value.input=='slider') {\r\n\t\t\tfeatureContext.hasSliders=true\r\n\t\t}\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\ta(this.getHtmlControlMessageForValue(i18n,this.value,this.name))\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\ta(\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tthis.value,\r\n\t\t\t\t'options.'+this.name,\r\n\t\t\t\tthis.name,\r\n\t\t\t\tfalse\r\n\t\t\t)\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=IntFeature\r\n","'use strict'\r\n\r\nconst capitalize=require('crnx-base/fake-lodash/capitalize')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\n\r\nclass Base {\r\n\tconstructor() {\r\n\t\tthis.entries=[]\r\n\t}\r\n\tenter() {\r\n\t\tconst entry={\r\n\t\t\tpre: [],\r\n\t\t\tcond: null,\r\n\t\t\tlog: [],\r\n\t\t\tpost: [],\r\n\t\t}\r\n\t\tthis.entries.push(entry)\r\n\t\tfunction makePushArgs(where){\r\n\t\t\treturn function(){\r\n\t\t\t\twhere.push(...arguments)\r\n\t\t\t\treturn proxy\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst proxy={\r\n\t\t\tpre: makePushArgs(entry.pre),\r\n\t\t\tcond: function(cond){\r\n\t\t\t\tentry.cond=cond\r\n\t\t\t\treturn proxy\r\n\t\t\t},\r\n\t\t\tlog: makePushArgs(entry.log),\r\n\t\t\tpost: makePushArgs(entry.post),\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn []\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"\"\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn lines\r\n\t}\r\n\twrite(haveToUpdateCanvas,haveToLogInput) {\r\n\t\tconst statementsGraph={}\r\n\t\tconst statementsRoot=[]\r\n\t\tlet statementsPrev=null\r\n\t\tconst WHITE=0\r\n\t\tconst GRAY=1\r\n\t\tconst BLACK=2\r\n\t\tconst addStatement=(statement,cond)=>{\r\n\t\t\tlet vertex\r\n\t\t\tif (statement in statementsGraph) {\r\n\t\t\t\tvertex=statementsGraph[statement]\r\n\t\t\t} else {\r\n\t\t\t\tvertex=statementsGraph[statement]={\r\n\t\t\t\t\tprevs: [],\r\n\t\t\t\t\tconds: [],\r\n\t\t\t\t\tmark: WHITE,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\tif (cond===null) {\r\n\t\t\t\t\tvertex.conds=null\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvertex.conds.push(cond)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tvertex.prevs.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=statement\r\n\t\t}\r\n\t\tconst closeEntryStatements=()=>{\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tstatementsRoot.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=null\r\n\t\t}\r\n\t\tconst getStatements=()=>{\r\n\t\t\tconst statements=[]\r\n\t\t\tlet currentCond=null\r\n\t\t\tconst writeStatement=(statement,vertex)=>{\r\n\t\t\t\tlet newCond=null\r\n\t\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\t\tnewCond=vertex.conds.join(' || ')\r\n\t\t\t\t}\r\n\t\t\t\tif (newCond!=currentCond) {\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"}\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentCond=newCond\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"if (\"+currentCond+\") {\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\tstatements.push('\\t'+statement)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatements.push(statement)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst recVertex=(statement,vertex)=>{\r\n\t\t\t\tvertex.mark=GRAY\r\n\t\t\t\trecPrevs(vertex.prevs)\r\n\t\t\t\tvertex.mark=BLACK\r\n\t\t\t\twriteStatement(statement,vertex)\r\n\t\t\t}\r\n\t\t\tconst recPrevs=(prevs)=>{\r\n\t\t\t\tprevs.forEach((statement)=>{\r\n\t\t\t\t\tif (statementsGraph[statement].mark==WHITE) {\r\n\t\t\t\t\t\trecVertex(statement,statementsGraph[statement])\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\trecPrevs(statementsRoot)\r\n\t\t\tif (currentCond!==null) {\r\n\t\t\t\tstatements.push(\"}\")\r\n\t\t\t}\r\n\t\t\treturn statements\r\n\t\t}\r\n\t\tthis.entries.forEach((entry)=>{\r\n\t\t\tentry.pre.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,null)\r\n\t\t\t})\r\n\t\t\tif (haveToLogInput) {\r\n\t\t\t\tentry.log.forEach(statement=>{\r\n\t\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tentry.post.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t})\r\n\t\t\tif (haveToUpdateCanvas) {\r\n\t\t\t\taddStatement(\"scheduleFrame();\",entry.cond)\r\n\t\t\t}\r\n\t\t\tcloseEntryStatements()\r\n\t\t})\r\n\t\tconst br=this.bracketListener()\r\n\t\tlet statements=getStatements()\r\n\t\tif (statements.length>0) {\r\n\t\t\tstatements=[...this.prependedStatements(),...statements]\r\n\t\t}\r\n\t\tif (statements.length==1) {\r\n\t\t\tconst match=/^(\\w+)\\(\\);$/.exec(statements[0])\r\n\t\t\tif (match) {\r\n\t\t\t\treturn this.wrapCall(\r\n\t\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\tbr[0]+match[1]+br[1]\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t// TODO what if no match?\r\n\t\t}\r\n\t\tif (statements.length>0) {\r\n\t\t\treturn this.wrapCall(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(br[0]+\"function(\"+this.bracketFnArg()+\"){\"),\r\n\t\t\t\t\tJsLines.bae(\"}\"+br[1])\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tJsLines.bae(...statements)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Slider extends Base {\r\n\tconstructor(id) {\r\n\t\tsuper()\r\n\t\tthis.id=id\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"document.getElementById('\"+this.id+\"').addEventListener('change',\",\");\"]\r\n\t}\r\n}\r\n\r\nclass MultipleSlider extends Base {\r\n\tconstructor(query) {\r\n\t\tsuper()\r\n\t\tthis.query=query\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"el.addEventListener('change',\",\");\"]\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\";[].forEach.call(document.querySelectorAll('\"+this.query+\"'),function(el){\"),\r\n\t\t\tJsLines.bae(\"});\")\r\n\t\t).ae(lines)\r\n\t}\r\n}\r\n\r\nclass CanvasMousemove extends Base {\r\n\tenter() {\r\n\t\tconst proxy=super.enter()\r\n\t\tconst floatHelper=(minMaxFlag,varFlag,inputType,varName,minValue,maxValue)=>{\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\tlet dest\r\n\t\t\tif (minValue==0 && maxValue==1) {\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=\"\r\n\t\t\t} else {\r\n\t\t\t\tproxy.pre(\"var min\"+VarName+\"=\"+minValue+\";\")\r\n\t\t\t\tproxy.pre(\"var max\"+VarName+\"=\"+maxValue+\";\")\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\")*\"\r\n\t\t\t}\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\tdest+\"(ev.clientX-rect.left)/(rect.width-1);\",\r\n\t\t\t\tdest+\"(rect.bottom-1-ev.clientY)/(rect.height-1);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tproxy.prexy=function(inputType,xStatement,yStatement){\r\n\t\t\tif (inputType.axis=='x') {\r\n\t\t\t\treturn proxy.pre(xStatement)\r\n\t\t\t} else if (inputType.axis=='y') {\r\n\t\t\t\treturn proxy.pre(yStatement)\r\n\t\t\t}\r\n\t\t\treturn proxy\r\n\t\t}\r\n\t\tproxy.minMaxFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,false,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.minMaxVarFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,true,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.newVarInt=function(inputType,varName){\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(ev.clientX-rect.left)/rect.width);\",\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(rect.bottom-1-ev.clientY)/rect.height);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"canvas.addEventListener('mousemove',\",\");\"]\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"ev\"\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn [\r\n\t\t\t\"var rect=this.getBoundingClientRect();\",\r\n\t\t]\r\n\t}\r\n}\r\n\r\nexports.Slider=Slider\r\nexports.MultipleSlider=MultipleSlider\r\nexports.CanvasMousemove=CanvasMousemove\r\n","'use strict'\r\n\r\nlet idCounter=0\r\nfunction generateId() {\r\n\treturn 'webgl-starter-id-'+(idCounter++)\r\n}\r\n\r\nconst i18ns=require('./i18n')\r\nconst Options=require('./options')\r\nconst Code=require('./code')\r\nconst OptionsOutput=require('./options-output')\r\nconst CodeOutput=require('crnx-base/code-output')\r\n\r\n$(function(){\r\n\t$('.webgl-starter').each(function(){\r\n\t\tconst $container=$(this)\r\n\t\tconst lang=$container.closest('[lang]').attr('lang')\r\n\t\tconst i18n=i18ns(lang)\r\n\t\tconst options=new Options()\r\n\t\tconst codeOutput=new CodeOutput(()=>new Code(options.fix(),i18n),i18n)\r\n\t\toptions.addUpdateCallback(codeOutput.update)\r\n\t\tconst optionsOutput=new OptionsOutput(options,generateId,i18n)\r\n\t\t$container.empty().append(\r\n\t\t\toptionsOutput.$output,\r\n\t\t\tcodeOutput.$output\r\n\t\t)\r\n\t})\r\n})\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\n\r\nclass NumericFeature extends Feature {\r\n\t// private:\r\n\tgetHtmlControlMessageForValue(i18n,value,name) {\r\n\t\tif (value.input instanceof Input.MouseMove) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"<li>\"+i18n('controls.type.'+value.input)+\" \"+i18n('controls.to')+\" <strong>\"+i18n('options.'+name)+\"</strong></li>\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tgetHtmlSliderLines(i18n,value,opName,htmlName,step) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (value.input=='slider') {\r\n\t\t\tconst fmtAttrs=formatNumbers.html({ min:value.min, max:value.max, value:value.value },value.precision)\r\n\t\t\tconst fmtLabels=formatNumbers({ min:value.min, max:value.max },value.precision)\r\n\t\t\tconst minMax=n=>i18n.numberWithUnits(n,value.unit,(a,e)=>Lines.html`<abbr title=${e}>`+a+`</abbr>`)\r\n\t\t\ta(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\tLines.html`\t<label for=${htmlName}>`+i18n(opName)+`</label>`,\r\n\t\t\t\t\"\t<span class=min>\"+minMax(fmtLabels.min)+\"</span>\",\r\n\t\t\t\tLines.html`\t<input type=range id=${htmlName} min=${fmtAttrs.min} max=${fmtAttrs.max} value=${fmtAttrs.value} step=${step}>`,\r\n\t\t\t\t\"\t<span class=max>\"+minMax(fmtLabels.max)+\"</span>\",\r\n\t\t\t\t\"</div>\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=NumericFeature\r\n","'use strict'\r\n\r\nconst Input=require('./input-classes')\r\nconst Option=Object.create(require('crnx-base/option-classes'))\r\n\r\nclass FixedLiveNumber {\r\n\tconstructor(src,setToDefault) {\r\n\t\tif (!setToDefault) {\r\n\t\t\tthis.value=src.value\r\n\t\t\tthis.min=src.min\r\n\t\t\tthis.max=src.max\r\n\t\t\tthis.input=Input.createFromString(src.input)\r\n\t\t} else {\r\n\t\t\tthis.value=src.defaultValue\r\n\t\t\tthis.min=src.availableMin\r\n\t\t\tthis.max=src.availableMax\r\n\t\t\tthis.input=Input.createFromString('constant')\r\n\t\t}\r\n\t\tthis.precision=src.precision\r\n\t\tthis.unit=src.unit\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value\r\n\t}\r\n\ttoString() {\r\n\t\treturn String(this.value)\r\n\t}\r\n}\r\n\r\n// abstract classes\r\n\r\nOption.LiveNumber = class extends Option.Number {\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tlet dataValue,dataMin,dataMax,dataInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value\r\n\t\t\tdataMin  =data.min\r\n\t\t\tdataMax  =data.max\r\n\t\t\tdataInput=data.input\r\n\t\t} else {\r\n\t\t\tdataValue=data\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._min=(dataMin!==undefined)?dataMin:this.availableMin\r\n\t\tthis._max=(dataMax!==undefined)?dataMax:this.availableMax\r\n\t\tthis._input=(dataInput!==undefined)?dataInput:'constant'\r\n\t\tthis._$range=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tif (this._$range) this._$range.toggle(this._input!='constant')\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.update()\r\n\t}\r\n\tget min() {\r\n\t\treturn this._min\r\n\t}\r\n\tset min(min) {\r\n\t\tthis._min=min\r\n\t\tthis.update()\r\n\t}\r\n\tget max() {\r\n\t\treturn this._max\r\n\t}\r\n\tset max(max) {\r\n\t\tthis._max=max\r\n\t\tthis.update()\r\n\t}\r\n\tget $range() {\r\n\t\treturn this._$range\r\n\t}\r\n\tset $range($range) {\r\n\t\tthis._$range=$range\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texportHelper(src) {\r\n\t\tconst data={}\r\n\t\tif (src.value!=src.defaultValue) data.value=src.value\r\n\t\tif (src.min!=src.availableMin) data.min=src.min\r\n\t\tif (src.max!=src.availableMax) data.max=src.max\r\n\t\tif (src.input!='constant') data.input=src.input\r\n\t\treturn data\r\n\t}\r\n\texport() {\r\n\t\treturn this.exportHelper(this)\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=new FixedLiveNumber(this)\r\n\t\tfixed.name=this.name\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.LiveInt = class extends Option.LiveNumber {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey']\r\n\t}\r\n}\r\n\r\nOption.CanvasLiveInt = class extends Option.LiveInt {\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider']\r\n\t}\r\n}\r\n\r\nOption.LiveFloat = class extends Option.LiveNumber {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.speed===undefined) settings.speed={}\r\n\t\tif (settings.speed.availableMin===undefined) settings.speed.availableMin=arrayArg[2]\r\n\t\tif (settings.speed.availableMax===undefined) settings.speed.availableMax=arrayArg[3]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tlet dataSpeedValue,dataSpeedMin,dataSpeedMax,dataSpeedInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tif (typeof data.speed == 'object') {\r\n\t\t\t\tdataSpeedValue=data.speed.value\r\n\t\t\t\tdataSpeedMin  =data.speed.min\r\n\t\t\t\tdataSpeedMax  =data.speed.max\r\n\t\t\t\tdataSpeedInput=data.speed.input\r\n\t\t\t} else {\r\n\t\t\t\tdataSpeedValue=data.speed\r\n\t\t\t}\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._speedAvailableMin=settings.speed.availableMin\r\n\t\tthis._speedAvailableMax=settings.speed.availableMax\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._speedValue=(dataSpeedValue!==undefined)?dataSpeedValue:0\r\n\t\tthis._speedMin=(dataSpeedMin!==undefined)?dataSpeedMin:this._speedAvailableMin\r\n\t\tthis._speedMax=(dataSpeedMax!==undefined)?dataSpeedMax:this._speedAvailableMax\r\n\t\tthis._speedInput=(dataSpeedInput!==undefined)?dataSpeedInput:'constant'\r\n\t\tthis._addSpeed=!(\r\n\t\t\tthis._speedValue==0 &&\r\n\t\t\tthis._speedMin==this._speedAvailableMin &&\r\n\t\t\tthis._speedMax==this._speedAvailableMax &&\r\n\t\t\tthis._speedInput=='constant'\r\n\t\t)\r\n\t\tthis._speed$=null\r\n\t\tthis._speed$range=null\r\n\t\tthis._$addSpeed=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tsuper.updateInternalVisibility()\r\n\t\tif (this._speed$range) this._speed$range.toggle(this._speedInput!='constant')\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this._input)<0\r\n\t\tif (this._speed$) this._speed$.toggle(\r\n\t\t\tthis._addSpeed && notGamepad\r\n\t\t)\r\n\t\tif (this._$addSpeed) this._$addSpeed.toggle(notGamepad)\r\n\t}\r\n\tget addSpeed() {\r\n\t\treturn this._addSpeed\r\n\t}\r\n\tset addSpeed(addSpeed) {\r\n\t\tthis._addSpeed=addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.update()\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey','gamepad0','gamepad1','gamepad2','gamepad3']\r\n\t}\r\n\tget speed() {\r\n\t\tconst option=this\r\n\t\treturn {\r\n\t\t\tget fullName() {\r\n\t\t\t\treturn option.fullName+'.speed'\r\n\t\t\t},\r\n\t\t\tget defaultValue() {\r\n\t\t\t\treturn 0\r\n\t\t\t},\r\n\t\t\tget value() {\r\n\t\t\t\treturn option._speedValue\r\n\t\t\t},\r\n\t\t\tset value(value) {\r\n\t\t\t\toption._speedValue=value\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget input() {\r\n\t\t\t\treturn option._speedInput\r\n\t\t\t},\r\n\t\t\tset input(input) {\r\n\t\t\t\toption._speedInput=input\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget availableMin() {\r\n\t\t\t\treturn option._speedAvailableMin\r\n\t\t\t},\r\n\t\t\tget availableMax() {\r\n\t\t\t\treturn option._speedAvailableMax\r\n\t\t\t},\r\n\t\t\tget min() {\r\n\t\t\t\treturn option._speedMin\r\n\t\t\t},\r\n\t\t\tset min(min) {\r\n\t\t\t\toption._speedMin=min\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget max() {\r\n\t\t\t\treturn option._speedMax\r\n\t\t\t},\r\n\t\t\tset max(max) {\r\n\t\t\t\toption._speedMax=max\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget precision() {\r\n\t\t\t\treturn option.precision\r\n\t\t\t},\r\n\t\t\tget unit() {\r\n\t\t\t\tif (option.unit!==undefined) {\r\n\t\t\t\t\treturn option.unit+'/second'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '1/second'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget availableInputTypes() {\r\n\t\t\t\treturn option.availableInputTypes\r\n\t\t\t},\r\n\t\t\tget $() {\r\n\t\t\t\treturn option._speed$\r\n\t\t\t},\r\n\t\t\tset $($) {\r\n\t\t\t\toption._speed$=$\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t},\r\n\t\t\tget $range() {\r\n\t\t\t\treturn option._speed$range\r\n\t\t\t},\r\n\t\t\tset $range($range) {\r\n\t\t\t\toption._speed$range=$range\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $addSpeed() {\r\n\t\treturn this._$addSpeed\r\n\t}\r\n\tset $addSpeed($addSpeed) {\r\n\t\tthis._$addSpeed=$addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texport() {\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tconst data=this.exportHelper(this)\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tthis.shortenExportAssign(this.exportHelper(this.speed),data,'speed')\r\n\t\t}\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed)\r\n\t\t} else {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed,true)\r\n\t\t}\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.LiveColor = class extends Option.Group {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.componentDefaultValues===undefined) settings.componentDefaultValues=arrayArg\r\n\t\tconst cs='rgba'\r\n\t\tsettings.descriptions=settings.componentDefaultValues.map((defaultValue,i)=>{\r\n\t\t\tconst c=cs.charAt(i)\r\n\t\t\treturn ['LiveFloat',c,[0,1,-1,+1],defaultValue]\r\n\t\t})\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst BaseOptionsOutput=require('crnx-base/options-output')\r\nconst ArrayOptionOutput=require('crnx-base/array-option-output')\r\n\r\nclass OptionsOutput extends BaseOptionsOutput {\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\tsuper.setOptionClassWriters(optionClassWriters)\r\n\t\tconst baseSelectWriter=optionClassWriters.get(Option.Select)\r\n\t\toptionClassWriters.set(Option.LiveNumber,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst writeSubOption=option=>{\r\n\t\t\t\tconst p=option.precision\r\n\t\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\t\tconst writeMinMaxInput=minOrMax=>setInputAttrs($(\"<input type='number' required>\"))\r\n\t\t\t\t\t.val(option[minOrMax])\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\t\toption[minOrMax]=parseFloat(this.value)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\tconst id=generateId()\r\n\t\t\t\tlet $inputSelect,$rangeMinInput,$rangeMaxInput\r\n\t\t\t\tconst $output=optionClassWriters.get(Option.Number)(option,writeOption,i18n,generateId)\r\n\t\t\t\t$output.find('button').before(\r\n\t\t\t\t\t$(\"<label class='nowrap'>\").append(\r\n\t\t\t\t\t\ti18n('options-output.inputs')+\": \",\r\n\t\t\t\t\t\t$inputSelect=$(\"<select>\").append(\r\n\t\t\t\t\t\t\toption.availableInputTypes.map(availableInputType=>\r\n\t\t\t\t\t\t\t\t$(\"<option>\").val(availableInputType).html(i18n('options-output.inputs.'+availableInputType))\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t).val(option.input).change(function(){\r\n\t\t\t\t\t\t\toption.input=this.value\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\" \",\r\n\t\t\t\t\toption.$range=$(\"<span class='range'>\").append(\r\n\t\t\t\t\t\ti18n('options-output.range')+\" \",\r\n\t\t\t\t\t\t$(\"<span class='nowrap'>\").append(\r\n\t\t\t\t\t\t\t$rangeMinInput=writeMinMaxInput('min'),\r\n\t\t\t\t\t\t\t\" .. \",\r\n\t\t\t\t\t\t\t$rangeMaxInput=writeMinMaxInput('max')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\" \"\r\n\t\t\t\t).click(function(){\r\n\t\t\t\t\t$inputSelect.val('constant').change()\r\n\t\t\t\t\t$rangeMinInput.val(option.availableMin).change()\r\n\t\t\t\t\t$rangeMaxInput.val(option.availableMax).change()\r\n\t\t\t\t})\r\n\t\t\t\treturn $output\r\n\t\t\t}\r\n\t\t\tif (option instanceof Option.LiveFloat) {\r\n\t\t\t\treturn option.$=$(\"<div>\").append(\r\n\t\t\t\t\twriteSubOption(option).append(\r\n\t\t\t\t\t\t\" \",\r\n\t\t\t\t\t\toption.$addSpeed=$(\"<label class='nowrap'>\").append(\r\n\t\t\t\t\t\t\t$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t\t.prop('checked',option.addSpeed)\r\n\t\t\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\t\t\toption.addSpeed=this.checked\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\" \"+i18n('options-output.addSpeed')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\toption.speed.$=writeSubOption(option.speed)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\treturn option.$=writeSubOption(option)\r\n\t\t\t}\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Array,function(){\r\n\t\t\treturn new ArrayOptionOutput(...arguments).$output\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nconst BaseOptions=require('crnx-base/options')\r\n\r\nclass Options extends BaseOptions {\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn [\r\n\t\t\t['Group','canvas',[\r\n\t\t\t\t['CanvasLiveInt','width' ,[1,1024],512,{ unit: 'pixel' }],\r\n\t\t\t\t['CanvasLiveInt','height',[1,1024],512,{ unit: 'pixel' }],\r\n\t\t\t]],\r\n\t\t\t['Group','background',[\r\n\t\t\t\t['Select','type',['none','solid']],\r\n\t\t\t\t['LiveColor','color',[1,1,1,1],{\r\n\t\t\t\t\tvisibilityData: {'background.type':'solid'},\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','material',[\r\n\t\t\t\t['Select','scope',['global','vertex','face']], // partly related to shape\r\n\t\t\t\t['Select','data',['one','sda']], // partly related to shape\r\n\t\t\t\t['LiveColor','color',[1,0,0,1],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'one'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','specularColor',[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','diffuseColor' ,[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','ambientColor' ,[0.2,0.2,0.2],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','light',[\r\n\t\t\t\t['Select','type',['off','phong','blinn']],\r\n\t\t\t\t['Group','direction',[\r\n\t\t\t\t\t['LiveFloat','x',[-4,+4,-4,+4],-1],\r\n\t\t\t\t\t['LiveFloat','y',[-4,+4,-4,+4],+1],\r\n\t\t\t\t\t['LiveFloat','z',[-4,+4,-4,+4],+1],\r\n\t\t\t\t],{\r\n\t\t\t\t\tvisibilityData: {'light.type':['phong','blinn']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','shape',[\r\n\t\t\t\t['Select','type',['square','triangle','gasket','cube','hat','terrain']],\r\n\t\t\t\t['Select','elements',['0','8','16','32']],\r\n\t\t\t\t['LiveInt','lod',[0,10],6,{\r\n\t\t\t\t\tvisibilityData: {'shape.type':['gasket','hat','terrain']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','transforms',[\r\n\t\t\t\t['Select','projection',['ortho','perspective']],\r\n\t\t\t\t['Array','model',[\r\n\t\t\t\t\t['LiveFloat','rotate.x',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t\t['LiveFloat','rotate.y',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t\t['LiveFloat','rotate.z',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t]],\r\n\t\t\t]],\r\n\t\t\t['Group','debug',[\r\n\t\t\t\t['Checkbox','shaders',true],\r\n\t\t\t\t['Checkbox','arrays'],\r\n\t\t\t\t['Checkbox','inputs'], // TODO hide if no inputs?\r\n\t\t\t\t['Checkbox','animations'],\r\n\t\t\t]],\r\n\t\t]\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nexports.square=require('./shapes/square')\r\nexports.triangle=require('./shapes/triangle')\r\nexports.gasket=require('./shapes/gasket')\r\nexports.cube=require('./shapes/cube')\r\nexports.hat=require('./shapes/hat')\r\nexports.terrain=require('./shapes/terrain')\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Cube extends Shape {\r\n\tget dim() { return 3 }\r\n\tget twoSided() { return false }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(\r\n\t\t\tthis.colorAttrs,\r\n\t\t\t0, // TODO remove 'clean' colors after bilinear interp is implemented\r\n\t\t\tthis.hasColorsPerFace?undefined:[\r\n\t\t\t\t[0.0, 0.0, 0.0],\r\n\t\t\t\t[1.0, 0.0, 0.0],\r\n\t\t\t\t[0.0, 1.0, 0.0],\r\n\t\t\t\t[1.0, 1.0, 0.0],\r\n\t\t\t\t[0.0, 0.0, 1.0],\r\n\t\t\t\t[1.0, 0.0, 1.0],\r\n\t\t\t\t[0.0, 1.0, 1.0],\r\n\t\t\t\t[1.0, 1.0, 1.0],\r\n\t\t\t]\r\n\t\t)\r\n\t\tconst nCubeVertices=8\r\n\t\tconst cubeColors=[]\r\n\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\tcubeColors.push(colorgen.getNextColorString())\r\n\t\t}\r\n\t\tconst cubeVertexPositions=[\r\n\t\t\t\"-0.5,-0.5,-0.5,\",\r\n\t\t\t\"+0.5,-0.5,-0.5,\",\r\n\t\t\t\"-0.5,+0.5,-0.5,\",\r\n\t\t\t\"+0.5,+0.5,-0.5,\",\r\n\t\t\t\"-0.5,-0.5,+0.5,\",\r\n\t\t\t\"+0.5,-0.5,+0.5,\",\r\n\t\t\t\"-0.5,+0.5,+0.5,\",\r\n\t\t\t\"+0.5,+0.5,+0.5,\",\r\n\t\t]\r\n\t\tconst nCubeFaces=6\r\n\t\tconst cubeFaceNames=[\r\n\t\t\t\"left\",\r\n\t\t\t\"right\",\r\n\t\t\t\"bottom\",\r\n\t\t\t\"top\",\r\n\t\t\t\"back\",\r\n\t\t\t\"front\",\r\n\t\t]\r\n\t\tconst cubeFaceNormals=[\r\n\t\t\t\"-1.0, 0.0, 0.0,\",\r\n\t\t\t\"+1.0, 0.0, 0.0,\",\r\n\t\t\t\" 0.0,-1.0, 0.0,\",\r\n\t\t\t\" 0.0,+1.0, 0.0,\",\r\n\t\t\t\" 0.0, 0.0,-1.0,\",\r\n\t\t\t\" 0.0, 0.0,+1.0,\",\r\n\t\t]\r\n\t\tconst cubeFaceVertices=[\r\n\t\t\t[4, 6, 0, 2],\r\n\t\t\t[1, 3, 5, 7],\r\n\t\t\t[0, 1, 4, 5],\r\n\t\t\t[2, 6, 3, 7],\r\n\t\t\t[0, 2, 1, 3],\r\n\t\t\t[5, 7, 4, 6],\r\n\t\t]\r\n\t\tconst quadToTriangleMap=[0, 1, 2, 2, 1, 3]\r\n\t\tconst vertexCtor=JsLines.b()\r\n\t\tvertexCtor(\"// x    y    z\")\r\n\t\tif (this.hasNormals) {\r\n\t\t\tvertexCtor.t(\"  n.x  n.y  n.z\")\r\n\t\t}\r\n\t\tvertexCtor.t(colorgen.getHeaderString())\r\n\t\tconst appendVertex=(iFace,iVertex,firstInFace)=>{\r\n\t\t\tvertexCtor(cubeVertexPositions[iVertex])\r\n\t\t\tif (this.hasNormals) {\r\n\t\t\t\tvertexCtor.t(cubeFaceNormals[iFace])\r\n\t\t\t}\r\n\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iVertex])\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iFace])\r\n\t\t\t}\r\n\t\t\tif (firstInFace) {\r\n\t\t\t\tvertexCtor.t(\" // \"+cubeFaceNames[iFace]+\" face\")\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst wrapVertices=()=>WrapLines.b(\r\n\t\t\tJsLines.bae(\"var vertices=new Float32Array([\"),\r\n\t\t\tJsLines.bae(\"]);\")\r\n\t\t).ae(\r\n\t\t\tvertexCtor.e()\r\n\t\t)\r\n\t\tif (!this.usesElements()) {\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tquadToTriangleMap.forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,cubeFaceVertices[i][j],k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t\"var nVertices=36;\",\r\n\t\t\t\twrapVertices()\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace || this.hasNormals) {\r\n\t\t\t// elements, face data\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tcubeFaceVertices[i].forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,j,k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([\",\r\n\t\t\t\t\"\t 0,  1,  2,  2,  1,  3, // left face\",\r\n\t\t\t\t\"\t 4,  5,  6,  6,  5,  7, // right face\",\r\n\t\t\t\t\"\t 8,  9, 10, 10,  9, 11, // bottom face\",\r\n\t\t\t\t\"\t12, 13, 14, 14, 13, 15, // top face\",\r\n\t\t\t\t\"\t16, 17, 18, 18, 17, 19, // back face\",\r\n\t\t\t\t\"\t20, 21, 22, 22, 21, 23, // front face\",\r\n\t\t\t\t\"]);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\t// elements, no face data\r\n\t\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\t\tvertexCtor(cubeVertexPositions[i])\r\n\t\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\t\tvertexCtor.t(cubeColors[i])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst elementCtor=JsLines.b()\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\telementCtor(\"\")\r\n\t\t\t\tquadToTriangleMap.forEach(function(j){\r\n\t\t\t\t\telementCtor.t(cubeFaceVertices[i][j]+\", \")\r\n\t\t\t\t})\r\n\t\t\t\telementCtor.t(\"// \"+cubeFaceNames[i]+\" face\")\r\n\t\t\t}\r\n\t\t\tconst wrapElements=()=>WrapLines.b(\r\n\t\t\t\tJsLines.bae(\"var elements=new \"+this.getElementIndexJsArray()+\"([\"),\r\n\t\t\t\tJsLines.bae(\"]);\")\r\n\t\t\t).ae(\r\n\t\t\t\telementCtor.e()\r\n\t\t\t)\r\n\t\t\treturn new Lines(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\twrapElements()\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Cube\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Gasket extends LodShape {\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"(Math.pow(3,\"+lodSymbol+\"+1)+3)/2\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\twriteStoreShape() {\r\n\t\tconst writePushVertex=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[0];\",\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[1];\"\r\n\t\t\t)\r\n\t\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\"colors[nextIndexIntoColors]\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"colors[nextElement%colors.length]\")\r\n\t\t\t\t}\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\".forEach(function(cc){\",\r\n\t\t\t\t\t\"\tvertices[nextIndexIntoVertices++]=cc;\",\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"return nextElement++;\")\r\n\t\t\t} else if (this.hasColorsPerVertex) {\r\n\t\t\t\ta(\"nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\")\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeTriangle=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"if (depth<=0) {\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p0));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p1));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p2));\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tif (es[0]===null) es[0]=pushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tif (es[1]===null) es[1]=pushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tif (es[2]===null) es[2]=pushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[0]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[1]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[2]);\",\r\n\t\t\t\t\t\t\"\treturn es;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"} else {\",\r\n\t\t\t\t\"\tvar p01=mix(p0,p1);\",\r\n\t\t\t\t\"\tvar p12=mix(p1,p2);\",\r\n\t\t\t\t\"\tvar p20=mix(p2,p0);\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\ttriangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);\",\r\n\t\t\t\t\t\"\treturn [es0[0],es1[0],es2[0]];\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeInitialTriangleCall=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"shapeLod,\",\r\n\t\t\t\t\"[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements() && !this.hasColorsPerFace) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\",\",\"[null,null,null]\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var nextIndexIntoVertices=0;\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"var nextIndexIntoElements=0;\")\r\n\t\t\ta(\"var nextElement=0;\")\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(\"// p = position, cc = color component, e = element, es = elements\")\r\n\t\t\ta(this.writeColorData())\r\n\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\ta(\"var nextIndexIntoColors=0;\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\"// p = position, e = element, es = elements\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"function pushVertex(p) {\"),\r\n\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t).ae(\r\n\t\t\t\twritePushVertex()\r\n\t\t\t)\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function pushElement(e) {\",\r\n\t\t\t\t\"\telements[nextIndexIntoElements++]=e;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"function mix(pa,pb) {\",\r\n\t\t\t\"\treturn [\",\r\n\t\t\t\"\t\t(pa[0]+pb[0])/2,\",\r\n\t\t\t\"\t\t(pa[1]+pb[1])/2,\",\r\n\t\t\t\"\t];\",\r\n\t\t\t\"}\",\r\n\t\t\t((!this.usesElements() || this.hasColorsPerFace)\r\n\t\t\t\t? WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t\t: WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2,es) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\twriteTriangle()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"triangle(\"),\r\n\t\t\t\tJsLines.bae(\");\")\r\n\t\t\t).ae(\r\n\t\t\t\twriteInitialTriangleCall()\r\n\t\t\t)\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Gasket\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Hat extends Mesh {\r\n\twriteMeshInit() {\r\n\t\treturn JsLines.bae(\r\n\t\t\t\"var xyRange=4;\",\r\n\t\t\t\"var xyScale=1/(4*Math.sqrt(2));\"\r\n\t\t)\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet iv=0\r\n\t\ta(\r\n\t\t\t\"var r2=(x*x+y*y)/2;\",\r\n\t\t\t\"var A=Math.exp(-r2)/Math.PI;\",\r\n\t\t\t\"var z=A*(1-r2);\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=x*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=y*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=z;\"\r\n\t\t)\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Hat\r\n","'use strict'\r\n\r\nconst Input=require('../input-classes')\r\nconst Option=require('../option-classes')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst Listener=require('../listener-classes')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\nconst IntFeature=require('../int-feature')\r\n\r\nclass LodShape extends Shape {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs)\r\n\t\tconst maxLod=this.getMaxPossibleLod(options.lod.max)\r\n\t\tconst cap=v=>Math.min(maxLod,v)\r\n\t\tthis.lod=Option.LiveInt.make('lod',[0,10],6)({\r\n\t\t\tvalue: cap(options.lod.value),\r\n\t\t\tmin:   cap(options.lod.min),\r\n\t\t\tmax:   cap(options.lod.max),\r\n\t\t\tinput: String(options.lod.input),\r\n\t\t}).fix()\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('shape.lod',this.lod)\r\n\t\t)\r\n\t}\r\n\tgetMaxPossibleLod(requestedMaxLod) { // due to element index type\r\n\t\tif (!this.usesElements() || this.elementIndexBits>=31) { // 1<<31 is a negative number, can't compare with it\r\n\t\t\treturn requestedMaxLod // no need to limit lod if elements are not used or index type is large enough\r\n\t\t}\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst indexLimit=1<<this.elementIndexBits\r\n\t\tfor (let m=requestedMaxLod;m>=0;m--) {\r\n\t\t\tlet n=eval(nVerticesFn(m))\r\n\t\t\tif (n<=indexLimit) {\r\n\t\t\t\treturn m\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO fail here\r\n\t}\r\n\twriteColorData() {\r\n\t\tconst a=JsLines.b()\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tfor (let i=0;i<4;i++) {\r\n\t\t\ta(\"[\"+colorgen.getNextColorString().slice(1,-1)+\"],\")\r\n\t\t}\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\"var colors=[\"),\r\n\t\t\tJsLines.bae(\"];\")\r\n\t\t).ae(a.e())\r\n\t}\r\n\t// abstract getDistinctVertexCount(lodSymbol) {} // # of distinct vertices where one vertex can be shared between different faces and output primitives\r\n\t// abstract getFaceVertexCount(lodSymbol) {} // # of distinct (vertex,face) pairs that still can be shared between output primitives\r\n\t// abstract getTotalVertexCount(lodSymbol) {} // # of vertices in output primitives = # of elements when element arrays are in use\r\n\t// abstract writeStoreShape() {}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\r\n\t\t\t\t\"var minShapeLod=\"+this.lod.min+\";\",\r\n\t\t\t\t\"var maxShapeLod=\"+this.lod.max+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+nVerticesFn(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nMaxElements=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nMaxElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices,nElements;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"\tnElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var shapeLod=\"+this.lod+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta(\r\n\t\t\tIndentLines.bae(this.writeStoreShape()),\r\n\t\t\tIndentLines.bae(this.writeBufferData()),\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\"storeShape(\"+this.lod+\");\")\r\n\t\t} else {\r\n\t\t\ta(\"storeShape();\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.lod.input=='slider') {\r\n\t\t\tvar listener=new Listener.Slider('shape.lod')\r\n\t\t\tlistener.enter()\r\n\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t.post(\"storeShape(parseInt(this.value));\")\r\n\t\t\ta(\r\n\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t)\r\n\t\t} else if (this.lod.input instanceof Input.MouseMove) {\r\n\t\t\tfeatureContext.canvasMousemoveListener.enter()\r\n\t\t\t\t.newVarInt(this.lod.input,'shapeLod')\r\n\t\t\t\t.cond(\"newShapeLod!=shapeLod\")\r\n\t\t\t\t.log(\"console.log('shapeLod input value:',newShapeLod);\")\r\n\t\t\t\t.post(\"storeShape(newShapeLod);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=LodShape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Mesh extends LodShape {\r\n\tget dim() { return 3 }\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\")+1,2)\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*4\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*6\"\r\n\t}\r\n\twriteMeshVertexColors(iv) {\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t((!this.usesElements() && !this.hasColorsPerFace)\r\n\t\t\t\t\t?\"var ic=((i+di)&1)*2+((j+dj)&1);\"\r\n\t\t\t\t\t:\"var ic=(i&1)*2+(j&1);\"\r\n\t\t\t\t),\r\n\t\t\t\t\"colors[ic].forEach(function(cc,icc){\",\r\n\t\t\t\t\"\tvertices[vertexOffset+\"+iv+\"+icc]=cc;\",\r\n\t\t\t\t\"});\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n\t// abstract writeMeshInit() {}\r\n\t// abstract writeMeshVertex() {}\r\n\twriteStoreShape() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var res=(1<<shapeLod);\")\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*6+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*4+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j) {\",\r\n\t\t\t\t\"\treturn i*(res+1)+j;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"function normalize(v) {\",\r\n\t\t\t\t\"\tvar l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);\",\r\n\t\t\t\t\"\treturn [v[0]/l,v[1]/l,v[2]/l];\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(this.writeColorData())\r\n\t\t}\r\n\t\ta(this.writeMeshInit())\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (var i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (var j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<6;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<4;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i,j,0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i,j,3);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<=res;i++) {\",\r\n\t\t\t\t\"\tvar y=i/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\tfor (j=0;j<=res;j++) {\",\r\n\t\t\t\t\"\t\tvar x=j/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\tvar vertexOffset=vertexElement(i,j)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(2).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i+0,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i+1,j+1);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Mesh\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('../feature')\r\n\r\nclass Shape extends Feature {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper()\r\n\t\tthis.elementIndexBits=parseInt(options.elements) // 0 if don't want element arrays; 8, 16 or 32 bits per element index, limits lod of shape\r\n\t\tthis.hasNormals=(hasReflections && this.dim==3) // true = need normals, unless shape is flat\r\n\t\tthis.hasColorsPerVertex=hasColorsPerVertex // TODO support for both hasColorsPerVertex and hasColorsPerFace == true\r\n\t\tthis.hasColorsPerFace=hasColorsPerFace\r\n\t\tthis.colorAttrs=colorAttrs // array of color attribute structs {name,enabled,weight}\r\n\t}\r\n\tget dim() { return 2 }\r\n\tget twoSided() { return true } // triangles can be viewed from both sides\r\n\tget glPrimitive() { return 'TRIANGLES' }\r\n\tusesElements() { // TODO convert to getter\r\n\t\treturn this.elementIndexBits>0\r\n\t}\r\n\tgetNumbersPerVertex() {\r\n\t\treturn this.dim+(this.hasNormals?3:0)+this.colorAttrs.length*3\r\n\t}\r\n\tgetElementIndexJsArray() {\r\n\t\treturn \"Uint\"+this.elementIndexBits+\"Array\"\r\n\t}\r\n\tgetElementIndexGlType() {\r\n\t\tif (this.elementIndexBits==8) {\r\n\t\t\treturn \"gl.UNSIGNED_BYTE\" // not recommended by ms [https://msdn.microsoft.com/en-us/library/dn798776%28v=vs.85%29.aspx]\r\n\t\t} else if (this.elementIndexBits==16) {\r\n\t\t\treturn \"gl.UNSIGNED_SHORT\" // mozilla examples use this\r\n\t\t} else if (this.elementIndexBits==32) {\r\n\t\t\treturn \"gl.UNSIGNED_INT\" // needs extension\r\n\t\t}\r\n\t}\r\n\twriteDebug(debugArrays) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (debugArrays) {\r\n\t\t\ta(\"console.log('vertex array byte length:',vertices.byteLength);\")\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"console.log('element array byte length:',elements.byteLength);\")\r\n\t\t\t\ta(\"console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);\")\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteBufferData() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\treturn JsLines.bae(\r\n\t\t\tthis.writeArrays(),\r\n\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\tthis.writeBufferData()\r\n\t\t)\r\n\t}\r\n\t// public:\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst writeVertexAttribArrays=(attrs)=>{\r\n\t\t\tconst cmpSize=attrs[0][0]\r\n\t\t\tconst allSameSize=attrs.every((attr)=>{\r\n\t\t\t\tvar size=attr[0]\r\n\t\t\t\treturn size==cmpSize\r\n\t\t\t})\r\n\t\t\tlet allEnabled=true\r\n\t\t\tconst arrayLines=JsLines.bae(...attrs.map(attr=>{\r\n\t\t\t\tconst size=attr[0], name=attr[1], enabled=attr[2]\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"'\"+name+\"',\"\r\n\t\t\t\t\t\t: \"[\"+size+\",'\"+name+\"'],\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tallEnabled=false\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"null,\"\r\n\t\t\t\t\t\t: \"[\"+size+\",null],\"\r\n\t\t\t\t\t)+\" // attribute \"+name+\" disabled\"\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t\tlet foreachEnableLines=JsLines.bae(\r\n\t\t\t\t\"var attrLoc=gl.getAttribLocation(program,attrName);\",\r\n\t\t\t\t\"gl.vertexAttribPointer(\",\r\n\t\t\t\t\"\tattrLoc,attrSize,gl.FLOAT,false,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferStride,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferOffset\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(attrLoc);\"\r\n\t\t\t)\r\n\t\t\tif (!allEnabled) {\r\n\t\t\t\tforeachEnableLines=WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"if (name!==null) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tforeachEnableLines\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tconst foreachLines=JsLines.bae(\r\n\t\t\t\t...allSameSize?[\r\n\t\t\t\t\t\"var attrSize=\"+cmpSize+\";\"\r\n\t\t\t\t]:[\r\n\t\t\t\t\t\"var attrSize=attr[0];\",\r\n\t\t\t\t\t\"var attrName=attr[1];\"\r\n\t\t\t\t],\r\n\t\t\t\tforeachEnableLines,\r\n\t\t\t\t\"bufferOffset+=attrSize;\"\r\n\t\t\t)\r\n\t\t\treturn WrapLines.b(\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"var bufferStride=\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\t\t\"var bufferOffset=0;\",\r\n\t\t\t\t\t\";[\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"].forEach(function(\"+(allSameSize?\"attrName\":\"attr\")+\"){\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\tarrayLines,\r\n\t\t\t\tforeachLines\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.elementIndexBits==32) {\r\n\t\t\ta(\"gl.getExtension('OES_element_index_uint');\") // TODO check if null is returned and don't allow more elements\r\n\t\t}\r\n\t\tif (this.dim>2) {\r\n\t\t\ta(\"gl.enable(gl.DEPTH_TEST);\")\r\n\t\t}\r\n\t\ta(\"gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\t}\r\n\t\ta(this.writeArraysAndBufferData(featureContext.debugOptions.arrays))\r\n\t\tif (!this.hasNormals && this.colorAttrs.length<=0) {\r\n\t\t\ta(\r\n\t\t\t\t\"var positionLoc=gl.getAttribLocation(program,'position');\",\r\n\t\t\t\t\"gl.vertexAttribPointer(positionLoc,\"+this.dim+\",gl.FLOAT,false,0,0);\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(positionLoc);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(writeVertexAttribArrays([\r\n\t\t\t\t[this.dim,'position',true],\r\n\t\t\t\t...this.hasNormals?[[3,'normal',true]]:[],\r\n\t\t\t\t...this.colorAttrs.map(attr=>[3,attr.name,attr.enabled])\r\n\t\t\t]))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.drawElements(gl.\"+this.glPrimitive+\",nElements,\"+this.getElementIndexGlType()+\",0);\")\r\n\t\t} else {\r\n\t\t\ta(\"gl.drawArrays(gl.\"+this.glPrimitive+\",0,nVertices);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Shape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Square extends Shape {\r\n\tget glPrimitive() { return 'TRIANGLE_FAN' }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=4;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t// x    y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"\t-0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=4;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2,3]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Square\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Terrain extends Mesh {\r\n\twriteMeshInit() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"var xyRange=1/Math.sqrt(2);\",\r\n\t\t\t\"var zRange=xyRange;\",\r\n\t\t\t\"var mask=res-1;\",\r\n\t\t\t\"function zOffset(i,j) {\",\r\n\t\t\t\"\treturn vertexElement(i,j\"+(noFaces?\"\":\",0\")+\")*\"+this.getNumbersPerVertex()+\"+2;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"function noise(depth) {\",\r\n\t\t\t\"\tvar r=zRange/Math.pow(2,shapeLod-depth-1);\",\r\n\t\t\t\"\treturn Math.random()*2*r-r;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"vertices[2]=0.0;\",\r\n\t\t\t\"var i0,i1,i2,i3;\",\r\n\t\t\t\"var j0,j1,j2,j3;\",\r\n\t\t\t\"for (var depth=shapeLod-1;depth>=0;depth--) {\",\r\n\t\t\t\"\tvar d=1<<depth;\",\r\n\t\t\t\"\t// diamond step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti1=i2-d;\",\r\n\t\t\t\"\t\t\tj1=j2-d;\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"\t// square step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti0=(i2-2*d)&mask;\",\r\n\t\t\t\"\t\t\tj0=(j2-2*d)&mask;\",\r\n\t\t\t\"\t\t\ti1=(i2-d);\",\r\n\t\t\t\"\t\t\tj1=(j2-d);\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j1)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i1,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (noFaces) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];\",\r\n\t\t\t\t\"for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];\",\r\n\t\t\t\t\"vertices[zOffset(res,res)]=vertices[zOffset(0,0)];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"vertices[vertexOffset+0]=x;\",\r\n\t\t\t\"vertices[vertexOffset+1]=y;\",\r\n\t\t\t(noFaces\r\n\t\t\t\t?\"// vertices[vertexOffset+2] already written\"\r\n\t\t\t\t:\"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];\"\r\n\t\t\t)\r\n\t\t)\r\n\t\tlet iv=3\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var d=4*xyRange/res;\",\r\n\t\t\t\t\"var normal=normalize([\",\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t\"1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Terrain\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Triangle extends Shape {\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=3;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t//                   x                      y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=3;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Triangle\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Transforms extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.rotateVectorEntries=[] // [{vector,suffix}] like features, but vectors have additional methods that don't follow feature interfaces\r\n\t\tthis.transformSequence=new Array(options.model.entries.length) // [{vector,component,suffix}]\r\n\t\tconst possibleComponents=['x','y','z']\r\n\t\tconst rotate=[[],[],[]]\r\n\t\toptions.model.entries.forEach((tr,iTr)=>{\r\n\t\t\tconst trData={\r\n\t\t\t\ttransform: tr,\r\n\t\t\t\tindex: iTr,\r\n\t\t\t}\r\n\t\t\tif (tr.type=='rotate.x') {\r\n\t\t\t\trotate[0].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.y') {\r\n\t\t\t\trotate[1].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.z') {\r\n\t\t\t\trotate[2].push(trData)\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst nLayers=Math.max.apply(null,rotate.map(r=>r.length))\r\n\t\tfor (let i=0;i<nLayers;i++) {\r\n\t\t\tlet isInGap=false\r\n\t\t\tlet isStraight=true\r\n\t\t\tlet lastStraightIndex=-1\r\n\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\tif (isInGap) {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tisStraight=false\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tlastStraightIndex=j\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisInGap=true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst suffix=(nLayers>1?String(i):'')\r\n\t\t\tconst makeVector=(values,names)=>{\r\n\t\t\t\tconst vector=new GlslVector('rotate'+(nLayers>1?'.'+i:''),values,180)\r\n\t\t\t\tvector.i18nId='transforms.model.rotate'\r\n\t\t\t\tthis.features.push(vector)\r\n\t\t\t\tthis.rotateVectorEntries.push({\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t})\r\n\t\t\t\treturn vector\r\n\t\t\t}\r\n\t\t\tconst storeSequenceElement=(vector,j)=>{\r\n\t\t\t\tthis.transformSequence[rotate[j][i].index]={\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tcomponent: possibleComponents[j],\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (isStraight) {\r\n\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\trotate.slice(0,lastStraightIndex+1).map(r=>r[i].transform),\r\n\t\t\t\t\tpossibleComponents.slice(0,lastStraightIndex+1)\r\n\t\t\t\t)\r\n\t\t\t\tfor (let j=0;j<=lastStraightIndex;j++) {\r\n\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\t\t\t[rotate[j][i].transform],\r\n\t\t\t\t\t\t\tpossibleComponents.slice(j,j+1)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget eyeAtInfinity() {\r\n\t\treturn this.options.projection=='ortho'\r\n\t}\r\n\t// private:\r\n\tuse2dTransform(flatShape) { // has flat shape and exactly one z rotation TODO multiple z rotations\r\n\t\treturn flatShape && this.options.model.entries.length==1 && this.options.model.entries[0].type=='rotate.z'\r\n\t}\r\n\tgetTransformMatricesLines(dim) { // dim==3 for normal transform, dim==4 for position transform\r\n\t\tconst a=Lines.ba(\"\")\r\n\t\tconst maxSuffixLength=1 // TODO calculate it\r\n\t\tconst width=4+maxSuffixLength // 1(sign)+3(c.x)+(max suffix length)\r\n\t\tconst pad=e=>{ // TODO (fake-)lodash pad\r\n\t\t\tif (e.length<width) {\r\n\t\t\t\treturn (\"          \"+e).slice(-width)\r\n\t\t\t} else {\r\n\t\t\t\treturn e\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst mat=(rows,comment)=>{\r\n\t\t\ta.t(\"*mat\"+dim+\"( // \"+comment)\r\n\t\t\trows.forEach((row,i)=>{\r\n\t\t\t\tif (i>=dim) return\r\n\t\t\t\ta(\"\t\")\r\n\t\t\t\trow.forEach((e,j)=>{\r\n\t\t\t\t\tif (j>=dim) return\r\n\t\t\t\t\ta.t(pad(e))\r\n\t\t\t\t\tif (i<dim-1 || j<dim-1) a.t(\",\")\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\ta(\")\")\r\n\t\t}\r\n\t\tthis.transformSequence.forEach(ts=>{\r\n\t\t\tif (!ts) return\r\n\t\t\tconst c=ts.vector.getGlslMapComponentValue('c'+ts.suffix,ts.component)\r\n\t\t\tconst s=ts.vector.getGlslMapComponentValue('s'+ts.suffix,ts.component)\r\n\t\t\tif (ts.component=='x') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    c,\"-\"+s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    s,    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around x axis\")\r\n\t\t\t} else if (ts.component=='y') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"0.0\",    s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"-\"+s,\"0.0\",    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around y axis\")\r\n\t\t\t} else if (ts.component=='z') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"-\"+s,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[    s,    c,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around z axis\")\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (dim==4 && this.options.projection=='perspective') {\r\n\t\t\tmat([\r\n\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"-(near+far)/2.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t],\"move center of coords inside view\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\t// public:\r\n\tgetGlslVertexDeclarationLines(flatShape) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(rve.vector.getGlslDeclarationLines())\r\n\t\t})\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta(\"attribute vec2 position;\")\r\n\t\t} else {\r\n\t\t\ta(\"attribute vec4 position;\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(flatShape,receivesAspect,needTransformedPosition) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('c'+rve.suffix,v=>`cos(radians(${v}))`),\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('s'+rve.suffix,v=>`sin(radians(${v}))`)\r\n\t\t\t)\r\n\t\t})\r\n\t\tif (this.options.projection=='perspective') {\r\n\t\t\ta(\r\n\t\t\t\t\"float fovy=45.0;\",\r\n\t\t\t\t\"float near=1.0/tan(radians(fovy)/2.0);\",\r\n\t\t\t\t\"float far=near+2.0;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta(\"vec4 transformedPosition=\")\r\n\t\t} else {\r\n\t\t\ta(\"gl_Position=\")\r\n\t\t}\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta.t(\r\n\t\t\t\t\"vec4(position*mat2(\",\r\n\t\t\t\t\"\tcz, -sz,\",\r\n\t\t\t\t\"\tsz,  cz\",\r\n\t\t\t\t\"),0,1)\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta.t(\"position\")\r\n\t\t\ta.t(this.getTransformMatricesLines(4))\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta.t(\";\")\r\n\t\t\ta(\"gl_Position=transformedPosition\")\r\n\t\t}\r\n\t\tif (this.options.projection=='ortho') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\"*vec4(1.0/aspect,1.0,-1.0,1.0)\") // correct aspect ratio and make coords right-handed\r\n\t\t\t} else if (!flatShape) {\r\n\t\t\t\ta.t(\"*vec4(1.0,1.0,-1.0,1.0)\") // make coords right-handed for 3d shapes\r\n\t\t\t}\r\n\t\t} else if (this.options.projection=='perspective') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear/aspect, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.t(\";\")\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexNormalTransformLines() {\r\n\t\treturn this.getTransformMatricesLines(3)\r\n\t}\r\n}\r\n\r\nmodule.exports=Transforms\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\n\r\nclass VectorComponent {\r\n\tconstructor(value,vectorName,wrapRange) {\r\n\t\tthis.value=value // value from options.fix()\r\n\t\tthis.vectorName=vectorName\r\n\t\tthis.wrapRange=wrapRange // if defined and components min/max == -/+ this value, use wrap() instead of clamp()\r\n\t}\r\n\tget suffix() {\r\n\t\tconst dotIndex=this.value.name.lastIndexOf('.')\r\n\t\tif (dotIndex<0) {\r\n\t\t\treturn this.value.name\r\n\t\t} else {\r\n\t\t\treturn this.value.name.slice(dotIndex+1)\r\n\t\t}\r\n\t}\r\n\tget name() { return this.vectorName+'.'+this.suffix }\r\n\tget varName() { return camelCase(this.name) }\r\n\tget varNameLoc() { return this.varName+'Loc' }\r\n\tget varNameSpeed() { return this.varName+'Speed' }\r\n\tget varNameInput() { return this.varName+'Input' }\r\n\tget minVarName() { return camelCase('min.'+this.name) }\r\n\tget maxVarName() { return camelCase('max.'+this.name) }\r\n\tget variable() {\r\n\t\treturn this.value.input!='constant' || this.hasSpeed()\r\n\t}\r\n\thasSpeed() {\r\n\t\treturn this.value.speed!=0 || this.value.speed.input!='constant'\r\n\t}\r\n\thasInput() {\r\n\t\treturn this.value.input!='constant' || this.value.speed.input!='constant'\r\n\t}\r\n\thasInputClass(inputClass) {\r\n\t\treturn this.value.input instanceof inputClass || this.value.speed.input instanceof inputClass\r\n\t}\r\n\tusesStartTime() {\r\n\t\treturn (this.value.input=='constant' && this.value.speed!=0) && this.value.speed.input=='constant'\r\n\t}\r\n\tusesPrevTime() {\r\n\t\treturn (this.value.input!='constant' && this.value.speed!=0) || this.value.speed.input!='constant'\r\n\t}\r\n\tget wrapReady() {\r\n\t\treturn this.wrapRange && this.value.min==-this.wrapRange && this.value.max==+this.wrapRange\r\n\t}\r\n\tget wrapped() {\r\n\t\treturn this.hasSpeed() && this.wrapReady && this.value.input=='slider' // need to wrap only if input with state is used\r\n\t}\r\n\tget clamped() {\r\n\t\treturn !this.wrapped && this.value.speed.input!='constant' && !this.wrapReady\r\n\t}\r\n\tget capped() {\r\n\t\treturn !this.wrapped && !this.clamped && this.hasSpeed() && !this.wrapReady\r\n\t}\r\n}\r\n\r\nmodule.exports=VectorComponent\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\nconst formatNumber=require('crnx-base/format-number')\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Listener=require('./listener-classes')\r\nconst VectorComponent=require('./vector-component')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass Vector extends NumericFeature {\r\n\tconstructor(name,values,wrapRange) {\r\n\t\tsuper()\r\n\t\tthis.name=name // name with dots like \"material.color\", transformed into \"materialColor\" for js var names\r\n\t\tthis.components=[]\r\n\t\tthis.componentsBySuffix={}\r\n\t\tvalues.forEach(v=>{\r\n\t\t\tconst component=new VectorComponent(v,name,wrapRange)\r\n\t\t\tthis.components.push(component)\r\n\t\t\tthis.componentsBySuffix[component.suffix]=component\r\n\t\t})\r\n\t\t// { TODO extra ctor args\r\n\t\tthis.i18nId=name\r\n\t\t// }\r\n\t\tthis.nVars=0\r\n\t\tthis.modeConstant=true // all vector components are constants\r\n\t\tthis.modeFloats=false // one/some vector components are variable, such components get their own glsl vars\r\n\t\tthis.components.forEach((component,i)=>{\r\n\t\t\tif (component.variable) {\r\n\t\t\t\tthis.modeConstant=false\r\n\t\t\t\tif (this.nVars++!=i) {\r\n\t\t\t\t\tthis.modeFloats=true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.nVars==1) {\r\n\t\t\tthis.modeFloats=true\r\n\t\t}\r\n\t\tthis.modeVector=(!this.modeConstant && !this.modeFloats) // first consecutive components are variable, packed into one glsl vector\r\n\t}\r\n\tget varName() { // js/glsl var name\r\n\t\treturn camelCase(this.name)\r\n\t}\r\n\tget updateFnName() {\r\n\t\treturn camelCase('update.'+this.name)\r\n\t}\r\n\t// fns that can be mapped over components:\r\n\tmakeInitialComponentValue() {\r\n\t\tconst numbers={}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (component.value.input=='slider') {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else {\r\n\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst fmt=formatNumbers.js(numbers)\r\n\t\treturn component=>{\r\n\t\t\tif (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\" // b/c slider could be init'd to a value different than the default\r\n\t\t\t} else {\r\n\t\t\t\treturn fmt[component.value.name]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tmakeUpdatedComponentValue() {\r\n\t\tconst numbers={}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (\r\n\t\t\t\tcomponent.value.speed!=0 || component.value.speed.input!='constant' ||\r\n\t\t\t\tcomponent.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad\r\n\t\t\t) {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else if (component.value.input=='slider') {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else {\r\n\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst fmt=formatNumbers.js(numbers)\r\n\t\treturn component=>{\r\n\t\t\tif (\r\n\t\t\t\tcomponent.value.speed!=0 || component.value.speed.input!='constant' ||\r\n\t\t\t\tcomponent.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad\r\n\t\t\t) {\r\n\t\t\t\treturn component.varName\r\n\t\t\t} else if (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\"\r\n\t\t\t} else {\r\n\t\t\t\treturn fmt[component.value.name]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// abstract fns:\r\n\tgetJsDeclarationLines() { return JsLines.be() } // Locs etc\r\n\tgetJsUpdateLines(componentValue) { return JsLines.be() }\r\n\taddPostToListenerEntryForComponent(entry,component) {} // do necessary entry.post()\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {} // TODO check if we need componentValue - GlslVector doesn't use it\r\n\t// public:\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.components.some(component=>component.hasInput())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (component.hasInput()) featureContext.hasInputs=true\r\n\t\t\tif (component.hasInputClass(Input.Slider)) featureContext.hasSliders=true\r\n\t\t\tif (component.hasInputClass(Input.Gamepad)) featureContext.pollsGamepad=true\r\n\t\t\tif (component.usesStartTime()) featureContext.hasStartTime=true\r\n\t\t\tif (component.usesPrevTime()) featureContext.hasPrevTime=true\r\n\t\t\tif (component.wrapped) featureContext.hasWrapFn=true\r\n\t\t\tif (component.clamped) featureContext.hasClampFn=true\r\n\t\t})\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\ta(\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value,this.i18nId+'.'+component.suffix),\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value.speed,this.i18nId+'.'+component.suffix+'.speed')\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\tthis.components.forEach(component=>a(\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tcomponent.value,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix,\r\n\t\t\t\tcomponent.name,\r\n\t\t\t\t'any'\r\n\t\t\t),\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tcomponent.value.speed,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix+'.speed',\r\n\t\t\t\tcomponent.name+'.speed',\r\n\t\t\t\t'any'\r\n\t\t\t)\r\n\t\t))\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst getSliderListenerLines=(doUpdate)=>{\r\n\t\t\tconst getManyListenersLines=()=>{\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\tconst writeListener=(v,htmlName)=>{\r\n\t\t\t\t\tif (v.input!='slider') return\r\n\t\t\t\t\tconst listener=new Listener.Slider(htmlName)\r\n\t\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\ta(featureContext.getListenerLines(listener))\r\n\t\t\t\t}\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\twriteListener(component.value,component.name)\r\n\t\t\t\t\twriteListener(component.value.speed,component.name+'.speed')\r\n\t\t\t\t})\r\n\t\t\t\treturn a.e()\r\n\t\t\t}\r\n\t\t\tconst getOneListenerLines=()=>{\r\n\t\t\t\tconst listener=new Listener.MultipleSlider(\"[id^=\\\"\"+this.name+\".\\\"]\") // will also handle speed sliders, but it's ok\r\n\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t\treturn featureContext.getListenerLines(listener)\r\n\t\t\t}\r\n\t\t\tconst manyListenersLines=getManyListenersLines()\r\n\t\t\tconst oneListenerLines=getOneListenerLines()\r\n\t\t\treturn manyListenersLines.count()<=oneListenerLines.count() ? manyListenersLines : oneListenerLines\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\ta(this.getJsDeclarationLines())\r\n\t\tif (this.modeConstant) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst someSpeeds=this.components.some(component=>component.hasSpeed())\r\n\t\tconst someValueSliders=this.components.some(component=>component.value.input=='slider')\r\n\t\tconst someGamepads=this.components.some(component=>component.hasInputClass(Input.Gamepad))\r\n\t\tconst writeVarLines=()=>{\r\n\t\t\tlet fmt, sfmt\r\n\t\t\tconst numbers={}, snumbers={}\r\n\t\t\tconst writes=[], swrites=[]\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (\r\n\t\t\t\t\t(component.value.input instanceof Input.MouseMove && (someValueSliders || someSpeeds || someGamepads)) || // mouse input required elsewhere\r\n\t\t\t\t\t(component.value.speed.input!='constant' && component.value.input!='slider') // variable speed and no value input capable of storing the state\r\n\t\t\t\t) {\r\n\t\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t\t\twrites.push(component)\r\n\t\t\t\t}\r\n\t\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tsnumbers[component.value.name]=component.value.speed\r\n\t\t\t\t\tswrites.push(component)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tfmt=formatNumbers.js(numbers)\r\n\t\t\tsfmt=formatNumbers.js(snumbers)\r\n\t\t\twrites.forEach(component=>a(\"var \"+component.varName+\"=\"+fmt[component.value.name]+\";\"))\r\n\t\t\tswrites.forEach(component=>a(\"var \"+component.varNameSpeed+\"=\"+sfmt[component.value.name]+\";\"))\r\n\t\t}\r\n\t\twriteVarLines()\r\n\t\tif (!someSpeeds && someValueSliders && !someGamepads) {\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function \"+this.updateFnName+\"() {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.getJsUpdateLines(this.makeUpdatedComponentValue())\r\n\t\t\t\t),\r\n\t\t\t\tthis.updateFnName+\"();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(getSliderListenerLines(!someSpeeds && !someGamepads))\r\n\t\tif (this.components.some(component=>(component.value.input instanceof Input.MouseMove))) {\r\n\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\t}\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.value.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tconst fmt=formatNumbers.js({\r\n\t\t\t\t\t\tmin:component.value.min,\r\n\t\t\t\t\t\tmax:component.value.max,\r\n\t\t\t\t\t},component.value.precision)\r\n\t\t\t\t\t;((!someSpeeds && !someValueSliders && !someGamepads) ? entry.minMaxVarFloat : entry.minMaxFloat)(\r\n\t\t\t\t\t\tcomponent.value.input,component.varName,fmt.min,fmt.max\r\n\t\t\t\t\t)\r\n\t\t\t\t\tentry.log(\"console.log('\"+component.name+\" input value:',\"+component.varName+\");\")\r\n\t\t\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\t\t\tthis.addPostToListenerEntryForComponent(entry,component)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (!someSpeeds && !someGamepads) {\r\n\t\t\t\tif (!someValueSliders) {\r\n\t\t\t\t\tthis.addPostToListenerEntryAfterComponents(entry,this.makeUpdatedComponentValue())\r\n\t\t\t\t} else {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.components.some(component=>(component.value.speed.input instanceof Input.MouseMove))) {\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tconst fmt=formatNumbers.js({\r\n\t\t\t\t\tmin:component.value.speed.min,\r\n\t\t\t\t\tmax:component.value.speed.max,\r\n\t\t\t\t},component.value.speed.precision)\r\n\t\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tentry.minMaxFloat(component.value.speed.input,component.varNameSpeed,fmt.min,fmt.max)\r\n\t\t\t\t\t\t.log(\"console.log('\"+component.name+\".speed input value:',\"+component.varNameSpeed+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tconst add=(s)=>{\r\n\t\t\tconst c=s.charAt(0)\r\n\t\t\tif (c=='-' || c=='+') {\r\n\t\t\t\treturn s\r\n\t\t\t} else {\r\n\t\t\t\treturn \"+\"+s\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet needUpdate=false\r\n\t\tconst writeGamepad=(component,v,dotSuffix,varSuffix)=>{\r\n\t\t\tif (v.input instanceof Input.Gamepad) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tconst fmt=formatNumbers.js({min:v.min,max:v.max,value:v.value},v.precision)\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var \"+component.minVarName+varSuffix+\"=\"+fmt.min+\";\",\r\n\t\t\t\t\t\"var \"+component.maxVarName+varSuffix+\"=\"+fmt.max+\";\",\r\n\t\t\t\t\t\"var \"+component.varName+varSuffix+\"=\"+fmt.value+\";\",\r\n\t\t\t\t\t\"if (gamepad && gamepad.axes.length>\"+v.input.axis+\") {\",\r\n\t\t\t\t\t\"\t\"+component.varName+varSuffix+\"=\"+component.minVarName+varSuffix+\"+(\"+component.maxVarName+varSuffix+\"-\"+component.minVarName+varSuffix+\")*(gamepad.axes[\"+v.input.axis+\"]+1)/2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.inputs) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+dotSuffix+\" input value:',\"+component.varName+varSuffix+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tconst v=component.value\r\n\t\t\twriteGamepad(component,v,'','')\r\n\t\t\twriteGamepad(component,v.speed,'.speed','Speed')\r\n\t\t\tif (component.hasSpeed()) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tlet addSpeed\r\n\t\t\t\tif (v.speed.input=='slider') {\r\n\t\t\t\t\taddSpeed=\"+parseFloat(document.getElementById('\"+component.name+\".speed').value)\"\r\n\t\t\t\t} else if (v.speed.input instanceof Input.MouseMove || v.speed.input instanceof Input.Gamepad) {\r\n\t\t\t\t\taddSpeed=\"+\"+component.varNameSpeed\r\n\t\t\t\t} else {\r\n\t\t\t\t\taddSpeed=add(formatNumber.js(v.speed))\r\n\t\t\t\t}\r\n\t\t\t\tlet limitFn=(x,dx)=>{\r\n\t\t\t\t\tif (x==component.varName) {\r\n\t\t\t\t\t\treturn dx.charAt(0)+\"=\"+dx.slice(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"=\"+x+dx\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (component.wrapped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=wrap(\"+x+dx+\",\"+formatNumber.js(v.max,v.precision)+\")\"\r\n\t\t\t\t} else if (component.clamped) {\r\n\t\t\t\t\tconst fmt=formatNumbers.js({min:v.min,max:v.max},v.precision)\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=clamp(\"+x+dx+\",\"+fmt.min+\",\"+fmt.max+\")\"\r\n\t\t\t\t} else if (component.capped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=Math.\"+(v.speed<0?\"max\":\"min\")+\"(\"+x+dx+\",\"+formatNumber.js(v.speed<0?v.min:v.max,v.precision)+\")\"\r\n\t\t\t\t}\r\n\t\t\t\tconst incrementLine=(base,dt)=>component.varName+limitFn(base,addSpeed+\"*\"+dt+\"/1000\")+\";\"\r\n\t\t\t\tif (v.input=='slider') {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"var \"+component.varNameInput+\"=document.getElementById('\"+component.name+\"');\",\r\n\t\t\t\t\t\t\"var \"+incrementLine(\"parseFloat(\"+component.varNameInput+\".value)\",\"(time-prevTime)\"),\r\n\t\t\t\t\t\tcomponent.varNameInput+\".value=\"+component.varName+\";\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (v.input instanceof Input.MouseMove || v.speed.input!='constant') {\r\n\t\t\t\t\ta(incrementLine(component.varName,\"(time-prevTime)\"))\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"var \"+incrementLine(formatNumber.js(v),\"(time-startTime)\"))\r\n\t\t\t\t}\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.animations) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+\" animation value:',\"+component.varName+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (needUpdate) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeUpdatedComponentValue()))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Vector\r\n"],"sourceRoot":"."}