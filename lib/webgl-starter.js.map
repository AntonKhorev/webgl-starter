{"version":3,"sources":["webgl-starter.js","node_modules/browser-pack/_prelude.js","node_modules/crnx-base/code-output-i18n.js","node_modules/crnx-base/code-output.js","node_modules/crnx-base/code-section.js","node_modules/crnx-base/fake-lodash/camelcase.js","node_modules/crnx-base/fake-lodash/capitalize.js","node_modules/crnx-base/fake-lodash/debounce.js","node_modules/crnx-base/fake-lodash/escape.js","node_modules/crnx-base/fake-lodash/repeat.js","node_modules/crnx-base/indent-lines.js","node_modules/crnx-base/interleave-lines.js","node_modules/crnx-base/js-lines.js","node_modules/crnx-base/lines.js","node_modules/crnx-base/nose-wrap-lines.js","node_modules/crnx-base/option-classes.js","node_modules/crnx-base/options-output.js","node_modules/crnx-base/options.js","node_modules/crnx-base/web-code.js","node_modules/crnx-base/wrap-lines.js","src/background.js","src/call-vector.js","src/canvas.js","src/code.js","src/colorgen.js","src/feature-context.js","src/feature.js","src/fixed-options-helpers.js","src/glsl-vector.js","src/i18n.js","src/illumination.js","src/input-classes.js","src/int-feature.js","src/listener-classes.js","src/main.js","src/numeric-feature.js","src/option-classes.js","src/options-output.js","src/options.js","src/shape-classes.js","src/shapes/cube.js","src/shapes/gasket.js","src/shapes/hat.js","src/shapes/lodshape.js","src/shapes/mesh.js","src/shapes/shape.js","src/shapes/square.js","src/shapes/terrain.js","src/shapes/triangle.js","src/transforms.js","src/vector-component.js","src/vector.js"],"names":["babelHelpers","typeof","obj","Symbol","constructor","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","classCallCheck","instance","TypeError","possibleConstructorReturn","self","call","ReferenceError","inherits","subClass","superClass","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","undefined","create","taggedTemplateLiteralLoose","strings","raw","e","t","n","r","s","o","u","a","require","f","Error","code","l","exports",1,"module","additionalStringsPrefix","additionalStrings","save","run","section.html","section.css","section.js","embedded","mode.full","mode.body","mode.embed","mode.paste","mode.file","warning.no-hljs","id",2,"debounce","repeat","CodeOutput","generateCode","i18n","_this","this","$sectionCode","$sectionModeInput","$indentCheckbox","$indentNumber","$jsSemicolonsCheckbox","getCode","getFormatting","indent","prop","checkValidity","Number","val","refs","jsSemicolons","getSectionModes","html","css","js","extractCode","sectionModes","sections","extractSections","sectionName","empty","append","$code","$","getHtml","join","window","hljs","highlightBlock","writeFormattingControls","change","on","writeSection","extractable","$summary","$saveButton","map","mode","click","section","blob","Blob","get","type","mimeType","navigator","msSaveOrOpenBlob","filename","$a","attr","URL","createObjectURL","appendTo","remove","$output","writeButtons","delay","update","w","open","document","write","close","getSection","JSON","stringify","title","submit","6","8",3,"CodeSection","lines","formatting",4,"capitalize","split","5","charAt","toUpperCase","slice","func","wait","timeoutId","clearTimeout","setTimeout",7,"entityMap","&","<",">","\"","'","String","replace","m","Array",9,"Lines","IndentLines","_Lines","data","level","doGet","indentStr","12",10,"escape","InterleaveLines","apply","arguments","out","first","fp","push","forEach","item","subOut",11,"JsLines","processStringInGet","TO","isArray","isDataEmpty","isEmpty","addTo","pop","shift","match","b","_this2","_arguments","makeLines","Function","bind","concat","ae","ba","_b","be","bae","_b2","count","_arguments2","reduce","v","test",13,"WrapLines","NoseWrapLines","_WrapLines","18",14,"Option","Base","_class","name","settings","fullName","optionByFullName","updateCallback","makeEntry","isInsideArray","_$","isVisible","fullNamesAffectingVisibility","visibilityData","testName","indexOf","make","nScalars","nArrays","nObjects","scalarArg","arrayArg","objectArg","arg","optionClass","collectArgs","updateVisibility","toggle","shortenExport","dataKeys","shortenExportAssign","parentData","set","Input","_Option$Base","_class2","defaultValue","_value","Boolean","_Option$Input","_class3","fix","NonBoolean","_Option$Input2","_class4","valueOf","toString","Factor","_Option$NonBoolean","_class5","_this4","availableValues","_Option$NonBoolean2","_class6","_this5","availableMin","availableMax","Collection","_Option$Base2","_class7","_this6","entries","descriptions","x","subName","subData","entry","fixedEntries","fixed","Void","_Option$Base3","_class8","Checkbox","_Option$Boolean","_class9","Select","_Option$Factor","_class10","Text","_Option$Factor2","_class11","Int","_Option$Number","_class12","Float","_Option$Number2","_class13","_this12","precision","Root","_Option$Collection","_class14","Group","_Option$Collection2","_class15","_Option$Base4","_class16","_this15","availableConstructors","Map","ctor","typePropertyName","_entries","subDatas","defaultType","availableTypes","subType","subCtor","addEntry","_this16","_this17","subFixed","types","_",15,"OptionsOutput","options","generateId","option","optionProto","getPrototypeOf","optionClassWriter","optionClassWriters","setOptionClassWriters","root","writeOption","availableValue","listId","text","p","setInputAttrs","$input","Math","pow","toFixed","setInputAttrsAndListeners","getOtherInput","$that","parseFloat","$sliderInput","$numberInput","$dragged","$entries","updateArrayEntries","children","writeDraggableOption","ev","parent","originalEvent","dataTransfer","effectAllowed","setData","setDragImage","addClass","keydown","$handle","$sorted","keyCode","prev","before","focus","next","after","preventDefault","dropEffect","$target","nextAll","is","prevAll","removeClass","$buttons",16,"Options","simpleUpdateCallback","optionClasses","optionsWithVisibilityAffectedByFullName","description","parentfullName","_Option$className","className","makeArgs","entriesDescription",17,"_templateObject","_templateObject2","_templateObject3","WebCode","getLines","stylePlaceLines","cachedStyleLines","styleExtractLines","getSectionPasteComment","basename","scriptPlaceLines","cachedScriptLines","scriptExtractLines","htmlExtractLines","getBodyHtmlSectionLines","getFullHtmlSectionLines","lang","cachedHeadLines","cachedBodyLines","_styleLines","styleLines","_headLines","headLines","_bodyLines","bodyLines","_scriptLines","scriptLines","wrappers","pushWrapper",19,"Feature","CallVector","Background","_Feature","isSolid","features","color","getJsLoopLines","featureContext","20","25","Vector","_Vector","values","calledFn","calledFnDefaultArgs","getJsUpdateLines","componentValue","nValueSliders","components","component","input","modeConstant","every","dotIndex","lastIndexOf","suffixArray","suffix","addPostToListenerEntryAfterComponents","post","26","50",21,"Listener","IntFeature","Canvas","width","height","getHtmlCanvasLines","getGlslVertexDeclarationLines","hasInputs","getGlslVertexOutputLines","needAspectConstant","providesAspect","getJsInitLines","canvasUpdater","canvasListener","wh","listener","Slider","enter","log","getListenerLines","31","32",22,"Shape","FeatureContext","Transforms","Illumination","BaseWebCode","Code","_BaseWebCode","debug","canvas","background","transforms","illumination","material","light","makeShape","shape","scope","getColorAttrs","featureNames","feature","requestFeatureContext","hasSliders","getVertexShaderLines","needTransformedPosition","wantsTransformedPosition","eyeAtInfinity","dim","hasNormals","getGlslVertexNormalTransformLines","getFragmentShaderLines","getGlslFragmentDeclarationLines","getGlslFragmentOutputLines","twoSided","_NoseWrapLines$b","_this3","getHtmlControlMessageLines","getHtmlInputLines","getMakeProgramLines","debugShaders","addWithCommentIfNotEmpty","featureLines","comment","getJsAfterInitLines","getJsInnerLoopLines","hasClampFn","hasWrapFn","pollsGamepad","hasStartTime","hasPrevTime","isAnimated","hasTime","24","29","38","48",23,"colorgenCounter","SingleColorgen","weight","noise","baseColors","defaultBaseColors","colorgenNumber","nextIndex","getNextColorString","baseColor","ci","sin","co","Colorgen","colorAttrs","singleColorgens","getHeaderString","singleColorgen","debugOptions","canvasMousemoveListener","CanvasMousemove","inputs","getRecursiveLines","method","args","some","makeFormatNumber","contextNumber","nonnegativeLimits","lead","max","abs","prec","spaces","fmt","formatNumber","number","capNumber","maxValue","capped","min",27,"fixOptHelp","GlslVector","wrapMode","getGlslDeclarationLines","modeFloats","nVars","varName","_ret","variable","getGlslValue","getGlslComponentsValue","selectedComponents","allSuffixString","results","showResult","result","componentsBySuffix","modeVector","allSameConstant","cmp","j","c","prevResult","getGlslMapDeclarationLines","mapName","mapFn","getGlslMapComponentValue","selectedComponent","getJsDeclarationLines","varNameLoc","addPostToListenerEntryForComponent","vs",28,"plural","word","expandIdAndString","string","expandRegexp","exec","idStart","idMids","idEnd","stringStart","stringMids","stringEnd","idMid","stringMid","plainValue","pixelValue","dataStrings","options.canvas","options.canvas.{width,height}","options.canvas.{width,height}.value","options.background","options.background.type","options.background.type.none","options.background.type.solid","options.background.color","options.background.color.{r,g,b,a}","options.background.color.{r,g,b,a}.value","options.background.color.{r,g,b,a}.speed","options.background.color.{r,g,b,a}.speed.value","options.material","options.material.scope","options.material.scope.global","options.material.scope.vertex","options.material.scope.face","options.material.data","options.material.data.one","options.material.data.sda","options.material.color","options.material.color.{r,g,b,a}","options.material.color.{r,g,b,a}.value","options.material.color.{r,g,b,a}.speed","options.material.color.{r,g,b,a}.speed.value","options.material.{specular,diffuse,ambient}Color","options.material.{specular,diffuse,ambient}Color.{r,g,b}","options.material.{specular,diffuse,ambient}Color.{r,g,b}.value","options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed","options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed.value","options.light","options.light.type","options.light.type.off","options.light.type.phong","options.light.type.blinn","options.light.direction","options.light.direction.{x,y,z}","options.light.direction.{x,y,z}.value","options.light.direction.{x,y,z}.speed","options.light.direction.{x,y,z}.speed.value","options.shape","options.shape.type","options.shape.type.square","options.shape.type.triangle","options.shape.type.gasket","options.shape.type.cube","options.shape.type.hat","options.shape.type.terrain","options.shape.elements","options.shape.elements.0","options.shape.elements.{8,16,32}","options.shape.lod","options.shape.lod.value","options.transforms","options.transforms.projection","options.transforms.projection.ortho","options.transforms.projection.perspective","options.transforms.model","options.transforms.model.rotate.{x,y,z}.add","options.transforms.model.rotate.{x,y,z}","options.transforms.model.rotate.{x,y,z}.value","options.transforms.model.rotate.{x,y,z}.speed","options.transforms.model.rotate.{x,y,z}.speed.value","options.debug","options.debug.shaders","options.debug.arrays","options.debug.inputs","options.debug.animations","options.formatting","options.formatting.indent","options.formatting.indent.tab","options.formatting.indent.{2,4,8}","options-output.inputs","options-output.inputs.constant","options-output.inputs.slider","options-output.inputs.mousemove{x,y}","options-output.inputs.gamepad{0,1,2,3}","options-output.range","options-output.reset","options-output.addSpeed","options-output.drag","options-output.delete","options-output.elements","controls.type.mousemovex","controls.type.mousemovey","controls.to","colorVector","specularColorVector","specularColor","diffuseColorVector","diffuseColor","ambientColorVector","ambientColor","LiveFloat","lightDirectionVector","direction","enabled","hasNormalAttr","normalTransformLines","colorRGB","colorA","colorRGBA","vector","specularDotArgs","shininessCorrection","35",30,"createFromString","str","constant","Constant","slider","mousemovex","MouseMove","mousemovey","gamepad0","Gamepad","gamepad1","gamepad2","gamepad3","_str","_Base","Variable","_Base2","_Variable","_Variable2","axis","_Variable3","NumericFeature","_NumericFeature","getHtmlControlMessageForValue","34","makePushArgs","where","proxy","pre","cond","prependedStatements","bracketFnArg","wrapCall","haveToUpdateCanvas","haveToLogInput","statementsGraph","statementsRoot","statementsPrev","WHITE","GRAY","BLACK","addStatement","statement","vertex","prevs","conds","mark","closeEntryStatements","getStatements","statements","currentCond","writeStatement","newCond","recVertex","recPrevs","br","bracketListener","MultipleSlider","query","_Base3","floatHelper","minMaxFlag","varFlag","inputType","minValue","VarName","dest","prexy","xStatement","yStatement","minMaxFloat","minMaxVarFloat","newVarInt",33,"idCounter","each","$container","codeOutput","optionsOutput","36","37","FixedLiveNumber","src","setToDefault","LiveNumber","dataValue","dataMin","dataMax","dataInput","_min","_max","_input","_$range","updateInternalVisibility","exportHelper","$range","LiveInt","_Option$LiveNumber","CanvasLiveInt","_Option$LiveInt","_Option$LiveNumber2","dataSpeedValue","dataSpeedMin","dataSpeedMax","dataSpeedInput","speed","_speedAvailableMin","_speedAvailableMax","_speedValue","_speedMin","_speedMax","_speedInput","_addSpeed","_speed$","_speed$range","_$addSpeed","notGamepad","addSpeed","availableInputTypes","$addSpeed","LiveColor","_Option$Group","componentDefaultValues","cs","BaseOptionsOutput","_BaseOptionsOutput","baseSelectWriter","$option","writeSubOption","writeMinMaxInput","minOrMax","inputSelectId","$inputSelect","$rangeMinInput","$rangeMaxInput","find","availableInputType","prepend","checked","BaseOptions","_BaseOptions","background.type","material.scope","material.data","light.type","shape.type","square","triangle","gasket","cube","hat","terrain","39","40","41","45","46","47","Cube","_Shape","writeArrays","colorgen","hasColorsPerFace","nCubeVertices","cubeColors","cubeVertexPositions","nCubeFaces","cubeFaceNames","cubeFaceNormals","cubeFaceVertices","quadToTriangleMap","vertexCtor","appendVertex","iFace","iVertex","firstInFace","hasColorsPerVertex","wrapVertices","usesElements","_loop","k","_loop2","getElementIndexJsArray","_ret3","elementCtor","_loop3","wrapElements","44","LodShape","Gasket","_LodShape","getDistinctVertexCount","lodSymbol","getFaceVertexCount","getTotalVertexCount","writeStoreShape","writePushVertex","writeTriangle","writeInitialTriangleCall","writeColorData","42","Mesh","Hat","_Mesh","writeMeshInit","writeMeshVertex","iv","writeMeshVertexColors","43","hasReflections","lod","getMaxPossibleLod","requestedMaxLod","elementIndexBits","nVerticesFn","indexLimit","eval","writeArraysAndBufferData","debugArrays","getNumbersPerVertex","writeDebug","writeBufferData","parseInt","elements","getElementIndexGlType","writeVertexAttribArrays","attrs","cmpSize","allSameSize","size","allEnabled","arrayLines","foreachEnableLines","foreachLines","arrays","glPrimitive","Square","colorDataForFace","Terrain","noFaces","Triangle","rotateVectorEntries","transformSequence","model","possibleComponents","rotate","tr","iTr","trData","transform","index","nLayers","isInGap","isStraight","lastStraightIndex","has","makeVector","names","i18nId","storeSequenceElement","use2dTransform","flatShape","getTransformMatricesLines","maxSuffixLength","pad","mat","rows","row","ts","projection","rve","receivesAspect",49,"camelCase","VectorComponent","vectorName","hasSpeed","hasInput","hasInputClass","inputClass","usesStartTime","usesPrevTime","wrapReady","wrapped","clamped","_templateObject4","makeInitialComponentValue","makeUpdatedComponentValue","writeInput","opName","htmlName","getSliderListenerLines","doUpdate","getManyListenersLines","writeListener","updateFnName","getOneListenerLines","manyListenersLines","oneListenerLines","someSpeeds","someValueSliders","someGamepads","varNameSpeed","add","needUpdate","writeGamepad","dotSuffix","varSuffix","minVarName","maxVarName","sfmt","limitFn","dx","incrementLine","base","dt","varNameInput","animations"],"mappings":"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","file":"webgl-starter.js","sourcesContent":["(function () {\n    var babelHelpers = {\n        typeof: function (obj) {\n            return obj && typeof Symbol !== 'undefined' && obj.constructor === Symbol ? 'symbol' : typeof obj;\n        },\n        createClass: function () {\n            function defineProperties(target, props) {\n                for (var i = 0; i < props.length; i++) {\n                    var descriptor = props[i];\n                    descriptor.enumerable = descriptor.enumerable || false;\n                    descriptor.configurable = true;\n                    if ('value' in descriptor)\n                        descriptor.writable = true;\n                    Object.defineProperty(target, descriptor.key, descriptor);\n                }\n            }\n            return function (Constructor, protoProps, staticProps) {\n                if (protoProps)\n                    defineProperties(Constructor.prototype, protoProps);\n                if (staticProps)\n                    defineProperties(Constructor, staticProps);\n                return Constructor;\n            };\n        }(),\n        classCallCheck: function (instance, Constructor) {\n            if (!(instance instanceof Constructor)) {\n                throw new TypeError('Cannot call a class as a function');\n            }\n        },\n        possibleConstructorReturn: function (self, call) {\n            if (!self) {\n                throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n            }\n            return call && (typeof call === 'object' || typeof call === 'function') ? call : self;\n        },\n        inherits: function (subClass, superClass) {\n            function defaults(obj, defaults) {\n                var keys = Object.getOwnPropertyNames(defaults);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = keys[i];\n                    var value = Object.getOwnPropertyDescriptor(defaults, key);\n                    if (value && value.configurable && obj[key] === undefined) {\n                        Object.defineProperty(obj, key, value);\n                    }\n                }\n                return obj;\n            }\n            ;\n            if (typeof superClass !== 'function' && superClass !== null) {\n                throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n            }\n            subClass.prototype = Object.create(superClass && superClass.prototype, {\n                constructor: {\n                    value: subClass,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true\n                }\n            });\n            if (superClass)\n                defaults(subClass, superClass);\n        },\n        taggedTemplateLiteralLoose: function (strings, raw) {\n            strings.raw = raw;\n            return strings;\n        }\n    };\n    (function e(t, n, r) {\n        function s(o, u) {\n            if (!n[o]) {\n                if (!t[o]) {\n                    var a = typeof require == 'function' && require;\n                    if (!u && a)\n                        return a(o, !0);\n                    if (i)\n                        return i(o, !0);\n                    var f = new Error('Cannot find module \\'' + o + '\\'');\n                    throw f.code = 'MODULE_NOT_FOUND', f;\n                }\n                var l = n[o] = { exports: {} };\n                t[o][0].call(l.exports, function (e) {\n                    var n = t[o][1][e];\n                    return s(n ? n : e);\n                }, l, l.exports, e, t, n, r);\n            }\n            return n[o].exports;\n        }\n        var i = typeof require == 'function' && require;\n        for (var o = 0; o < r.length; o++)\n            s(r[o]);\n        return s;\n    }({\n        1: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (strings) {\n                    var additionalStringsPrefix = 'code-output';\n                    var additionalStrings = {\n                        'save': 'Save source code',\n                        'run': 'Run in new window',\n                        'section.html': 'HTML',\n                        'section.css': 'CSS',\n                        'section.js': 'JavaScript',\n                        'embedded': 'embedded in HTML source code',\n                        'mode.full': 'complete HTML',\n                        'mode.body': 'only HTML body',\n                        'mode.embed': 'embed in HTML',\n                        'mode.paste': 'extract to paste into HTML later',\n                        'mode.file': 'extract to load as external resource',\n                        'warning.no-hljs': '<a href=\\'https://highlightjs.org/\\'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.'\n                    };\n                    for (var id in additionalStrings) {\n                        strings[additionalStringsPrefix + '.' + id] = additionalStrings[id];\n                    }\n                    return strings;\n                };\n            },\n            {}\n        ],\n        2: [\n            function (require, module, exports) {\n                'use strict';\n                var debounce = require(6);\n                var repeat = require(8);\n                var CodeOutput = function () {\n                    function CodeOutput(generateCode, i18n) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, CodeOutput);\n                        var code = generateCode();\n                        var $sectionCode = {}, $sectionModeInput = {};\n                        var $indentCheckbox = undefined, $indentNumber = undefined, $jsSemicolonsCheckbox = undefined;\n                        var getHtmlDataUri = function (html) {\n                            return 'data:text/html;charset=utf-8,' + encodeURIComponent(html);\n                        };\n                        var getCode = function () {\n                            return code;\n                        };\n                        var getFormatting = function () {\n                            var indent = '\\t';\n                            if (!$indentCheckbox.prop('checked')) {\n                                var n = 4;\n                                if ($indentNumber[0].checkValidity()) {\n                                    n = Number($indentNumber.val());\n                                }\n                                indent = repeat(' ', n);\n                            }\n                            return {\n                                refs: _this.refs,\n                                indent: indent,\n                                jsSemicolons: $jsSemicolonsCheckbox.prop('checked')\n                            };\n                        };\n                        var getSectionModes = function () {\n                            return {\n                                html: $sectionModeInput['html'].val(),\n                                css: $sectionModeInput['css'].val(),\n                                js: $sectionModeInput['js'].val()\n                            };\n                        };\n                        var extractCode = function () {\n                            var sectionModes = getSectionModes();\n                            var sections = code.extractSections(sectionModes);\n                            for (var sectionName in sections) {\n                                if (sectionModes[sectionName] == 'embed') {\n                                    $sectionCode[sectionName].empty().append('<p>' + i18n('code-output.embedded') + '</p>');\n                                } else {\n                                    var $code = undefined;\n                                    $sectionCode[sectionName].empty().append($('<pre>').append($code = $('<code class=\\'' + sectionName + '\\'>')));\n                                    $code.html(sections[sectionName].getHtml(getFormatting()).join('\\n'));\n                                    if (window.hljs) {\n                                        hljs.highlightBlock($code[0]);\n                                    }\n                                }\n                            }\n                        };\n                        var writeFormattingControls = function () {\n                            return $('<details>').append('<summary>Formatting</summary>', $('<div>').append($('<label>').append($indentCheckbox = $('<input type=\\'checkbox\\' checked>').change(extractCode), ' indent with tabs')), $('<div>').append($('<label>').append($indentNumber = $('<input type=\\'number\\' min=\\'0\\' max=\\'32\\' value=\\'4\\' required>').on('input change', extractCode), ' spaces per indent')), $('<div>').append($('<label>').append($jsSemicolonsCheckbox = $('<input type=\\'checkbox\\'>').change(extractCode), ' JavaScript semicolons')));\n                        };\n                        var writeSection = function (sectionName) {\n                            var extractable = sectionName != 'html';\n                            var $summary = $('<summary>' + i18n('code-output.section.' + sectionName) + '</summary>');\n                            var $saveButton = undefined;\n                            $summary.append(' ', $sectionModeInput[sectionName] = $('<select>').append((sectionName == 'html' ? [\n                                'full',\n                                'body'\n                            ] : [\n                                'embed',\n                                'paste',\n                                'file'\n                            ]).map(function (mode) {\n                                return $('<option>').val(mode).html(i18n('code-output.mode.' + mode));\n                            })).change(function () {\n                                if (extractable) {\n                                    $saveButton.prop('disabled', this.value == 'embed');\n                                }\n                                extractCode();\n                            }), ' ', /*\r\n   // doesn't work in IE\r\n   $(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n   \t// yes I want a button, but download attr is only available for links\r\n   \t$(this).attr('href',getHtmlDataUri(\r\n   \t\tsection.get(this.formatting).join(\"\\n\")\r\n   \t))\r\n   })\r\n   */\n                            $saveButton = $('<button type=\\'button\\'>' + i18n('code-output.save') + '</button>').click(function () {\n                                var section = code.extractSections(getSectionModes())[sectionName];\n                                // http://stackoverflow.com/a/24354303\n                                var blob = new Blob([section.get(getFormatting()).join('\\n')], { type: section.mimeType });\n                                if (navigator.msSaveOrOpenBlob) {\n                                    navigator.msSaveOrOpenBlob(blob, section.filename);\n                                } else {\n                                    var $a = $('<a>').attr('download', section.filename).attr('href', URL.createObjectURL(blob)).appendTo('body');\n                                    $a.get(0).click();\n                                    $a.remove();\n                                }\n                            }));\n                            if (extractable) {\n                                $saveButton.prop('disabled', $sectionModeInput[sectionName].val() == 'embed');\n                            }\n                            return $('<details open>').append($summary, $sectionCode[sectionName] = $('<div class=\\'code\\'>'));\n                        };\n                        var $output = $('<div class=\\'code-output\\'>').append(this.writeButtons(getCode, getFormatting, i18n)).append(writeFormattingControls(), writeSection('html'), writeSection('css'), writeSection('js'));\n                        if (!window.hljs) {\n                            $output.append('<p>' + i18n('code-output.warning.no-hljs') + '</p>');\n                        }\n                        $output.append(this.writeButtons(getCode, getFormatting, i18n));\n                        extractCode();\n                        var delay = 200;\n                        var update = debounce(function () {\n                            code = generateCode();\n                            extractCode();\n                        }, delay);\n                        // public props:\n                        this.$output = $output;\n                        this.update = update;\n                    }\n                    // private interface:\n                    CodeOutput.prototype.writeButtons = function writeButtons(getCode, getFormatting, i18n) {\n                        return $('<div>').append($('<button type=\\'button\\'>' + i18n('code-output.run') + '</button>').click(function () {\n                            /*\r\n   // doesn't work in IE\r\n   window.open(getHtmlDataUri(\r\n   \tcode.get(this.formatting).join(\"\\n\")\r\n   ),\"generatedCode\")\r\n   */\n                            var code = getCode();\n                            var w = window.open('', 'generatedCode');\n                            w.document.open();\n                            w.document.write(code.get(getFormatting()).join('\\n'));\n                            w.document.close();\n                        }), ' ', $('<button type=\\'button\\'>Open in CodePen</button>').click(function () {\n                            // http://blog.codepen.io/documentation/api/prefill/\n                            var code = getCode();\n                            var sections = code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(getFormatting()).join('\\n');\n                            };\n                            $('<form method=\\'post\\' action=\\'http://codepen.io/pen/define/\\'>').append($('<input type=\\'hidden\\' name=\\'data\\'>').val(JSON.stringify({\n                                html: getSection('html'),\n                                css: getSection('css'),\n                                js: getSection('js'),\n                                title: code.title\n                            }))).appendTo('body').submit();\n                        }), ' ', $('<button type=\\'button\\'>Open in JSFiddle</button>').click(function () {\n                            // http://doc.jsfiddle.net/api/post.html\n                            var code = getCode();\n                            var sections = code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(getFormatting()).join('\\n');\n                            };\n                            var writeSection = function (sectionName) {\n                                return $('<input type=\\'hidden\\'>').attr('name', sectionName).val(getSection(sectionName));\n                            };\n                            $('<form method=\\'post\\' action=\\'http://jsfiddle.net/api/post/library/pure/\\'>').append(writeSection('html'), writeSection('css'), writeSection('js'), $('<input type=\\'hidden\\' name=\\'title\\'>').val(code.title), '<input type=\\'hidden\\' name=\\'wrap\\' value=\\'b\\'>').appendTo('body').submit();\n                        }));\n                    };\n                    babelHelpers.createClass(CodeOutput, [{\n                            key: 'refs',\n                            get: function () {\n                                return {};\n                            }\n                        }]);\n                    return CodeOutput;\n                }();\n                module.exports = CodeOutput;\n            },\n            {\n                '6': 6,\n                '8': 8\n            }\n        ],\n        3: [\n            function (require, module, exports) {\n                'use strict';\n                var CodeSection = function () {\n                    function CodeSection(filename, mimeType, lines) {\n                        babelHelpers.classCallCheck(this, CodeSection);\n                        this.filename = filename;\n                        this.mimeType = mimeType;\n                        this.lines = lines;\n                    }\n                    CodeSection.prototype.get = function get(formatting) {\n                        return this.lines.get(formatting);\n                    };\n                    CodeSection.prototype.getHtml = function getHtml(formatting) {\n                        return this.lines.getHtml(formatting);\n                    };\n                    return CodeSection;\n                }();\n                module.exports = CodeSection;\n            },\n            {}\n        ],\n        4: [\n            function (require, module, exports) {\n                // assumes string is dot-separated, like this: \"some.html.id\"\n                var capitalize = require(5);\n                module.exports = function (s) {\n                    return s.split('.').map(function (w, i) {\n                        return i > 0 ? capitalize(w) : w;\n                    }).join('');\n                };\n            },\n            { '5': 5 }\n        ],\n        5: [\n            function (require, module, exports) {\n                // assumes string is lowercase\n                module.exports = function (s) {\n                    return s.charAt(0).toUpperCase() + s.slice(1);\n                };\n            },\n            {}\n        ],\n        6: [\n            function (require, module, exports) {\n                // no options\n                module.exports = function (func, wait) {\n                    var timeoutId = null;\n                    return function () {\n                        clearTimeout(timeoutId);\n                        timeoutId = setTimeout(func, wait);\n                    };\n                };\n            },\n            {}\n        ],\n        7: [\n            function (require, module, exports) {\n                module.exports = function (s) {\n                    var entityMap = {\n                        '&': '&amp;',\n                        '<': '&lt;',\n                        '>': '&gt;',\n                        '\"': '&quot;',\n                        '\\'': '&#39;'\n                    };\n                    // lodash also escapes `\n                    return String(s).replace(/[&<>\"']/g, function (m) {\n                        return entityMap[m];\n                    });\n                };\n            },\n            {}\n        ],\n        8: [\n            function (require, module, exports) {\n                module.exports = function (s, n) {\n                    return Array(n + 1).join(s);\n                };\n            },\n            {}\n        ],\n        9: [\n            function (require, module, exports) {\n                'use strict';\n                var repeat = require(8);\n                var Lines = require(12);\n                var IndentLines = function (_Lines) {\n                    babelHelpers.inherits(IndentLines, _Lines);\n                    function IndentLines(data, level) {\n                        babelHelpers.classCallCheck(this, IndentLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        if (level !== undefined) {\n                            _this.level = level;\n                        } else {\n                            _this.level = 1;\n                        }\n                        return _this;\n                    }\n                    IndentLines.prototype.doGet = function doGet(formatting, html) {\n                        var indent = '\\t';\n                        if (formatting.indent !== undefined) {\n                            indent = formatting.indent;\n                        }\n                        var indentStr = repeat(indent, this.level);\n                        return _Lines.prototype.doGet.call(this, formatting, html).map(function (s) {\n                            return indentStr + s;\n                        });\n                    };\n                    return IndentLines;\n                }(Lines);\n                module.exports = IndentLines;\n            },\n            {\n                '12': 12,\n                '8': 8\n            }\n        ],\n        10: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                var Lines = require(12);\n                var InterleaveLines = function (_Lines) {\n                    babelHelpers.inherits(InterleaveLines, _Lines);\n                    function InterleaveLines() {\n                        babelHelpers.classCallCheck(this, InterleaveLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    InterleaveLines.prototype.doGet = function doGet(formatting, html) {\n                        var out = [];\n                        var first = true;\n                        var fp = function () {\n                            if (first) {\n                                first = false;\n                            } else {\n                                out.push('');\n                            }\n                        };\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (subOut.length > 0) {\n                                    fp();\n                                    out.push.apply(out, subOut);\n                                }\n                            } else if (typeof item == 'string') {\n                                fp();\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                        });\n                        return out;\n                    };\n                    return InterleaveLines;\n                }(Lines);\n                module.exports = InterleaveLines;\n            },\n            {\n                '12': 12,\n                '7': 7\n            }\n        ],\n        11: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(12);\n                var JsLines = function (_Lines) {\n                    babelHelpers.inherits(JsLines, _Lines);\n                    function JsLines() {\n                        babelHelpers.classCallCheck(this, JsLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    JsLines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        if (formatting.jsSemicolons) {\n                            return s.replace(/^;/, '');\n                        } else {\n                            return s.replace(/;$/, '');\n                        }\n                    };\n                    return JsLines;\n                }(Lines);\n                module.exports = JsLines;\n            },\n            { '12': 12 }\n        ],\n        12: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\n                var escape = require(7);\n                var repeat = require(8);\n                var TO = {};\n                // TODO Symbol\n                var Lines = function () {\n                    // lines private interface:\n                    function Lines(data) {\n                        babelHelpers.classCallCheck(this, Lines);\n                        if (!Array.isArray(data)) {\n                            throw new TypeError('attempted to construct Lines with non-array data argument');\n                        }\n                        this.data = data;\n                    }\n                    Lines.prototype.isDataEmpty = function isDataEmpty() {\n                        for (var i = 0; i < this.data.length; i++) {\n                            var item = this.data[i];\n                            if (item instanceof Lines) {\n                                if (!item.isEmpty()) {\n                                    return false;\n                                }\n                            } else if (typeof item == 'string') {\n                                return false;\n                            }\n                        }\n                        return true;\n                    };\n                    Lines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        return s;\n                    };\n                    Lines.prototype.doGet = function doGet(formatting, html) {\n                        var _this = this;\n                        var out = [];\n                        var addTo = false;\n                        this.data.forEach(function (item) {\n                            if (item === TO) {\n                                addTo = true;\n                            } else if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (addTo && subOut.length > 0) {\n                                    out.push(out.pop() + subOut.shift());\n                                }\n                                out.push.apply(out, subOut);\n                                addTo = false;\n                            } else if (typeof item == 'string') {\n                                var s = _this.processStringInGet(item, formatting);\n                                if (formatting.indent !== undefined && formatting.indent != '\\t') {\n                                    s = s.replace(/^(\\t)+/, function (match) {\n                                        return repeat(formatting.indent, match.length);\n                                    });\n                                }\n                                s = html ? escape(s) : s;\n                                if (addTo) {\n                                    out.push(out.pop() + s);\n                                } else {\n                                    out.push(s);\n                                }\n                                addTo = false;\n                            }\n                        });\n                        return out;\n                    };\n                    // lines public interface:\n                    Lines.b = function b() {\n                        var _this2 = this, _arguments = arguments;\n                        var data = [];\n                        var makeLines = function () {\n                            return new (Function.prototype.bind.apply(_this2, [null].concat([data], Array.prototype.slice.call(_arguments))))();\n                        };\n                        var a = function () {\n                            return a.a.apply(a, arguments);\n                        };\n                        a.a = function () {\n                            data.push.apply(data, arguments);\n                            return this;\n                        };\n                        a.t = function () {\n                            data.push.apply(data, [TO].concat(Array.prototype.slice.call(arguments)));\n                            return this;\n                        };\n                        a.e = makeLines;\n                        a.ae = function () {\n                            return this.a.apply(this, arguments).e();\n                        };\n                        return a;\n                    };\n                    Lines.ba = function ba() {\n                        var _b;\n                        return (_b = this.b()).a.apply(_b, arguments);\n                    };\n                    Lines.be = function be() {\n                        return this.b().e();\n                    };\n                    Lines.bae = function bae() {\n                        var _b2;\n                        return (_b2 = this.b()).a.apply(_b2, arguments).e();\n                    };\n                    Lines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    Lines.prototype.get = function get(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, false);\n                    };\n                    Lines.prototype.getHtml = function getHtml(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, true);\n                    };\n                    Lines.prototype.count = function count() {\n                        return this.doGet({}, false).length;    // can be faster b/c don't need to output stuff\n                    };\n                    // TODO make HtmlLines\n                    Lines.html = function html(strings) {\n                        var _arguments2 = arguments;\n                        // html template tag\n                        // usage example for attributes: Lines.html`<input type=text value=${value}>`\n                        // usage example for elements: Lines.html`<option>${option}</option>`\n                        return strings.reduce(function (r, s, i) {\n                            var v = _arguments2[i];\n                            switch (r.slice(-1)) {\n                            case '=':\n                                if (v === false) {\n                                    return r.replace(/\\s+[a-zA-Z0-9-]+=$/, '') + s;    // TODO more permitting attr name regexp\n                                } else if (v === true) {\n                                    return r.replace(/=$/, '') + s;\n                                }\n                                v = String(v).replace(/&/g, '&amp;');\n                                if (v == '') {\n                                    return r.replace(/=$/, '') + s;\n                                } else if (!/[\\s\"'=<>`]/.test(v)) {\n                                    return r + v + s;\n                                } else if (!/'/.test(v)) {\n                                    return r + '\\'' + v + '\\'' + s;\n                                } else {\n                                    v = v.replace(/\"/g, '&quot;');\n                                    return r + '\"' + v + '\"' + s;\n                                }\n                            case '>':\n                                v = String(v).replace(/&/g, '&amp;').replace(/</g, '&lt;');\n                                return r + v + s;\n                            }\n                            throw new Error('invalid character before substitution');\n                        });\n                    };\n                    return Lines;\n                }();\n                module.exports = Lines;\n            },\n            {\n                '7': 7,\n                '8': 8\n            }\n        ],\n        13: [\n            function (require, module, exports) {\n                'use strict';\n                var WrapLines = require(18);\n                var NoseWrapLines = function (_WrapLines) {\n                    babelHelpers.inherits(NoseWrapLines, _WrapLines);\n                    function NoseWrapLines() {\n                        babelHelpers.classCallCheck(this, NoseWrapLines);\n                        return babelHelpers.possibleConstructorReturn(this, _WrapLines.apply(this, arguments));\n                    }\n                    NoseWrapLines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    NoseWrapLines.prototype.doGet = function doGet(formatting, html) {\n                        if (this.isEmpty()) {\n                            return [];\n                        } else {\n                            return _WrapLines.prototype.doGet.call(this, formatting, html);\n                        }\n                    };\n                    return NoseWrapLines;\n                }(WrapLines);\n                module.exports = NoseWrapLines;\n            },\n            { '18': 18 }\n        ],\n        14: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\n                var Option = {};\n                // abstract classes\n                Option.Base = function () {\n                    _class.make = function make(name) {\n                        var nScalars = 0, nArrays = 0, nObjects = 0;\n                        var scalarArg = undefined, arrayArg = [], objectArg = {};\n                        for (var i = 1; i < arguments.length; i++) {\n                            var arg = arguments[i];\n                            if (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\n                                if (nScalars++ == 0)\n                                    scalarArg = arg;\n                            } else if (Array.isArray(arg)) {\n                                if (nArrays++ == 0)\n                                    arrayArg = arg;\n                            } else if (arg instanceof Object) {\n                                if (nObjects++ == 0)\n                                    objectArg = arg;\n                            }\n                        }\n                        var optionClass = this;\n                        var settings = this.collectArgs(scalarArg, arrayArg, objectArg);\n                        return function () {\n                            return new (Function.prototype.bind.apply(optionClass, [null].concat([\n                                name,\n                                settings\n                            ], Array.prototype.slice.call(arguments))))();\n                        };\n                    };\n                    _class.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return settings;\n                    };\n                    function _class(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class);\n                        this.name = name;\n                        this.updateCallback = updateCallback;\n                        this.fullName = fullName;\n                        this._$ = null;\n                        this.isVisible = function () {\n                            return true;\n                        };\n                        this.fullNamesAffectingVisibility = [];\n                        if (settings.visibilityData !== undefined) {\n                            this.isVisible = function () {\n                                for (var testName in settings.visibilityData) {\n                                    var value = optionByFullName[testName].value;\n                                    if (settings.visibilityData[testName].indexOf(value) < 0) {\n                                        return false;\n                                    }\n                                }\n                                return true;\n                            };\n                            for (var testName in settings.visibilityData) {\n                                this.fullNamesAffectingVisibility.push(testName);\n                            }\n                        }\n                    }\n                    _class.prototype.updateVisibility = function updateVisibility() {\n                        if (this.$)\n                            this.$.toggle(this.isVisible());\n                    };\n                    _class.prototype.shortenExport = function shortenExport(data) {\n                        // used by parent\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            return data.value;\n                        } else {\n                            return data;\n                        }\n                    };\n                    _class.prototype.shortenExportAssign = function shortenExportAssign(data, parentData, name) {\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            parentData[name] = data.value;\n                        } else if (dataKeys.length > 0) {\n                            parentData[name] = data;\n                        }\n                    };\n                    babelHelpers.createClass(_class, [{\n                            key: '$',\n                            get: function () {\n                                return this._$;\n                            },\n                            set: function ($) {\n                                this._$ = $;\n                                this.updateVisibility();\n                            }\n                        }]);\n                    return _class;\n                }();\n                Option.Input = function (_Option$Base) {\n                    babelHelpers.inherits(_class2, _Option$Base);\n                    _class2.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.defaultValue === undefined)\n                            settings.defaultValue = scalarArg;\n                        return _Option$Base.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class2(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class2);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Base.apply(this, arguments));\n                        _this.defaultValue = settings.defaultValue;\n                        if (typeof data == 'object') {\n                            data = data.value;\n                        }\n                        if (data !== undefined) {\n                            _this._value = data;\n                        } else {\n                            _this._value = _this.defaultValue;\n                        }\n                        return _this;\n                    }\n                    _class2.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        return data;\n                    };\n                    babelHelpers.createClass(_class2, [{\n                            key: 'value',\n                            get: function () {\n                                return this._value;\n                            },\n                            set: function (value) {\n                                this._value = value;\n                                this.updateCallback();\n                            }\n                        }]);\n                    return _class2;\n                }(Option.Base);\n                Option.Boolean = function (_Option$Input) {\n                    babelHelpers.inherits(_class3, _Option$Input);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input.apply(this, arguments));\n                    }\n                    _class3.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return _Option$Input.collectArgs.call(this, !!scalarArg, arrayArg, settings);\n                    };\n                    _class3.prototype.fix = function fix() {\n                        return this.value;\n                    };\n                    return _class3;\n                }(Option.Input);\n                Option.NonBoolean = function (_Option$Input2) {\n                    babelHelpers.inherits(_class4, _Option$Input2);\n                    function _class4() {\n                        babelHelpers.classCallCheck(this, _class4);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input2.apply(this, arguments));\n                    }\n                    _class4.prototype.fix = function fix() {\n                        var value = this.value;\n                        return {\n                            // can't use fixed value in boolean context\n                            name: this.name,\n                            value: value,\n                            valueOf: function () {\n                                return value;\n                            },\n                            toString: function () {\n                                return String(value);\n                            }\n                        };\n                    };\n                    return _class4;\n                }(Option.Input);\n                Option.Factor = function (_Option$NonBoolean) {\n                    babelHelpers.inherits(_class5, _Option$NonBoolean);\n                    _class5.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableValues === undefined)\n                            settings.availableValues = arrayArg;\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableValues[0];\n                        return _Option$NonBoolean.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class5(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class5);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean.apply(this, arguments));\n                        _this4.availableValues = settings.availableValues;\n                        return _this4;\n                    }\n                    return _class5;\n                }(Option.NonBoolean);\n                Option.Number = function (_Option$NonBoolean2) {\n                    babelHelpers.inherits(_class6, _Option$NonBoolean2);\n                    // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\n                    _class6.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableMin === undefined)\n                            settings.availableMin = arrayArg[0];\n                        if (settings.availableMax === undefined)\n                            settings.availableMax = arrayArg[1];\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableMin;\n                        return _Option$NonBoolean2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class6(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class6);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean2.apply(this, arguments));\n                        _this5.availableMin = settings.availableMin;\n                        _this5.availableMax = settings.availableMax;\n                        return _this5;\n                    }\n                    return _class6;\n                }(Option.NonBoolean);\n                Option.Collection = function (_Option$Base2) {\n                    babelHelpers.inherits(_class7, _Option$Base2);\n                    _class7.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        return _Option$Base2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class7(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class7);\n                        var _this6 = babelHelpers.possibleConstructorReturn(this, _Option$Base2.apply(this, arguments));\n                        _this6.entries = settings.descriptions.map(function (x) {\n                            var subName = x[1];\n                            var subData = undefined;\n                            if (typeof data == 'object')\n                                subData = data[subName];\n                            return makeEntry(x, fullName, subData, isInsideArray);    // nested option\n                        });\n                        return _this6;\n                    }\n                    _class7.prototype.export = function _export() {\n                        var data = {};\n                        this.entries.forEach(function (entry) {\n                            entry.shortenExportAssign(entry.export(), data, entry.name);\n                        });\n                        return data;\n                    };\n                    _class7.prototype.fix = function fix() {\n                        var fixedEntries = [];\n                        var fixed = {\n                            name: this.name,\n                            entries: fixedEntries\n                        };\n                        this.entries.forEach(function (entry) {\n                            fixedEntries.push(fixed[entry.name] = entry.fix());\n                        });\n                        return fixed;\n                    };\n                    return _class7;\n                }(Option.Base);\n                // concrete classes\n                Option.Void = function (_Option$Base3) {\n                    babelHelpers.inherits(_class8, _Option$Base3);\n                    function _class8() {\n                        babelHelpers.classCallCheck(this, _class8);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Base3.apply(this, arguments));\n                    }\n                    // useful as array entry w/o settings\n                    _class8.prototype.export = function _export() {\n                        return {};\n                    };\n                    _class8.prototype.fix = function fix() {\n                        return { name: this.name };\n                    };\n                    return _class8;\n                }(Option.Base);\n                Option.Checkbox = function (_Option$Boolean) {\n                    babelHelpers.inherits(_class9, _Option$Boolean);\n                    function _class9() {\n                        babelHelpers.classCallCheck(this, _class9);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Boolean.apply(this, arguments));\n                    }\n                    return _class9;\n                }(Option.Boolean);\n                Option.Select = function (_Option$Factor) {\n                    babelHelpers.inherits(_class10, _Option$Factor);\n                    function _class10() {\n                        babelHelpers.classCallCheck(this, _class10);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor.apply(this, arguments));\n                    }\n                    return _class10;\n                }(Option.Factor);\n                Option.Text = function (_Option$Factor2) {\n                    babelHelpers.inherits(_class11, _Option$Factor2);\n                    function _class11() {\n                        babelHelpers.classCallCheck(this, _class11);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor2.apply(this, arguments));\n                    }\n                    return _class11;\n                }(Option.Factor);\n                Option.Int = function (_Option$Number) {\n                    babelHelpers.inherits(_class12, _Option$Number);\n                    function _class12() {\n                        babelHelpers.classCallCheck(this, _class12);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class12, [{\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        }]);\n                    return _class12;\n                }(Option.Number);\n                Option.Float = function (_Option$Number2) {\n                    babelHelpers.inherits(_class13, _Option$Number2);\n                    function _class13(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class13);\n                        var _this12 = babelHelpers.possibleConstructorReturn(this, _Option$Number2.apply(this, arguments));\n                        if (settings.precision !== undefined) {\n                            _this12.precision = settings.precision;\n                        } else {\n                            if (_this12.availableMax >= 100) {\n                                _this12.precision = 1;\n                            } else if (_this12.availableMax >= 10) {\n                                _this12.precision = 2;\n                            } else {\n                                _this12.precision = 3;\n                            }\n                        }\n                        return _this12;\n                    }\n                    return _class13;\n                }(Option.Number);\n                Option.Root = function (_Option$Collection) {\n                    babelHelpers.inherits(_class14, _Option$Collection);\n                    function _class14() {\n                        babelHelpers.classCallCheck(this, _class14);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection.apply(this, arguments));\n                    }\n                    return _class14;\n                }(Option.Collection);\n                Option.Group = function (_Option$Collection2) {\n                    babelHelpers.inherits(_class15, _Option$Collection2);\n                    function _class15() {\n                        babelHelpers.classCallCheck(this, _class15);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection2.apply(this, arguments));\n                    }\n                    return _class15;\n                }(Option.Collection);\n                Option.Array = function (_Option$Base4) {\n                    babelHelpers.inherits(_class16, _Option$Base4);\n                    // TODO consider extending Collection\n                    _class16.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        if (settings.typePropertyName === undefined)\n                            settings.typePropertyName = scalarArg;\n                        return _Option$Base4.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class16(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class16);\n                        var _this15 = babelHelpers.possibleConstructorReturn(this, _Option$Base4.apply(this, arguments));\n                        _this15.availableConstructors = new Map();\n                        settings.descriptions.forEach(function (x) {\n                            // TODO test array inside array\n                            var type = x[1];\n                            var ctor = function (subData) {\n                                return makeEntry(x, fullName, subData, true);\n                            };\n                            _this15.availableConstructors.set(type, ctor);\n                        });\n                        if (settings.typePropertyName !== undefined) {\n                            _this15.typePropertyName = settings.typePropertyName;\n                        } else {\n                            _this15.typePropertyName = 'type';\n                        }\n                        // populate array entries from data:\n                        _this15._entries = [];\n                        var subDatas = [];\n                        if (Array.isArray(data)) {\n                            subDatas = data;\n                        } else if (typeof data == 'object') {\n                            subDatas = data.value;\n                        }\n                        var defaultType = _this15.availableTypes[0];\n                        for (var i = 0; i < subDatas.length; i++) {\n                            var subData = subDatas[i];\n                            var subType = defaultType;\n                            if (typeof subData == 'object' && subData[_this15.typePropertyName] !== undefined) {\n                                subType = subData[_this15.typePropertyName];\n                            }\n                            var subCtor = _this15.availableConstructors.get(subType);\n                            if (subCtor) {\n                                _this15._entries.push(subCtor(subData));\n                            }\n                        }\n                        return _this15;\n                    }\n                    _class16.prototype.addEntry = function addEntry(type) {\n                        var entry = this.availableConstructors.get(type)();\n                        this._entries.push(entry);\n                        this.updateCallback();\n                        return entry;\n                    };\n                    _class16.prototype.export = function _export() {\n                        var _this16 = this;\n                        var defaultType = this.availableTypes[0];\n                        return {\n                            value: this._entries.map(function (entry) {\n                                var subData = entry.export();\n                                var subType = entry.name;\n                                if (subType != defaultType)\n                                    subData[_this16.typePropertyName] = subType;\n                                return entry.shortenExport(subData);\n                            })\n                        };\n                    };\n                    _class16.prototype.fix = function fix() {\n                        var _this17 = this;\n                        return {\n                            name: this.name,\n                            entries: this._entries.map(function (entry) {\n                                var subFixed = entry.fix();\n                                if (typeof subFixed == 'object')\n                                    subFixed[_this17.typePropertyName] = entry.name;\n                                return subFixed;\n                            })\n                        };\n                    };\n                    babelHelpers.createClass(_class16, [\n                        {\n                            key: 'availableTypes',\n                            get: function () {\n                                var types = [];\n                                this.availableConstructors.forEach(function (_, type) {\n                                    types.push(type);\n                                });\n                                return types;\n                            }\n                        },\n                        {\n                            key: 'entries',\n                            get: function () {\n                                return this._entries;\n                            },\n                            set: function (entries) {\n                                this._entries = entries;\n                                this.updateCallback();\n                            }\n                        }\n                    ]);\n                    return _class16;\n                }(Option.Base);\n                module.exports = Option;\n            },\n            {}\n        ],\n        15: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(14);\n                var OptionsOutput = function () {\n                    function OptionsOutput(options, generateId, i18n) {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        var optionClassWriters = new Map();\n                        this.setOptionClassWriters(optionClassWriters);\n                        function write(option) {\n                            var optionProto = option;\n                            while (optionProto = Object.getPrototypeOf(optionProto)) {\n                                var optionClassWriter = optionClassWriters.get(optionProto.constructor);\n                                if (optionClassWriter) {\n                                    return optionClassWriter(option, write, i18n, generateId);\n                                }\n                            }\n                        }\n                        // public prop:\n                        this.$output = write(options.root);\n                    }\n                    // override this fn for custom writers\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        optionClassWriters.set(Option.Root, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'options-output\\'>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Group, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Void, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'option no-lead\\'>').html(i18n('options.' + option.fullName));\n                        });\n                        optionClassWriters.set(Option.Checkbox, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option no-lead\\'>').append($('<input type=\\'checkbox\\' id=\\'' + id + '\\'>').prop('checked', option.value).change(function () {\n                                option.value = $(this).prop('checked');\n                            }), ' <label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + '</label>');\n                        });\n                        optionClassWriters.set(Option.Select, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label> ', $('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n('options.' + option.fullName + '.' + availableValue));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            }));\n                        });\n                        optionClassWriters.set(Option.Text, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var listId = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label> ', $('<input type=\\'text\\' id=\\'' + id + '\\' list=\\'' + listId + '\\' />').val(option.value).on('input change', function () {\n                                option.value = this.value;\n                            }), ' ', $('<datalist id=\\'' + listId + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').text(availableValue);\n                            })));\n                        });\n                        optionClassWriters.set(Option.Number, function (option, writeOption, i18n, generateId) {\n                            var p = option.precision;\n                            var setInputAttrs = function ($input) {\n                                return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                            };\n                            var setInputAttrsAndListeners = function ($input, getOtherInput) {\n                                return setInputAttrs($input).val(option.value).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        var $that = getOtherInput();\n                                        $that.val(this.value);\n                                        option.value = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var id = generateId();\n                            var $sliderInput = undefined, $numberInput = undefined;\n                            var $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>', ' <span class=\\'min\\'>' + option.availableMin + '</span> ', $sliderInput = setInputAttrsAndListeners($('<input type=\\'range\\' id=\\'' + id + '\\'>'), function () {\n                                return $numberInput;\n                            }), ' <span class=\\'max\\'>' + option.availableMax + '</span> ', $numberInput = setInputAttrsAndListeners($('<input type=\\'number\\' required>'), function () {\n                                return $sliderInput;\n                            }), ' ', $('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $sliderInput.val(option.defaultValue).change();\n                            }));\n                        });\n                        optionClassWriters.set(Option.Array, function (option, writeOption, i18n, generateId) {\n                            var $dragged = null;\n                            var $entries = undefined;\n                            var updateArrayEntries = function () {\n                                option.entries = $entries.children().map(function () {\n                                    return $(this).data('option');\n                                }).get();\n                            };\n                            var writeDraggableOption = function (option) {\n                                // have to make drag handler 'draggable', not the whole item\n                                // because inputs and labels don't like to be inside 'draggable'\n                                // http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\n                                return $('<div class=\\'draggable-with-handle\\'>').data('option', option).append($('<div draggable=\\'true\\' tabindex=\\'0\\' title=\\'' + i18n('options-output.drag') + '\\'>').on('dragstart', function (ev) {\n                                    $dragged = $(this).parent();\n                                    ev.originalEvent.dataTransfer.effectAllowed = 'move';\n                                    ev.originalEvent.dataTransfer.setData('Text', name);\n                                    if (ev.originalEvent.dataTransfer.setDragImage) {\n                                        // doesn't work in IE\n                                        ev.originalEvent.dataTransfer.setDragImage($dragged[0], 0, 0);\n                                    }\n                                    setTimeout(function () {\n                                        $dragged.addClass('ghost');\n                                    }, 0);\n                                }).keydown(function (ev) {\n                                    var $handle = $(this);\n                                    var $sorted = $handle.parent();\n                                    if (ev.keyCode == 38) {\n                                        $sorted.prev().before($sorted);\n                                        $handle.focus();\n                                        updateArrayEntries();\n                                        return false;\n                                    } else if (ev.keyCode == 40) {\n                                        $sorted.next().after($sorted);\n                                        $handle.focus();\n                                        updateArrayEntries();\n                                        return false;\n                                    }\n                                }), writeOption(option), $('<div tabindex=\\'0\\' class=\\'delete\\' title=\\'' + i18n('options-output.delete') + '\\'>').click(function () {\n                                    $(this).parent().remove();\n                                    updateArrayEntries();\n                                }).keydown(function (ev) {\n                                    if (ev.keyCode == 13 || ev.keyCode == 32) {\n                                        $(this).parent().remove();\n                                        updateArrayEntries();\n                                        return false;\n                                    }\n                                })).on('dragover', function (ev) {\n                                    ev.preventDefault();\n                                    ev.originalEvent.dataTransfer.dropEffect = 'move';\n                                    var $target = $(this);\n                                    if ($dragged) {\n                                        if ($target.nextAll().is($dragged)) {\n                                            $target.before($dragged);\n                                            updateArrayEntries();\n                                        } else if ($target.prevAll().is($dragged)) {\n                                            $target.after($dragged);\n                                            updateArrayEntries();\n                                        }\n                                    }\n                                }).on('drop', function (ev) {\n                                    ev.preventDefault();\n                                }).on('dragend', function (ev) {\n                                    ev.preventDefault();\n                                    if ($dragged) {\n                                        $dragged.removeClass('ghost');\n                                        $dragged = null;\n                                    }\n                                });\n                            };\n                            option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append($entries = $('<div>').append(option.entries.map(writeDraggableOption)));\n                            var $buttons = $('<div>');\n                            option.availableTypes.forEach(function (type, i) {\n                                if (i)\n                                    $buttons.append(' ');\n                                $buttons.append($('<button type=\\'button\\'>').html(i18n('options.' + option.fullName + '.' + type + '.add')).click(function () {\n                                    var entry = option.addEntry(type);\n                                    $entries.append(writeDraggableOption(entry));\n                                }));\n                            });\n                            option.$.append($buttons);\n                            return option.$;\n                        });\n                    };\n                    return OptionsOutput;\n                }();\n                module.exports = OptionsOutput;\n            },\n            { '14': 14 }\n        ],\n        16: [\n            function (require, module, exports) {\n                'use strict';\n                var Options = function () {\n                    function Options(data) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, Options);\n                        // data = imported values, import is done in ctor to avoid calling updateCallback later\n                        this.updateCallback = undefined;\n                        // general update callback for stuff like regenerating the code\n                        var simpleUpdateCallback = function () {\n                            if (_this.updateCallback)\n                                _this.updateCallback();\n                        };\n                        var Option = this.optionClasses;\n                        var optionByFullName = {};\n                        var optionsWithVisibilityAffectedByFullName = {};\n                        var makeEntry = function (description, parentfullName, data, isInsideArray) {\n                            var _Option$className;\n                            var className = description[0];\n                            if (Option[className] === undefined) {\n                                throw new Error('invalid option type \\'' + className + '\\'');\n                            }\n                            var name = description[1];\n                            var fullName = name;\n                            if (parentfullName !== null) {\n                                fullName = parentfullName + '.' + name;\n                            }\n                            var makeArgs = description.slice(1);\n                            var updateCallback = undefined;\n                            if (isInsideArray) {\n                                updateCallback = simpleUpdateCallback;\n                            } else {\n                                updateCallback = function () {\n                                    if (optionsWithVisibilityAffectedByFullName[fullName] !== undefined) {\n                                        optionsWithVisibilityAffectedByFullName[fullName].forEach(function (option) {\n                                            option.updateVisibility();\n                                        });\n                                    }\n                                    if (_this.updateCallback)\n                                        _this.updateCallback();\n                                };\n                            }\n                            var option = (_Option$className = Option[className]).make.apply(_Option$className, makeArgs)(data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray);\n                            if (!isInsideArray) {\n                                optionByFullName[fullName] = option;\n                                option.fullNamesAffectingVisibility.forEach(function (testName) {\n                                    if (optionsWithVisibilityAffectedByFullName[testName] === undefined) {\n                                        optionsWithVisibilityAffectedByFullName[testName] = [];\n                                    }\n                                    optionsWithVisibilityAffectedByFullName[testName].push(option);\n                                });\n                            }\n                            return option;\n                        };\n                        this.root = Option.Root.make(null, this.entriesDescription)(data, null, optionByFullName, simpleUpdateCallback, makeEntry, false);\n                    }\n                    // methods to be redefined by subclasses\n                    // TODO make them static?\n                    // public methods\n                    Options.prototype.export = function _export() {\n                        return this.root.shortenExport(this.root.export());\n                    };\n                    Options.prototype.fix = function fix() {\n                        return this.root.fix();\n                    };\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(14);\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }();\n                module.exports = Options;\n            },\n            { '14': 14 }\n        ],\n        17: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ], [\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<script src=',\n                        '></script>'\n                    ], [\n                        '<script src=',\n                        '></script>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<html lang=',\n                        '>'\n                    ], [\n                        '<html lang=',\n                        '>'\n                    ]);\n                var Lines = require(12);\n                var NoseWrapLines = require(13);\n                var CodeSection = require(3);\n                var WebCode = function () {\n                    function WebCode() {\n                        babelHelpers.classCallCheck(this, WebCode);\n                    }\n                    WebCode.prototype.get = function get(formatting) {\n                        return this.getLines().get(formatting);\n                    };\n                    WebCode.prototype.getHtml = function getHtml(formatting) {\n                        return this.getLines().getHtml(formatting);\n                    };\n                    WebCode.prototype.extractSections = function extractSections(sectionModes) {\n                        if (sectionModes === undefined) {\n                            sectionModes = {};\n                        }\n                        var stylePlaceLines = NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines);\n                        var styleExtractLines = Lines.be();\n                        if (sectionModes.css == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                stylePlaceLines = Lines.be();\n                            } else {\n                                stylePlaceLines = Lines.bae('<!-- <style> ' + this.getSectionPasteComment('css') + ' </style> -->');\n                            }\n                            styleExtractLines = this.cachedStyleLines;\n                        } else if (sectionModes.css == 'file') {\n                            stylePlaceLines = Lines.bae(Lines.html(_templateObject, this.basename + '.css'));\n                            styleExtractLines = this.cachedStyleLines;\n                        }\n                        var scriptPlaceLines = NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines);\n                        var scriptExtractLines = Lines.be();\n                        if (sectionModes.js == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                scriptPlaceLines = Lines.be();\n                            } else {\n                                scriptPlaceLines = Lines.bae('<!-- <script> ' + this.getSectionPasteComment('js') + ' </script> -->');\n                            }\n                            scriptExtractLines = this.cachedScriptLines;\n                        } else if (sectionModes.js == 'file') {\n                            scriptPlaceLines = Lines.bae(Lines.html(_templateObject2, this.basename + '.js'));\n                            scriptExtractLines = this.cachedScriptLines;\n                        }\n                        var htmlExtractLines = undefined;\n                        if (sectionModes.html == 'body') {\n                            htmlExtractLines = this.getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        } else {\n                            htmlExtractLines = this.getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        }\n                        var type = function (sectionName) {\n                            return 'text/' + (sectionName == 'js' ? 'javascript' : sectionName);\n                        };\n                        return {\n                            html: new CodeSection(this.filename, type('html'), htmlExtractLines),\n                            css: new CodeSection(this.basename + '.css', type('css'), styleExtractLines),\n                            js: new CodeSection(this.basename + '.js', type('js'), scriptExtractLines)\n                        };\n                    };\n                    // get title()\n                    // private:\n                    WebCode.prototype.getLines = function getLines() {\n                        return this.getFullHtmlSectionLines(NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines), NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines));\n                    };\n                    WebCode.prototype.getFullHtmlSectionLines = function getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        var a = Lines.b();\n                        a('<!DOCTYPE html>');\n                        if (this.lang !== null) {\n                            a(Lines.html(_templateObject3, this.lang));\n                        } else {\n                            a('<html>');\n                        }\n                        a('<head>', '<meta charset=utf-8>');\n                        if (this.title !== null) {\n                            a('<title>' + this.title + '</title>');\n                        }\n                        a(stylePlaceLines, this.cachedHeadLines, '</head>', '<body>', this.cachedBodyLines, scriptPlaceLines, '</body>', '</html>');\n                        return a.e();\n                    };\n                    WebCode.prototype.getBodyHtmlSectionLines = function getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        return Lines.bae(stylePlaceLines, this.cachedHeadLines, this.cachedBodyLines, scriptPlaceLines);\n                    };\n                    WebCode.prototype.getSectionPasteComment = function getSectionPasteComment(sectionName) {\n                        // section placeholder comment in paste mode - likely to be overridden with i18n\n                        return sectionName + ' goes here';\n                    };\n                    babelHelpers.createClass(WebCode, [\n                        {\n                            key: 'filename',\n                            // public:\n                            get: function () {\n                                return this.basename + '.html';\n                            }\n                        },\n                        {\n                            key: 'mimeType',\n                            get: function () {\n                                return 'text/html';\n                            }\n                        },\n                        {\n                            key: 'cachedStyleLines',\n                            get: function () {\n                                if (!this._styleLines)\n                                    this._styleLines = this.styleLines;\n                                return this._styleLines;\n                            }\n                        },\n                        {\n                            key: 'cachedHeadLines',\n                            get: function () {\n                                if (!this._headLines)\n                                    this._headLines = this.headLines;\n                                return this._headLines;\n                            }\n                        },\n                        {\n                            key: 'cachedBodyLines',\n                            get: function () {\n                                if (!this._bodyLines)\n                                    this._bodyLines = this.bodyLines;\n                                return this._bodyLines;\n                            }\n                        },\n                        {\n                            key: 'cachedScriptLines',\n                            get: function () {\n                                if (!this._scriptLines)\n                                    this._scriptLines = this.scriptLines;\n                                return this._scriptLines;\n                            }    // to be redefined in subclasses:\n                        },\n                        {\n                            key: 'basename',\n                            get: function () {\n                                // filename base\n                                return 'source';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                // language tag for <html lang=xx> or null to skip it - likely read from i18n\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                // page title or null to skip it\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                // contents of <style>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'headLines',\n                            get: function () {\n                                // contents of <head> following <style>, goes to <body> in html body mode\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                // contents of <body> preceding <script>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                // contents of <script>\n                                return Lines.be();\n                            }\n                        }\n                    ]);\n                    return WebCode;\n                }();\n                module.exports = WebCode;\n            },\n            {\n                '12': 12,\n                '13': 13,\n                '3': 3\n            }\n        ],\n        18: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                var Lines = require(12);\n                var WrapLines = function (_Lines) {\n                    babelHelpers.inherits(WrapLines, _Lines);\n                    function WrapLines(data) {\n                        babelHelpers.classCallCheck(this, WrapLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        _this.wrappers = [];\n                        for (var i = 1; i < arguments.length; i++) {\n                            _this.wrappers.push(arguments[i]);\n                        }\n                        return _this;\n                    }\n                    WrapLines.prototype.isEmpty = function isEmpty() {\n                        return false;\n                    };\n                    WrapLines.prototype.doGet = function doGet(formatting, html) {\n                        var _this2 = this;\n                        var indent = '\\t';\n                        if (formatting.indent !== undefined) {\n                            indent = formatting.indent;\n                        }\n                        var out = [];\n                        var i = 0;\n                        var pushWrapper = function () {\n                            var item = _this2.wrappers[i];\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut);\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                            i++;\n                        };\n                        pushWrapper();\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut.map(function (s) {\n                                    return indent + s;\n                                }));\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(indent + s);\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            }\n                        });\n                        if (this.wrappers.length == 2) {\n                            pushWrapper();\n                        }\n                        return out;\n                    };\n                    return WrapLines;\n                }(Lines);\n                module.exports = WrapLines;\n            },\n            {\n                '12': 12,\n                '7': 7\n            }\n        ],\n        19: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var Feature = require(25);\n                var CallVector = require(20);\n                var Background = function (_Feature) {\n                    babelHelpers.inherits(Background, _Feature);\n                    function Background(options) {\n                        babelHelpers.classCallCheck(this, Background);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.isSolid = options.type == 'solid';\n                        if (_this.isSolid) {\n                            _this.features.push(new CallVector('background.color', options.color.entries, 'gl.clearColor', [\n                                0,\n                                0,\n                                0,\n                                0\n                            ]));\n                        }\n                        return _this;\n                    }\n                    Background.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_Feature.prototype.getJsLoopLines.call(this, featureContext));\n                        if (this.isSolid) {\n                            a('gl.clear(gl.COLOR_BUFFER_BIT);');\n                        }\n                        return a.e();\n                    };\n                    return Background;\n                }(Feature);\n                module.exports = Background;\n            },\n            {\n                '11': 11,\n                '20': 20,\n                '25': 25\n            }\n        ],\n        20: [\n            function (require, module, exports) {\n                'use strict';\n                var fixOptHelp = require(26);\n                var JsLines = require(11);\n                var Vector = require(50);\n                var CallVector = function (_Vector) {\n                    babelHelpers.inherits(CallVector, _Vector);\n                    function CallVector(name, values, calledFn, calledFnDefaultArgs) {\n                        babelHelpers.classCallCheck(this, CallVector);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Vector.call(this, name, values));\n                        _this.calledFn = calledFn;\n                        _this.calledFnDefaultArgs = calledFnDefaultArgs;\n                        return _this;\n                    }\n                    // private:\n                    CallVector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        var _this2 = this;\n                        var a = JsLines.b();\n                        var nValueSliders = 0;\n                        this.components.forEach(function (component) {\n                            nValueSliders += component.value.input == 'slider';\n                        });\n                        if (this.modeConstant && this.components.every(function (component, i) {\n                                return component.value == _this2.calledFnDefaultArgs[i];\n                            })) {\n                        } else if (nValueSliders <= 1) {\n                            a(this.calledFn + '(' + this.components.map(componentValue).join(',') + ');');\n                        } else if (this.components.every(function (component) {\n                                return component.value.input == 'slider';\n                            })) {\n                            var obj = this.calledFn;\n                            var dotIndex = obj.lastIndexOf('.');\n                            if (dotIndex >= 0) {\n                                obj = obj.slice(0, dotIndex);\n                            }\n                            var suffixArray = '[' + this.components.map(function (component) {\n                                return '\\'' + component.suffix + '\\'';\n                            }).join(',') + ']';\n                            a(this.calledFn + '.apply(' + obj + ',' + suffixArray + '.map(function(c){', '\\treturn parseFloat(document.getElementById(\\'' + this.name + '.\\'+c).value);', '}));');\n                        } else {\n                            a(this.calledFn + '(');\n                            this.components.forEach(function (component, i) {\n                                if (i > 0) {\n                                    a.t(',');\n                                }\n                                a('\\t' + componentValue(component));\n                            });\n                            a(');');\n                        }\n                        return a.e();\n                    };\n                    CallVector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                        entry.post(this.calledFn + '(' + this.components.map(componentValue).join(',') + ');');\n                    };\n                    return CallVector;\n                }(Vector);\n                module.exports = CallVector;\n            },\n            {\n                '11': 11,\n                '26': 26,\n                '50': 50\n            }\n        ],\n        21: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                    '\\t<canvas id=myCanvas width=',\n                    ' height=',\n                    '></canvas>'\n                ], [\n                    '\\t<canvas id=myCanvas width=',\n                    ' height=',\n                    '></canvas>'\n                ]);\n                var Lines = require(12);\n                var JsLines = require(11);\n                var Listener = require(32);\n                var Feature = require(25);\n                var IntFeature = require(31);\n                var Canvas = function (_Feature) {\n                    babelHelpers.inherits(Canvas, _Feature);\n                    function Canvas(options) {\n                        babelHelpers.classCallCheck(this, Canvas);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.width = options.width;\n                        _this.height = options.height;\n                        _this.features.push(new IntFeature('canvas.width', options.width), new IntFeature('canvas.height', options.height));\n                        return _this;\n                    }\n                    Canvas.prototype.getHtmlCanvasLines = function getHtmlCanvasLines() {\n                        return Lines.bae('<div>', Lines.html(_templateObject, this.width, this.height), '</div>');\n                    };\n                    Canvas.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines() {\n                        if (this.hasInputs()) {\n                            return Lines.bae('uniform float aspect;');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    Canvas.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines() {\n                        var needAspectConstant = !this.hasInputs() && Number(this.width) != Number(this.height);\n                        if (needAspectConstant) {\n                            return Lines.bae('float aspect=' + this.width + '.0/' + this.height + '.0;');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    Canvas.prototype.providesAspect = function providesAspect() {\n                        return this.hasInputs() || Number(this.width) != Number(this.height);\n                    };\n                    Canvas.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this2 = this;\n                        var a = JsLines.ba(_Feature.prototype.getJsInitLines.call(this, featureContext));\n                        var canvasUpdater = function () {\n                            a('function updateAspect() {', '\\tgl.viewport(0,0,canvas.width,canvas.height);', '\\tgl.uniform1f(aspectLoc,canvas.width/canvas.height);', '}', 'updateAspect();');\n                        };\n                        var canvasListener = function (wh) {\n                            if (_this2[wh].input == 'slider') {\n                                var listener = new Listener.Slider('canvas.' + wh);\n                                listener.enter().log('console.log(this.id,\\'input value:\\',parseInt(this.value));').post('canvas.' + wh + '=parseInt(this.value);').post('updateAspect();');\n                                a(featureContext.getListenerLines(listener));\n                            }\n                        };\n                        if (this.hasInputs()) {\n                            a('var aspectLoc=gl.getUniformLocation(program,\\'aspect\\');');\n                            canvasUpdater();\n                            canvasListener('width');\n                            canvasListener('height');\n                        }\n                        return a.e();\n                    };\n                    return Canvas;\n                }(Feature);\n                module.exports = Canvas;\n            },\n            {\n                '11': 11,\n                '12': 12,\n                '25': 25,\n                '31': 31,\n                '32': 32\n            }\n        ],\n        22: [\n            function (require, module, exports) {\n                'use strict';\n                var Shape = require(38);\n                var FeatureContext = require(24);\n                var Canvas = require(21);\n                var Background = require(19);\n                var Transforms = require(48);\n                var Illumination = require(29);\n                var Lines = require(12);\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var NoseWrapLines = require(13);\n                var InterleaveLines = require(10);\n                var IndentLines = require(9);\n                var BaseWebCode = require(17);\n                var Code = function (_BaseWebCode) {\n                    babelHelpers.inherits(Code, _BaseWebCode);\n                    function Code(options, i18n) {\n                        babelHelpers.classCallCheck(this, Code);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _BaseWebCode.call(this));\n                        _this.options = options;\n                        _this.i18n = i18n;\n                        _this.featureContext = new FeatureContext(options.debug);\n                        _this.canvas = new Canvas(options.canvas);\n                        _this.background = new Background(options.background);\n                        _this.transforms = new Transforms(options.transforms);\n                        _this.illumination = new Illumination(options.material, options.light);\n                        var makeShape = function () {\n                            return new Shape[(String(options.shape.type))](options.shape, options.light.type != 'off', options.material.scope == 'vertex', options.material.scope == 'face', _this.illumination.getColorAttrs());\n                        };\n                        _this.shape = makeShape();\n                        _this.features = [\n                            _this.canvas,\n                            _this.background,\n                            _this.transforms,\n                            _this.illumination,\n                            _this.shape\n                        ];\n                        _this.featureNames = [\n                            'canvas',\n                            'background',\n                            'transforms',\n                            'illumination',\n                            'shape'\n                        ];\n                        _this.features.forEach(function (feature) {\n                            feature.requestFeatureContext(_this.featureContext);\n                        });\n                        return _this;\n                    }\n                    babelHelpers.createClass(Code, [\n                        {\n                            key: 'basename',\n                            get: function () {\n                                return 'webgl';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                return 'en';\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                return 'WebGL example - Generated code';\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                var a = Lines.b();\n                                if (this.featureContext.hasSliders) {\n                                    a('label {', '\\tdisplay: inline-block;', '\\twidth: 15em;', '\\ttext-align: right;', '}', '.min {', '\\tdisplay: inline-block;', '\\twidth: 4em;', '\\ttext-align: right;', '}', '.max {', '\\tdisplay: inline-block;', '\\twidth: 4em;', '\\ttext-align: left;', '}');\n                                }\n                                return a.e();\n                            }\n                        },\n                        {\n                            key: 'headLines',\n                            get: function () {\n                                var _this2 = this;\n                                var getVertexShaderLines = function () {\n                                    var needTransformedPosition = _this2.illumination.wantsTransformedPosition(_this2.transforms.eyeAtInfinity);\n                                    return Lines.bae(_this2.canvas.getGlslVertexDeclarationLines(), _this2.transforms.getGlslVertexDeclarationLines(_this2.shape.dim == 2), _this2.illumination.getGlslVertexDeclarationLines(_this2.transforms.eyeAtInfinity, _this2.shape.dim > 2), WrapLines.b('void main() {', '}').ae(_this2.canvas.getGlslVertexOutputLines(), _this2.transforms.getGlslVertexOutputLines(_this2.shape.dim == 2, _this2.canvas.providesAspect(), needTransformedPosition), _this2.illumination.getGlslVertexOutputLines(_this2.transforms.eyeAtInfinity, _this2.shape.hasNormals, _this2.transforms.getGlslVertexNormalTransformLines())));\n                                };\n                                var getFragmentShaderLines = function () {\n                                    return Lines.bae('precision mediump float;', _this2.illumination.getGlslFragmentDeclarationLines(_this2.transforms.eyeAtInfinity), WrapLines.b('void main() {', '}').ae(_this2.illumination.getGlslFragmentOutputLines(_this2.transforms.eyeAtInfinity, _this2.shape.twoSided)));\n                                };\n                                return Lines.bae(WrapLines.b('<script id=myVertexShader type=x-shader/x-vertex>', '</script>').ae(getVertexShaderLines()), WrapLines.b('<script id=myFragmentShader type=x-shader/x-fragment>', '</script>').ae(getFragmentShaderLines()));\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                var _NoseWrapLines$b, _this3 = this;\n                                return Lines.bae.apply(Lines, [\n                                    this.canvas.getHtmlCanvasLines(),\n                                    (_NoseWrapLines$b = NoseWrapLines.b('<ul>', '</ul>')).ae.apply(_NoseWrapLines$b, this.features.map(function (feature) {\n                                        return feature.getHtmlControlMessageLines(_this3.i18n);\n                                    }))\n                                ].concat(this.features.map(function (feature) {\n                                    return feature.getHtmlInputLines(_this3.i18n);\n                                })));\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                var _this4 = this;\n                                var getMakeProgramLines = function () {\n                                    var a = JsLines.b();\n                                    a('var vertexShader=gl.createShader(gl.VERTEX_SHADER);', 'gl.shaderSource(vertexShader,vertexShaderSrc);', 'gl.compileShader(vertexShader);');\n                                    if (_this4.options.debugShaders) {\n                                        a('if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));');\n                                    }\n                                    a('var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);', 'gl.shaderSource(fragmentShader,fragmentShaderSrc);', 'gl.compileShader(fragmentShader);');\n                                    if (_this4.options.debugShaders) {\n                                        a('if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));');\n                                    }\n                                    a('var program=gl.createProgram();', 'gl.attachShader(program,vertexShader);', 'gl.attachShader(program,fragmentShader);', 'gl.linkProgram(program);', 'return program;');\n                                    return a.e();\n                                };\n                                var getJsInitLines = function () {\n                                    var a = JsLines.b();\n                                    a(WrapLines.b(JsLines.bae('function makeProgram(vertexShaderSrc,fragmentShaderSrc) {'), JsLines.bae('}')).ae(getMakeProgramLines()), 'var canvas=document.getElementById(\\'myCanvas\\');', 'var gl=canvas.getContext(\\'webgl\\')||canvas.getContext(\\'experimental-webgl\\');', 'var program=makeProgram(', '\\tdocument.getElementById(\\'myVertexShader\\').text,', '\\tdocument.getElementById(\\'myFragmentShader\\').text', ');', 'gl.useProgram(program);');\n                                    var addWithCommentIfNotEmpty = function (featureLines, comment) {\n                                        if (featureLines.count() > 0) {\n                                            a('', '// ' + comment, // TODO i18n\n                                            featureLines);\n                                        }\n                                    };\n                                    _this4.features.forEach(function (feature, i) {\n                                        addWithCommentIfNotEmpty(feature.getJsInitLines(_this4.featureContext), 'init ' + _this4.featureNames[i]);\n                                    });\n                                    addWithCommentIfNotEmpty(_this4.featureContext.getJsAfterInitLines(), 'init mousemove listener');\n                                    return a.e();\n                                };\n                                var getJsInnerLoopLines = function () {\n                                    var a = JsLines.b();\n                                    if (_this4.featureContext.hasClampFn) {\n                                        a('function clamp(v,min,max) {', '\\treturn Math.min(Math.max(v,min),max);', '}');\n                                    }\n                                    if (_this4.featureContext.hasWrapFn) {\n                                        a('function wrap(v,maxAbs) {', '\\tv%=maxAbs*2;', '\\tif (Math.abs(v)<=maxAbs) return v;', '\\treturn v-(v>0?1:-1)*maxAbs*2;', '}');\n                                    }\n                                    if (_this4.featureContext.pollsGamepad) {\n                                        a('var gamepad;', 'var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);', 'for (var i=0;i<gamepads.length;i++) {', '\\tif (gamepads[i]) {', '\\t\\tgamepad=gamepads[i];', '\\t\\tbreak;', '\\t}', '}');\n                                    }\n                                    a.apply(undefined, _this4.features.map(function (feature) {\n                                        return feature.getJsLoopLines(_this4.featureContext);\n                                    }));\n                                    return a.e();\n                                };\n                                var getJsLoopLines = function () {\n                                    var a = JsLines.b();\n                                    if (_this4.featureContext.hasStartTime && _this4.featureContext.hasPrevTime) {\n                                        a('var startTime=performance.now();');\n                                        a('var prevTime=startTime;');\n                                    } else if (_this4.featureContext.hasStartTime) {\n                                        a('var startTime=performance.now();');\n                                    } else if (_this4.featureContext.hasPrevTime) {\n                                        a('var prevTime=performance.now();');\n                                    }\n                                    // wrap inner render lines in function if needed\n                                    if (_this4.featureContext.isAnimated) {\n                                        if (_this4.featureContext.hasTime) {\n                                            a('function renderFrame(time) {');\n                                        } else {\n                                            a('function renderFrame() {');\n                                        }\n                                        a(IndentLines.bae(getJsInnerLoopLines()));\n                                        if (_this4.featureContext.hasPrevTime) {\n                                            a('\\tprevTime=time;');\n                                        }\n                                        a('\\trequestAnimationFrame(renderFrame);', '}', 'requestAnimationFrame(renderFrame);');\n                                    } else if (_this4.featureContext.hasInputs) {\n                                        a('var frameId=null;', 'function renderFrame() {', IndentLines.bae(getJsInnerLoopLines()), '\\tframeId=null;', '}', 'function scheduleFrame() {', '\\tif (frameId===null) {', '\\t\\tframeId=requestAnimationFrame(renderFrame);', '\\t}', '}', 'scheduleFrame();');\n                                    } else {\n                                        a(getJsInnerLoopLines());\n                                    }\n                                    return a.e();\n                                };\n                                return InterleaveLines.bae(getJsInitLines(), getJsLoopLines());\n                            }\n                        }\n                    ]);\n                    return Code;\n                }(BaseWebCode);\n                module.exports = Code;\n            },\n            {\n                '10': 10,\n                '11': 11,\n                '12': 12,\n                '13': 13,\n                '17': 17,\n                '18': 18,\n                '19': 19,\n                '21': 21,\n                '24': 24,\n                '29': 29,\n                '38': 38,\n                '48': 48,\n                '9': 9\n            }\n        ],\n        23: [\n            function (require, module, exports) {\n                var colorgenCounter = 0;\n                var SingleColorgen = function (weight, noise, baseColors) {\n                    this.weight = weight;\n                    this.noise = noise;\n                    if (noise === undefined)\n                        this.noise = 0.4;\n                    this.baseColors = baseColors || this.defaultBaseColors;\n                    this.colorgenNumber = colorgenCounter++;\n                    this.nextIndex = 0;\n                };\n                SingleColorgen.prototype.defaultBaseColors = [\n                    [\n                        1,\n                        0,\n                        0\n                    ],\n                    // TODO 'cube' color order, when cube is not ugly\n                    [\n                        0,\n                        1,\n                        0\n                    ],\n                    [\n                        0,\n                        0,\n                        1\n                    ],\n                    [\n                        1,\n                        1,\n                        0\n                    ],\n                    [\n                        1,\n                        0,\n                        1\n                    ],\n                    [\n                        0,\n                        1,\n                        1\n                    ]\n                ];\n                SingleColorgen.prototype.getNextColorString = function () {\n                    var baseColor = this.baseColors[this.nextIndex];\n                    this.nextIndex = (this.nextIndex + 1) % this.baseColors.length;\n                    return baseColor.map(function (ci, i) {\n                        var s = Math.sin(this.colorgenNumber * 9000 + this.nextIndex * 400 + i * 100);\n                        var co = (ci * (1 - this.noise) + s * s * this.noise) * this.weight;\n                        return ' ' + co.toFixed(1) + ',';\n                    }, this).join('');\n                };\n                var Colorgen = function (colorAttrs, noise, baseColors) {\n                    this.colorAttrs = colorAttrs;\n                    this.singleColorgens = this.colorAttrs.map(function (attr) {\n                        return new SingleColorgen(attr.weight, noise, baseColors);\n                    });\n                };\n                Colorgen.prototype.getHeaderString = function () {\n                    return this.colorAttrs.map(function () {\n                        return '    r    g    b';\n                    }).join('');\n                };\n                Colorgen.prototype.getNextColorString = function () {\n                    return this.singleColorgens.map(function (singleColorgen) {\n                        return singleColorgen.getNextColorString();\n                    }).join('');\n                };\n                module.exports = Colorgen;\n            },\n            {}\n        ],\n        24: [\n            function (require, module, exports) {\n                'use strict';\n                var Listener = require(32);\n                var FeatureContext = function () {\n                    function FeatureContext(debugOptions) {\n                        babelHelpers.classCallCheck(this, FeatureContext);\n                        this.debugOptions = debugOptions;\n                        this.canvasMousemoveListener = new Listener.CanvasMousemove();\n                        //// to be set by features:\n                        // for html:\n                        this.hasSliders = false;\n                        // for js:\n                        this.hasInputs = false;\n                        // must have renderFrame()\n                        this.hasStartTime = false;\n                        this.hasPrevTime = false;\n                        this.pollsGamepad = false;\n                        this.hasClampFn = false;\n                        this.hasWrapFn = false;\n                    }\n                    FeatureContext.prototype.getJsAfterInitLines = function getJsAfterInitLines() {\n                        return this.canvasMousemoveListener.write(!this.isAnimated, this.debugOptions.inputs);\n                    };\n                    FeatureContext.prototype.getListenerLines = function getListenerLines(listener) {\n                        return listener.write(!this.isAnimated, this.debugOptions.inputs);\n                    };\n                    babelHelpers.createClass(FeatureContext, [\n                        {\n                            key: 'hasTime',\n                            get: function () {\n                                return this.hasStartTime || this.hasPrevTime;\n                            }\n                        },\n                        {\n                            key: 'isAnimated',\n                            get: function () {\n                                return this.hasStartTime || this.hasPrevTime || this.pollsGamepad;\n                            }\n                        }\n                    ]);\n                    return FeatureContext;\n                }();\n                module.exports = FeatureContext;\n            },\n            { '32': 32 }\n        ],\n        25: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(12);\n                var Feature = function () {\n                    function Feature() {\n                        babelHelpers.classCallCheck(this, Feature);\n                        this.features = [];\n                    }\n                    // private:\n                    Feature.prototype.getRecursiveLines = function getRecursiveLines(method, args) {\n                        return Lines.bae.apply(Lines, this.features.map(function (feature) {\n                            return feature[method].apply(feature, args);\n                        }));\n                    };\n                    // methods to be redefined:\n                    Feature.prototype.hasInputs = function hasInputs() {\n                        return this.features.some(function (feature) {\n                            return feature.hasInputs();\n                        });\n                    };\n                    Feature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        this.features.forEach(function (feature) {\n                            feature.requestFeatureContext(featureContext);\n                        });\n                    };\n                    Feature.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        return this.getRecursiveLines('getHtmlInputLines', arguments);\n                    };\n                    Feature.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        return this.getRecursiveLines('getHtmlControlMessageLines', arguments);\n                    };\n                    Feature.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        return this.getRecursiveLines('getJsInitLines', arguments);\n                    };\n                    Feature.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        return this.getRecursiveLines('getJsLoopLines', arguments);\n                    };\n                    return Feature;\n                }();\n                module.exports = Feature;\n            },\n            { '12': 12 }\n        ],\n        26: [\n            function (require, module, exports) {\n                'use strict';\n                // fixed-width number formatting - don't use it for min width\n                function makeFormatNumber(contextNumber) {\n                    var nonnegativeLimits = contextNumber.availableMin >= 0 && contextNumber.availableMax >= 0;\n                    var lead = Math.max(String(Math.abs(contextNumber.availableMin)).split('.')[0].length, String(Math.abs(contextNumber.availableMax)).split('.')[0].length);\n                    var prec = contextNumber.precision;\n                    var width = lead + prec + (prec > 0);\n                    var spaces = '          ';\n                    // http://stackoverflow.com/q/10073699\n                    var fmt = function (n) {\n                        return (spaces + (+n).toFixed(prec)).slice(-width);\n                    };\n                    if (nonnegativeLimits) {\n                        return function (n) {\n                            return fmt(n);\n                        };\n                    } else {\n                        return function (n) {\n                            return (n <= 0 ? n < 0 ? '-' : ' ' : '+') + fmt(Math.abs(n));\n                        };\n                    }\n                }\n                function formatNumber(number) {\n                    return makeFormatNumber(number)(number);\n                }\n                function capNumber(number, maxValue) {\n                    var capped = new Number(Math.min(maxValue, number));\n                    // TODO Number was replaced by FixedLiveNumber in option-classes\n                    capped.min = number.min;\n                    capped.max = Math.min(maxValue, number.max);\n                    capped.input = number.input;\n                    // needed for formatting:\n                    capped.availableMin = number.availableMin;\n                    capped.availableMax = number.availableMax;\n                    capped.precision = number.precision;\n                    return capped;\n                }\n                exports.makeFormatNumber = makeFormatNumber;\n                exports.formatNumber = formatNumber;\n                exports.capNumber = capNumber;\n            },\n            {}\n        ],\n        27: [\n            function (require, module, exports) {\n                'use strict';\n                var fixOptHelp = require(26);\n                var Lines = require(12);\n                var JsLines = require(11);\n                var Vector = require(50);\n                var GlslVector = function (_Vector) {\n                    babelHelpers.inherits(GlslVector, _Vector);\n                    function GlslVector(name, values, wrapMode) {\n                        babelHelpers.classCallCheck(this, GlslVector);\n                        return babelHelpers.possibleConstructorReturn(this, _Vector.call(this, name, values, wrapMode));\n                    }\n                    // public:\n                    GlslVector.prototype.getGlslDeclarationLines = function getGlslDeclarationLines() {\n                        var _this2 = this;\n                        if (this.modeConstant) {\n                            return Lines.be();\n                        } else if (this.modeFloats) {\n                            var _ret = function () {\n                                var a = Lines.b();\n                                _this2.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a('uniform float ' + component.varName + ';');\n                                    }\n                                });\n                                return { v: a.e() };\n                            }();\n                            if (typeof _ret === 'object')\n                                return _ret.v;\n                        } else {\n                            return Lines.bae('uniform vec' + this.nVars + ' ' + this.varName + ';');\n                        }\n                    };\n                    GlslVector.prototype.getGlslValue = function getGlslValue() {\n                        return this.getGlslComponentsValue(this.components.map(function (component) {\n                            return component.suffix;\n                        }).join(''));\n                    };\n                    GlslVector.prototype.getGlslComponentsValue = function getGlslComponentsValue(selectedComponents) {\n                        var _this3 = this;\n                        var allSuffixString = this.components.map(function (component) {\n                            return component.suffix;\n                        }).slice(0, this.nVars).join('');\n                        var results = [];\n                        // [[isConstant,componentName]]\n                        var showResult = function (result) {\n                            if (result[0]) {\n                                return fixOptHelp.formatNumber(_this3.componentsBySuffix[result[1]].value);\n                            } else {\n                                if (_this3.modeVector) {\n                                    if (result[1] == allSuffixString) {\n                                        return _this3.varName;\n                                    } else {\n                                        return _this3.varName + '.' + result[1];\n                                    }\n                                } else {\n                                    return _this3.componentsBySuffix[result[1]].varName;\n                                }\n                            }\n                        };\n                        var allSameConstant = function () {\n                            if (!results[0][0])\n                                return false;\n                            var cmp = fixOptHelp.formatNumber(_this3.componentsBySuffix[results[0][1]].value);\n                            return results.every(function (result) {\n                                return result[0] && fixOptHelp.formatNumber(_this3.componentsBySuffix[result[1]].value) == cmp;\n                            });\n                        };\n                        for (var j = 0; j < selectedComponents.length; j++) {\n                            var c = selectedComponents.charAt(j);\n                            if (!this.componentsBySuffix[c].variable) {\n                                results.push([\n                                    true,\n                                    c\n                                ]);\n                            } else {\n                                if (this.modeVector && results.length > 0) {\n                                    var prevResult = results.pop();\n                                    if (prevResult[0]) {\n                                        results.push(prevResult, [\n                                            false,\n                                            c\n                                        ]);    // prev is constant, don't merge\n                                    } else {\n                                        results.push([\n                                            prevResult[0],\n                                            prevResult[1] + c\n                                        ]);    // merge\n                                    }\n                                } else {\n                                    results.push([\n                                        false,\n                                        c\n                                    ]);\n                                }\n                            }\n                        }\n                        if (results.length == 1) {\n                            if (this.modeVector && selectedComponents == allSuffixString) {\n                                return this.varName;\n                            } else {\n                                return showResult(results[0]);\n                            }\n                        } else {\n                            if (allSameConstant()) {\n                                return 'vec' + selectedComponents.length + '(' + showResult(results[0]) + ')';    // see OpenGL ES SL section 5.4.2\n                            } else {\n                                return 'vec' + selectedComponents.length + '(' + results.map(showResult).join(',') + ')';\n                            }\n                        }\n                    };\n                    GlslVector.prototype.getGlslMapDeclarationLines = function getGlslMapDeclarationLines(mapName, mapFn) {\n                        if (this.components.length > 1) {\n                            return Lines.bae('vec' + this.components.length + ' ' + mapName + '=' + mapFn(this.getGlslValue()) + ';');\n                        } else {\n                            return Lines.bae('float ' + mapName + this.components[0].suffix + '=' + mapFn(this.getGlslValue()) + ';');\n                        }\n                    };\n                    GlslVector.prototype.getGlslMapComponentValue = function getGlslMapComponentValue(mapName, selectedComponent) {\n                        if (this.components.length > 1) {\n                            return mapName + '.' + selectedComponent;\n                        } else {\n                            return mapName + selectedComponent;\n                        }\n                    };\n                    // private:\n                    GlslVector.prototype.getJsDeclarationLines = function getJsDeclarationLines() {\n                        var a = JsLines.b();\n                        if (this.modeConstant) {\n                            return a.e();\n                        }\n                        if (this.modeFloats) {\n                            this.components.forEach(function (component) {\n                                if (component.variable) {\n                                    a('var ' + component.varNameLoc + '=gl.getUniformLocation(program,\\'' + component.varName + '\\');');\n                                }\n                            });\n                        } else {\n                            a('var ' + this.varName + 'Loc=gl.getUniformLocation(program,\\'' + this.varName + '\\');');\n                        }\n                        return a.e();\n                    };\n                    GlslVector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        var a = JsLines.b();\n                        if (this.modeVector) {\n                            a('gl.uniform' + this.nVars + 'f(' + this.varName + 'Loc');\n                            if (this.components.every(function (component) {\n                                    return component.value.input != 'slider';\n                                })) {\n                                // all values are short, no getElement... queries\n                                this.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a.t(',' + componentValue(component));\n                                    }\n                                });\n                                a.t(');');\n                            } else {\n                                this.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a.t(',', '\\t' + componentValue(component));\n                                    }\n                                });\n                                a(');');\n                            }\n                        } else {\n                            this.components.forEach(function (component) {\n                                if (component.variable) {\n                                    a('gl.uniform1f(' + component.varNameLoc + ',' + componentValue(component) + ');');\n                                }\n                            });\n                        }\n                        return a.e();\n                    };\n                    GlslVector.prototype.addPostToListenerEntryForComponent = function addPostToListenerEntryForComponent(entry, component) {\n                        if (this.modeVector) {\n                        } else {\n                            entry.post('gl.uniform1f(' + component.varNameLoc + ',' + component.varName + ');');\n                        }\n                    };\n                    GlslVector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                        var _this4 = this;\n                        if (this.modeVector) {\n                            (function () {\n                                var vs = [];\n                                _this4.components.forEach(function (component, i) {\n                                    if (i < _this4.nVars) {\n                                        vs.push(component.varName);\n                                    }\n                                });\n                                entry.post('gl.uniform' + _this4.nVars + 'f(' + _this4.varName + 'Loc,' + vs.join(',') + ');');\n                            }());\n                        }\n                    };\n                    return GlslVector;\n                }(Vector);\n                module.exports = GlslVector;\n            },\n            {\n                '11': 11,\n                '12': 12,\n                '26': 26,\n                '50': 50\n            }\n        ],\n        28: [\n            function (require, module, exports) {\n                'use strict';\n                function number(n) {\n                    return n.toString().replace('-', '\\u2212');\n                }\n                function plural(n, word) {\n                    if (n == 1) {\n                        return word;\n                    } else {\n                        return word + 's';\n                    }\n                }\n                var plainValue = function (x) {\n                    return number(x);\n                };\n                var pixelValue = function (n) {\n                    return number(n) + ' <abbr title=\\'' + plural(n, 'pixel') + '\\'>px</abbr>';\n                };\n                var dataStrings = {\n                    'options.canvas': 'Canvas',\n                    'options.canvas.{width,height}': 'Canvas {width,height}',\n                    'options.canvas.{width,height}.value': pixelValue,\n                    'options.background': 'Background',\n                    'options.background.type': 'Background type',\n                    'options.background.type.none': 'none (transparent)',\n                    'options.background.type.solid': 'solid color',\n                    'options.background.color': 'Background color',\n                    'options.background.color.{r,g,b,a}': 'Background color {red,green,blue,alpha} component',\n                    'options.background.color.{r,g,b,a}.value': plainValue,\n                    'options.background.color.{r,g,b,a}.speed': 'Background color {red,green,blue,alpha} speed',\n                    'options.background.color.{r,g,b,a}.speed.value': plainValue,\n                    'options.material': 'Material',\n                    'options.material.scope': 'Set material color for objects',\n                    'options.material.scope.global': 'entire scene',\n                    'options.material.scope.vertex': 'shape vertices',\n                    'options.material.scope.face': 'shape faces',\n                    'options.material.data': 'For each object have',\n                    'options.material.data.one': 'one color',\n                    'options.material.data.sda': 'specular/diffuse/ambient colors',\n                    'options.material.color': 'Material color',\n                    'options.material.color.{r,g,b,a}': 'Material color {red,green,blue,alpha} component',\n                    'options.material.color.{r,g,b,a}.value': plainValue,\n                    'options.material.color.{r,g,b,a}.speed': 'Material color {red,green,blue,alpha} speed',\n                    'options.material.color.{r,g,b,a}.speed.value': plainValue,\n                    'options.material.{specular,diffuse,ambient}Color': 'Material {specular,diffuse,ambient} color',\n                    'options.material.{specular,diffuse,ambient}Color.{r,g,b}': '{Specular,Diffuse,Ambient} color {red,green,blue} component',\n                    'options.material.{specular,diffuse,ambient}Color.{r,g,b}.value': plainValue,\n                    'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed': 'Material {specular,diffuse,ambient} color {red,green,blue,alpha} speed',\n                    'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed.value': plainValue,\n                    'options.light': 'Light',\n                    // directional if on\n                    'options.light.type': 'Light type',\n                    'options.light.type.off': 'off',\n                    'options.light.type.phong': 'on with Phong reflections',\n                    // wp: Phong reflection model\n                    'options.light.type.blinn': 'on with Blinn\\u2013Phong reflections',\n                    // wp: BlinnPhong shading model\n                    'options.light.direction': 'Light direction',\n                    'options.light.direction.{x,y,z}': 'Light direction {x,y,z} component',\n                    'options.light.direction.{x,y,z}.value': plainValue,\n                    'options.light.direction.{x,y,z}.speed': 'Light direction {x,y,z} speed',\n                    'options.light.direction.{x,y,z}.speed.value': plainValue,\n                    'options.shape': 'Shape',\n                    'options.shape.type': 'Shape to draw',\n                    'options.shape.type.square': 'square',\n                    'options.shape.type.triangle': 'triangle',\n                    'options.shape.type.gasket': 'Sierpinski gasket',\n                    // wp: Sierpinski triangle\n                    'options.shape.type.cube': 'cube',\n                    'options.shape.type.hat': 'Mexican hat function',\n                    // wp: Mexican hat wavelet\n                    'options.shape.type.terrain': 'diamond-square fractal terrain',\n                    // wp: Diamond-square algorithm\n                    'options.shape.elements': 'Element array',\n                    'options.shape.elements.0': 'not used',\n                    'options.shape.elements.{8,16,32}': 'with {8,16,32}-bit index',\n                    'options.shape.lod': 'Shape detail level',\n                    // recursion depth for fractal shapes\n                    'options.shape.lod.value': plainValue,\n                    'options.transforms': 'Transforms',\n                    'options.transforms.projection': 'Projection',\n                    'options.transforms.projection.ortho': 'orthogonal',\n                    'options.transforms.projection.perspective': 'perspective',\n                    'options.transforms.model': 'Model transform',\n                    'options.transforms.model.rotate.{x,y,z}.add': 'Add rotation around {x,y,z} axis',\n                    'options.transforms.model.rotate.{x,y,z}': 'Angle of rotation around {x,y,z} axis',\n                    'options.transforms.model.rotate.{x,y,z}.value': plainValue,\n                    'options.transforms.model.rotate.{x,y,z}.speed': 'Speed of rotation around {x,y,z} axis',\n                    'options.transforms.model.rotate.{x,y,z}.speed.value': plainValue,\n                    'options.debug': 'Debug options',\n                    'options.debug.shaders': 'Log shader compilation errors',\n                    'options.debug.arrays': 'Log allocated array sizes',\n                    'options.debug.inputs': 'Log input values',\n                    'options.debug.animations': 'Log animated values',\n                    'options.formatting': 'Code formatting options',\n                    'options.formatting.indent': 'Indent',\n                    'options.formatting.indent.tab': 'tab',\n                    'options.formatting.indent.{2,4,8}': '{2,4,8} spaces',\n                    'options-output.inputs': 'Input method',\n                    'options-output.inputs.constant': 'none',\n                    'options-output.inputs.slider': 'slider',\n                    'options-output.inputs.mousemove{x,y}': 'mouse {x,y} axis',\n                    'options-output.inputs.gamepad{0,1,2,3}': 'gamepad {0,1,2,3} axis',\n                    'options-output.range': 'with range',\n                    'options-output.reset': 'Reset',\n                    'options-output.addSpeed': 'Add speed',\n                    'options-output.drag': 'Drag or press up/down while in focus to reorder transforms',\n                    'options-output.delete': 'Delete transform',\n                    'options-output.elements': 'choosing 8- or 16-bit index may limit available shape detail levels',\n                    'controls.type.mousemovex': 'Move the mouse pointer horizontally over the canvas',\n                    'controls.type.mousemovey': 'Move the mouse pointer vertically over the canvas',\n                    'controls.to': 'to update'\n                };\n                dataStrings = require(1)(dataStrings);\n                var strings = {};\n                var expandRegexp = /^([^{]*)\\{([^}]*)\\}(.*)$/;\n                function expandIdAndString(id, string) {\n                    var match = undefined;\n                    if (match = expandRegexp.exec(id)) {\n                        (function () {\n                            var idStart = match[1];\n                            var idMids = match[2].split(',');\n                            var idEnd = match[3];\n                            if (typeof string == 'string' && (match = expandRegexp.exec(string))) {\n                                (function () {\n                                    var stringStart = match[1];\n                                    var stringMids = match[2].split(',');\n                                    var stringEnd = match[3];\n                                    idMids.forEach(function (idMid, i) {\n                                        var stringMid = stringMids[i];\n                                        expandIdAndString(idStart + idMid + idEnd, stringStart + stringMid + stringEnd);\n                                    });\n                                }());\n                            } else {\n                                idMids.forEach(function (idMid) {\n                                    expandIdAndString(idStart + idMid + idEnd, string);\n                                });\n                            }\n                        }());\n                    } else {\n                        strings[id] = string;\n                    }\n                }\n                for (var id in dataStrings) {\n                    expandIdAndString(id, dataStrings[id]);\n                }\n                module.exports = function (id, n) {\n                    if (strings[id] === undefined) {\n                        throw new Error('undefined string ' + id);\n                    }\n                    if (typeof strings[id] == 'string') {\n                        return strings[id];\n                    } else {\n                        return strings[id](n);\n                    }\n                };\n            },\n            { '1': 1 }\n        ],\n        29: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(35);\n                var Lines = require(12);\n                var WrapLines = require(18);\n                var Feature = require(25);\n                var GlslVector = require(27);\n                var Illumination = function (_Feature) {\n                    babelHelpers.inherits(Illumination, _Feature);\n                    function Illumination(material, light) {\n                        babelHelpers.classCallCheck(this, Illumination);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.material = material;\n                        _this.light = light;\n                        // possible options checks:\n                        // material.scope=='global': constant or user input -> uniform\n                        // material.scope!='global': colors in model data -> attribute\n                        // material.data=='one': one color\n                        // material.data!='one': s/d/a colors\n                        // light.type=='off'\n                        // light.type!='off'\n                        // light.type=='blinn'\n                        if (material.scope == 'global') {\n                            if (material.data == 'one') {\n                                _this.features.push(_this.colorVector = new GlslVector('material.color', material.color.entries));\n                            } else if (light.type != 'off') {\n                                _this.features.push(_this.specularColorVector = new GlslVector('material.specularColor', material.specularColor.entries), _this.diffuseColorVector = new GlslVector('material.diffuseColor', material.diffuseColor.entries), _this.ambientColorVector = new GlslVector('material.ambientColor', material.ambientColor.entries));\n                            } else {\n                                _this.features.push(_this.ambientColorVector = new GlslVector('material.ambientColor', [].concat(material.ambientColor.entries, [Option.LiveFloat.make('a', [\n                                        0,\n                                        1,\n                                        -1,\n                                        +1\n                                    ], 1)().fix()])));    // TODO consider extendind .specularColor and .diffuseColor, b/c they would be present if vertex scope is chosen\n                            }\n                        }\n                        if (light.type != 'off') {\n                            _this.features.push(_this.lightDirectionVector = new GlslVector('light.direction', light.direction.entries));\n                        }\n                        return _this;\n                    }\n                    Illumination.prototype.getColorAttrs = function getColorAttrs() {\n                        if (this.material.scope == 'global') {\n                            return [];\n                        } else {\n                            if (this.material.data == 'one') {\n                                return [{\n                                        name: 'color',\n                                        enabled: true,\n                                        weight: 1\n                                    }];\n                            } else {\n                                return [\n                                    {\n                                        name: 'specularColor',\n                                        enabled: this.light.type != 'off',\n                                        weight: 0.4\n                                    },\n                                    {\n                                        name: 'diffuseColor',\n                                        enabled: this.light.type != 'off',\n                                        weight: 0.4\n                                    },\n                                    {\n                                        name: 'ambientColor',\n                                        enabled: true,\n                                        weight: 0.2\n                                    }\n                                ];\n                            }\n                        }\n                    };\n                    Illumination.prototype.wantsTransformedPosition = function wantsTransformedPosition(eyeAtInfinity) {\n                        return !eyeAtInfinity && this.light.type != 'off' && this.material.data != 'one';\n                    };\n                    Illumination.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines(eyeAtInfinity, hasNormalAttr) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('varying vec3 interpolatedView;');\n                        }\n                        if (this.light.type != 'off') {\n                            if (hasNormalAttr) {\n                                a('attribute vec3 normal;');\n                            }\n                            a('varying vec3 interpolatedNormal;');\n                        }\n                        if (this.material.scope != 'global') {\n                            if (this.material.data == 'one') {\n                                a('attribute vec4 color;');\n                                a('varying vec4 interpolatedColor;');\n                            } else {\n                                if (this.light.type == 'off') {\n                                    a('attribute vec4 ambientColor;');\n                                    a('varying vec4 interpolatedColor;');\n                                } else {\n                                    a('attribute vec3 specularColor;', 'attribute vec3 diffuseColor;', 'attribute vec3 ambientColor;', 'varying vec3 interpolatedSpecularColor;', 'varying vec3 interpolatedDiffuseColor;', 'varying vec3 interpolatedAmbientColor;');\n                                }\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines(eyeAtInfinity, hasNormalAttr, normalTransformLines) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('interpolatedView=-transformedPosition.xyz;');\n                        }\n                        if (this.light.type != 'off') {\n                            a('interpolatedNormal=');\n                            if (hasNormalAttr) {\n                                a.t('normal');\n                            } else {\n                                a.t('vec3(0.0,0.0,1.0)');\n                            }\n                            a.t(normalTransformLines);\n                            a.t(';');\n                        }\n                        if (this.material.scope != 'global') {\n                            if (this.material.data == 'one') {\n                                a('interpolatedColor=color;');\n                            } else {\n                                if (this.light.type == 'off') {\n                                    a('interpolatedColor=ambientColor;');\n                                } else {\n                                    a('interpolatedSpecularColor=specularColor;', 'interpolatedDiffuseColor=diffuseColor;', 'interpolatedAmbientColor=ambientColor;');\n                                }\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslFragmentDeclarationLines = function getGlslFragmentDeclarationLines(eyeAtInfinity) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('varying vec3 interpolatedView;');\n                        }\n                        if (this.light.type != 'off') {\n                            a(this.lightDirectionVector.getGlslDeclarationLines(), 'varying vec3 interpolatedNormal;');\n                        }\n                        if (this.material.scope == 'global') {\n                            if (this.material.data == 'one') {\n                                a(this.colorVector.getGlslDeclarationLines());\n                            } else {\n                                if (this.light.type != 'off') {\n                                    a(this.specularColorVector.getGlslDeclarationLines());\n                                    a(this.diffuseColorVector.getGlslDeclarationLines());\n                                }\n                                a(this.ambientColorVector.getGlslDeclarationLines());\n                            }\n                        } else {\n                            if (this.material.data == 'one' || this.light.type == 'off') {\n                                a('varying vec4 interpolatedColor;');\n                            } else {\n                                a('varying vec3 interpolatedSpecularColor;', 'varying vec3 interpolatedDiffuseColor;', 'varying vec3 interpolatedAmbientColor;');\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslFragmentOutputLines = function getGlslFragmentOutputLines(eyeAtInfinity, twoSided) {\n                        var _this2 = this;\n                        var a = Lines.b();\n                        var colorRGB = undefined, colorA = undefined, colorRGBA = undefined;\n                        if (this.material.scope == 'global') {\n                            (function () {\n                                var vector = _this2.material.data == 'one' ? _this2.colorVector : _this2.ambientColorVector;\n                                colorRGB = function () {\n                                    return vector.getGlslComponentsValue('rgb');\n                                };\n                                colorA = function () {\n                                    return vector.getGlslComponentsValue('a');\n                                };\n                                colorRGBA = function () {\n                                    return vector.getGlslValue();\n                                };\n                            }());\n                        } else {\n                            colorRGB = function () {\n                                return 'interpolatedColor.rgb';\n                            };\n                            // TODO don't pass it as vec4 if light is on\n                            colorA = function () {\n                                return 'interpolatedColor.a';\n                            };\n                            colorRGBA = function () {\n                                return 'interpolatedColor';\n                            };\n                        }\n                        if (this.light.type == 'off') {\n                            a('gl_FragColor=' + colorRGBA() + ';');\n                        } else {\n                            a('vec3 N=normalize(interpolatedNormal);');\n                            if (twoSided) {\n                                a('if (!gl_FrontFacing) N=-N;');\n                            }\n                            a('vec3 L=normalize(' + this.lightDirectionVector.getGlslValue() + ');');\n                            if (this.material.data == 'one') {\n                                a('gl_FragColor=vec4(' + colorRGB() + '*max(0.0,dot(L,N)),' + colorA() + ');');\n                            } else {\n                                if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                                    a('vec3 V=normalize(interpolatedView);');\n                                } else {\n                                    a('vec3 V=vec3(0.0,0.0,1.0);');\n                                }\n                                var specularDotArgs = 'H,N';\n                                var shininessCorrection = '';\n                                if (this.light.type == 'blinn') {\n                                    a('vec3 H=normalize(L+V);');\n                                } else {\n                                    a('vec3 R=reflect(-L,N);');\n                                    specularDotArgs = 'R,V';\n                                    shininessCorrection = '/4.0';\n                                }\n                                a('float shininess=100.0;');\n                                a(WrapLines.b('gl_FragColor=vec4(', ',1.0);').ae(this.material.scope == 'global' ? Lines.bae('+' + this.specularColorVector.getGlslValue() + '*pow(max(0.0,dot(' + specularDotArgs + ')),shininess' + shininessCorrection + ')', '+' + this.diffuseColorVector.getGlslValue() + '*max(0.0,dot(L,N))', '+' + this.ambientColorVector.getGlslValue()) : Lines.bae('+interpolatedSpecularColor*pow(max(0.0,dot(' + specularDotArgs + ')),shininess' + shininessCorrection + ')', '+interpolatedDiffuseColor*max(0.0,dot(L,N))', '+interpolatedAmbientColor')));\n                            }\n                        }\n                        return a.e();\n                    };\n                    return Illumination;\n                }(Feature);\n                module.exports = Illumination;\n            },\n            {\n                '12': 12,\n                '18': 18,\n                '25': 25,\n                '27': 27,\n                '35': 35\n            }\n        ],\n        30: [\n            function (require, module, exports) {\n                'use strict';\n                var Base = function () {\n                    function Base(str) {\n                        babelHelpers.classCallCheck(this, Base);\n                        this._str = str;\n                    }\n                    Base.prototype.toString = function toString() {\n                        return this._str;\n                    };\n                    Base.prototype.valueOf = function valueOf() {\n                        return this._str;\n                    };\n                    return Base;\n                }();\n                var Constant = function (_Base) {\n                    babelHelpers.inherits(Constant, _Base);\n                    function Constant() {\n                        babelHelpers.classCallCheck(this, Constant);\n                        return babelHelpers.possibleConstructorReturn(this, _Base.apply(this, arguments));\n                    }\n                    return Constant;\n                }(Base);\n                var Variable = function (_Base2) {\n                    babelHelpers.inherits(Variable, _Base2);\n                    function Variable() {\n                        babelHelpers.classCallCheck(this, Variable);\n                        return babelHelpers.possibleConstructorReturn(this, _Base2.apply(this, arguments));\n                    }\n                    return Variable;\n                }(Base);\n                var Slider = function (_Variable) {\n                    babelHelpers.inherits(Slider, _Variable);\n                    function Slider() {\n                        babelHelpers.classCallCheck(this, Slider);\n                        return babelHelpers.possibleConstructorReturn(this, _Variable.apply(this, arguments));\n                    }\n                    return Slider;\n                }(Variable);\n                var MouseMove = function (_Variable2) {\n                    babelHelpers.inherits(MouseMove, _Variable2);\n                    function MouseMove(str) {\n                        babelHelpers.classCallCheck(this, MouseMove);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Variable2.call(this, str));\n                        _this4.axis = str.slice(-1);\n                        return _this4;\n                    }\n                    return MouseMove;\n                }(Variable);\n                var Gamepad = function (_Variable3) {\n                    babelHelpers.inherits(Gamepad, _Variable3);\n                    function Gamepad(str) {\n                        babelHelpers.classCallCheck(this, Gamepad);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Variable3.call(this, str));\n                        _this5.axis = Number(str.slice(-1));\n                        return _this5;\n                    }\n                    return Gamepad;\n                }(Variable);\n                function createFromString(str) {\n                    return new {\n                        'constant': Constant,\n                        'slider': Slider,\n                        'mousemovex': MouseMove,\n                        'mousemovey': MouseMove,\n                        'gamepad0': Gamepad,\n                        'gamepad1': Gamepad,\n                        'gamepad2': Gamepad,\n                        'gamepad3': Gamepad\n                    }[str](str);\n                }\n                exports.Base = Base;\n                exports.Constant = Constant;\n                exports.Variable = Variable;\n                exports.Slider = Slider;\n                exports.MouseMove = MouseMove;\n                exports.Gamepad = Gamepad;\n                exports.createFromString = createFromString;\n            },\n            {}\n        ],\n        31: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<label for=',\n                        '>',\n                        ':</label>'\n                    ], [\n                        '\\t<label for=',\n                        '>',\n                        ':</label>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' />'\n                    ], [\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' />'\n                    ]);\n                var Lines = require(12);\n                var NumericFeature = require(34);\n                var IntFeature = function (_NumericFeature) {\n                    babelHelpers.inherits(IntFeature, _NumericFeature);\n                    function IntFeature(name, value) {\n                        babelHelpers.classCallCheck(this, IntFeature);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _NumericFeature.call(this));\n                        _this.name = name;\n                        _this.value = value;\n                        return _this;\n                    }\n                    IntFeature.prototype.hasInputs = function hasInputs() {\n                        return _NumericFeature.prototype.hasInputs.call(this) || this.value.input != 'constant';\n                    };\n                    IntFeature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        _NumericFeature.prototype.requestFeatureContext.call(this, featureContext);\n                        if (this.value.input != 'constant') {\n                            featureContext.hasInputs = true;\n                        }\n                        if (this.value.input == 'slider') {\n                            featureContext.hasSliders = true;\n                        }\n                    };\n                    IntFeature.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlControlMessageLines.call(this, i18n));\n                        a(this.getHtmlControlMessageForValue(i18n, this.value, this.name));\n                        return a.e();\n                    };\n                    IntFeature.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlInputLines.call(this, i18n));\n                        var v = this.value;\n                        if (v.input == 'slider') {\n                            a('<div>', Lines.html(_templateObject, this.name, i18n('options.' + this.name)), '\\t<span class=min>' + i18n('options.' + this.name + '.value', v.min) + '</span>', // html inserted, no escaping\n                            Lines.html(_templateObject2, this.name, v.min, v.max, v), '\\t<span class=max>' + i18n('options.' + this.name + '.value', v.max) + '</span>', '</div>');\n                        }\n                        return a.e();\n                    };\n                    return IntFeature;\n                }(NumericFeature);\n                module.exports = IntFeature;\n            },\n            {\n                '12': 12,\n                '34': 34\n            }\n        ],\n        32: [\n            function (require, module, exports) {\n                'use strict';\n                var capitalize = require(5);\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var Base = function () {\n                    function Base() {\n                        babelHelpers.classCallCheck(this, Base);\n                        this.entries = [];\n                    }\n                    Base.prototype.enter = function enter() {\n                        var entry = {\n                            pre: [],\n                            cond: null,\n                            log: [],\n                            post: []\n                        };\n                        this.entries.push(entry);\n                        function makePushArgs(where) {\n                            return function () {\n                                where.push.apply(where, arguments);\n                                return proxy;\n                            };\n                        }\n                        var proxy = {\n                            pre: makePushArgs(entry.pre),\n                            cond: function (cond) {\n                                entry.cond = cond;\n                                return proxy;\n                            },\n                            log: makePushArgs(entry.log),\n                            post: makePushArgs(entry.post)\n                        };\n                        return proxy;\n                    };\n                    Base.prototype.prependedStatements = function prependedStatements() {\n                        return [];\n                    };\n                    Base.prototype.bracketFnArg = function bracketFnArg() {\n                        return '';\n                    };\n                    Base.prototype.wrapCall = function wrapCall(lines) {\n                        return lines;\n                    };\n                    Base.prototype.write = function write(haveToUpdateCanvas, haveToLogInput) {\n                        var statementsGraph = {};\n                        var statementsRoot = [];\n                        var statementsPrev = null;\n                        var WHITE = 0;\n                        var GRAY = 1;\n                        var BLACK = 2;\n                        var addStatement = function (statement, cond) {\n                            var vertex = undefined;\n                            if (statement in statementsGraph) {\n                                vertex = statementsGraph[statement];\n                            } else {\n                                vertex = statementsGraph[statement] = {\n                                    prevs: [],\n                                    conds: [],\n                                    mark: WHITE\n                                };\n                            }\n                            if (vertex.conds !== null) {\n                                if (cond === null) {\n                                    vertex.conds = null;\n                                } else {\n                                    vertex.conds.push(cond);\n                                }\n                            }\n                            if (statementsPrev !== null) {\n                                vertex.prevs.push(statementsPrev);\n                            }\n                            statementsPrev = statement;\n                        };\n                        var closeEntryStatements = function () {\n                            if (statementsPrev !== null) {\n                                statementsRoot.push(statementsPrev);\n                            }\n                            statementsPrev = null;\n                        };\n                        var getStatements = function () {\n                            var statements = [];\n                            var currentCond = null;\n                            var writeStatement = function (statement, vertex) {\n                                var newCond = null;\n                                if (vertex.conds !== null) {\n                                    newCond = vertex.conds.join(' || ');\n                                }\n                                if (newCond != currentCond) {\n                                    if (currentCond !== null) {\n                                        statements.push('}');\n                                    }\n                                    currentCond = newCond;\n                                    if (currentCond !== null) {\n                                        statements.push('if (' + currentCond + ') {');\n                                    }\n                                }\n                                if (currentCond !== null) {\n                                    statements.push('\\t' + statement);\n                                } else {\n                                    statements.push(statement);\n                                }\n                            };\n                            var recVertex = function (statement, vertex) {\n                                vertex.mark = GRAY;\n                                recPrevs(vertex.prevs);\n                                vertex.mark = BLACK;\n                                writeStatement(statement, vertex);\n                            };\n                            var recPrevs = function (prevs) {\n                                prevs.forEach(function (statement) {\n                                    if (statementsGraph[statement].mark == WHITE) {\n                                        recVertex(statement, statementsGraph[statement]);\n                                    }\n                                });\n                            };\n                            recPrevs(statementsRoot);\n                            if (currentCond !== null) {\n                                statements.push('}');\n                            }\n                            return statements;\n                        };\n                        this.entries.forEach(function (entry) {\n                            entry.pre.forEach(function (statement) {\n                                addStatement(statement, null);\n                            });\n                            if (haveToLogInput) {\n                                entry.log.forEach(function (statement) {\n                                    addStatement(statement, entry.cond);\n                                });\n                            }\n                            entry.post.forEach(function (statement) {\n                                addStatement(statement, entry.cond);\n                            });\n                            if (haveToUpdateCanvas) {\n                                addStatement('scheduleFrame();', entry.cond);\n                            }\n                            closeEntryStatements();\n                        });\n                        var br = this.bracketListener();\n                        var statements = getStatements();\n                        if (statements.length > 0) {\n                            statements = [].concat(this.prependedStatements(), statements);\n                        }\n                        if (statements.length == 1) {\n                            var match = /^(\\w+)\\(\\);$/.exec(statements[0]);\n                            if (match) {\n                                return this.wrapCall(JsLines.bae(br[0] + match[1] + br[1]));\n                            }    // TODO what if no match?\n                        }\n                        if (statements.length > 0) {\n                            return this.wrapCall(WrapLines.b(JsLines.bae(br[0] + 'function(' + this.bracketFnArg() + '){'), JsLines.bae('}' + br[1])).ae(JsLines.bae.apply(JsLines, statements)));\n                        } else {\n                            return JsLines.be();\n                        }\n                    };\n                    return Base;\n                }();\n                var Slider = function (_Base) {\n                    babelHelpers.inherits(Slider, _Base);\n                    function Slider(id) {\n                        babelHelpers.classCallCheck(this, Slider);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Base.call(this));\n                        _this.id = id;\n                        return _this;\n                    }\n                    Slider.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'document.getElementById(\\'' + this.id + '\\').addEventListener(\\'change\\',',\n                            ');'\n                        ];\n                    };\n                    return Slider;\n                }(Base);\n                var MultipleSlider = function (_Base2) {\n                    babelHelpers.inherits(MultipleSlider, _Base2);\n                    function MultipleSlider(query) {\n                        babelHelpers.classCallCheck(this, MultipleSlider);\n                        var _this2 = babelHelpers.possibleConstructorReturn(this, _Base2.call(this));\n                        _this2.query = query;\n                        return _this2;\n                    }\n                    MultipleSlider.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'el.addEventListener(\\'change\\',',\n                            ');'\n                        ];\n                    };\n                    MultipleSlider.prototype.wrapCall = function wrapCall(lines) {\n                        return WrapLines.b(JsLines.bae(';[].forEach.call(document.querySelectorAll(\\'' + this.query + '\\'),function(el){'), JsLines.bae('});')).ae(lines);\n                    };\n                    return MultipleSlider;\n                }(Base);\n                var CanvasMousemove = function (_Base3) {\n                    babelHelpers.inherits(CanvasMousemove, _Base3);\n                    function CanvasMousemove() {\n                        babelHelpers.classCallCheck(this, CanvasMousemove);\n                        return babelHelpers.possibleConstructorReturn(this, _Base3.apply(this, arguments));\n                    }\n                    CanvasMousemove.prototype.enter = function enter() {\n                        var proxy = _Base3.prototype.enter.call(this);\n                        var floatHelper = function (minMaxFlag, varFlag, inputType, varName, minValue, maxValue) {\n                            var VarName = capitalize(varName);\n                            var dest = undefined;\n                            if (minValue == 0 && maxValue == 1) {\n                                dest = (varFlag ? 'var ' : '') + varName + '=';\n                            } else {\n                                proxy.pre('var min' + VarName + '=' + minValue + ';');\n                                proxy.pre('var max' + VarName + '=' + maxValue + ';');\n                                dest = (varFlag ? 'var ' : '') + varName + '=min' + VarName + '+(max' + VarName + '-min' + VarName + ')*';\n                            }\n                            return proxy.prexy(inputType, dest + '(ev.clientX-rect.left)/(rect.width-1);', dest + '(rect.bottom-1-ev.clientY)/(rect.height-1);');\n                        };\n                        proxy.prexy = function (inputType, xStatement, yStatement) {\n                            if (inputType.axis == 'x') {\n                                return proxy.pre(xStatement);\n                            } else if (inputType.axis == 'y') {\n                                return proxy.pre(yStatement);\n                            }\n                            return proxy;\n                        };\n                        proxy.minMaxFloat = function (inputType, varName, minValue, maxValue) {\n                            return floatHelper(true, false, inputType, varName, minValue, maxValue);\n                        };\n                        proxy.minMaxVarFloat = function (inputType, varName, minValue, maxValue) {\n                            return floatHelper(true, true, inputType, varName, minValue, maxValue);\n                        };\n                        proxy.newVarInt = function (inputType, varName) {\n                            var VarName = capitalize(varName);\n                            return proxy.prexy(inputType, 'var new' + VarName + '=Math.floor(min' + VarName + '+(max' + VarName + '-min' + VarName + '+1)*(ev.clientX-rect.left)/rect.width);', 'var new' + VarName + '=Math.floor(min' + VarName + '+(max' + VarName + '-min' + VarName + '+1)*(rect.bottom-1-ev.clientY)/rect.height);');\n                        };\n                        return proxy;\n                    };\n                    CanvasMousemove.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'canvas.addEventListener(\\'mousemove\\',',\n                            ');'\n                        ];\n                    };\n                    CanvasMousemove.prototype.bracketFnArg = function bracketFnArg() {\n                        return 'ev';\n                    };\n                    CanvasMousemove.prototype.prependedStatements = function prependedStatements() {\n                        return ['var rect=this.getBoundingClientRect();'];\n                    };\n                    return CanvasMousemove;\n                }(Base);\n                exports.Slider = Slider;\n                exports.MultipleSlider = MultipleSlider;\n                exports.CanvasMousemove = CanvasMousemove;\n            },\n            {\n                '11': 11,\n                '18': 18,\n                '5': 5\n            }\n        ],\n        33: [\n            function (require, module, exports) {\n                'use strict';\n                var idCounter = 0;\n                function generateId() {\n                    return 'webgl-starter-id-' + idCounter++;\n                }\n                var i18n = require(28);\n                var Options = require(37);\n                var Code = require(22);\n                var OptionsOutput = require(36);\n                var CodeOutput = require(2);\n                function getHtmlDataUri(html) {\n                    // with base64: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/btoa\n                    //return \"data:text/html;charset=utf-8;base64,\"+window.btoa(unescape(encodeURIComponent(str)));\n                    // without base64: https://en.wikipedia.org/wiki/Data_URI_scheme\n                    return 'data:text/html;charset=utf-8,' + encodeURIComponent(html);\n                }\n                $(function () {\n                    $('.webgl-starter').each(function () {\n                        var $container = $(this);\n                        var options = new Options();\n                        var codeOutput = new CodeOutput(function () {\n                            return new Code(options.fix(), i18n);\n                        }, i18n);\n                        options.updateCallback = codeOutput.update;\n                        var optionsOutput = new OptionsOutput(options, generateId, i18n);\n                        $container.empty().append(optionsOutput.$output, codeOutput.$output);\n                    });\n                });\n            },\n            {\n                '2': 2,\n                '22': 22,\n                '28': 28,\n                '36': 36,\n                '37': 37\n            }\n        ],\n        34: [\n            function (require, module, exports) {\n                'use strict';\n                var Input = require(30);\n                var Lines = require(12);\n                var Feature = require(25);\n                var NumericFeature = function (_Feature) {\n                    babelHelpers.inherits(NumericFeature, _Feature);\n                    function NumericFeature() {\n                        babelHelpers.classCallCheck(this, NumericFeature);\n                        return babelHelpers.possibleConstructorReturn(this, _Feature.apply(this, arguments));\n                    }\n                    // private:\n                    NumericFeature.prototype.getHtmlControlMessageForValue = function getHtmlControlMessageForValue(i18n, value, name) {\n                        if (value.input instanceof Input.MouseMove) {\n                            return Lines.bae('<li>' + i18n('controls.type.' + value.input) + ' ' + i18n('controls.to') + ' <strong>' + i18n('options.' + name) + '</strong></li>');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    return NumericFeature;\n                }(Feature);\n                module.exports = NumericFeature;\n            },\n            {\n                '12': 12,\n                '25': 25,\n                '30': 30\n            }\n        ],\n        35: [\n            function (require, module, exports) {\n                'use strict';\n                var Input = require(30);\n                var Option = Object.create(require(14));\n                var FixedLiveNumber = function () {\n                    function FixedLiveNumber(src, setToDefault) {\n                        babelHelpers.classCallCheck(this, FixedLiveNumber);\n                        if (!setToDefault) {\n                            this.value = src.value;\n                            this.min = src.min;\n                            this.max = src.max;\n                            this.input = Input.createFromString(src.input);\n                        } else {\n                            this.value = src.defaultValue;\n                            this.min = src.availableMin;\n                            this.max = src.availableMax;\n                            this.input = Input.createFromString('constant');\n                        }\n                        // TODO remove it - needed for formatting and to decide on clamp()/wrap():\n                        this.availableMin = src.availableMin;\n                        this.availableMax = src.availableMax;\n                        this.precision = src.precision;\n                    }\n                    FixedLiveNumber.prototype.valueOf = function valueOf() {\n                        return this.value;\n                    };\n                    FixedLiveNumber.prototype.toString = function toString() {\n                        return String(this.value);\n                    };\n                    return FixedLiveNumber;\n                }();\n                // abstract classes\n                Option.LiveNumber = function (_Option$Number) {\n                    babelHelpers.inherits(_class, _Option$Number);\n                    function _class(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class);\n                        var dataValue = undefined, dataMin = undefined, dataMax = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataMin = data.min;\n                            dataMax = data.max;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                        _this._min = dataMin !== undefined ? dataMin : _this.availableMin;\n                        _this._max = dataMax !== undefined ? dataMax : _this.availableMax;\n                        _this._input = dataInput !== undefined ? dataInput : 'constant';\n                        _this._$range = null;\n                        return _this;\n                    }\n                    _class.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        if (this._$range)\n                            this._$range.toggle(this._input != 'constant');\n                    };\n                    _class.prototype.exportHelper = function exportHelper(src) {\n                        var data = {};\n                        if (src.value != src.defaultValue)\n                            data.value = src.value;\n                        if (src.min != src.availableMin)\n                            data.min = src.min;\n                        if (src.max != src.availableMax)\n                            data.max = src.max;\n                        if (src.input != 'constant')\n                            data.input = src.input;\n                        return data;\n                    };\n                    _class.prototype.export = function _export() {\n                        return this.exportHelper(this);\n                    };\n                    _class.prototype.fix = function fix() {\n                        var fixed = new FixedLiveNumber(this);\n                        fixed.name = this.name;\n                        return fixed;\n                    };\n                    babelHelpers.createClass(_class, [\n                        {\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateInternalVisibility();\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'min',\n                            get: function () {\n                                return this._min;\n                            },\n                            set: function (min) {\n                                this._min = min;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'max',\n                            get: function () {\n                                return this._max;\n                            },\n                            set: function (max) {\n                                this._max = max;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: '$range',\n                            get: function () {\n                                return this._$range;\n                            },\n                            set: function ($range) {\n                                this._$range = $range;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class;\n                }(Option.Number);\n                // concrete classes\n                Option.LiveInt = function (_Option$LiveNumber) {\n                    babelHelpers.inherits(_class2, _Option$LiveNumber);\n                    function _class2() {\n                        babelHelpers.classCallCheck(this, _class2);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class2, [\n                        {\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        },\n                        {\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider',\n                                    'mousemovex',\n                                    'mousemovey'\n                                ];\n                            }\n                        }\n                    ]);\n                    return _class2;\n                }(Option.LiveNumber);\n                Option.CanvasLiveInt = function (_Option$LiveInt) {\n                    babelHelpers.inherits(_class3, _Option$LiveInt);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveInt.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class3, [{\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider'\n                                ];\n                            }\n                        }]);\n                    return _class3;\n                }(Option.LiveInt);\n                Option.LiveFloat = function (_Option$LiveNumber2) {\n                    babelHelpers.inherits(_class4, _Option$LiveNumber2);\n                    _class4.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.speed === undefined)\n                            settings.speed = {};\n                        if (settings.speed.availableMin === undefined)\n                            settings.speed.availableMin = arrayArg[2];\n                        if (settings.speed.availableMax === undefined)\n                            settings.speed.availableMax = arrayArg[3];\n                        return _Option$LiveNumber2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class4(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class4);\n                        var dataSpeedValue = undefined, dataSpeedMin = undefined, dataSpeedMax = undefined, dataSpeedInput = undefined;\n                        if (typeof data == 'object') {\n                            if (typeof data.speed == 'object') {\n                                dataSpeedValue = data.speed.value;\n                                dataSpeedMin = data.speed.min;\n                                dataSpeedMax = data.speed.max;\n                                dataSpeedInput = data.speed.input;\n                            } else {\n                                dataSpeedValue = data.speed;\n                            }\n                        }\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber2.apply(this, arguments));\n                        _this4._speedAvailableMin = settings.speed.availableMin;\n                        _this4._speedAvailableMax = settings.speed.availableMax;\n                        if (settings.precision !== undefined) {\n                            _this4.precision = settings.precision;\n                        } else {\n                            if (_this4.availableMax >= 100) {\n                                _this4.precision = 1;\n                            } else if (_this4.availableMax >= 10) {\n                                _this4.precision = 2;\n                            } else {\n                                _this4.precision = 3;\n                            }\n                        }\n                        _this4._speedValue = dataSpeedValue !== undefined ? dataSpeedValue : 0;\n                        _this4._speedMin = dataSpeedMin !== undefined ? dataSpeedMin : _this4._speedAvailableMin;\n                        _this4._speedMax = dataSpeedMax !== undefined ? dataSpeedMax : _this4._speedAvailableMax;\n                        _this4._speedInput = dataSpeedInput !== undefined ? dataSpeedInput : 'constant';\n                        _this4._addSpeed = !(_this4._speedValue == 0 && _this4._speedMin == _this4._speedAvailableMin && _this4._speedMax == _this4._speedAvailableMax && _this4._speedInput == 'constant');\n                        _this4._speed$ = null;\n                        _this4._speed$range = null;\n                        _this4._$addSpeed = null;\n                        return _this4;\n                    }\n                    _class4.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        _Option$LiveNumber2.prototype.updateInternalVisibility.call(this);\n                        if (this._speed$range)\n                            this._speed$range.toggle(this._speedInput != 'constant');\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this._input) < 0;\n                        if (this._speed$)\n                            this._speed$.toggle(this._addSpeed && notGamepad);\n                        if (this._$addSpeed)\n                            this._$addSpeed.toggle(notGamepad);\n                    };\n                    _class4.prototype.export = function _export() {\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this.input) < 0;\n                        var data = this.exportHelper(this);\n                        if (notGamepad && this.addSpeed) {\n                            this.shortenExportAssign(this.exportHelper(this.speed), data, 'speed');\n                        }\n                        return data;\n                    };\n                    _class4.prototype.fix = function fix() {\n                        var fixed = _Option$LiveNumber2.prototype.fix.call(this);\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this.input) < 0;\n                        if (notGamepad && this.addSpeed) {\n                            fixed.speed = new FixedLiveNumber(this.speed);\n                        } else {\n                            fixed.speed = new FixedLiveNumber(this.speed, true);\n                        }\n                        return fixed;\n                    };\n                    babelHelpers.createClass(_class4, [\n                        {\n                            key: 'addSpeed',\n                            get: function () {\n                                return this._addSpeed;\n                            },\n                            set: function (addSpeed) {\n                                this._addSpeed = addSpeed;\n                                this.updateInternalVisibility();\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider',\n                                    'mousemovex',\n                                    'mousemovey',\n                                    'gamepad0',\n                                    'gamepad1',\n                                    'gamepad2',\n                                    'gamepad3'\n                                ];\n                            }\n                        },\n                        {\n                            key: 'speed',\n                            get: function () {\n                                var option = this;\n                                return {\n                                    get fullName() {\n                                        return option.fullName + '.speed';\n                                    },\n                                    get defaultValue() {\n                                        return 0;\n                                    },\n                                    get value() {\n                                        return option._speedValue;\n                                    },\n                                    set value(value) {\n                                        option._speedValue = value;\n                                        option.updateCallback();\n                                    },\n                                    get input() {\n                                        return option._speedInput;\n                                    },\n                                    set input(input) {\n                                        option._speedInput = input;\n                                        option.updateInternalVisibility();\n                                        option.updateCallback();\n                                    },\n                                    get availableMin() {\n                                        return option._speedAvailableMin;\n                                    },\n                                    get availableMax() {\n                                        return option._speedAvailableMax;\n                                    },\n                                    get min() {\n                                        return option._speedMin;\n                                    },\n                                    set min(min) {\n                                        option._speedMin = min;\n                                        option.updateCallback();\n                                    },\n                                    get max() {\n                                        return option._speedMax;\n                                    },\n                                    set max(max) {\n                                        option._speedMax = max;\n                                        option.updateCallback();\n                                    },\n                                    get precision() {\n                                        return option.precision;\n                                    },\n                                    get availableInputTypes() {\n                                        return option.availableInputTypes;\n                                    },\n                                    get $() {\n                                        return option._speed$;\n                                    },\n                                    set $($) {\n                                        option._speed$ = $;\n                                        option.updateInternalVisibility();\n                                    },\n                                    get $range() {\n                                        return option._speed$range;\n                                    },\n                                    set $range($range) {\n                                        option._speed$range = $range;\n                                        option.updateInternalVisibility();\n                                    }\n                                };\n                            }\n                        },\n                        {\n                            key: '$addSpeed',\n                            get: function () {\n                                return this._$addSpeed;\n                            },\n                            set: function ($addSpeed) {\n                                this._$addSpeed = $addSpeed;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class4;\n                }(Option.LiveNumber);\n                Option.LiveColor = function (_Option$Group) {\n                    babelHelpers.inherits(_class5, _Option$Group);\n                    function _class5() {\n                        babelHelpers.classCallCheck(this, _class5);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Group.apply(this, arguments));\n                    }\n                    _class5.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.componentDefaultValues === undefined)\n                            settings.componentDefaultValues = arrayArg;\n                        var cs = 'rgba';\n                        settings.descriptions = settings.componentDefaultValues.map(function (defaultValue, i) {\n                            var c = cs.charAt(i);\n                            return [\n                                'LiveFloat',\n                                c,\n                                [\n                                    0,\n                                    1,\n                                    -1,\n                                    +1\n                                ],\n                                defaultValue\n                            ];\n                        });\n                        return _Option$Group.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    return _class5;\n                }(Option.Group);\n                module.exports = Option;\n            },\n            {\n                '14': 14,\n                '30': 30\n            }\n        ],\n        36: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(35);\n                var BaseOptionsOutput = require(15);\n                var OptionsOutput = function (_BaseOptionsOutput) {\n                    babelHelpers.inherits(OptionsOutput, _BaseOptionsOutput);\n                    function OptionsOutput() {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptionsOutput.apply(this, arguments));\n                    }\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        _BaseOptionsOutput.prototype.setOptionClassWriters.call(this, optionClassWriters);\n                        var baseSelectWriter = optionClassWriters.get(Option.Select);\n                        optionClassWriters.set(Option.Select, function (option, writeOption, i18n, generateId) {\n                            var $option = baseSelectWriter(option, writeOption, i18n, generateId);\n                            if (option.name == 'elements') {\n                                $option.append(' ' + i18n('options-output.elements'));\n                            }\n                            return $option;\n                        });\n                        optionClassWriters.set(Option.LiveNumber, function (option, writeOption, i18n, generateId) {\n                            var writeSubOption = function (option) {\n                                var p = option.precision;\n                                var setInputAttrs = function ($input) {\n                                    return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                                };\n                                var writeMinMaxInput = function (minOrMax) {\n                                    return setInputAttrs($('<input type=\\'number\\' required>')).val(option[minOrMax]).on('input change', function () {\n                                        if (this.checkValidity()) {\n                                            option[minOrMax] = parseFloat(this.value);\n                                        }\n                                    });\n                                };\n                                var id = generateId();\n                                var inputSelectId = generateId();\n                                var $inputSelect = undefined, $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                                var $output = optionClassWriters.get(Option.Number)(option, writeOption, i18n, generateId);\n                                $output.find('button').before(' <label for=\\'' + inputSelectId + '\\'>' + i18n('options-output.inputs') + ':</label> ', $inputSelect = $('<select id=\\'' + inputSelectId + '\\'>').append(option.availableInputTypes.map(function (availableInputType) {\n                                    return $('<option>').val(availableInputType).html(i18n('options-output.inputs.' + availableInputType));\n                                })).val(option.input).change(function () {\n                                    option.input = this.value;\n                                }), ' ', option.$range = $('<span class=\\'range\\'>').append(i18n('options-output.range') + ' ').append($rangeMinInput = writeMinMaxInput('min')).append(' .. ').append($rangeMaxInput = writeMinMaxInput('max')), ' ').click(function () {\n                                    $inputSelect.val('constant').change();\n                                    $rangeMinInput.val(option.availableMin).change();\n                                    $rangeMaxInput.val(option.availableMax).change();\n                                });\n                                return $output;\n                            };\n                            if (option instanceof Option.LiveFloat) {\n                                return option.$ = $('<div>').append(writeSubOption(option).append(' ', option.$addSpeed = $('<label> ' + i18n('options-output.addSpeed') + '</label>').prepend($('<input type=\\'checkbox\\'>').prop('checked', option.addSpeed).change(function () {\n                                    option.addSpeed = this.checked;\n                                }))), option.speed.$ = writeSubOption(option.speed));\n                            } else {\n                                return option.$ = writeSubOption(option);\n                            }\n                        });\n                    };\n                    return OptionsOutput;\n                }(BaseOptionsOutput);\n                module.exports = OptionsOutput;\n            },\n            {\n                '15': 15,\n                '35': 35\n            }\n        ],\n        37: [\n            function (require, module, exports) {\n                'use strict';\n                var BaseOptions = require(16);\n                var Options = function (_BaseOptions) {\n                    babelHelpers.inherits(Options, _BaseOptions);\n                    function Options() {\n                        babelHelpers.classCallCheck(this, Options);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptions.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(35);\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [\n                                    [\n                                        'Group',\n                                        'canvas',\n                                        [\n                                            [\n                                                'CanvasLiveInt',\n                                                'width',\n                                                [\n                                                    1,\n                                                    1024\n                                                ],\n                                                512\n                                            ],\n                                            [\n                                                'CanvasLiveInt',\n                                                'height',\n                                                [\n                                                    1,\n                                                    1024\n                                                ],\n                                                512\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'background',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'none',\n                                                    'solid'\n                                                ]\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'color',\n                                                [\n                                                    1,\n                                                    1,\n                                                    1,\n                                                    1\n                                                ],\n                                                { visibilityData: { 'background.type': 'solid' } }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'material',\n                                        [\n                                            [\n                                                'Select',\n                                                'scope',\n                                                [\n                                                    'global',\n                                                    'vertex',\n                                                    'face'\n                                                ]\n                                            ],\n                                            // partly related to shape\n                                            [\n                                                'Select',\n                                                'data',\n                                                [\n                                                    'one',\n                                                    'sda'\n                                                ]\n                                            ],\n                                            // partly related to shape\n                                            [\n                                                'LiveColor',\n                                                'color',\n                                                [\n                                                    1,\n                                                    0,\n                                                    0,\n                                                    1\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'one'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'specularColor',\n                                                [\n                                                    0.4,\n                                                    0.4,\n                                                    0.4\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'diffuseColor',\n                                                [\n                                                    0.4,\n                                                    0.4,\n                                                    0.4\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'ambientColor',\n                                                [\n                                                    0.2,\n                                                    0.2,\n                                                    0.2\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'light',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'off',\n                                                    'phong',\n                                                    'blinn'\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'direction',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'x',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        -1\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'y',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        +1\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'z',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        +1\n                                                    ]\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'light.type': [\n                                                            'phong',\n                                                            'blinn'\n                                                        ]\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'shape',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'square',\n                                                    'triangle',\n                                                    'gasket',\n                                                    'cube',\n                                                    'hat',\n                                                    'terrain'\n                                                ]\n                                            ],\n                                            [\n                                                'Select',\n                                                'elements',\n                                                [\n                                                    '0',\n                                                    '8',\n                                                    '16',\n                                                    '32'\n                                                ]\n                                            ],\n                                            [\n                                                'LiveInt',\n                                                'lod',\n                                                [\n                                                    0,\n                                                    10\n                                                ],\n                                                6,\n                                                {\n                                                    visibilityData: {\n                                                        'shape.type': [\n                                                            'gasket',\n                                                            'hat',\n                                                            'terrain'\n                                                        ]\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'transforms',\n                                        [\n                                            [\n                                                'Select',\n                                                'projection',\n                                                [\n                                                    'ortho',\n                                                    'perspective'\n                                                ]\n                                            ],\n                                            [\n                                                'Array',\n                                                'model',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.x',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.y',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.z',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0\n                                                    ]\n                                                ]\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'debug',\n                                        [\n                                            [\n                                                'Checkbox',\n                                                'shaders',\n                                                true\n                                            ],\n                                            [\n                                                'Checkbox',\n                                                'arrays'\n                                            ],\n                                            [\n                                                'Checkbox',\n                                                'inputs'\n                                            ],\n                                            // TODO hide if no inputs?\n                                            [\n                                                'Checkbox',\n                                                'animations'\n                                            ]\n                                        ]\n                                    ]\n                                ];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }(BaseOptions);\n                module.exports = Options;\n            },\n            {\n                '16': 16,\n                '35': 35\n            }\n        ],\n        38: [\n            function (require, module, exports) {\n                'use strict';\n                exports.square = require(45);\n                exports.triangle = require(47);\n                exports.gasket = require(40);\n                exports.cube = require(39);\n                exports.hat = require(41);\n                exports.terrain = require(46);\n            },\n            {\n                '39': 39,\n                '40': 40,\n                '41': 41,\n                '45': 45,\n                '46': 46,\n                '47': 47\n            }\n        ],\n        39: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var Colorgen = require(23);\n                var Shape = require(44);\n                var Cube = function (_Shape) {\n                    babelHelpers.inherits(Cube, _Shape);\n                    function Cube() {\n                        babelHelpers.classCallCheck(this, Cube);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Cube.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0, // TODO remove 'clean' colors after bilinear interp is implemented\n                        this.hasColorsPerFace ? undefined : [\n                            [\n                                0,\n                                0,\n                                0\n                            ],\n                            [\n                                1,\n                                0,\n                                0\n                            ],\n                            [\n                                0,\n                                1,\n                                0\n                            ],\n                            [\n                                1,\n                                1,\n                                0\n                            ],\n                            [\n                                0,\n                                0,\n                                1\n                            ],\n                            [\n                                1,\n                                0,\n                                1\n                            ],\n                            [\n                                0,\n                                1,\n                                1\n                            ],\n                            [\n                                1,\n                                1,\n                                1\n                            ]\n                        ]);\n                        var nCubeVertices = 8;\n                        var cubeColors = [];\n                        for (var i = 0; i < nCubeVertices; i++) {\n                            cubeColors.push(colorgen.getNextColorString());\n                        }\n                        var cubeVertexPositions = [\n                            '-0.5,-0.5,-0.5,',\n                            '+0.5,-0.5,-0.5,',\n                            '-0.5,+0.5,-0.5,',\n                            '+0.5,+0.5,-0.5,',\n                            '-0.5,-0.5,+0.5,',\n                            '+0.5,-0.5,+0.5,',\n                            '-0.5,+0.5,+0.5,',\n                            '+0.5,+0.5,+0.5,'\n                        ];\n                        var nCubeFaces = 6;\n                        var cubeFaceNames = [\n                            'left',\n                            'right',\n                            'bottom',\n                            'top',\n                            'back',\n                            'front'\n                        ];\n                        var cubeFaceNormals = [\n                            '-1.0, 0.0, 0.0,',\n                            '+1.0, 0.0, 0.0,',\n                            ' 0.0,-1.0, 0.0,',\n                            ' 0.0,+1.0, 0.0,',\n                            ' 0.0, 0.0,-1.0,',\n                            ' 0.0, 0.0,+1.0,'\n                        ];\n                        var cubeFaceVertices = [\n                            [\n                                4,\n                                6,\n                                0,\n                                2\n                            ],\n                            [\n                                1,\n                                3,\n                                5,\n                                7\n                            ],\n                            [\n                                0,\n                                1,\n                                4,\n                                5\n                            ],\n                            [\n                                2,\n                                6,\n                                3,\n                                7\n                            ],\n                            [\n                                0,\n                                2,\n                                1,\n                                3\n                            ],\n                            [\n                                5,\n                                7,\n                                4,\n                                6\n                            ]\n                        ];\n                        var quadToTriangleMap = [\n                            0,\n                            1,\n                            2,\n                            2,\n                            1,\n                            3\n                        ];\n                        var vertexCtor = JsLines.b();\n                        vertexCtor('// x    y    z');\n                        if (this.hasNormals) {\n                            vertexCtor.t('  n.x  n.y  n.z');\n                        }\n                        vertexCtor.t(colorgen.getHeaderString());\n                        var appendVertex = function (iFace, iVertex, firstInFace) {\n                            vertexCtor(cubeVertexPositions[iVertex]);\n                            if (_this2.hasNormals) {\n                                vertexCtor.t(cubeFaceNormals[iFace]);\n                            }\n                            if (_this2.hasColorsPerVertex) {\n                                vertexCtor.t(cubeColors[iVertex]);\n                            } else if (_this2.hasColorsPerFace) {\n                                vertexCtor.t(cubeColors[iFace]);\n                            }\n                            if (firstInFace) {\n                                vertexCtor.t(' // ' + cubeFaceNames[iFace] + ' face');\n                            }\n                        };\n                        var wrapVertices = function () {\n                            return WrapLines.b(JsLines.bae('var vertices=new Float32Array(['), JsLines.bae(']);')).ae(vertexCtor.e());\n                        };\n                        if (!this.usesElements()) {\n                            var _loop = function (i) {\n                                quadToTriangleMap.forEach(function (j, k) {\n                                    appendVertex(i, cubeFaceVertices[i][j], k == 0);\n                                });\n                            };\n                            for (var i = 0; i < nCubeFaces; i++) {\n                                _loop(i);\n                            }\n                            return JsLines.bae('var nVertices=36;', wrapVertices());\n                        } else if (this.hasColorsPerFace || this.hasNormals) {\n                            var _loop2 = function (i) {\n                                cubeFaceVertices[i].forEach(function (j, k) {\n                                    appendVertex(i, j, k == 0);\n                                });\n                            };\n                            // elements, face data\n                            for (var i = 0; i < nCubeFaces; i++) {\n                                _loop2(i);\n                            }\n                            return JsLines.bae(wrapVertices(), 'var nElements=36;', 'var elements=new ' + this.getElementIndexJsArray() + '([', '\\t 0,  1,  2,  2,  1,  3, // left face', '\\t 4,  5,  6,  6,  5,  7, // right face', '\\t 8,  9, 10, 10,  9, 11, // bottom face', '\\t12, 13, 14, 14, 13, 15, // top face', '\\t16, 17, 18, 18, 17, 19, // back face', '\\t20, 21, 22, 22, 21, 23, // front face', ']);');\n                        } else {\n                            var _ret3 = function () {\n                                // elements, no face data\n                                for (var i = 0; i < nCubeVertices; i++) {\n                                    vertexCtor(cubeVertexPositions[i]);\n                                    if (_this2.hasColorsPerVertex) {\n                                        vertexCtor.t(cubeColors[i]);\n                                    }\n                                }\n                                var elementCtor = JsLines.b();\n                                var _loop3 = function (i) {\n                                    elementCtor('');\n                                    quadToTriangleMap.forEach(function (j) {\n                                        elementCtor.t(cubeFaceVertices[i][j] + ', ');\n                                    });\n                                    elementCtor.t('// ' + cubeFaceNames[i] + ' face');\n                                };\n                                for (var i = 0; i < nCubeFaces; i++) {\n                                    _loop3(i);\n                                }\n                                var wrapElements = function () {\n                                    return WrapLines.b(JsLines.bae('var elements=new ' + _this2.getElementIndexJsArray() + '(['), JsLines.bae(']);')).ae(elementCtor.e());\n                                };\n                                return { v: new Lines(wrapVertices(), 'var nElements=36;', wrapElements()) };\n                            }();\n                            if (typeof _ret3 === 'object')\n                                return _ret3.v;\n                        }\n                    };\n                    babelHelpers.createClass(Cube, [\n                        {\n                            key: 'dim',\n                            get: function () {\n                                return 3;\n                            }\n                        },\n                        {\n                            key: 'twoSided',\n                            get: function () {\n                                return false;\n                            }\n                        }\n                    ]);\n                    return Cube;\n                }(Shape);\n                module.exports = Cube;\n            },\n            {\n                '11': 11,\n                '18': 18,\n                '23': 23,\n                '44': 44\n            }\n        ],\n        40: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var LodShape = require(42);\n                var Gasket = function (_LodShape) {\n                    babelHelpers.inherits(Gasket, _LodShape);\n                    function Gasket() {\n                        babelHelpers.classCallCheck(this, Gasket);\n                        return babelHelpers.possibleConstructorReturn(this, _LodShape.apply(this, arguments));\n                    }\n                    Gasket.prototype.getDistinctVertexCount = function getDistinctVertexCount(lodSymbol) {\n                        return '(Math.pow(3,' + lodSymbol + '+1)+3)/2';\n                    };\n                    Gasket.prototype.getFaceVertexCount = function getFaceVertexCount(lodSymbol) {\n                        return 'Math.pow(3,' + lodSymbol + ')*3';\n                    };\n                    Gasket.prototype.getTotalVertexCount = function getTotalVertexCount(lodSymbol) {\n                        return 'Math.pow(3,' + lodSymbol + ')*3';\n                    };\n                    Gasket.prototype.writeStoreShape = function writeStoreShape() {\n                        var _this2 = this;\n                        var writePushVertex = function () {\n                            var a = JsLines.b();\n                            a('vertices[nextIndexIntoVertices++]=p[0];', 'vertices[nextIndexIntoVertices++]=p[1];');\n                            if (_this2.hasColorsPerVertex || _this2.hasColorsPerFace) {\n                                if (!_this2.usesElements() || _this2.hasColorsPerFace) {\n                                    a('colors[nextIndexIntoColors]');\n                                } else {\n                                    a('colors[nextElement%colors.length]');\n                                }\n                                a.t('.forEach(function(cc){', '\\tvertices[nextIndexIntoVertices++]=cc;', '});');\n                            }\n                            if (_this2.usesElements()) {\n                                a('return nextElement++;');\n                            } else if (_this2.hasColorsPerVertex) {\n                                a('nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                            }\n                            return a.e();\n                        };\n                        var writeTriangle = function () {\n                            var a = JsLines.b();\n                            a('if (depth<=0) {');\n                            if (!_this2.usesElements()) {\n                                if (_this2.hasColorsPerFace) {\n                                    a('\\tpushVertex(p0);', '\\tpushVertex(p1);', '\\tpushVertex(p2);', '\\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                                } else {\n                                    a('\\tpushVertex(p0);', '\\tpushVertex(p1);', '\\tpushVertex(p2);');\n                                }\n                            } else {\n                                if (_this2.hasColorsPerFace) {\n                                    a('\\tpushElement(pushVertex(p0));', '\\tpushElement(pushVertex(p1));', '\\tpushElement(pushVertex(p2));', '\\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                                } else {\n                                    a('\\tif (es[0]===null) es[0]=pushVertex(p0);', '\\tif (es[1]===null) es[1]=pushVertex(p1);', '\\tif (es[2]===null) es[2]=pushVertex(p2);', '\\tpushElement(es[0]);', '\\tpushElement(es[1]);', '\\tpushElement(es[2]);', '\\treturn es;');\n                                }\n                            }\n                            a('} else {', '\\tvar p01=mix(p0,p1);', '\\tvar p12=mix(p1,p2);', '\\tvar p20=mix(p2,p0);');\n                            if (!_this2.usesElements()) {\n                                a('\\ttriangle(depth-1,p0,p01,p20);', '\\ttriangle(depth-1,p1,p12,p01);', '\\ttriangle(depth-1,p2,p20,p12);');\n                            } else if (_this2.hasColorsPerFace) {\n                                a('\\tvar es0=triangle(depth-1,p0,p01,p20);', '\\tvar es1=triangle(depth-1,p1,p12,p01);', '\\tvar es2=triangle(depth-1,p2,p20,p12);');\n                            } else {\n                                a('\\tvar es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);', '\\tvar es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);', '\\tvar es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);', '\\treturn [es0[0],es1[0],es2[0]];');\n                            }\n                            a('}');\n                            return a.e();\n                        };\n                        var writeInitialTriangleCall = function () {\n                            var a = JsLines.b();\n                            a('shapeLod,', '[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],', '[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],', '[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]');\n                            if (_this2.usesElements() && !_this2.hasColorsPerFace) {\n                                a.t(',', '[null,null,null]');\n                            }\n                            return a.e();\n                        };\n                        var a = JsLines.b();\n                        a('var nextIndexIntoVertices=0;');\n                        if (this.usesElements()) {\n                            a('var nextIndexIntoElements=0;');\n                            a('var nextElement=0;');\n                        }\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            a('// p = position, cc = color component, e = element, es = elements');\n                            a(this.writeColorData());\n                            if (!this.usesElements() || this.hasColorsPerFace) {\n                                a('var nextIndexIntoColors=0;');\n                            }\n                        } else {\n                            a('// p = position, e = element, es = elements');\n                        }\n                        a(WrapLines.b(JsLines.bae('function pushVertex(p) {'), JsLines.bae('}')).ae(writePushVertex()));\n                        if (this.usesElements()) {\n                            a('function pushElement(e) {', '\\telements[nextIndexIntoElements++]=e;', '}');\n                        }\n                        a('function mix(pa,pb) {', '\\treturn [', '\\t\\t(pa[0]+pb[0])/2,', '\\t\\t(pa[1]+pb[1])/2,', '\\t];', '}', (!this.usesElements() || this.hasColorsPerFace ? WrapLines.b(JsLines.bae('function triangle(depth,p0,p1,p2) {'), JsLines.bae('}')) : WrapLines.b(JsLines.bae('function triangle(depth,p0,p1,p2,es) {'), JsLines.bae('}'))).ae(writeTriangle()), WrapLines.b(JsLines.bae('triangle('), JsLines.bae(');')).ae(writeInitialTriangleCall()));\n                        return a.e();\n                    };\n                    return Gasket;\n                }(LodShape);\n                module.exports = Gasket;\n            },\n            {\n                '11': 11,\n                '18': 18,\n                '42': 42\n            }\n        ],\n        41: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(12);\n                var Mesh = require(43);\n                var Hat = function (_Mesh) {\n                    babelHelpers.inherits(Hat, _Mesh);\n                    function Hat() {\n                        babelHelpers.classCallCheck(this, Hat);\n                        return babelHelpers.possibleConstructorReturn(this, _Mesh.apply(this, arguments));\n                    }\n                    Hat.prototype.writeMeshInit = function writeMeshInit() {\n                        return JsLines.bae('var xyRange=4;', 'var xyScale=1/(4*Math.sqrt(2));');\n                    };\n                    Hat.prototype.writeMeshVertex = function writeMeshVertex() {\n                        var a = JsLines.b();\n                        var iv = 0;\n                        a('var r2=(x*x+y*y)/2;', 'var A=Math.exp(-r2)/Math.PI;', 'var z=A*(1-r2);', 'vertices[vertexOffset+' + iv++ + ']=x*xyScale;', 'vertices[vertexOffset+' + iv++ + ']=y*xyScale;', 'vertices[vertexOffset+' + iv++ + ']=z;');\n                        if (this.hasNormals) {\n                            a('var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);', 'vertices[vertexOffset+' + iv++ + ']=normal[0];', 'vertices[vertexOffset+' + iv++ + ']=normal[1];', 'vertices[vertexOffset+' + iv++ + ']=normal[2];');\n                        }\n                        a(this.writeMeshVertexColors(iv));\n                        return a.e();\n                    };\n                    return Hat;\n                }(Mesh);\n                module.exports = Hat;\n            },\n            {\n                '12': 12,\n                '43': 43\n            }\n        ],\n        42: [\n            function (require, module, exports) {\n                'use strict';\n                var fixOptHelp = require(26);\n                var Input = require(30);\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var IndentLines = require(9);\n                var Listener = require(32);\n                var Colorgen = require(23);\n                var Shape = require(44);\n                var IntFeature = require(31);\n                var LodShape = function (_Shape) {\n                    babelHelpers.inherits(LodShape, _Shape);\n                    function LodShape(options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs) {\n                        babelHelpers.classCallCheck(this, LodShape);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Shape.call(this, options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs));\n                        _this.lod = fixOptHelp.capNumber(options.lod, _this.getMaxPossibleLod(options.lod.max));\n                        _this.features.push(new IntFeature('shape.lod', _this.lod));\n                        return _this;\n                    }\n                    LodShape.prototype.getMaxPossibleLod = function getMaxPossibleLod(requestedMaxLod) {\n                        // due to element index type\n                        if (!this.usesElements() || this.elementIndexBits >= 31) {\n                            // 1<<31 is a negative number, can't compare with it\n                            return requestedMaxLod;    // no need to limit lod if elements are not used or index type is large enough\n                        }\n                        var nVerticesFn = this.hasColorsPerFace ? this.getFaceVertexCount : this.getDistinctVertexCount;\n                        var indexLimit = 1 << this.elementIndexBits;\n                        for (var m = requestedMaxLod; m >= 0; m--) {\n                            var n = eval(nVerticesFn(m));\n                            if (n <= indexLimit) {\n                                return m;\n                            }\n                        }    // TODO fail here\n                    };\n                    LodShape.prototype.writeColorData = function writeColorData() {\n                        var a = JsLines.b();\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        for (var i = 0; i < 4; i++) {\n                            a('[' + colorgen.getNextColorString().slice(1, -1) + '],');\n                        }\n                        return WrapLines.b(JsLines.bae('var colors=['), JsLines.bae('];')).ae(a.e());\n                    };\n                    // abstract getDistinctVertexCount(lodSymbol) {} // # of distinct vertices where one vertex can be shared between different faces and output primitives\n                    // abstract getFaceVertexCount(lodSymbol) {} // # of distinct (vertex,face) pairs that still can be shared between output primitives\n                    // abstract getTotalVertexCount(lodSymbol) {} // # of vertices in output primitives = # of elements when element arrays are in use\n                    // abstract writeStoreShape() {}\n                    LodShape.prototype.writeArraysAndBufferData = function writeArraysAndBufferData(debugArrays) {\n                        var nVerticesFn = this.hasColorsPerFace ? this.getFaceVertexCount : this.getDistinctVertexCount;\n                        var a = JsLines.b();\n                        if (this.lod.input != 'constant') {\n                            a('var minShapeLod=' + this.lod.min + ';', 'var maxShapeLod=' + this.lod.max + ';');\n                            if (this.usesElements()) {\n                                a('var nMaxVertices=' + nVerticesFn('maxShapeLod') + ';', 'var vertices=new Float32Array(nMaxVertices*' + this.getNumbersPerVertex() + ');', 'var nMaxElements=' + this.getTotalVertexCount('maxShapeLod') + ';', 'var elements=new ' + this.getElementIndexJsArray() + '(nMaxElements);', this.writeDebug(debugArrays), 'var shapeLod,nVertices,nElements;', 'function storeShape(newShapeLod) {', '\\tshapeLod=newShapeLod;', '\\tnVertices=' + nVerticesFn('shapeLod') + ';', '\\tnElements=' + this.getTotalVertexCount('shapeLod') + ';');\n                            } else {\n                                a('var nMaxVertices=' + this.getTotalVertexCount('maxShapeLod') + ';', 'var vertices=new Float32Array(nMaxVertices*' + this.getNumbersPerVertex() + ');', this.writeDebug(debugArrays), 'var shapeLod,nVertices;', 'function storeShape(newShapeLod) {', '\\tshapeLod=newShapeLod;', '\\tnVertices=' + this.getTotalVertexCount('shapeLod') + ';');\n                            }\n                        } else {\n                            a('var shapeLod=' + this.lod + ';');\n                            if (this.usesElements()) {\n                                a('var nVertices=' + nVerticesFn('shapeLod') + ';', 'var vertices=new Float32Array(nVertices*' + this.getNumbersPerVertex() + ');', 'var nElements=' + this.getTotalVertexCount('shapeLod') + ';', 'var elements=new ' + this.getElementIndexJsArray() + '(nElements);', this.writeDebug(debugArrays), 'function storeShape() {');\n                            } else {\n                                a('var nVertices=' + this.getTotalVertexCount('shapeLod') + ';', 'var vertices=new Float32Array(nVertices*' + this.getNumbersPerVertex() + ');', this.writeDebug(debugArrays), 'function storeShape() {');\n                            }\n                        }\n                        a(IndentLines.bae(this.writeStoreShape()), IndentLines.bae(this.writeBufferData()), '}');\n                        if (this.lod.input != 'constant') {\n                            a('storeShape(' + this.lod + ');');\n                        } else {\n                            a('storeShape();');\n                        }\n                        return a.e();\n                    };\n                    LodShape.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var a = JsLines.ba(_Shape.prototype.getJsInitLines.call(this, featureContext));\n                        if (this.lod.input == 'slider') {\n                            var listener = new Listener.Slider('shape.lod');\n                            listener.enter().log('console.log(this.id,\\'input value:\\',parseInt(this.value));').post('storeShape(parseInt(this.value));');\n                            a(featureContext.getListenerLines(listener));\n                        } else if (this.lod.input instanceof Input.MouseMove) {\n                            featureContext.canvasMousemoveListener.enter().newVarInt(this.lod.input, 'shapeLod').cond('newShapeLod!=shapeLod').log('console.log(\\'shapeLod input value:\\',newShapeLod);').post('storeShape(newShapeLod);');\n                        }\n                        return a.e();\n                    };\n                    return LodShape;\n                }(Shape);\n                module.exports = LodShape;\n            },\n            {\n                '11': 11,\n                '18': 18,\n                '23': 23,\n                '26': 26,\n                '30': 30,\n                '31': 31,\n                '32': 32,\n                '44': 44,\n                '9': 9\n            }\n        ],\n        43: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var IndentLines = require(9);\n                var LodShape = require(42);\n                var Mesh = function (_LodShape) {\n                    babelHelpers.inherits(Mesh, _LodShape);\n                    function Mesh() {\n                        babelHelpers.classCallCheck(this, Mesh);\n                        return babelHelpers.possibleConstructorReturn(this, _LodShape.apply(this, arguments));\n                    }\n                    Mesh.prototype.getDistinctVertexCount = function getDistinctVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + ')+1,2)';\n                    };\n                    Mesh.prototype.getFaceVertexCount = function getFaceVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + '),2)*4';\n                    };\n                    Mesh.prototype.getTotalVertexCount = function getTotalVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + '),2)*6';\n                    };\n                    Mesh.prototype.writeMeshVertexColors = function writeMeshVertexColors(iv) {\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            return JsLines.bae(!this.usesElements() && !this.hasColorsPerFace ? 'var ic=((i+di)&1)*2+((j+dj)&1);' : 'var ic=(i&1)*2+(j&1);', 'colors[ic].forEach(function(cc,icc){', '\\tvertices[vertexOffset+' + iv + '+icc]=cc;', '});');\n                        } else {\n                            return JsLines.be();\n                        }\n                    };\n                    // abstract writeMeshInit() {}\n                    // abstract writeMeshVertex() {}\n                    Mesh.prototype.writeStoreShape = function writeStoreShape() {\n                        var a = JsLines.b();\n                        a('var res=(1<<shapeLod);');\n                        if (!this.usesElements()) {\n                            a('function vertexElement(i,j,k) {', '\\treturn (i*res+j)*6+k;', '}');\n                        } else if (this.hasColorsPerFace) {\n                            a('function vertexElement(i,j,k) {', '\\treturn (i*res+j)*4+k;', '}');\n                        } else {\n                            a('function vertexElement(i,j) {', '\\treturn i*(res+1)+j;', '}');\n                        }\n                        if (this.hasNormals) {\n                            a('function normalize(v) {', '\\tvar l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);', '\\treturn [v[0]/l,v[1]/l,v[2]/l];', '}');\n                        }\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            a(this.writeColorData());\n                        }\n                        a(this.writeMeshInit());\n                        if (!this.usesElements()) {\n                            a('for (var i=0;i<res;i++) {', '\\tfor (var j=0;j<res;j++) {', '\\t\\tfor (var k=0;k<6;k++) {', '\\t\\t\\tvar di=[0,0,1,1,0,1][k];', '\\t\\t\\tvar dj=[0,1,0,0,1,1][k];', '\\t\\t\\tvar y=(i+di)/res*xyRange*2-xyRange;', '\\t\\t\\tvar x=(j+dj)/res*xyRange*2-xyRange;', '\\t\\t\\tvar vertexOffset=vertexElement(i,j,k)*' + this.getNumbersPerVertex() + ';', IndentLines.b(3).ae(this.writeMeshVertex()), '\\t\\t}', '\\t}', '}');\n                        } else if (this.hasColorsPerFace) {\n                            a('var i,j;', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tfor (var k=0;k<4;k++) {', '\\t\\t\\tvar di=[0,0,1,1][k];', '\\t\\t\\tvar dj=[0,1,0,1][k];', '\\t\\t\\tvar y=(i+di)/res*xyRange*2-xyRange;', '\\t\\t\\tvar x=(j+dj)/res*xyRange*2-xyRange;', '\\t\\t\\tvar vertexOffset=vertexElement(i,j,k)*' + this.getNumbersPerVertex() + ';', IndentLines.b(3).ae(this.writeMeshVertex()), '\\t\\t}', '\\t}', '}', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tvar elementOffset=(i*res+j)*6;', '\\t\\telements[elementOffset+0]=vertexElement(i,j,0);', '\\t\\telements[elementOffset+1]=vertexElement(i,j,1);', '\\t\\telements[elementOffset+2]=vertexElement(i,j,2);', '\\t\\telements[elementOffset+3]=vertexElement(i,j,2);', '\\t\\telements[elementOffset+4]=vertexElement(i,j,1);', '\\t\\telements[elementOffset+5]=vertexElement(i,j,3);', '\\t}', '}');\n                        } else {\n                            a('var i,j;', 'for (i=0;i<=res;i++) {', '\\tvar y=i/res*xyRange*2-xyRange;', '\\tfor (j=0;j<=res;j++) {', '\\t\\tvar x=j/res*xyRange*2-xyRange;', '\\t\\tvar vertexOffset=vertexElement(i,j)*' + this.getNumbersPerVertex() + ';', IndentLines.b(2).ae(this.writeMeshVertex()), '\\t}', '}', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tvar elementOffset=(i*res+j)*6;', '\\t\\telements[elementOffset+0]=vertexElement(i+0,j+0);', '\\t\\telements[elementOffset+1]=vertexElement(i+0,j+1);', '\\t\\telements[elementOffset+2]=vertexElement(i+1,j+0);', '\\t\\telements[elementOffset+3]=vertexElement(i+1,j+0);', '\\t\\telements[elementOffset+4]=vertexElement(i+0,j+1);', '\\t\\telements[elementOffset+5]=vertexElement(i+1,j+1);', '\\t}', '}');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Mesh, [{\n                            key: 'dim',\n                            get: function () {\n                                return 3;\n                            }\n                        }]);\n                    return Mesh;\n                }(LodShape);\n                module.exports = Mesh;\n            },\n            {\n                '11': 11,\n                '42': 42,\n                '9': 9\n            }\n        ],\n        44: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var Feature = require(25);\n                var Shape = function (_Feature) {\n                    babelHelpers.inherits(Shape, _Feature);\n                    function Shape(options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs) {\n                        babelHelpers.classCallCheck(this, Shape);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.elementIndexBits = parseInt(options.elements);\n                        // 0 if don't want element arrays; 8, 16 or 32 bits per element index, limits lod of shape\n                        _this.hasNormals = hasReflections && _this.dim == 3;\n                        // true = need normals, unless shape is flat\n                        _this.hasColorsPerVertex = hasColorsPerVertex;\n                        // TODO support for both hasColorsPerVertex and hasColorsPerFace == true\n                        _this.hasColorsPerFace = hasColorsPerFace;\n                        _this.colorAttrs = colorAttrs;\n                        // array of color attribute structs {name,enabled,weight}\n                        return _this;\n                    }\n                    Shape.prototype.usesElements = function usesElements() {\n                        // TODO convert to getter\n                        return this.elementIndexBits > 0;\n                    };\n                    Shape.prototype.getNumbersPerVertex = function getNumbersPerVertex() {\n                        return this.dim + (this.hasNormals ? 3 : 0) + this.colorAttrs.length * 3;\n                    };\n                    Shape.prototype.getElementIndexJsArray = function getElementIndexJsArray() {\n                        return 'Uint' + this.elementIndexBits + 'Array';\n                    };\n                    Shape.prototype.getElementIndexGlType = function getElementIndexGlType() {\n                        if (this.elementIndexBits == 8) {\n                            return 'gl.UNSIGNED_BYTE';    // not recommended by ms [https://msdn.microsoft.com/en-us/library/dn798776%28v=vs.85%29.aspx]\n                        } else if (this.elementIndexBits == 16) {\n                            return 'gl.UNSIGNED_SHORT';    // mozilla examples use this\n                        } else if (this.elementIndexBits == 32) {\n                            return 'gl.UNSIGNED_INT';    // needs extension\n                        }\n                    };\n                    Shape.prototype.writeDebug = function writeDebug(debugArrays) {\n                        var a = JsLines.b();\n                        if (debugArrays) {\n                            a('console.log(\\'vertex array byte length:\\',vertices.byteLength);');\n                            if (this.usesElements()) {\n                                a('console.log(\\'element array byte length:\\',elements.byteLength);');\n                                a('console.log(\\'vertex+element array byte length:\\',vertices.byteLength+elements.byteLength);');\n                            }\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.writeBufferData = function writeBufferData() {\n                        var a = JsLines.b();\n                        a('gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);');\n                        if (this.usesElements()) {\n                            a('gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);');\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.writeArraysAndBufferData = function writeArraysAndBufferData(debugArrays) {\n                        return JsLines.bae(this.writeArrays(), this.writeDebug(debugArrays), this.writeBufferData());\n                    };\n                    // public:\n                    Shape.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this2 = this;\n                        var writeVertexAttribArrays = function (attrs) {\n                            var cmpSize = attrs[0][0];\n                            var allSameSize = attrs.every(function (attr) {\n                                var size = attr[0];\n                                return size == cmpSize;\n                            });\n                            var allEnabled = true;\n                            var arrayLines = JsLines.bae.apply(JsLines, attrs.map(function (attr) {\n                                var size = attr[0], name = attr[1], enabled = attr[2];\n                                if (enabled) {\n                                    return allSameSize ? '\\'' + name + '\\',' : '[' + size + ',\\'' + name + '\\'],';\n                                } else {\n                                    allEnabled = false;\n                                    return (allSameSize ? 'null,' : '[' + size + ',null],') + ' // attribute ' + name + ' disabled';\n                                }\n                            }));\n                            var foreachEnableLines = JsLines.bae('var attrLoc=gl.getAttribLocation(program,attrName);', 'gl.vertexAttribPointer(', '\\tattrLoc,attrSize,gl.FLOAT,false,', '\\tFloat32Array.BYTES_PER_ELEMENT*bufferStride,', '\\tFloat32Array.BYTES_PER_ELEMENT*bufferOffset', ');', 'gl.enableVertexAttribArray(attrLoc);');\n                            if (!allEnabled) {\n                                foreachEnableLines = WrapLines.b(JsLines.bae('if (name!==null) {'), JsLines.bae('}')).ae(foreachEnableLines);\n                            }\n                            var foreachLines = JsLines.bae.apply(JsLines, (allSameSize ? ['var attrSize=' + cmpSize + ';'] : [\n                                'var attrSize=attr[0];',\n                                'var attrName=attr[1];'\n                            ]).concat([\n                                foreachEnableLines,\n                                'bufferOffset+=attrSize;'\n                            ]));\n                            return WrapLines.b(JsLines.bae('var bufferStride=' + _this2.getNumbersPerVertex() + ';', 'var bufferOffset=0;', ';['), JsLines.bae('].forEach(function(' + (allSameSize ? 'attrName' : 'attr') + '){'), JsLines.bae('});')).ae(arrayLines, foreachLines);\n                        };\n                        var a = JsLines.ba(_Feature.prototype.getJsInitLines.call(this, featureContext));\n                        if (this.elementIndexBits == 32) {\n                            a('gl.getExtension(\\'OES_element_index_uint\\');');    // TODO check if null is returned and don't allow more elements\n                        }\n                        if (this.dim > 2) {\n                            a('gl.enable(gl.DEPTH_TEST);');\n                        }\n                        a('gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());');\n                        if (this.usesElements()) {\n                            a('gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());');\n                        }\n                        a(this.writeArraysAndBufferData(featureContext.debugOptions.arrays));\n                        if (!this.hasNormals && this.colorAttrs.length <= 0) {\n                            a('var positionLoc=gl.getAttribLocation(program,\\'position\\');', 'gl.vertexAttribPointer(positionLoc,' + this.dim + ',gl.FLOAT,false,0,0);', 'gl.enableVertexAttribArray(positionLoc);');\n                        } else {\n                            a(writeVertexAttribArrays([[\n                                    this.dim,\n                                    'position',\n                                    true\n                                ]].concat(this.hasNormals ? [[\n                                    3,\n                                    'normal',\n                                    true\n                                ]] : [], this.colorAttrs.map(function (attr) {\n                                return [\n                                    3,\n                                    attr.name,\n                                    attr.enabled\n                                ];\n                            }))));\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_Feature.prototype.getJsLoopLines.call(this, featureContext));\n                        if (this.usesElements()) {\n                            a('gl.drawElements(gl.' + this.glPrimitive + ',nElements,' + this.getElementIndexGlType() + ',0);');\n                        } else {\n                            a('gl.drawArrays(gl.' + this.glPrimitive + ',0,nVertices);');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Shape, [\n                        {\n                            key: 'dim',\n                            get: function () {\n                                return 2;\n                            }\n                        },\n                        {\n                            key: 'twoSided',\n                            get: function () {\n                                return true;\n                            }    // triangles can be viewed from both sides\n                        },\n                        {\n                            key: 'glPrimitive',\n                            get: function () {\n                                return 'TRIANGLES';\n                            }\n                        }\n                    ]);\n                    return Shape;\n                }(Feature);\n                module.exports = Shape;\n            },\n            {\n                '11': 11,\n                '18': 18,\n                '25': 25\n            }\n        ],\n        45: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var Colorgen = require(23);\n                var Shape = require(44);\n                var Square = function (_Shape) {\n                    babelHelpers.inherits(Square, _Shape);\n                    function Square() {\n                        babelHelpers.classCallCheck(this, Square);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Square.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        var colorDataForFace = undefined;\n                        var writeColorData = function () {\n                            if (_this2.hasColorsPerFace && !_this2.hasColorsPerVertex) {\n                                if (colorDataForFace === undefined) {\n                                    colorDataForFace = colorgen.getNextColorString();\n                                }\n                                return colorDataForFace;\n                            } else {\n                                return colorgen.getNextColorString();\n                            }\n                        };\n                        var a = JsLines.ba('var nVertices=4;', 'var vertices=new Float32Array([', '\\t// x    y' + colorgen.getHeaderString(), '\\t-0.5,-0.5,' + writeColorData(), '\\t+0.5,-0.5,' + writeColorData(), '\\t+0.5,+0.5,' + writeColorData(), '\\t-0.5,+0.5,' + writeColorData(), ']);');\n                        if (this.usesElements()) {\n                            a('var nElements=4;', 'var elements=new ' + this.getElementIndexJsArray() + '([0,1,2,3]);');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Square, [{\n                            key: 'glPrimitive',\n                            get: function () {\n                                return 'TRIANGLE_FAN';\n                            }\n                        }]);\n                    return Square;\n                }(Shape);\n                module.exports = Square;\n            },\n            {\n                '11': 11,\n                '23': 23,\n                '44': 44\n            }\n        ],\n        46: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var Mesh = require(43);\n                var Terrain = function (_Mesh) {\n                    babelHelpers.inherits(Terrain, _Mesh);\n                    function Terrain() {\n                        babelHelpers.classCallCheck(this, Terrain);\n                        return babelHelpers.possibleConstructorReturn(this, _Mesh.apply(this, arguments));\n                    }\n                    Terrain.prototype.writeMeshInit = function writeMeshInit() {\n                        var noFaces = this.usesElements() && !this.hasColorsPerFace;\n                        var a = JsLines.b();\n                        a('var xyRange=1/Math.sqrt(2);', 'var zRange=xyRange;', 'var mask=res-1;', 'function zOffset(i,j) {', '\\treturn vertexElement(i,j' + (noFaces ? '' : ',0') + ')*' + this.getNumbersPerVertex() + '+2;', '}', 'function noise(depth) {', '\\tvar r=zRange/Math.pow(2,shapeLod-depth-1);', '\\treturn Math.random()*2*r-r;', '}', 'vertices[2]=0.0;', 'var i0,i1,i2,i3;', 'var j0,j1,j2,j3;', 'for (var depth=shapeLod-1;depth>=0;depth--) {', '\\tvar d=1<<depth;', '\\t// diamond step', '\\tfor (i2=d;i2<res;i2+=2*d) {', '\\t\\tfor (j2=d;j2<res;j2+=2*d) {', '\\t\\t\\ti1=i2-d;', '\\t\\t\\tj1=j2-d;', '\\t\\t\\ti3=(i2+d)&mask;', '\\t\\t\\tj3=(j2+d)&mask;', '\\t\\t\\tvertices[zOffset(i2,j2)]=(', '\\t\\t\\t\\tvertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+', '\\t\\t\\t\\tvertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t}', '\\t}', '\\t// square step', '\\tfor (i2=d;i2<res;i2+=2*d) {', '\\t\\tfor (j2=d;j2<res;j2+=2*d) {', '\\t\\t\\ti0=(i2-2*d)&mask;', '\\t\\t\\tj0=(j2-2*d)&mask;', '\\t\\t\\ti1=(i2-d);', '\\t\\t\\tj1=(j2-d);', '\\t\\t\\ti3=(i2+d)&mask;', '\\t\\t\\tj3=(j2+d)&mask;', '\\t\\t\\tvertices[zOffset(i2,j1)]=(', '\\t\\t\\t\\tvertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+', '\\t\\t\\t\\tvertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t\\tvertices[zOffset(i1,j2)]=(', '\\t\\t\\t\\tvertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+', '\\t\\t\\t\\tvertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t}', '\\t}', '}');\n                        if (noFaces) {\n                            a('for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];', 'for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];', 'vertices[zOffset(res,res)]=vertices[zOffset(0,0)];');\n                        }\n                        return a.e();\n                    };\n                    Terrain.prototype.writeMeshVertex = function writeMeshVertex() {\n                        var noFaces = this.usesElements() && !this.hasColorsPerFace;\n                        var a = JsLines.b();\n                        a('vertices[vertexOffset+0]=x;', 'vertices[vertexOffset+1]=y;', noFaces ? '// vertices[vertexOffset+2] already written' : 'vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];');\n                        var iv = 3;\n                        if (this.hasNormals) {\n                            a('var d=4*xyRange/res;', 'var normal=normalize([', noFaces ? '\\t(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,' : '\\t(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,', noFaces ? '\\t(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,' : '\\t(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,', '1]);', 'vertices[vertexOffset+' + iv++ + ']=normal[0];', 'vertices[vertexOffset+' + iv++ + ']=normal[1];', 'vertices[vertexOffset+' + iv++ + ']=normal[2];');\n                        }\n                        a(this.writeMeshVertexColors(iv));\n                        return a.e();\n                    };\n                    return Terrain;\n                }(Mesh);\n                module.exports = Terrain;\n            },\n            {\n                '11': 11,\n                '43': 43\n            }\n        ],\n        47: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(11);\n                var Colorgen = require(23);\n                var Shape = require(44);\n                var Triangle = function (_Shape) {\n                    babelHelpers.inherits(Triangle, _Shape);\n                    function Triangle() {\n                        babelHelpers.classCallCheck(this, Triangle);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Triangle.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        var colorDataForFace = undefined;\n                        var writeColorData = function () {\n                            if (_this2.hasColorsPerFace && !_this2.hasColorsPerVertex) {\n                                if (colorDataForFace === undefined) {\n                                    colorDataForFace = colorgen.getNextColorString();\n                                }\n                                return colorDataForFace;\n                            } else {\n                                return colorgen.getNextColorString();\n                            }\n                        };\n                        var a = JsLines.ba('var nVertices=3;', 'var vertices=new Float32Array([', '\\t//                   x                      y' + colorgen.getHeaderString(), '\\t-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),' + writeColorData(), '\\t-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),' + writeColorData(), '\\t-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),' + writeColorData(), ']);');\n                        if (this.usesElements()) {\n                            a('var nElements=3;', 'var elements=new ' + this.getElementIndexJsArray() + '([0,1,2]);');\n                        }\n                        return a.e();\n                    };\n                    return Triangle;\n                }(Shape);\n                module.exports = Triangle;\n            },\n            {\n                '11': 11,\n                '23': 23,\n                '44': 44\n            }\n        ],\n        48: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(12);\n                var Feature = require(25);\n                var GlslVector = require(27);\n                var Transforms = function (_Feature) {\n                    babelHelpers.inherits(Transforms, _Feature);\n                    function Transforms(options) {\n                        babelHelpers.classCallCheck(this, Transforms);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.options = options;\n                        _this.rotateVectorEntries = [];\n                        // [{vector,suffix}] like features, but vectors have additional methods that don't follow feature interfaces\n                        _this.transformSequence = new Array(options.model.entries.length);\n                        // [{vector,component,suffix}]\n                        var possibleComponents = [\n                            'x',\n                            'y',\n                            'z'\n                        ];\n                        var rotate = [\n                            [],\n                            [],\n                            []\n                        ];\n                        options.model.entries.forEach(function (tr, iTr) {\n                            var trData = {\n                                transform: tr,\n                                index: iTr\n                            };\n                            if (tr.type == 'rotate.x') {\n                                rotate[0].push(trData);\n                            } else if (tr.type == 'rotate.y') {\n                                rotate[1].push(trData);\n                            } else if (tr.type == 'rotate.z') {\n                                rotate[2].push(trData);\n                            }\n                        });\n                        var nLayers = Math.max.apply(null, rotate.map(function (r) {\n                            return r.length;\n                        }));\n                        var _loop = function (i) {\n                            var isInGap = false;\n                            var isStraight = true;\n                            var lastStraightIndex = -1;\n                            for (var j = 0; j < 3; j++) {\n                                var has = i < rotate[j].length;\n                                if (isInGap) {\n                                    if (has) {\n                                        isStraight = false;\n                                        break;\n                                    }\n                                } else {\n                                    if (has) {\n                                        lastStraightIndex = j;\n                                    } else {\n                                        isInGap = true;\n                                    }\n                                }\n                            }\n                            var suffix = nLayers > 1 ? String(i) : '';\n                            var makeVector = function (values, names) {\n                                var vector = new GlslVector('rotate' + (nLayers > 1 ? '.' + i : ''), values, true);\n                                vector.i18nId = 'transforms.model.rotate';\n                                _this.features.push(vector);\n                                _this.rotateVectorEntries.push({\n                                    vector: vector,\n                                    suffix: suffix\n                                });\n                                return vector;\n                            };\n                            var storeSequenceElement = function (vector, j) {\n                                _this.transformSequence[rotate[j][i].index] = {\n                                    vector: vector,\n                                    component: possibleComponents[j],\n                                    suffix: suffix\n                                };\n                            };\n                            if (isStraight) {\n                                var vector = makeVector(rotate.slice(0, lastStraightIndex + 1).map(function (r) {\n                                    return r[i].transform;\n                                }), possibleComponents.slice(0, lastStraightIndex + 1));\n                                for (var j = 0; j <= lastStraightIndex; j++) {\n                                    storeSequenceElement(vector, j);\n                                }\n                            } else {\n                                for (var j = 0; j < 3; j++) {\n                                    var has = i < rotate[j].length;\n                                    if (has) {\n                                        var vector = makeVector([rotate[j][i].transform], possibleComponents.slice(j, j + 1));\n                                        storeSequenceElement(vector, j);\n                                    }\n                                }\n                            }\n                        };\n                        for (var i = 0; i < nLayers; i++) {\n                            _loop(i);\n                        }\n                        return _this;\n                    }\n                    // private:\n                    Transforms.prototype.use2dTransform = function use2dTransform(flatShape) {\n                        // has flat shape and exactly one z rotation TODO multiple z rotations\n                        return flatShape && this.options.model.length == 1 && this.options.model[0].type == 'rotate.z';\n                    };\n                    Transforms.prototype.getTransformMatricesLines = function getTransformMatricesLines(dim) {\n                        // dim==3 for normal transform, dim==4 for position transform\n                        var a = Lines.ba('');\n                        var maxSuffixLength = 1;\n                        // TODO calculate it\n                        var width = 4 + maxSuffixLength;\n                        // 1(sign)+3(c.x)+(max suffix length)\n                        var pad = function (e) {\n                            // TODO (fake-)lodash pad\n                            if (e.length < width) {\n                                return ('          ' + e).slice(-width);\n                            } else {\n                                return e;\n                            }\n                        };\n                        var mat = function (rows, comment) {\n                            a.t('*mat' + dim + '( // ' + comment);\n                            rows.forEach(function (row, i) {\n                                if (i >= dim)\n                                    return;\n                                a('\\t');\n                                row.forEach(function (e, j) {\n                                    if (j >= dim)\n                                        return;\n                                    a.t(pad(e));\n                                    if (i < dim - 1 || j < dim - 1)\n                                        a.t(',');\n                                });\n                            });\n                            a(')');\n                        };\n                        this.transformSequence.forEach(function (ts) {\n                            if (!ts)\n                                return;\n                            var c = ts.vector.getGlslMapComponentValue('c' + ts.suffix, ts.component);\n                            var s = ts.vector.getGlslMapComponentValue('s' + ts.suffix, ts.component);\n                            if (ts.component == 'x') {\n                                mat([\n                                    [\n                                        '1.0',\n                                        '0.0',\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        c,\n                                        '-' + s,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        s,\n                                        c,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around x axis');\n                            } else if (ts.component == 'y') {\n                                mat([\n                                    [\n                                        c,\n                                        '0.0',\n                                        s,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '1.0',\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '-' + s,\n                                        '0.0',\n                                        c,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around y axis');\n                            } else if (ts.component == 'z') {\n                                mat([\n                                    [\n                                        c,\n                                        '-' + s,\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        s,\n                                        c,\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '1.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around z axis');\n                            }\n                        });\n                        if (dim == 4 && this.options.projection == 'perspective') {\n                            mat([\n                                [\n                                    '1.0',\n                                    '0.0',\n                                    '0.0',\n                                    '0.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '1.0',\n                                    '0.0',\n                                    '0.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '0.0',\n                                    '1.0',\n                                    '-(near+far)/2.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '0.0',\n                                    '0.0',\n                                    '1.0'\n                                ]\n                            ], 'move center of coords inside view');\n                        }\n                        return a.e();\n                    };\n                    // public:\n                    Transforms.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines(flatShape) {\n                        var a = Lines.b();\n                        this.rotateVectorEntries.forEach(function (rve) {\n                            a(rve.vector.getGlslDeclarationLines());\n                        });\n                        if (this.use2dTransform(flatShape)) {\n                            a('attribute vec2 position;');\n                        } else {\n                            a('attribute vec4 position;');\n                        }\n                        return a.e();\n                    };\n                    Transforms.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines(flatShape, receivesAspect, needTransformedPosition) {\n                        var a = Lines.b();\n                        this.rotateVectorEntries.forEach(function (rve) {\n                            a(rve.vector.getGlslMapDeclarationLines('c' + rve.suffix, function (v) {\n                                return 'cos(radians(' + v + '))';\n                            }), rve.vector.getGlslMapDeclarationLines('s' + rve.suffix, function (v) {\n                                return 'sin(radians(' + v + '))';\n                            }));\n                        });\n                        if (this.options.projection == 'perspective') {\n                            a('float fovy=45.0;', 'float near=1.0/tan(radians(fovy)/2.0);', 'float far=near+2.0;');\n                        }\n                        if (needTransformedPosition) {\n                            a('vec4 transformedPosition=');\n                        } else {\n                            a('gl_Position=');\n                        }\n                        if (this.use2dTransform(flatShape)) {\n                            a.t('vec4(position*mat2(', '\\tcz, -sz,', '\\tsz,  cz', '),0,1)');\n                        } else {\n                            a.t('position');\n                            a.t(this.getTransformMatricesLines(4));\n                        }\n                        if (needTransformedPosition) {\n                            a.t(';');\n                            a('gl_Position=transformedPosition');\n                        }\n                        if (this.options.projection == 'ortho') {\n                            if (receivesAspect) {\n                                a.t('*vec4(1.0/aspect,1.0,-1.0,1.0)');    // correct aspect ratio and make coords right-handed\n                            } else if (!flatShape) {\n                                a.t('*vec4(1.0,1.0,-1.0,1.0)');    // make coords right-handed for 3d shapes\n                            }\n                        } else if (this.options.projection == 'perspective') {\n                            if (receivesAspect) {\n                                a.t('*mat4(', '\\tnear/aspect, 0.0,  0.0,                   0.0,', '\\t0.0,         near, 0.0,                   0.0,', '\\t0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),', '\\t0.0,         0.0,  -1.0,                  0.0', ')');\n                            } else {\n                                a.t('*mat4(', '\\tnear, 0.0,  0.0,                   0.0,', '\\t0.0,  near, 0.0,                   0.0,', '\\t0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),', '\\t0.0,  0.0,  -1.0,                  0.0', ')');\n                            }\n                        }\n                        a.t(';');\n                        return a.e();\n                    };\n                    Transforms.prototype.getGlslVertexNormalTransformLines = function getGlslVertexNormalTransformLines() {\n                        return this.getTransformMatricesLines(3);\n                    };\n                    babelHelpers.createClass(Transforms, [{\n                            key: 'eyeAtInfinity',\n                            get: function () {\n                                return this.options.projection == 'ortho';\n                            }\n                        }]);\n                    return Transforms;\n                }(Feature);\n                module.exports = Transforms;\n            },\n            {\n                '12': 12,\n                '25': 25,\n                '27': 27\n            }\n        ],\n        49: [\n            function (require, module, exports) {\n                'use strict';\n                var camelCase = require(4);\n                var VectorComponent = function () {\n                    function VectorComponent(value, vectorName, wrapMode) {\n                        babelHelpers.classCallCheck(this, VectorComponent);\n                        this.value = value;\n                        // value from options.fix()\n                        this.vectorName = vectorName;\n                        this.wrapMode = !!wrapMode;    // if true and components min/max == their default values, use wrap() instead of clamp()\n                    }\n                    VectorComponent.prototype.hasSpeed = function hasSpeed() {\n                        return this.value.speed != 0 || this.value.speed.input != 'constant';\n                    };\n                    VectorComponent.prototype.hasInput = function hasInput() {\n                        return this.value.input != 'constant' || this.value.speed.input != 'constant';\n                    };\n                    VectorComponent.prototype.hasInputClass = function hasInputClass(inputClass) {\n                        return this.value.input instanceof inputClass || this.value.speed.input instanceof inputClass;\n                    };\n                    VectorComponent.prototype.usesStartTime = function usesStartTime() {\n                        return this.value.input == 'constant' && this.value.speed != 0 && this.value.speed.input == 'constant';\n                    };\n                    VectorComponent.prototype.usesPrevTime = function usesPrevTime() {\n                        return this.value.input != 'constant' && this.value.speed != 0 || this.value.speed.input != 'constant';\n                    };\n                    babelHelpers.createClass(VectorComponent, [\n                        {\n                            key: 'suffix',\n                            get: function () {\n                                var dotIndex = this.value.name.lastIndexOf('.');\n                                if (dotIndex < 0) {\n                                    return this.value.name;\n                                } else {\n                                    return this.value.name.slice(dotIndex + 1);\n                                }\n                            }\n                        },\n                        {\n                            key: 'name',\n                            get: function () {\n                                return this.vectorName + '.' + this.suffix;\n                            }\n                        },\n                        {\n                            key: 'varName',\n                            get: function () {\n                                return camelCase(this.name);\n                            }\n                        },\n                        {\n                            key: 'varNameLoc',\n                            get: function () {\n                                return this.varName + 'Loc';\n                            }\n                        },\n                        {\n                            key: 'varNameSpeed',\n                            get: function () {\n                                return this.varName + 'Speed';\n                            }\n                        },\n                        {\n                            key: 'varNameInput',\n                            get: function () {\n                                return this.varName + 'Input';\n                            }\n                        },\n                        {\n                            key: 'minVarName',\n                            get: function () {\n                                return camelCase('min.' + this.name);\n                            }\n                        },\n                        {\n                            key: 'maxVarName',\n                            get: function () {\n                                return camelCase('max.' + this.name);\n                            }\n                        },\n                        {\n                            key: 'variable',\n                            get: function () {\n                                return this.value.input != 'constant' || this.hasSpeed();\n                            }\n                        },\n                        {\n                            key: 'wrapReady',\n                            get: function () {\n                                return this.wrapMode && this.value.min == this.value.availableMin && this.value.max == this.value.availableMax && // can wrap only if limits are not changed\n                                this.value.min == -this.value.max;\n                            }\n                        },\n                        {\n                            key: 'wrapped',\n                            get: function () {\n                                return this.hasSpeed() && this.wrapReady && this.value.input == 'slider';    // need to wrap only if input with state is used\n                            }\n                        },\n                        {\n                            key: 'clamped',\n                            get: function () {\n                                return !this.wrapped && this.value.speed.input != 'constant' && !this.wrapReady;\n                            }\n                        },\n                        {\n                            key: 'capped',\n                            get: function () {\n                                return !this.wrapped && !this.clamped && this.hasSpeed() && !this.wrapReady;\n                            }\n                        }\n                    ]);\n                    return VectorComponent;\n                }();\n                module.exports = VectorComponent;\n            },\n            { '4': 4 }\n        ],\n        50: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<label for=',\n                        '>',\n                        '</label>'\n                    ], [\n                        '\\t<label for=',\n                        '>',\n                        '</label>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<span class=min>',\n                        '</span>'\n                    ], [\n                        '\\t<span class=min>',\n                        '</span>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' step=any />'\n                    ], [\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' step=any />'\n                    ]), _templateObject4 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<span class=max>',\n                        '</span>'\n                    ], [\n                        '\\t<span class=max>',\n                        '</span>'\n                    ]);\n                var camelCase = require(4);\n                var fixOptHelp = require(26);\n                var Input = require(30);\n                var Lines = require(12);\n                var JsLines = require(11);\n                var WrapLines = require(18);\n                var Listener = require(32);\n                var VectorComponent = require(49);\n                var NumericFeature = require(34);\n                var Vector = function (_NumericFeature) {\n                    babelHelpers.inherits(Vector, _NumericFeature);\n                    function Vector(name, values, wrapMode) {\n                        babelHelpers.classCallCheck(this, Vector);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _NumericFeature.call(this));\n                        _this.name = name;\n                        // name with dots like \"material.color\", transformed into \"materialColor\" for js var names\n                        _this.components = [];\n                        _this.componentsBySuffix = {};\n                        values.forEach(function (v) {\n                            var component = new VectorComponent(v, name, wrapMode);\n                            _this.components.push(component);\n                            _this.componentsBySuffix[component.suffix] = component;\n                        });\n                        // { TODO extra ctor args\n                        _this.i18nId = name;\n                        // }\n                        _this.nVars = 0;\n                        _this.modeConstant = true;\n                        // all vector components are constants\n                        _this.modeFloats = false;\n                        // one/some vector components are variable, such components get their own glsl vars\n                        _this.components.forEach(function (component, i) {\n                            if (component.variable) {\n                                _this.modeConstant = false;\n                                if (_this.nVars++ != i) {\n                                    _this.modeFloats = true;\n                                }\n                            }\n                        });\n                        if (_this.nVars == 1) {\n                            _this.modeFloats = true;\n                        }\n                        _this.modeVector = !_this.modeConstant && !_this.modeFloats;\n                        // first consecutive components are variable, packed into one glsl vector\n                        return _this;\n                    }\n                    // fns that can be mapped over components:\n                    Vector.prototype.makeInitialComponentValue = function makeInitialComponentValue() {\n                        return function (component) {\n                            if (component.value.input == 'slider') {\n                                return 'parseFloat(document.getElementById(\\'' + component.name + '\\').value)';    // b/c slider could be init'd to a value different than the default\n                            } else {\n                                return fixOptHelp.formatNumber(component.value);\n                            }\n                        };\n                    };\n                    Vector.prototype.makeUpdatedComponentValue = function makeUpdatedComponentValue() {\n                        return function (component) {\n                            if (component.value.speed != 0 || component.value.speed.input != 'constant' || component.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad) {\n                                return component.varName;\n                            } else if (component.value.input == 'slider') {\n                                return 'parseFloat(document.getElementById(\\'' + component.name + '\\').value)';\n                            } else {\n                                return fixOptHelp.formatNumber(component.value);\n                            }\n                        };\n                    };\n                    // abstract fns:\n                    Vector.prototype.getJsDeclarationLines = function getJsDeclarationLines() {\n                        return JsLines.be();\n                    };\n                    // Locs etc\n                    Vector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        return JsLines.be();\n                    };\n                    Vector.prototype.addPostToListenerEntryForComponent = function addPostToListenerEntryForComponent(entry, component) {\n                    };\n                    // do necessary entry.post()\n                    Vector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                    };\n                    // TODO check if we need componentValue - GlslVector doesn't use it\n                    // public:\n                    Vector.prototype.hasInputs = function hasInputs() {\n                        return _NumericFeature.prototype.hasInputs.call(this) || this.components.some(function (component) {\n                            return component.hasInput();\n                        });\n                    };\n                    Vector.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        _NumericFeature.prototype.requestFeatureContext.call(this, featureContext);\n                        this.components.forEach(function (component) {\n                            if (component.hasInput())\n                                featureContext.hasInputs = true;\n                            if (component.hasInputClass(Input.Slider))\n                                featureContext.hasSliders = true;\n                            if (component.hasInputClass(Input.Gamepad))\n                                featureContext.pollsGamepad = true;\n                            if (component.usesStartTime())\n                                featureContext.hasStartTime = true;\n                            if (component.usesPrevTime())\n                                featureContext.hasPrevTime = true;\n                            if (component.wrapped)\n                                featureContext.hasWrapFn = true;\n                            if (component.clamped)\n                                featureContext.hasClampFn = true;\n                        });\n                    };\n                    Vector.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        var _this2 = this;\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlControlMessageLines.call(this, i18n));\n                        this.components.forEach(function (component) {\n                            a(_this2.getHtmlControlMessageForValue(i18n, component.value, _this2.i18nId + '.' + component.suffix), _this2.getHtmlControlMessageForValue(i18n, component.value.speed, _this2.i18nId + '.' + component.suffix + '.speed'));\n                        });\n                        return a.e();\n                    };\n                    Vector.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        var _this3 = this;\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlInputLines.call(this, i18n));\n                        var writeInput = function (v, opName, htmlName) {\n                            if (v.input != 'slider')\n                                return;\n                            var fmt = fixOptHelp.makeFormatNumber(v);\n                            a('<div>', Lines.html(_templateObject, htmlName, i18n(opName)), Lines.html(_templateObject2, i18n(opName + '.value', v.min)), Lines.html(_templateObject3, htmlName, fmt(v.min), fmt(v.max), fmt(v)), Lines.html(_templateObject4, i18n(opName + '.value', v.max)), '</div>');\n                        };\n                        this.components.forEach(function (component) {\n                            writeInput(component.value, 'options.' + _this3.i18nId + '.' + component.suffix, component.name);\n                            writeInput(component.value.speed, 'options.' + _this3.i18nId + '.' + component.suffix + '.speed', component.name + '.speed');\n                        });\n                        return a.e();\n                    };\n                    Vector.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this4 = this;\n                        var getSliderListenerLines = function (doUpdate) {\n                            var getManyListenersLines = function () {\n                                var a = JsLines.b();\n                                var writeListener = function (v, htmlName) {\n                                    if (v.input != 'slider')\n                                        return;\n                                    var listener = new Listener.Slider(htmlName);\n                                    var entry = listener.enter();\n                                    entry.log('console.log(this.id,\\'input value:\\',parseFloat(this.value));');\n                                    if (doUpdate) {\n                                        entry.post(_this4.updateFnName + '();');\n                                    }\n                                    a(featureContext.getListenerLines(listener));\n                                };\n                                _this4.components.forEach(function (component) {\n                                    writeListener(component.value, component.name);\n                                    writeListener(component.value.speed, component.name + '.speed');\n                                });\n                                return a.e();\n                            };\n                            var getOneListenerLines = function () {\n                                var listener = new Listener.MultipleSlider('[id^=\"' + _this4.name + '.\"]');\n                                // will also handle speed sliders, but it's ok\n                                var entry = listener.enter();\n                                entry.log('console.log(this.id,\\'input value:\\',parseFloat(this.value));');\n                                if (doUpdate) {\n                                    entry.post(_this4.updateFnName + '();');\n                                }\n                                return featureContext.getListenerLines(listener);\n                            };\n                            var manyListenersLines = getManyListenersLines();\n                            var oneListenerLines = getOneListenerLines();\n                            return manyListenersLines.count() <= oneListenerLines.count() ? manyListenersLines : oneListenerLines;\n                        };\n                        var a = JsLines.ba(_NumericFeature.prototype.getJsInitLines.call(this, featureContext));\n                        a(this.getJsDeclarationLines());\n                        if (this.modeConstant) {\n                            a(this.getJsUpdateLines(this.makeInitialComponentValue()));\n                            return a.e();\n                        }\n                        var someSpeeds = this.components.some(function (component) {\n                            return component.hasSpeed();\n                        });\n                        var someValueSliders = this.components.some(function (component) {\n                            return component.value.input == 'slider';\n                        });\n                        var someGamepads = this.components.some(function (component) {\n                            return component.hasInputClass(Input.Gamepad);\n                        });\n                        this.components.forEach(function (component) {\n                            if (component.value.input instanceof Input.MouseMove && (someValueSliders || someSpeeds || someGamepads) || // mouse input required elsewhere\n                                component.value.speed.input != 'constant' && component.value.input != 'slider'    // variable speed and no value input capable of storing the state\n) {\n                                a('var ' + component.varName + '=' + fixOptHelp.formatNumber(component.value) + ';');\n                            }\n                            if (component.value.speed.input instanceof Input.MouseMove) {\n                                a('var ' + component.varNameSpeed + '=' + fixOptHelp.formatNumber(component.value.speed) + ';');\n                            }\n                        });\n                        if (!someSpeeds && someValueSliders && !someGamepads) {\n                            a(WrapLines.b(JsLines.bae('function ' + this.updateFnName + '() {'), JsLines.bae('}')).ae(this.getJsUpdateLines(this.makeUpdatedComponentValue())), this.updateFnName + '();');\n                        }\n                        a(getSliderListenerLines(!someSpeeds && !someGamepads));\n                        if (this.components.some(function (component) {\n                                return component.value.input instanceof Input.MouseMove;\n                            })) {\n                            (function () {\n                                if (!someSpeeds && !someValueSliders && !someGamepads) {\n                                    a(_this4.getJsUpdateLines(_this4.makeInitialComponentValue()));\n                                }\n                                var entry = featureContext.canvasMousemoveListener.enter();\n                                _this4.components.forEach(function (component) {\n                                    if (component.value.input instanceof Input.MouseMove) {\n                                        var fmt = fixOptHelp.makeFormatNumber(component.value);\n                                        (!someSpeeds && !someValueSliders && !someGamepads ? entry.minMaxVarFloat : entry.minMaxFloat)(component.value.input, component.varName, fmt(component.value.min), fmt(component.value.max));\n                                        entry.log('console.log(\\'' + component.name + ' input value:\\',' + component.varName + ');');\n                                        if (!someSpeeds && !someValueSliders && !someGamepads) {\n                                            _this4.addPostToListenerEntryForComponent(entry, component);\n                                        }\n                                    }\n                                });\n                                if (!someSpeeds && !someGamepads) {\n                                    if (!someValueSliders) {\n                                        _this4.addPostToListenerEntryAfterComponents(entry, _this4.makeUpdatedComponentValue());\n                                    } else {\n                                        entry.post(_this4.updateFnName + '();');\n                                    }\n                                }\n                            }());\n                        }\n                        if (this.components.some(function (component) {\n                                return component.value.speed.input instanceof Input.MouseMove;\n                            })) {\n                            (function () {\n                                var entry = featureContext.canvasMousemoveListener.enter();\n                                _this4.components.forEach(function (component) {\n                                    var fmt = fixOptHelp.makeFormatNumber(component.value.speed);\n                                    if (component.value.speed.input instanceof Input.MouseMove) {\n                                        entry.minMaxFloat(component.value.speed.input, component.varNameSpeed, fmt(component.value.speed.min), fmt(component.value.speed.max)).log('console.log(\\'' + component.name + '.speed input value:\\',' + component.varNameSpeed + ');');\n                                    }\n                                });\n                            }());\n                        }\n                        return a.e();\n                    };\n                    Vector.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_NumericFeature.prototype.getJsLoopLines.call(this, featureContext));\n                        var add = function (s) {\n                            var c = s.charAt(0);\n                            if (c == '-' || c == '+') {\n                                return s;\n                            } else {\n                                return '+' + s;\n                            }\n                        };\n                        var needUpdate = false;\n                        var writeGamepad = function (component, v, dotSuffix, varSuffix) {\n                            if (v.input instanceof Input.Gamepad) {\n                                needUpdate = true;\n                                var fmt = fixOptHelp.makeFormatNumber(v);\n                                a('var ' + component.minVarName + varSuffix + '=' + fmt(v.min) + ';', 'var ' + component.maxVarName + varSuffix + '=' + fmt(v.max) + ';', 'var ' + component.varName + varSuffix + '=' + fmt(v) + ';', 'if (gamepad && gamepad.axes.length>' + v.input.axis + ') {', '\\t' + component.varName + varSuffix + '=' + component.minVarName + varSuffix + '+(' + component.maxVarName + varSuffix + '-' + component.minVarName + varSuffix + ')*(gamepad.axes[' + v.input.axis + ']+1)/2;', '}');\n                                if (featureContext && featureContext.debugOptions.inputs) {\n                                    // TODO always pass featureContext\n                                    a('console.log(\\'' + component.name + dotSuffix + ' input value:\\',' + component.varName + varSuffix + ');');\n                                }\n                            }\n                        };\n                        this.components.forEach(function (component) {\n                            var v = component.value;\n                            writeGamepad(component, v, '', '');\n                            writeGamepad(component, v.speed, '.speed', 'Speed');\n                            if (component.hasSpeed()) {\n                                (function () {\n                                    needUpdate = true;\n                                    var fmt = fixOptHelp.makeFormatNumber(v);\n                                    var sfmt = fixOptHelp.makeFormatNumber(v.speed);\n                                    var addSpeed = undefined;\n                                    if (v.speed.input == 'slider') {\n                                        addSpeed = '+parseFloat(document.getElementById(\\'' + component.name + '.speed\\').value)';\n                                    } else if (v.speed.input instanceof Input.MouseMove || v.speed.input instanceof Input.Gamepad) {\n                                        addSpeed = '+' + component.varNameSpeed;\n                                    } else {\n                                        addSpeed = add(sfmt(v.speed));\n                                    }\n                                    var limitFn = function (x, dx) {\n                                        if (x == component.varName) {\n                                            return dx.charAt(0) + '=' + dx.slice(1);\n                                        } else {\n                                            return '=' + x + dx;\n                                        }\n                                    };\n                                    if (component.wrapped) {\n                                        limitFn = function (x, dx) {\n                                            return '=wrap(' + x + dx + ',' + fmt(v.max) + ')';\n                                        };\n                                    } else if (component.clamped) {\n                                        limitFn = function (x, dx) {\n                                            return '=clamp(' + x + dx + ',' + fmt(v.min) + ',' + fmt(v.max) + ')';\n                                        };\n                                    } else if (component.capped) {\n                                        limitFn = function (x, dx) {\n                                            return '=Math.' + (v.speed < 0 ? 'max' : 'min') + '(' + x + dx + ',' + (v.speed < 0 ? fmt(v.min) : fmt(v.max)) + ')';\n                                        };\n                                    }\n                                    var incrementLine = function (base, dt) {\n                                        return component.varName + limitFn(base, addSpeed + '*' + dt + '/1000') + ';';\n                                    };\n                                    if (v.input == 'slider') {\n                                        a('var ' + component.varNameInput + '=document.getElementById(\\'' + component.name + '\\');', 'var ' + incrementLine('parseFloat(' + component.varNameInput + '.value)', '(time-prevTime)'), component.varNameInput + '.value=' + component.varName + ';');\n                                    } else if (v.input instanceof Input.MouseMove || v.speed.input != 'constant') {\n                                        a(incrementLine(component.varName, '(time-prevTime)'));\n                                    } else {\n                                        a('var ' + incrementLine(fmt(v), '(time-startTime)'));\n                                    }\n                                    if (featureContext && featureContext.debugOptions.animations) {\n                                        // TODO always pass featureContext\n                                        a('console.log(\\'' + component.name + ' animation value:\\',' + component.varName + ');');\n                                    }\n                                }());\n                            }\n                        });\n                        if (needUpdate) {\n                            a(this.getJsUpdateLines(this.makeUpdatedComponentValue()));\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Vector, [\n                        {\n                            key: 'varName',\n                            get: function () {\n                                // js/glsl var name\n                                return camelCase(this.name);\n                            }\n                        },\n                        {\n                            key: 'updateFnName',\n                            get: function () {\n                                return camelCase('update.' + this.name);\n                            }\n                        }\n                    ]);\n                    return Vector;\n                }(NumericFeature);\n                module.exports = Vector;\n            },\n            {\n                '11': 11,\n                '12': 12,\n                '18': 18,\n                '26': 26,\n                '30': 30,\n                '32': 32,\n                '34': 34,\n                '4': 4,\n                '49': 49\n            }\n        ]\n    }, {}, [33]));\n}());","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict'\r\n\r\nmodule.exports=function(strings){\r\n\tconst additionalStringsPrefix='code-output'\r\n\tconst additionalStrings={\r\n\t\t'save': \"Save source code\",\r\n\t\t'run': \"Run in new window\",\r\n\t\t'section.html': \"HTML\",\r\n\t\t'section.css': \"CSS\",\r\n\t\t'section.js': \"JavaScript\",\r\n\t\t'embedded': \"embedded in HTML source code\",\r\n\t\t'mode.full': \"complete HTML\",\r\n\t\t'mode.body': \"only HTML body\",\r\n\t\t'mode.embed': \"embed in HTML\",\r\n\t\t'mode.paste': \"extract to paste into HTML later\",\r\n\t\t'mode.file': \"extract to load as external resource\",\r\n\t\t'warning.no-hljs': \"<a href='https://highlightjs.org/'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.\",\r\n\t}\r\n\tfor (let id in additionalStrings) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst debounce=require('./fake-lodash/debounce')\r\nconst repeat=require('./fake-lodash/repeat')\r\n\r\nclass CodeOutput {\r\n\tconstructor(generateCode,i18n) {\r\n\t\tlet code=generateCode()\r\n\t\tconst $sectionCode={}, $sectionModeInput={}\r\n\t\tlet $indentCheckbox, $indentNumber, $jsSemicolonsCheckbox\r\n\t\tconst getHtmlDataUri=(html)=>'data:text/html;charset=utf-8,'+encodeURIComponent(html)\r\n\t\tconst getCode=()=>code\r\n\t\tconst getFormatting=()=>{\r\n\t\t\tlet indent='\\t'\r\n\t\t\tif (!$indentCheckbox.prop('checked')) {\r\n\t\t\t\tlet n=4\r\n\t\t\t\tif ($indentNumber[0].checkValidity()) {\r\n\t\t\t\t\tn=Number($indentNumber.val())\r\n\t\t\t\t}\r\n\t\t\t\tindent=repeat(' ',n)\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\trefs: this.refs,\r\n\t\t\t\tindent,\r\n\t\t\t\tjsSemicolons: $jsSemicolonsCheckbox.prop('checked'),\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst getSectionModes=()=>({\r\n\t\t\thtml: $sectionModeInput['html'].val(),\r\n\t\t\tcss:  $sectionModeInput['css' ].val(),\r\n\t\t\tjs:   $sectionModeInput['js'  ].val(),\r\n\t\t})\r\n\t\tconst extractCode=()=>{\r\n\t\t\tconst sectionModes=getSectionModes()\r\n\t\t\tconst sections=code.extractSections(sectionModes)\r\n\t\t\tfor (let sectionName in sections) {\r\n\t\t\t\tif (sectionModes[sectionName]=='embed') {\r\n\t\t\t\t\t$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\t\"<p>\"+i18n('code-output.embedded')+\"</p>\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet $code\r\n\t\t\t\t\t$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\t$(\"<pre>\").append(\r\n\t\t\t\t\t\t\t$code=$(\"<code class='\"+sectionName+\"'>\")\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t\t$code.html(\r\n\t\t\t\t\t\tsections[sectionName].getHtml(getFormatting()).join(\"\\n\")\r\n\t\t\t\t\t)\r\n\t\t\t\t\tif (window.hljs) {\r\n\t\t\t\t\t\thljs.highlightBlock($code[0])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst writeFormattingControls=()=>{\r\n\t\t\treturn $(\"<details>\").append(\r\n\t\t\t\t\"<summary>Formatting</summary>\",\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentCheckbox=$(\"<input type='checkbox' checked>\").change(extractCode),\r\n\t\t\t\t\t\t\" indent with tabs\"\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentNumber=$(\"<input type='number' min='0' max='32' value='4' required>\").on('input change',extractCode),\r\n\t\t\t\t\t\t\" spaces per indent\"\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$jsSemicolonsCheckbox=$(\"<input type='checkbox'>\").change(extractCode),\r\n\t\t\t\t\t\t\" JavaScript semicolons\"\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst writeSection=(sectionName)=>{\r\n\t\t\tconst extractable=sectionName!='html'\r\n\t\t\tconst $summary=$(\"<summary>\"+i18n('code-output.section.'+sectionName)+\"</summary>\")\r\n\t\t\tlet $saveButton\r\n\t\t\t$summary.append(\r\n\t\t\t\t\" \",\r\n\t\t\t\t$sectionModeInput[sectionName]=$(\"<select>\").append(\r\n\t\t\t\t\t(sectionName=='html'\r\n\t\t\t\t\t\t? ['full','body']\r\n\t\t\t\t\t\t: ['embed','paste','file']\r\n\t\t\t\t\t).map(mode=>\r\n\t\t\t\t\t\t$(\"<option>\").val(mode).html(i18n('code-output.mode.'+mode))\r\n\t\t\t\t\t)\r\n\t\t\t\t).change(function(){\r\n\t\t\t\t\tif (extractable) {\r\n\t\t\t\t\t\t$saveButton.prop('disabled',this.value=='embed')\r\n\t\t\t\t\t}\r\n\t\t\t\t\textractCode()\r\n\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t/*\r\n\t\t\t\t// doesn't work in IE\r\n\t\t\t\t$(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n\t\t\t\t\t// yes I want a button, but download attr is only available for links\r\n\t\t\t\t\t$(this).attr('href',getHtmlDataUri(\r\n\t\t\t\t\t\tsection.get(this.formatting).join(\"\\n\")\r\n\t\t\t\t\t))\r\n\t\t\t\t})\r\n\t\t\t\t*/\r\n\t\t\t\t$saveButton=$(\"<button type='button'>\"+i18n('code-output.save')+\"</button>\").click(function(){\r\n\t\t\t\t\tconst section=code.extractSections(getSectionModes())[sectionName]\r\n\t\t\t\t\t// http://stackoverflow.com/a/24354303\r\n\t\t\t\t\tconst blob=new Blob(\r\n\t\t\t\t\t\t[section.get(getFormatting()).join(\"\\n\")],\r\n\t\t\t\t\t\t{type:section.mimeType}\r\n\t\t\t\t\t)\r\n\t\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob,section.filename)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst $a=$(\"<a>\")\r\n\t\t\t\t\t\t\t.attr('download',section.filename)\r\n\t\t\t\t\t\t\t.attr('href',URL.createObjectURL(blob))\r\n\t\t\t\t\t\t\t.appendTo('body')\r\n\t\t\t\t\t\t$a.get(0).click()\r\n\t\t\t\t\t\t$a.remove()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tif (extractable) {\r\n\t\t\t\t$saveButton.prop('disabled',$sectionModeInput[sectionName].val()=='embed')\r\n\t\t\t}\r\n\t\t\treturn $(\"<details open>\").append(\r\n\t\t\t\t$summary,\r\n\t\t\t\t$sectionCode[sectionName]=$(\"<div class='code'>\")\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst $output=$(\"<div class='code-output'>\").append(this.writeButtons(getCode,getFormatting,i18n)).append(\r\n\t\t\twriteFormattingControls(),\r\n\t\t\twriteSection('html'),\r\n\t\t\twriteSection('css'),\r\n\t\t\twriteSection('js')\r\n\t\t)\r\n\t\tif (!window.hljs) {\r\n\t\t\t$output.append(\"<p>\"+i18n('code-output.warning.no-hljs')+\"</p>\")\r\n\t\t}\r\n\t\t$output.append(this.writeButtons(getCode,getFormatting,i18n))\r\n\t\textractCode()\r\n\r\n\t\tconst delay=200\r\n\t\tconst update=debounce(()=>{\r\n\t\t\tcode=generateCode()\r\n\t\t\textractCode()\r\n\t\t},delay)\r\n\r\n\t\t// public props:\r\n\t\tthis.$output=$output\r\n\t\tthis.update=update\r\n\t}\r\n\r\n\t// private interface:\r\n\tget refs() {\r\n\t\treturn {}\r\n\t}\r\n\twriteButtons(getCode,getFormatting,i18n) {\r\n\t\treturn $(\"<div>\").append(\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.run')+\"</button>\").click(function(){\r\n\t\t\t\t/*\r\n\t\t\t\t// doesn't work in IE\r\n\t\t\t\twindow.open(getHtmlDataUri(\r\n\t\t\t\t\tcode.get(this.formatting).join(\"\\n\")\r\n\t\t\t\t),\"generatedCode\")\r\n\t\t\t\t*/\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst w=window.open(\"\",\"generatedCode\")\r\n\t\t\t\tw.document.open()\r\n\t\t\t\tw.document.write(\r\n\t\t\t\t\tcode.get(getFormatting()).join(\"\\n\")\r\n\t\t\t\t)\r\n\t\t\t\tw.document.close()\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>Open in CodePen</button>\").click(function(){\r\n\t\t\t\t// http://blog.codepen.io/documentation/api/prefill/\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst sections=code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(getFormatting()).join(\"\\n\")\r\n\t\t\t\t$(\"<form method='post' action='http://codepen.io/pen/define/'>\").append(\r\n\t\t\t\t\t$(\"<input type='hidden' name='data'>\").val(JSON.stringify({\r\n\t\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\t\ttitle: code.title,\r\n\t\t\t\t\t}))\r\n\t\t\t\t).appendTo('body').submit()\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>Open in JSFiddle</button>\").click(function(){\r\n\t\t\t\t// http://doc.jsfiddle.net/api/post.html\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst sections=code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(getFormatting()).join(\"\\n\")\r\n\t\t\t\tconst writeSection=sectionName=>\r\n\t\t\t\t\t$(\"<input type='hidden'>\")\r\n\t\t\t\t\t\t.attr('name',sectionName)\r\n\t\t\t\t\t\t.val(getSection(sectionName))\r\n\t\t\t\t$(\"<form method='post' action='http://jsfiddle.net/api/post/library/pure/'>\").append(\r\n\t\t\t\t\twriteSection('html'),\r\n\t\t\t\t\twriteSection('css'),\r\n\t\t\t\t\twriteSection('js'),\r\n\t\t\t\t\t$(\"<input type='hidden' name='title'>\").val(code.title),\r\n\t\t\t\t\t\"<input type='hidden' name='wrap' value='b'>\"\r\n\t\t\t\t).appendTo('body').submit()\r\n\t\t\t})\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput\r\n","'use strict'\r\n\r\nclass CodeSection {\r\n\tconstructor(filename,mimeType,lines) {\r\n\t\tthis.filename=filename\r\n\t\tthis.mimeType=mimeType\r\n\t\tthis.lines=lines\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.lines.get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.lines.getHtml(formatting)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeSection\r\n","// assumes string is dot-separated, like this: \"some.html.id\"\r\nvar capitalize=require('./capitalize')\r\nmodule.exports=function(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('')\r\n}\r\n","// assumes string is lowercase\r\nmodule.exports=function(s){\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1)\r\n}\r\n","// no options\r\nmodule.exports=function(func,wait){\r\n\tvar timeoutId=null\r\n\treturn function(){\r\n\t\tclearTimeout(timeoutId)\r\n\t\ttimeoutId=setTimeout(func,wait)\r\n\t}\r\n}\r\n","module.exports=function(s){\r\n\tvar entityMap={\r\n\t\t'&': '&amp;',\r\n\t\t'<': '&lt;',\r\n\t\t'>': '&gt;',\r\n\t\t'\"': '&quot;',\r\n\t\t\"'\": '&#39;',\r\n\t\t// lodash also escapes `\r\n\t}\r\n\treturn String(s).replace(/[&<>\"']/g,m=>entityMap[m])\r\n}\r\n","module.exports=function(s,n){\r\n\treturn Array(n+1).join(s)\r\n}\r\n","'use strict'\r\n\r\nconst repeat=require('./fake-lodash/repeat')\r\nconst Lines=require('./lines')\r\n\r\nclass IndentLines extends Lines {\r\n\tconstructor(data,level) {\r\n\t\tsuper(data)\r\n\t\tif (level!==undefined) {\r\n\t\t\tthis.level=level\r\n\t\t} else {\r\n\t\t\tthis.level=1\r\n\t\t}\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst indentStr=repeat(indent,this.level)\r\n\t\treturn super.doGet(formatting,html).map(s=>indentStr+s)\r\n\t}\r\n}\r\n\r\nmodule.exports=IndentLines\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass InterleaveLines extends Lines {\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet first=true\r\n\t\tconst fp=()=>{\r\n\t\t\tif (first) {\r\n\t\t\t\tfirst=false\r\n\t\t\t} else {\r\n\t\t\t\tout.push('')\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (subOut.length>0) {\r\n\t\t\t\t\tfp()\r\n\t\t\t\t\tout.push(...subOut)\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tfp()\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=InterleaveLines\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\n\r\nclass JsLines extends Lines {\r\n\tprocessStringInGet(s,formatting) {\r\n\t\tif (formatting.jsSemicolons) {\r\n\t\t\treturn s.replace(/^;/,'')\r\n\t\t} else {\r\n\t\t\treturn s.replace(/;$/,'')\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=JsLines\r\n","'use strict'\r\n\r\n/*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst repeat=require('./fake-lodash/repeat')\r\n\r\nconst TO={} // TODO Symbol\r\n\r\nclass Lines {\r\n\t// lines private interface:\r\n\tconstructor(data) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError(\"attempted to construct Lines with non-array data argument\")\r\n\t\t}\r\n\t\tthis.data=data\r\n\t}\r\n\tisDataEmpty() {\r\n\t\tfor (let i=0;i<this.data.length;i++) {\r\n\t\t\tconst item=this.data[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tif (!item.isEmpty()) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\tprocessStringInGet(s,formatting) {\r\n\t\treturn s\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet addTo=false\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item===TO) {\r\n\t\t\t\taddTo=true\r\n\t\t\t} else if (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (addTo && subOut.length>0) {\r\n\t\t\t\t\tout.push(out.pop()+subOut.shift())\r\n\t\t\t\t}\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t\taddTo=false\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tlet s=this.processStringInGet(item,formatting)\r\n\t\t\t\tif (formatting.indent!==undefined && formatting.indent!='\\t') {\r\n\t\t\t\t\ts=s.replace(/^(\\t)+/,match=>repeat(formatting.indent,match.length))\r\n\t\t\t\t}\r\n\t\t\t\ts=(html ? escape(s) : s)\r\n\t\t\t\tif (addTo) {\r\n\t\t\t\t\tout.push(out.pop()+s)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout.push(s)\r\n\t\t\t\t}\r\n\t\t\t\taddTo=false\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n\r\n\t// lines public interface:\r\n\tstatic b() {\r\n\t\tconst data=[]\r\n\t\tconst makeLines=()=>new this(data,...arguments)\r\n\t\tconst a=function(){\r\n\t\t\treturn a.a(...arguments)\r\n\t\t}\r\n\t\ta.a=function(){\r\n\t\t\tdata.push(...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.t=function(){\r\n\t\t\tdata.push(TO,...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.e=makeLines\r\n\t\ta.ae=function(){\r\n\t\t\treturn this.a(...arguments).e()\r\n\t\t}\r\n\t\treturn a\r\n\t}\r\n\tstatic ba() {\r\n\t\treturn this.b().a(...arguments)\r\n\t}\r\n\tstatic be() {\r\n\t\treturn this.b().e()\r\n\t}\r\n\tstatic bae() {\r\n\t\treturn this.b().a(...arguments).e()\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tget(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,false)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,true)\r\n\t}\r\n\tcount() {\r\n\t\treturn this.doGet({},false).length // can be faster b/c don't need to output stuff\r\n\t}\r\n\r\n\t// TODO make HtmlLines\r\n\tstatic html(strings/*,...values*/) {\r\n\t\t// html template tag\r\n\t\t// usage example for attributes: Lines.html`<input type=text value=${value}>`\r\n\t\t// usage example for elements: Lines.html`<option>${option}</option>`\r\n\t\treturn strings.reduce((r,s,i)=>{\r\n\t\t\tlet v=arguments[i]\r\n\t\t\tswitch (r.slice(-1)) {\r\n\t\t\tcase '=':\r\n\t\t\t\tif (v===false) {\r\n\t\t\t\t\treturn r.replace(/\\s+[a-zA-Z0-9-]+=$/,'')+s // TODO more permitting attr name regexp\r\n\t\t\t\t} else if (v===true) {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t}\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;')\r\n\t\t\t\tif (v=='') {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t} else if (!/[\\s\"'=<>`]/.test(v)) {\r\n\t\t\t\t\treturn r+v+s\r\n\t\t\t\t} else if (!/'/.test(v)) {\r\n\t\t\t\t\treturn r+\"'\"+v+\"'\"+s\r\n\t\t\t\t} else {\r\n\t\t\t\t\tv=v.replace(/\"/g,'&quot;')\r\n\t\t\t\t\treturn r+'\"'+v+'\"'+s\r\n\t\t\t\t}\r\n\t\t\tcase '>':\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;').replace(/</g,'&lt;')\r\n\t\t\t\treturn r+v+s\r\n\t\t\t}\r\n\t\t\tthrow new Error(\"invalid character before substitution\")\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=Lines\r\n","'use strict'\r\n\r\nconst WrapLines=require('./wrap-lines')\r\n\r\nclass NoseWrapLines extends WrapLines {\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tif (this.isEmpty()) {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\treturn super.doGet(formatting,html)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=NoseWrapLines\r\n","'use strict'\r\n\r\n/*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\r\n\r\nconst Option={}\r\n\r\n// abstract classes\r\n\r\nOption.Base = class {\r\n\tstatic make(name) {\r\n\t\tlet nScalars=0, nArrays=0, nObjects=0\r\n\t\tlet scalarArg, arrayArg=[], objectArg={}\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tlet arg=arguments[i]\r\n\t\t\tif (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\r\n\t\t\t\tif (nScalars++==0) scalarArg=arg\r\n\t\t\t} else if (Array.isArray(arg)) {\r\n\t\t\t\tif (nArrays++==0) arrayArg=arg\r\n\t\t\t} else if (arg instanceof Object) {\r\n\t\t\t\tif (nObjects++==0) objectArg=arg\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst optionClass=this\r\n\t\tconst settings=this.collectArgs(scalarArg,arrayArg,objectArg)\r\n\t\treturn function(){\r\n\t\t\treturn new optionClass(name,settings,...arguments)\r\n\t\t}\r\n\t}\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn settings\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tthis.name=name\r\n\t\tthis.updateCallback=updateCallback\r\n\t\tthis.fullName=fullName\r\n\t\tthis._$=null\r\n\t\tthis.isVisible=()=>true\r\n\t\tthis.fullNamesAffectingVisibility=[]\r\n\t\tif (settings.visibilityData!==undefined) {\r\n\t\t\tthis.isVisible=()=>{\r\n\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\tconst value=optionByFullName[testName].value\r\n\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)<0) {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\tthis.fullNamesAffectingVisibility.push(testName)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $() {\r\n\t\treturn this._$\r\n\t}\r\n\tset $($) {\r\n\t\tthis._$=$\r\n\t\tthis.updateVisibility()\r\n\t}\r\n\tupdateVisibility() {\r\n\t\tif (this.$) this.$.toggle(this.isVisible())\r\n\t}\r\n\tshortenExport(data) { // used by parent\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\treturn data.value\r\n\t\t} else {\r\n\t\t\treturn data\r\n\t\t}\r\n\t}\r\n\tshortenExportAssign(data,parentData,name) {\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\tparentData[name]=data.value\r\n\t\t} else if (dataKeys.length>0) {\r\n\t\t\tparentData[name]=data\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Input = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.defaultValue===undefined) settings.defaultValue=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.defaultValue=settings.defaultValue\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdata=data.value\r\n\t\t}\r\n\t\tif (data!==undefined) {\r\n\t\t\tthis._value=data\r\n\t\t} else {\r\n\t\t\tthis._value=this.defaultValue\r\n\t\t}\r\n\t}\r\n\tget value() {\r\n\t\treturn this._value\r\n\t}\r\n\tset value(value) {\r\n\t\tthis._value=value\r\n\t\tthis.updateCallback()\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value\r\n\t\treturn data\r\n\t}\r\n}\r\n\r\nOption.Boolean = class extends Option.Input {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn super.collectArgs(!!scalarArg,arrayArg,settings)\r\n\t}\r\n\tfix() {\r\n\t\treturn this.value\r\n\t}\r\n}\r\n\r\nOption.NonBoolean = class extends Option.Input {\r\n\tfix() {\r\n\t\tconst value=this.value\r\n\t\treturn { // can't use fixed value in boolean context\r\n\t\t\tname: this.name,\r\n\t\t\tvalue,\r\n\t\t\tvalueOf() { return value },\r\n\t\t\ttoString() { return String(value) },\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Factor = class extends Option.NonBoolean {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableValues===undefined) settings.availableValues=arrayArg\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableValues[0]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableValues=settings.availableValues\r\n\t}\r\n}\r\n\r\nOption.Number = class extends Option.NonBoolean { // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableMin===undefined) settings.availableMin=arrayArg[0]\r\n\t\tif (settings.availableMax===undefined) settings.availableMax=arrayArg[1]\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableMin\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableMin=settings.availableMin\r\n\t\tthis.availableMax=settings.availableMax\r\n\t}\r\n}\r\n\r\nOption.Collection = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.entries=settings.descriptions.map(x=>{\r\n\t\t\tconst subName=x[1]\r\n\t\t\tlet subData\r\n\t\t\tif (typeof data == 'object') subData=data[subName]\r\n\t\t\treturn makeEntry(x,fullName,subData,isInsideArray) // nested option\r\n\t\t})\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tentry.shortenExportAssign(entry.export(),data,entry.name)\r\n\t\t})\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixedEntries=[]\r\n\t\tconst fixed={\r\n\t\t\tname: this.name,\r\n\t\t\tentries: fixedEntries,\r\n\t\t}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tfixedEntries.push(fixed[entry.name]=entry.fix())\r\n\t\t})\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.Void = class extends Option.Base { // useful as array entry w/o settings\r\n\texport() {\r\n\t\treturn {}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Checkbox = class extends Option.Boolean {}\r\n\r\nOption.Select = class extends Option.Factor {}\r\n\r\nOption.Text = class extends Option.Factor {}\r\n\r\nOption.Int = class extends Option.Number {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n}\r\n\r\nOption.Float = class extends Option.Number {\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Root = class extends Option.Collection {}\r\n\r\nOption.Group = class extends Option.Collection {}\r\n\r\nOption.Array = class extends Option.Base { // TODO consider extending Collection\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\tif (settings.typePropertyName===undefined) settings.typePropertyName=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableConstructors=new Map\r\n\t\tsettings.descriptions.forEach(x=>{ // TODO test array inside array\r\n\t\t\tconst type=x[1]\r\n\t\t\tconst ctor=subData=>makeEntry(x,fullName,subData,true)\r\n\t\t\tthis.availableConstructors.set(type,ctor)\r\n\t\t})\r\n\t\tif (settings.typePropertyName!==undefined) {\r\n\t\t\tthis.typePropertyName=settings.typePropertyName\r\n\t\t} else {\r\n\t\t\tthis.typePropertyName='type'\r\n\t\t}\r\n\t\t// populate array entries from data:\r\n\t\tthis._entries=[]\r\n\t\tlet subDatas=[]\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tsubDatas=data\r\n\t\t} else if (typeof data == 'object') {\r\n\t\t\tsubDatas=data.value\r\n\t\t}\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\tfor (let i=0;i<subDatas.length;i++) {\r\n\t\t\tconst subData=subDatas[i]\r\n\t\t\tlet subType=defaultType\r\n\t\t\tif (typeof subData == 'object' && subData[this.typePropertyName]!==undefined) {\r\n\t\t\t\tsubType=subData[this.typePropertyName]\r\n\t\t\t}\r\n\t\t\tlet subCtor=this.availableConstructors.get(subType)\r\n\t\t\tif (subCtor) {\r\n\t\t\t\tthis._entries.push(subCtor(subData))\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget availableTypes() {\r\n\t\tconst types=[]\r\n\t\tthis.availableConstructors.forEach((_,type)=>{\r\n\t\t\ttypes.push(type)\r\n\t\t})\r\n\t\treturn types\r\n\t}\r\n\tget entries() {\r\n\t\treturn this._entries\r\n\t}\r\n\tset entries(entries) {\r\n\t\tthis._entries=entries\r\n\t\tthis.updateCallback()\r\n\t}\r\n\taddEntry(type) {\r\n\t\tconst entry=this.availableConstructors.get(type)()\r\n\t\tthis._entries.push(entry)\r\n\t\tthis.updateCallback()\r\n\t\treturn entry\r\n\t}\r\n\texport() {\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\treturn {\r\n\t\t\tvalue: this._entries.map(entry=>{\r\n\t\t\t\tconst subData=entry.export()\r\n\t\t\t\tconst subType=entry.name\r\n\t\t\t\tif (subType!=defaultType) subData[this.typePropertyName]=subType\r\n\t\t\t\treturn entry.shortenExport(subData)\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t\tentries: this._entries.map(entry=>{\r\n\t\t\t\tconst subFixed=entry.fix()\r\n\t\t\t\tif (typeof subFixed == 'object') subFixed[this.typePropertyName]=entry.name\r\n\t\t\t\treturn subFixed\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\n\r\nclass OptionsOutput {\r\n\tconstructor(options,generateId,i18n) {\r\n\t\tconst optionClassWriters=new Map\r\n\t\tthis.setOptionClassWriters(optionClassWriters)\r\n\t\tfunction write(option) {\r\n\t\t\tlet optionProto=option\r\n\t\t\twhile (optionProto=Object.getPrototypeOf(optionProto)) {\r\n\t\t\t\tconst optionClassWriter=optionClassWriters.get(optionProto.constructor)\r\n\t\t\t\tif (optionClassWriter) {\r\n\t\t\t\t\treturn optionClassWriter(option,write,i18n,generateId)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// public prop:\r\n\t\tthis.$output=write(options.root)\r\n\t}\r\n\t// override this fn for custom writers\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\toptionClassWriters.set(Option.Root,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='options-output'>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Group,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Void,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\")\r\n\t\t\t\t.html(i18n('options.'+option.fullName))\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Checkbox,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\").append(\r\n\t\t\t\t$(\"<input type='checkbox' id='\"+id+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.value)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.value=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\"</label>\"\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label> \",\r\n\t\t\t\t$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>\r\n\t\t\t\t\t\t$(\"<option>\").val(availableValue).html(i18n('options.'+option.fullName+'.'+availableValue))\r\n\t\t\t\t\t)\r\n\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\toption.value=this.value\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Text,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst listId=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label> \",\r\n\t\t\t\t$(\"<input type='text' id='\"+id+\"' list='\"+listId+\"' />\")\r\n\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\toption.value=this.value\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<datalist id='\"+listId+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>$(\"<option>\").text(availableValue))\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Number,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\tconst setInputAttrsAndListeners=($input,getOtherInput)=>setInputAttrs($input)\r\n\t\t\t\t.val(option.value)\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\tconst $that=getOtherInput()\r\n\t\t\t\t\t\t$that.val(this.value)\r\n\t\t\t\t\t\toption.value=parseFloat(this.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $sliderInput,$numberInput\r\n\t\t\tlet $rangeMinInput,$rangeMaxInput\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\",\r\n\t\t\t\t\" <span class='min'>\"+option.availableMin+\"</span> \",\r\n\t\t\t\t$sliderInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='range' id='\"+id+\"'>\"),\r\n\t\t\t\t\t()=>$numberInput\r\n\t\t\t\t),\r\n\t\t\t\t\" <span class='max'>\"+option.availableMax+\"</span> \",\r\n\t\t\t\t$numberInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='number' required>\"),\r\n\t\t\t\t\t()=>$sliderInput\r\n\t\t\t\t),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t$sliderInput.val(option.defaultValue).change()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Array,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tlet $dragged=null\r\n\t\t\tlet $entries\r\n\t\t\tconst updateArrayEntries=()=>{\r\n\t\t\t\toption.entries=$entries.children().map(function(){\r\n\t\t\t\t\treturn $(this).data('option')\r\n\t\t\t\t}).get()\r\n\t\t\t}\r\n\t\t\tconst writeDraggableOption=option=>{\r\n\t\t\t\t// have to make drag handler 'draggable', not the whole item\r\n\t\t\t\t// because inputs and labels don't like to be inside 'draggable'\r\n\t\t\t\t// http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\r\n\t\t\t\treturn $(\"<div class='draggable-with-handle'>\").data('option',option).append(\r\n\t\t\t\t\t$(\"<div draggable='true' tabindex='0' title='\"+i18n('options-output.drag')+\"'>\")\r\n\t\t\t\t\t\t.on('dragstart',function(ev){\r\n\t\t\t\t\t\t\t$dragged=$(this).parent()\r\n\t\t\t\t\t\t\tev.originalEvent.dataTransfer.effectAllowed='move'\r\n\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setData('Text',name)\r\n\t\t\t\t\t\t\tif (ev.originalEvent.dataTransfer.setDragImage) { // doesn't work in IE\r\n\t\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setDragImage($dragged[0],0,0)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t$dragged.addClass('ghost')\r\n\t\t\t\t\t\t\t},0)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.keydown(function(ev){\r\n\t\t\t\t\t\t\tconst $handle=$(this)\r\n\t\t\t\t\t\t\tconst $sorted=$handle.parent()\r\n\t\t\t\t\t\t\tif (ev.keyCode==38) {\r\n\t\t\t\t\t\t\t\t$sorted.prev().before($sorted)\r\n\t\t\t\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t} else if (ev.keyCode==40) {\r\n\t\t\t\t\t\t\t\t$sorted.next().after($sorted)\r\n\t\t\t\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\twriteOption(option),\r\n\t\t\t\t\t$(\"<div tabindex='0' class='delete' title='\"+i18n('options-output.delete')+\"'>\").click(function(){\r\n\t\t\t\t\t\t$(this).parent().remove()\r\n\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t}).keydown(function(ev){\r\n\t\t\t\t\t\tif (ev.keyCode==13 || ev.keyCode==32) {\r\n\t\t\t\t\t\t\t$(this).parent().remove()\r\n\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t).on('dragover',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t\tev.originalEvent.dataTransfer.dropEffect='move'\r\n\t\t\t\t\tconst $target=$(this)\r\n\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\tif ($target.nextAll().is($dragged)) {\r\n\t\t\t\t\t\t\t$target.before($dragged)\r\n\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t} else if ($target.prevAll().is($dragged)) {\r\n\t\t\t\t\t\t\t$target.after($dragged)\r\n\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).on('drop',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t}).on('dragend',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\t$dragged.removeClass('ghost')\r\n\t\t\t\t\t\t$dragged=null\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\toption.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\t\t$entries=$(\"<div>\").append(option.entries.map(writeDraggableOption))\r\n\t\t\t)\r\n\t\t\tconst $buttons=$(\"<div>\")\r\n\t\t\toption.availableTypes.forEach((type,i)=>{\r\n\t\t\t\tif (i) $buttons.append(\" \")\r\n\t\t\t\t$buttons.append(\r\n\t\t\t\t\t$(\"<button type='button'>\").html(\r\n\t\t\t\t\t\ti18n('options.'+option.fullName+'.'+type+'.add')\r\n\t\t\t\t\t).click(function(){\r\n\t\t\t\t\t\tconst entry=option.addEntry(type)\r\n\t\t\t\t\t\t$entries.append(writeDraggableOption(entry))\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\toption.$.append($buttons)\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nclass Options {\r\n\tconstructor(data) { // data = imported values, import is done in ctor to avoid calling updateCallback later\r\n\t\tthis.updateCallback=undefined // general update callback for stuff like regenerating the code\r\n\t\tconst simpleUpdateCallback=()=>{\r\n\t\t\tif (this.updateCallback) this.updateCallback()\r\n\t\t}\r\n\t\tconst Option=this.optionClasses\r\n\t\tconst optionByFullName={}\r\n\t\tconst optionsWithVisibilityAffectedByFullName={}\r\n\t\tconst makeEntry=(description,parentfullName,data,isInsideArray)=>{\r\n\t\t\tconst className=description[0]\r\n\t\t\tif (Option[className]===undefined) {\r\n\t\t\t\tthrow new Error(`invalid option type '${className}'`)\r\n\t\t\t}\r\n\t\t\tconst name=description[1]\r\n\t\t\tlet fullName=name\r\n\t\t\tif (parentfullName!==null) {\r\n\t\t\t\tfullName=parentfullName+'.'+name\r\n\t\t\t}\r\n\t\t\tconst makeArgs=description.slice(1)\r\n\t\t\tlet updateCallback\r\n\t\t\tif (isInsideArray) {\r\n\t\t\t\tupdateCallback=simpleUpdateCallback\r\n\t\t\t} else {\r\n\t\t\t\tupdateCallback=()=>{\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[fullName]!==undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[fullName].forEach(option=>{\r\n\t\t\t\t\t\t\toption.updateVisibility()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.updateCallback) this.updateCallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst option=Option[className].make(...makeArgs)(\r\n\t\t\t\tdata,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray\r\n\t\t\t)\r\n\t\t\tif (!isInsideArray) {\r\n\t\t\t\toptionByFullName[fullName]=option\r\n\t\t\t\toption.fullNamesAffectingVisibility.forEach(testName=>{\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[testName]===undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName]=[]\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName].push(option)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn option\r\n\t\t}\r\n\t\tthis.root=Option.Root.make(null,this.entriesDescription)(\r\n\t\t\tdata,null,optionByFullName,simpleUpdateCallback,makeEntry,false\r\n\t\t)\r\n\t}\r\n\t// methods to be redefined by subclasses\r\n\t// TODO make them static?\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn []\r\n\t}\r\n\t// public methods\r\n\texport() {\r\n\t\treturn this.root.shortenExport(this.root.export())\r\n\t}\r\n\tfix() {\r\n\t\treturn this.root.fix()\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\nconst NoseWrapLines=require('./nose-wrap-lines')\r\nconst CodeSection=require('./code-section')\r\n\r\nclass WebCode {\r\n\t// public:\r\n\tget filename() {\r\n\t\treturn this.basename+'.html'\r\n\t}\r\n\tget mimeType() {\r\n\t\treturn 'text/html'\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.getLines().get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.getLines().getHtml(formatting)\r\n\t}\r\n\textractSections(sectionModes) {\r\n\t\tif (sectionModes===undefined) {\r\n\t\t\tsectionModes={}\r\n\t\t}\r\n\t\tlet stylePlaceLines=NoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines)\r\n\t\tlet styleExtractLines=Lines.be()\r\n\t\tif (sectionModes.css=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tstylePlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tstylePlaceLines=Lines.bae(\"<!-- <style> \"+this.getSectionPasteComment('css')+\" </style> -->\")\r\n\t\t\t}\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t} else if (sectionModes.css=='file') {\r\n\t\t\tstylePlaceLines=Lines.bae(Lines.html`<link rel=stylesheet href=${this.basename+'.css'}>`)\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t}\r\n\t\tlet scriptPlaceLines=NoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\tlet scriptExtractLines=Lines.be()\r\n\t\tif (sectionModes.js=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tscriptPlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tscriptPlaceLines=Lines.bae(\"<!-- <script> \"+this.getSectionPasteComment('js')+\" </script> -->\")\r\n\t\t\t}\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t} else if (sectionModes.js=='file') {\r\n\t\t\tscriptPlaceLines=Lines.bae(Lines.html`<script src=${this.basename+'.js'}></script>`)\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t}\r\n\t\tlet htmlExtractLines\r\n\t\tif (sectionModes.html=='body') {\r\n\t\t\thtmlExtractLines=this.getBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t} else {\r\n\t\t\thtmlExtractLines=this.getFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t}\r\n\t\tconst type=sectionName=>'text/'+(sectionName=='js'?'javascript':sectionName)\r\n\t\treturn {\r\n\t\t\thtml: new CodeSection(this.filename,type('html'),htmlExtractLines),\r\n\t\t\tcss:  new CodeSection(this.basename+'.css',type('css'),styleExtractLines),\r\n\t\t\tjs:   new CodeSection(this.basename+'.js',type('js'),scriptExtractLines),\r\n\t\t}\r\n\t}\r\n\t// get title()\r\n\r\n\t// private:\r\n\tgetLines() {\r\n\t\treturn this.getFullHtmlSectionLines(\r\n\t\t\tNoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines),\r\n\t\t\tNoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\t)\r\n\t}\r\n\tgetFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\tconst a=Lines.b()\r\n\t\ta(\"<!DOCTYPE html>\")\r\n\t\tif (this.lang!==null) {\r\n\t\t\ta(Lines.html`<html lang=${this.lang}>`)\r\n\t\t} else {\r\n\t\t\ta(\"<html>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"<head>\",\r\n\t\t\t\"<meta charset=utf-8>\"\r\n\t\t)\r\n\t\tif (this.title!==null) {\r\n\t\t\ta(\"<title>\"+this.title+\"</title>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\t\"</head>\",\r\n\t\t\t\"<body>\",\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines,\r\n\t\t\t\"</body>\",\r\n\t\t\t\"</html>\"\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n\tgetBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\treturn Lines.bae(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines\r\n\t\t)\r\n\t}\r\n\tget cachedStyleLines()  { if (!this._styleLines)  this._styleLines =this.styleLines;  return this._styleLines  }\r\n\tget cachedHeadLines()   { if (!this._headLines)   this._headLines  =this.headLines;   return this._headLines   }\r\n\tget cachedBodyLines()   { if (!this._bodyLines)   this._bodyLines  =this.bodyLines;   return this._bodyLines   }\r\n\tget cachedScriptLines() { if (!this._scriptLines) this._scriptLines=this.scriptLines; return this._scriptLines }\r\n\r\n\t// to be redefined in subclasses:\r\n\tget basename() { // filename base\r\n\t\treturn 'source'\r\n\t}\r\n\tget lang() { // language tag for <html lang=xx> or null to skip it - likely read from i18n\r\n\t\treturn null\r\n\t}\r\n\tget title() { // page title or null to skip it\r\n\t\treturn null\r\n\t}\r\n\tget styleLines() { // contents of <style>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget headLines() { // contents of <head> following <style>, goes to <body> in html body mode\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget bodyLines() { // contents of <body> preceding <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget scriptLines() { // contents of <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetSectionPasteComment(sectionName) { // section placeholder comment in paste mode - likely to be overridden with i18n\r\n\t\treturn sectionName+\" goes here\"\r\n\t}\r\n}\r\n\r\nmodule.exports=WebCode\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass WrapLines extends Lines {\r\n\tconstructor(data) {\r\n\t\tsuper(data)\r\n\t\tthis.wrappers=[]\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tthis.wrappers.push(arguments[i])\r\n\t\t}\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn false\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst out=[]\r\n\t\tlet i=0\r\n\t\tconst pushWrapper=()=>{\r\n\t\t\tconst item=this.wrappers[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\tpushWrapper()\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut.map(s=>indent+s))\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(indent+s)\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.wrappers.length==2) {\r\n\t\t\tpushWrapper()\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=WrapLines\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Feature=require('./feature')\r\nconst CallVector=require('./call-vector')\r\n\r\nclass Background extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.isSolid=(options.type=='solid')\r\n\t\tif (this.isSolid) {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tnew CallVector('background.color',options.color.entries,'gl.clearColor',[0,0,0,0])\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.isSolid) {\r\n\t\t\ta(\"gl.clear(gl.COLOR_BUFFER_BIT);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Background\r\n","'use strict'\r\n\r\nconst fixOptHelp=require('./fixed-options-helpers')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass CallVector extends Vector {\r\n\tconstructor(name,values,calledFn,calledFnDefaultArgs) {\r\n\t\tsuper(name,values)\r\n\t\tthis.calledFn=calledFn\r\n\t\tthis.calledFnDefaultArgs=calledFnDefaultArgs\r\n\t}\r\n\t// private:\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet nValueSliders=0\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tnValueSliders+=component.value.input=='slider'\r\n\t\t})\r\n\t\tif (this.modeConstant && this.components.every((component,i)=>component.value==this.calledFnDefaultArgs[i])) {\r\n\t\t\t// equal to default values, don't do anything\r\n\t\t} else if (nValueSliders<=1) {\r\n\t\t\ta(this.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\")\r\n\t\t} else if (this.components.every(component=>component.value.input=='slider')) {\r\n\t\t\tlet obj=this.calledFn\r\n\t\t\tconst dotIndex=obj.lastIndexOf('.')\r\n\t\t\tif (dotIndex>=0) {\r\n\t\t\t\tobj=obj.slice(0,dotIndex)\r\n\t\t\t}\r\n\t\t\tconst suffixArray=\"[\"+this.components.map(component=>\"'\"+component.suffix+\"'\").join(\",\")+\"]\"\r\n\t\t\ta(\r\n\t\t\t\tthis.calledFn+\".apply(\"+obj+\",\"+suffixArray+\".map(function(c){\",\r\n\t\t\t\t\"\treturn parseFloat(document.getElementById('\"+this.name+\".'+c).value);\",\r\n\t\t\t\t\"}));\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(this.calledFn+\"(\")\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i>0) {\r\n\t\t\t\t\ta.t(\",\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\ta(\r\n\t\t\t\t\");\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tentry.post(\r\n\t\t\tthis.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\"\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CallVector\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Listener=require('./listener-classes')\r\nconst Feature=require('./feature')\r\nconst IntFeature=require('./int-feature')\r\n\r\nclass Canvas extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.width=options.width\r\n\t\tthis.height=options.height\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('canvas.width' ,options.width),\r\n\t\t\tnew IntFeature('canvas.height',options.height)\r\n\t\t)\r\n\t}\r\n\tgetHtmlCanvasLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\t\"<div>\",\r\n\t\t\tLines.html`\t<canvas id=myCanvas width=${this.width} height=${this.height}></canvas>`,\r\n\t\t\t\"</div>\"\r\n\t\t)\r\n\t}\r\n\tgetGlslVertexDeclarationLines() {\r\n\t\tif (this.hasInputs()) {\r\n\t\t\treturn Lines.bae(\"uniform float aspect;\")\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tgetGlslVertexOutputLines() {\r\n\t\tconst needAspectConstant=!this.hasInputs() && Number(this.width)!=Number(this.height)\r\n\t\tif (needAspectConstant) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float aspect=\"+this.width+\".0/\"+this.height+\".0;\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tprovidesAspect() {\r\n\t\treturn this.hasInputs() || Number(this.width)!=Number(this.height)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tconst canvasUpdater=()=>{\r\n\t\t\ta(\r\n\t\t\t\t\"function updateAspect() {\",\r\n\t\t\t\t\"\tgl.viewport(0,0,canvas.width,canvas.height);\",\r\n\t\t\t\t\"\tgl.uniform1f(aspectLoc,canvas.width/canvas.height);\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"updateAspect();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst canvasListener=wh=>{\r\n\t\t\tif (this[wh].input=='slider') {\r\n\t\t\t\tconst listener=new Listener.Slider('canvas.'+wh)\r\n\t\t\t\tlistener.enter()\r\n\t\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t\t.post(\"canvas.\"+wh+\"=parseInt(this.value);\")\r\n\t\t\t\t\t.post(\"updateAspect();\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.hasInputs()) {\r\n\t\t\ta(\"var aspectLoc=gl.getUniformLocation(program,'aspect');\")\r\n\t\t\tcanvasUpdater()\r\n\t\t\tcanvasListener('width')\r\n\t\t\tcanvasListener('height')\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Canvas\r\n","'use strict'\r\n\r\nconst Shape=require('./shape-classes')\r\nconst FeatureContext=require('./feature-context')\r\nconst Canvas=require('./canvas')\r\nconst Background=require('./background')\r\nconst Transforms=require('./transforms')\r\nconst Illumination=require('./illumination')\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst BaseWebCode=require('crnx-base/web-code')\r\n\r\nclass Code extends BaseWebCode {\r\n\tconstructor(options,i18n) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.i18n=i18n\r\n\t\tthis.featureContext=new FeatureContext(options.debug)\r\n\t\tthis.canvas=new Canvas(options.canvas)\r\n\t\tthis.background=new Background(options.background)\r\n\t\tthis.transforms=new Transforms(options.transforms)\r\n\t\tthis.illumination=new Illumination(options.material,options.light)\r\n\t\tconst makeShape=()=>{\r\n\t\t\treturn new Shape[String(options.shape.type)](\r\n\t\t\t\toptions.shape,\r\n\t\t\t\toptions.light.type!='off',\r\n\t\t\t\toptions.material.scope=='vertex',\r\n\t\t\t\toptions.material.scope=='face',\r\n\t\t\t\tthis.illumination.getColorAttrs()\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.shape=makeShape()\r\n\t\tthis.features=[\r\n\t\t\tthis.canvas,\r\n\t\t\tthis.background,\r\n\t\t\tthis.transforms,\r\n\t\t\tthis.illumination,\r\n\t\t\tthis.shape,\r\n\t\t]\r\n\t\tthis.featureNames=[\r\n\t\t\t'canvas',\r\n\t\t\t'background',\r\n\t\t\t'transforms',\r\n\t\t\t'illumination',\r\n\t\t\t'shape',\r\n\t\t]\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(this.featureContext)\r\n\t\t})\r\n\t}\r\n\tget basename() {\r\n\t\treturn 'webgl'\r\n\t}\r\n\tget lang() {\r\n\t\treturn 'en'\r\n\t}\r\n\tget title() {\r\n\t\treturn \"WebGL example - Generated code\"\r\n\t}\r\n\tget styleLines() {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.featureContext.hasSliders) {\r\n\t\t\ta(\r\n\t\t\t\t\"label {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 15em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".min {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 4em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".max {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 4em;\",\r\n\t\t\t\t\"\ttext-align: left;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tget headLines() {\r\n\t\tconst getVertexShaderLines=()=>{\r\n\t\t\tconst needTransformedPosition=this.illumination.wantsTransformedPosition(this.transforms.eyeAtInfinity)\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\tthis.canvas.getGlslVertexDeclarationLines(),\r\n\t\t\t\tthis.transforms.getGlslVertexDeclarationLines(this.shape.dim==2),\r\n\t\t\t\tthis.illumination.getGlslVertexDeclarationLines(this.transforms.eyeAtInfinity,this.shape.dim>2),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.canvas.getGlslVertexOutputLines(),\r\n\t\t\t\t\tthis.transforms.getGlslVertexOutputLines(this.shape.dim==2,this.canvas.providesAspect(),needTransformedPosition),\r\n\t\t\t\t\tthis.illumination.getGlslVertexOutputLines(this.transforms.eyeAtInfinity,this.shape.hasNormals,this.transforms.getGlslVertexNormalTransformLines())\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst getFragmentShaderLines=()=>{\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"precision mediump float;\",\r\n\t\t\t\tthis.illumination.getGlslFragmentDeclarationLines(this.transforms.eyeAtInfinity),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.illumination.getGlslFragmentOutputLines(this.transforms.eyeAtInfinity,this.shape.twoSided)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn Lines.bae(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myVertexShader type=x-shader/x-vertex>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetVertexShaderLines()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myFragmentShader type=x-shader/x-fragment>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetFragmentShaderLines()\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\tget bodyLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\tthis.canvas.getHtmlCanvasLines(),\r\n\t\t\tNoseWrapLines.b(\r\n\t\t\t\t\"<ul>\",\r\n\t\t\t\t\"</ul>\"\r\n\t\t\t).ae(\r\n\t\t\t\t...this.features.map(feature=>feature.getHtmlControlMessageLines(this.i18n))\r\n\t\t\t),\r\n\t\t\t...this.features.map(feature=>feature.getHtmlInputLines(this.i18n))\r\n\t\t)\r\n\t}\r\n\tget scriptLines() {\r\n\t\tconst getMakeProgramLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"var vertexShader=gl.createShader(gl.VERTEX_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(vertexShader,vertexShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(vertexShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(fragmentShader,fragmentShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(fragmentShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var program=gl.createProgram();\",\r\n\t\t\t\t\"gl.attachShader(program,vertexShader);\",\r\n\t\t\t\t\"gl.attachShader(program,fragmentShader);\",\r\n\t\t\t\t\"gl.linkProgram(program);\",\r\n\t\t\t\t\"return program;\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInitLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function makeProgram(vertexShaderSrc,fragmentShaderSrc) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tgetMakeProgramLines()\r\n\t\t\t\t),\r\n\t\t\t\t\"var canvas=document.getElementById('myCanvas');\",\r\n\t\t\t\t\"var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');\",\r\n\t\t\t\t\"var program=makeProgram(\",\r\n\t\t\t\t\"\tdocument.getElementById('myVertexShader').text,\",\r\n\t\t\t\t\"\tdocument.getElementById('myFragmentShader').text\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.useProgram(program);\"\r\n\t\t\t)\r\n\t\t\tconst addWithCommentIfNotEmpty=(featureLines,comment)=>{\r\n\t\t\t\tif (featureLines.count()>0) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\",\r\n\t\t\t\t\t\t\"// \"+comment, // TODO i18n\r\n\t\t\t\t\t\tfeatureLines\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.features.forEach((feature,i)=>{\r\n\t\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\t\tfeature.getJsInitLines(this.featureContext),\r\n\t\t\t\t\t\"init \"+this.featureNames[i]\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\tthis.featureContext.getJsAfterInitLines(),\r\n\t\t\t\t\"init mousemove listener\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInnerLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasClampFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function clamp(v,min,max) {\",\r\n\t\t\t\t\t\"\treturn Math.min(Math.max(v,min),max);\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.hasWrapFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function wrap(v,maxAbs) {\",\r\n\t\t\t\t\t\"\tv%=maxAbs*2;\",\r\n\t\t\t\t\t\"\tif (Math.abs(v)<=maxAbs) return v;\",\r\n\t\t\t\t\t\"\treturn v-(v>0?1:-1)*maxAbs*2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.pollsGamepad) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var gamepad;\",\r\n\t\t\t\t\t\"var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);\",\r\n\t\t\t\t\t\"for (var i=0;i<gamepads.length;i++) {\",\r\n\t\t\t\t\t\"\tif (gamepads[i]) {\",\r\n\t\t\t\t\t\"\t\tgamepad=gamepads[i];\",\r\n\t\t\t\t\t\"\t\tbreak;\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t...this.features.map(feature=>feature.getJsLoopLines(this.featureContext))\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasStartTime && this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t\ta(\"var prevTime=startTime;\")\r\n\t\t\t} else if (this.featureContext.hasStartTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t} else if (this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var prevTime=performance.now();\")\r\n\t\t\t}\r\n\t\t\t// wrap inner render lines in function if needed\r\n\t\t\tif (this.featureContext.isAnimated) {\r\n\t\t\t\tif (this.featureContext.hasTime) {\r\n\t\t\t\t\ta(\"function renderFrame(time) {\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"function renderFrame() {\")\r\n\t\t\t\t}\r\n\t\t\t\ta(IndentLines.bae(getJsInnerLoopLines()))\r\n\t\t\t\tif (this.featureContext.hasPrevTime) {\r\n\t\t\t\t\ta(\"\tprevTime=time;\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\trequestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"requestAnimationFrame(renderFrame);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.featureContext.hasInputs) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var frameId=null;\",\r\n\t\t\t\t\t\"function renderFrame() {\",\r\n\t\t\t\t\tIndentLines.bae(getJsInnerLoopLines()),\r\n\t\t\t\t\t\"\tframeId=null;\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"function scheduleFrame() {\",\r\n\t\t\t\t\t\"\tif (frameId===null) {\",\r\n\t\t\t\t\t\"\t\tframeId=requestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"scheduleFrame();\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(getJsInnerLoopLines())\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\treturn InterleaveLines.bae(\r\n\t\t\tgetJsInitLines(),\r\n\t\t\tgetJsLoopLines()\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=Code","var colorgenCounter=0;\r\n\r\nvar SingleColorgen=function(weight,noise,baseColors){\r\n\tthis.weight=weight;\r\n\tthis.noise=noise;\r\n\tif (noise===undefined) this.noise=0.4;\r\n\tthis.baseColors=baseColors||this.defaultBaseColors;\r\n\tthis.colorgenNumber=colorgenCounter++;\r\n\tthis.nextIndex=0;\r\n};\r\nSingleColorgen.prototype.defaultBaseColors=[\r\n\t[1.0, 0.0, 0.0], // TODO 'cube' color order, when cube is not ugly\r\n\t[0.0, 1.0, 0.0],\r\n\t[0.0, 0.0, 1.0],\r\n\t[1.0, 1.0, 0.0],\r\n\t[1.0, 0.0, 1.0],\r\n\t[0.0, 1.0, 1.0],\r\n];\r\nSingleColorgen.prototype.getNextColorString=function(){\r\n\tvar baseColor=this.baseColors[this.nextIndex];\r\n\tthis.nextIndex=(this.nextIndex+1)%this.baseColors.length;\r\n\treturn baseColor.map(function(ci,i){\r\n\t\tvar s=Math.sin(this.colorgenNumber*9000+this.nextIndex*400+i*100);\r\n\t\tvar co=(ci*(1-this.noise)+s*s*this.noise)*this.weight;\r\n\t\treturn \" \"+co.toFixed(1)+\",\";\r\n\t},this).join(\"\");\r\n};\r\n\r\nvar Colorgen=function(colorAttrs,noise,baseColors){\r\n\tthis.colorAttrs=colorAttrs;\r\n\tthis.singleColorgens=this.colorAttrs.map(function(attr){\r\n\t\treturn new SingleColorgen(attr.weight,noise,baseColors);\r\n\t});\r\n};\r\nColorgen.prototype.getHeaderString=function(){\r\n\treturn this.colorAttrs.map(function(){\r\n\t\treturn \"    r    g    b\";\r\n\t}).join(\"\");\r\n};\r\nColorgen.prototype.getNextColorString=function(){\r\n\treturn this.singleColorgens.map(function(singleColorgen){\r\n\t\treturn singleColorgen.getNextColorString();\r\n\t}).join(\"\");\r\n};\r\n\r\nmodule.exports=Colorgen;\r\n","'use strict'\r\n\r\nconst Listener=require('./listener-classes')\r\n\r\nclass FeatureContext {\r\n\tconstructor(debugOptions) {\r\n\t\tthis.debugOptions=debugOptions\r\n\t\tthis.canvasMousemoveListener=new Listener.CanvasMousemove()\r\n\t\t//// to be set by features:\r\n\t\t// for html:\r\n\t\tthis.hasSliders=false\r\n\t\t// for js:\r\n\t\tthis.hasInputs=false // must have renderFrame()\r\n\t\tthis.hasStartTime=false\r\n\t\tthis.hasPrevTime=false\r\n\t\tthis.pollsGamepad=false\r\n\t\tthis.hasClampFn=false\r\n\t\tthis.hasWrapFn=false\r\n\t}\r\n\tget hasTime() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime\r\n\t}\r\n\tget isAnimated() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime || this.pollsGamepad\r\n\t}\r\n\tgetJsAfterInitLines() {\r\n\t\treturn this.canvasMousemoveListener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n\tgetListenerLines(listener) {\r\n\t\treturn listener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n}\r\n\r\nmodule.exports=FeatureContext\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\n\r\nclass Feature {\r\n\tconstructor() {\r\n\t\tthis.features=[]\r\n\t}\r\n\t// private:\r\n\tgetRecursiveLines(method,args) {\r\n\t\treturn Lines.bae(...this.features.map(feature=>feature[method](...args)))\r\n\t}\r\n\t// methods to be redefined:\r\n\thasInputs() {\r\n\t\treturn this.features.some(feature=>feature.hasInputs())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(featureContext)\r\n\t\t})\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlInputLines',arguments)\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlControlMessageLines',arguments)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsInitLines',arguments)\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsLoopLines',arguments)\r\n\t}\r\n}\r\n\r\nmodule.exports=Feature\r\n","'use strict'\r\n\r\n// fixed-width number formatting - don't use it for min width\r\nfunction makeFormatNumber(contextNumber) {\r\n\tconst nonnegativeLimits=(contextNumber.availableMin>=0 && contextNumber.availableMax>=0)\r\n\tconst lead=Math.max(\r\n\t\tString(Math.abs(contextNumber.availableMin)).split('.')[0].length,\r\n\t\tString(Math.abs(contextNumber.availableMax)).split('.')[0].length\r\n\t)\r\n\tconst prec=contextNumber.precision\r\n\tconst width=lead+prec+(prec>0)\r\n\tconst spaces='          ' // http://stackoverflow.com/q/10073699\r\n\tconst fmt=n=>(spaces+(+n).toFixed(prec)).slice(-width)\r\n\tif (nonnegativeLimits) {\r\n\t\treturn n=>fmt(n)\r\n\t} else {\r\n\t\treturn n=>(n<=0 ? n<0 ? '-' : ' ' : '+')+fmt(Math.abs(n))\r\n\t}\r\n}\r\n\r\nfunction formatNumber(number) {\r\n\treturn makeFormatNumber(number)(number)\r\n}\r\n\r\nfunction capNumber(number,maxValue) {\r\n\tconst capped=new Number(Math.min(maxValue,number)) // TODO Number was replaced by FixedLiveNumber in option-classes\r\n\tcapped.min=number.min\r\n\tcapped.max=Math.min(maxValue,number.max)\r\n\tcapped.input=number.input\r\n\t// needed for formatting:\r\n\tcapped.availableMin=number.availableMin\r\n\tcapped.availableMax=number.availableMax\r\n\tcapped.precision=number.precision\r\n\treturn capped\r\n}\r\n\r\nexports.makeFormatNumber=makeFormatNumber\r\nexports.formatNumber=formatNumber\r\nexports.capNumber=capNumber\r\n","'use strict'\r\n\r\nconst fixOptHelp=require('./fixed-options-helpers')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass GlslVector extends Vector {\r\n\tconstructor(name,values,wrapMode) {\r\n\t\tsuper(name,values,wrapMode)\r\n\t}\r\n\t// public:\r\n\tgetGlslDeclarationLines() {\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn Lines.be()\r\n\t\t} else if (this.modeFloats) {\r\n\t\t\tconst a=Lines.b()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"uniform float \"+component.varName+\";\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn a.e()\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"uniform vec\"+this.nVars+\" \"+this.varName+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslValue() {\r\n\t\treturn this.getGlslComponentsValue(this.components.map(component=>component.suffix).join(''))\r\n\t}\r\n\tgetGlslComponentsValue(selectedComponents) {\r\n\t\tconst allSuffixString=this.components.map(component=>component.suffix).slice(0,this.nVars).join('')\r\n\t\tconst results=[] // [[isConstant,componentName]]\r\n\t\tconst showResult=result=>{\r\n\t\t\tif (result[0]) {\r\n\t\t\t\treturn fixOptHelp.formatNumber(this.componentsBySuffix[result[1]].value)\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector) {\r\n\t\t\t\t\tif (result[1]==allSuffixString) {\r\n\t\t\t\t\t\treturn this.varName\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn this.varName+\".\"+result[1]\r\n\t\t\t\t\t}\r\n \t\t\t\t} else {\r\n\t\t\t\t\treturn this.componentsBySuffix[result[1]].varName\r\n \t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst allSameConstant=()=>{\r\n\t\t\tif (!results[0][0]) return false\r\n\t\t\tconst cmp=fixOptHelp.formatNumber(this.componentsBySuffix[results[0][1]].value)\r\n\t\t\treturn results.every(result=>(result[0] && fixOptHelp.formatNumber(this.componentsBySuffix[result[1]].value)==cmp))\r\n\t\t}\r\n\t\tfor (let j=0;j<selectedComponents.length;j++) {\r\n\t\t\tconst c=selectedComponents.charAt(j)\r\n\t\t\tif (!this.componentsBySuffix[c].variable) {\r\n\t\t\t\tresults.push([true,c])\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector && results.length>0) {\r\n\t\t\t\t\tconst prevResult=results.pop()\r\n\t\t\t\t\tif (prevResult[0]) {\r\n\t\t\t\t\t\tresults.push(prevResult,[false,c]) // prev is constant, don't merge\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresults.push([prevResult[0],prevResult[1]+c]) // merge\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresults.push([false,c])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (results.length==1) {\r\n\t\t\tif (this.modeVector && selectedComponents==allSuffixString) {\r\n\t\t\t\treturn this.varName\r\n\t\t\t} else {\r\n\t\t\t\treturn showResult(results[0])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (allSameConstant()) {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+showResult(results[0])+\")\" // see OpenGL ES SL section 5.4.2\r\n\t\t\t} else {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+results.map(showResult).join(\",\")+\")\"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tgetGlslMapDeclarationLines(mapName,mapFn) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"vec\"+this.components.length+\" \"+mapName+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float \"+mapName+this.components[0].suffix+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslMapComponentValue(mapName,selectedComponent) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn mapName+\".\"+selectedComponent\r\n\t\t} else {\r\n\t\t\treturn mapName+selectedComponent\r\n\t\t}\r\n\t}\r\n\t// private:\r\n\tgetJsDeclarationLines() {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tif (this.modeFloats) {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"var \"+component.varNameLoc+\"=gl.getUniformLocation(program,'\"+component.varName+\"');\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\ta(\"var \"+this.varName+\"Loc=gl.getUniformLocation(program,'\"+this.varName+\"');\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeVector) {\r\n\t\t\ta(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc\")\r\n\t\t\tif (this.components.every(component=>component.value.input!='slider')) { // all values are short, no getElement... queries\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\",\"+componentValue(component))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta.t(\");\")\r\n\t\t\t} else {\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\r\n\t\t\t\t\t\t\t\",\",\r\n\t\t\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta(\");\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"gl.uniform1f(\"+component.varNameLoc+\",\"+componentValue(component)+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryForComponent(entry,component) {\r\n\t\tif (this.modeVector) {\r\n\t\t\t// written at the end as a vector\r\n\t\t} else {\r\n\t\t\tentry.post(\"gl.uniform1f(\"+component.varNameLoc+\",\"+component.varName+\");\")\r\n\t\t}\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tif (this.modeVector) {\r\n\t\t\tconst vs=[]\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i<this.nVars) {\r\n\t\t\t\t\tvs.push(component.varName)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tentry.post(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc,\"+vs.join(\",\")+\");\")\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=GlslVector\r\n","'use strict'\r\n\r\nfunction number(n) {\r\n\treturn n.toString().replace('-','')\r\n}\r\nfunction plural(n,word) {\r\n\tif (n==1) {\r\n\t\treturn word\r\n\t} else {\r\n\t\treturn word+'s'\r\n\t}\r\n}\r\nconst plainValue=x=>number(x)\r\nconst pixelValue=n=>number(n)+\" <abbr title='\"+plural(n,'pixel')+\"'>px</abbr>\"\r\n\r\nlet dataStrings={\r\n\t'options.canvas': \"Canvas\",\r\n\t'options.canvas.{width,height}': \"Canvas {width,height}\",\r\n\t'options.canvas.{width,height}.value': pixelValue,\r\n\r\n\t'options.background': \"Background\",\r\n\t'options.background.type': \"Background type\",\r\n\t'options.background.type.none': \"none (transparent)\",\r\n\t'options.background.type.solid': \"solid color\",\r\n\t'options.background.color': \"Background color\",\r\n\t'options.background.color.{r,g,b,a}': 'Background color {red,green,blue,alpha} component',\r\n\t'options.background.color.{r,g,b,a}.value': plainValue,\r\n\t'options.background.color.{r,g,b,a}.speed': 'Background color {red,green,blue,alpha} speed',\r\n\t'options.background.color.{r,g,b,a}.speed.value': plainValue,\r\n\r\n\t'options.material': \"Material\",\r\n\t'options.material.scope': \"Set material color for objects\",\r\n\t'options.material.scope.global': \"entire scene\",\r\n\t'options.material.scope.vertex': \"shape vertices\",\r\n\t'options.material.scope.face': \"shape faces\",\r\n\t'options.material.data': \"For each object have\",\r\n\t'options.material.data.one': \"one color\",\r\n\t'options.material.data.sda': \"specular/diffuse/ambient colors\",\r\n\t'options.material.color': \"Material color\",\r\n\t'options.material.color.{r,g,b,a}': \"Material color {red,green,blue,alpha} component\",\r\n\t'options.material.color.{r,g,b,a}.value': plainValue,\r\n\t'options.material.color.{r,g,b,a}.speed': \"Material color {red,green,blue,alpha} speed\",\r\n\t'options.material.color.{r,g,b,a}.speed.value': plainValue,\r\n\t'options.material.{specular,diffuse,ambient}Color': \"Material {specular,diffuse,ambient} color\",\r\n\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}': \"{Specular,Diffuse,Ambient} color {red,green,blue} component\",\r\n\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}.value': plainValue,\r\n\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed': \"Material {specular,diffuse,ambient} color {red,green,blue,alpha} speed\",\r\n\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed.value': plainValue,\r\n\r\n\t'options.light': \"Light\", // directional if on\r\n\t'options.light.type': \"Light type\",\r\n\t'options.light.type.off': \"off\",\r\n\t'options.light.type.phong': \"on with Phong reflections\", // wp: Phong reflection model\r\n\t'options.light.type.blinn': \"on with BlinnPhong reflections\", // wp: BlinnPhong shading model\r\n\t'options.light.direction': \"Light direction\",\r\n\t'options.light.direction.{x,y,z}': \"Light direction {x,y,z} component\",\r\n\t'options.light.direction.{x,y,z}.value': plainValue,\r\n\t'options.light.direction.{x,y,z}.speed': \"Light direction {x,y,z} speed\",\r\n\t'options.light.direction.{x,y,z}.speed.value': plainValue,\r\n\r\n\t'options.shape': \"Shape\",\r\n\t'options.shape.type': \"Shape to draw\",\r\n\t'options.shape.type.square': \"square\",\r\n\t'options.shape.type.triangle': \"triangle\",\r\n\t'options.shape.type.gasket': \"Sierpinski gasket\", // wp: Sierpinski triangle\r\n\t'options.shape.type.cube': \"cube\",\r\n\t'options.shape.type.hat': \"Mexican hat function\", // wp: Mexican hat wavelet\r\n\t'options.shape.type.terrain': \"diamond-square fractal terrain\", // wp: Diamond-square algorithm\r\n\t'options.shape.elements': \"Element array\",\r\n\t'options.shape.elements.0': \"not used\",\r\n\t'options.shape.elements.{8,16,32}': \"with {8,16,32}-bit index\",\r\n\t'options.shape.lod': \"Shape detail level\", // recursion depth for fractal shapes\r\n\t'options.shape.lod.value': plainValue,\r\n\r\n\t'options.transforms': \"Transforms\",\r\n\t'options.transforms.projection': \"Projection\",\r\n\t'options.transforms.projection.ortho': \"orthogonal\",\r\n\t'options.transforms.projection.perspective': \"perspective\",\r\n\t'options.transforms.model': \"Model transform\",\r\n\t'options.transforms.model.rotate.{x,y,z}.add': \"Add rotation around {x,y,z} axis\",\r\n\t'options.transforms.model.rotate.{x,y,z}': \"Angle of rotation around {x,y,z} axis\",\r\n\t'options.transforms.model.rotate.{x,y,z}.value': plainValue,\r\n\t'options.transforms.model.rotate.{x,y,z}.speed': \"Speed of rotation around {x,y,z} axis\",\r\n\t'options.transforms.model.rotate.{x,y,z}.speed.value': plainValue,\r\n\r\n\t'options.debug': \"Debug options\",\r\n\t'options.debug.shaders': \"Log shader compilation errors\",\r\n\t'options.debug.arrays': \"Log allocated array sizes\",\r\n\t'options.debug.inputs': \"Log input values\",\r\n\t'options.debug.animations': \"Log animated values\",\r\n\r\n\t'options.formatting': \"Code formatting options\",\r\n\t'options.formatting.indent': \"Indent\",\r\n\t'options.formatting.indent.tab': \"tab\",\r\n\t'options.formatting.indent.{2,4,8}': \"{2,4,8} spaces\",\r\n\r\n\t'options-output.inputs': \"Input method\",\r\n\t'options-output.inputs.constant': \"none\",\r\n\t'options-output.inputs.slider': \"slider\",\r\n\t'options-output.inputs.mousemove{x,y}': \"mouse {x,y} axis\",\r\n\t'options-output.inputs.gamepad{0,1,2,3}': \"gamepad {0,1,2,3} axis\",\r\n\t'options-output.range': \"with range\",\r\n\t'options-output.reset': \"Reset\",\r\n\t'options-output.addSpeed': \"Add speed\",\r\n\t'options-output.drag': \"Drag or press up/down while in focus to reorder transforms\",\r\n\t'options-output.delete': \"Delete transform\",\r\n\t'options-output.elements': \"choosing 8- or 16-bit index may limit available shape detail levels\",\r\n\r\n\t'controls.type.mousemovex': \"Move the mouse pointer horizontally over the canvas\",\r\n\t'controls.type.mousemovey': \"Move the mouse pointer vertically over the canvas\",\r\n\t'controls.to': \"to update\",\r\n}\r\n\r\ndataStrings=require('crnx-base/code-output-i18n')(dataStrings)\r\n\r\nconst strings={}\r\nconst expandRegexp=/^([^{]*)\\{([^}]*)\\}(.*)$/\r\nfunction expandIdAndString(id,string) {\r\n\tlet match\r\n\tif (match=expandRegexp.exec(id)) {\r\n\t\tconst idStart=match[1]\r\n\t\tconst idMids=match[2].split(',')\r\n\t\tconst idEnd=match[3]\r\n\t\tif ((typeof string=='string') && (match=expandRegexp.exec(string))) {\r\n\t\t\tconst stringStart=match[1]\r\n\t\t\tconst stringMids=match[2].split(',')\r\n\t\t\tconst stringEnd=match[3]\r\n\t\t\tidMids.forEach((idMid,i)=>{\r\n\t\t\t\tconst stringMid=stringMids[i]\r\n\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+stringMid+stringEnd)\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tidMids.forEach(idMid=>{\r\n\t\t\t\texpandIdAndString(idStart+idMid+idEnd,string)\r\n\t\t\t})\r\n\t\t}\r\n\t} else {\r\n\t\tstrings[id]=string\r\n\t}\r\n}\r\nfor (let id in dataStrings) {\r\n\texpandIdAndString(id,dataStrings[id])\r\n}\r\n\r\nmodule.exports=function(id,n){\r\n\tif (strings[id]===undefined) {\r\n\t\tthrow new Error(\"undefined string \"+id)\r\n\t} if (typeof strings[id] == 'string') {\r\n\t\treturn strings[id]\r\n\t} else {\r\n\t\treturn strings[id](n)\r\n\t}\r\n}\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Illumination extends Feature {\r\n\tconstructor(material,light) {\r\n\t\tsuper()\r\n\t\tthis.material=material\r\n\t\tthis.light=light\r\n\t\t// possible options checks:\r\n\t\t// material.scope=='global': constant or user input -> uniform\r\n\t\t// material.scope!='global': colors in model data -> attribute\r\n\t\t// material.data=='one': one color\r\n\t\t// material.data!='one': s/d/a colors\r\n\t\t// light.type=='off'\r\n\t\t// light.type!='off'\r\n\t\t// light.type=='blinn'\r\n\t\tif (material.scope=='global') {\r\n\t\t\tif (material.data=='one') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.colorVector=new GlslVector('material.color',material.color.entries)\r\n\t\t\t\t)\r\n\t\t\t} else if (light.type!='off') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.specularColorVector=new GlslVector('material.specularColor',material.specularColor.entries),\r\n\t\t\t\t\tthis.diffuseColorVector =new GlslVector('material.diffuseColor' ,material.diffuseColor.entries),\r\n\t\t\t\t\tthis.ambientColorVector =new GlslVector('material.ambientColor' ,material.ambientColor.entries)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.ambientColorVector=new GlslVector('material.ambientColor',[\r\n\t\t\t\t\t\t...material.ambientColor.entries, Option.LiveFloat.make('a',[0,1,-1,+1],1)().fix()\r\n\t\t\t\t\t])\r\n\t\t\t\t)\r\n\t\t\t\t// TODO consider extendind .specularColor and .diffuseColor, b/c they would be present if vertex scope is chosen\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (light.type!='off') {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tthis.lightDirectionVector=new GlslVector('light.direction',light.direction.entries)\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetColorAttrs() {\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"color\",enabled:true,weight:1.0}\r\n\t\t\t\t]\r\n\t\t\t} else {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"specularColor\",enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"diffuseColor\" ,enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"ambientColor\" ,enabled:true                  ,weight:0.2}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\twantsTransformedPosition(eyeAtInfinity) {\r\n\t\treturn !eyeAtInfinity && this.light.type!='off' && this.material.data!='one'\r\n\t}\r\n\tgetGlslVertexDeclarationLines(eyeAtInfinity,hasNormalAttr) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta(\"attribute vec3 normal;\")\r\n\t\t\t}\r\n\t\t\ta(\"varying vec3 interpolatedNormal;\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"attribute vec4 color;\")\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"attribute vec4 ambientColor;\")\r\n\t\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"attribute vec3 specularColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 diffuseColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 ambientColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(eyeAtInfinity,hasNormalAttr,normalTransformLines) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"interpolatedView=-transformedPosition.xyz;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\"interpolatedNormal=\")\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta.t(\"normal\")\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\"vec3(0.0,0.0,1.0)\")\r\n\t\t\t}\r\n\t\t\ta.t(normalTransformLines)\r\n\t\t\ta.t(\";\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"interpolatedColor=color;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"interpolatedColor=ambientColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"interpolatedSpecularColor=specularColor;\",\r\n\t\t\t\t\t\t\"interpolatedDiffuseColor=diffuseColor;\",\r\n\t\t\t\t\t\t\"interpolatedAmbientColor=ambientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentDeclarationLines(eyeAtInfinity) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\r\n\t\t\t\tthis.lightDirectionVector.getGlslDeclarationLines(),\r\n\t\t\t\t\"varying vec3 interpolatedNormal;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(this.colorVector.getGlslDeclarationLines())\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type!='off') {\r\n\t\t\t\t\ta(this.specularColorVector.getGlslDeclarationLines())\r\n\t\t\t\t\ta(this.diffuseColorVector.getGlslDeclarationLines())\r\n\t\t\t\t}\r\n\t\t\t\ta(this.ambientColorVector.getGlslDeclarationLines())\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one' || this.light.type=='off') {\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentOutputLines(eyeAtInfinity,twoSided) {\r\n\t\tconst a=Lines.b()\r\n\t\tlet colorRGB,colorA,colorRGBA\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tconst vector=(this.material.data=='one'\r\n\t\t\t\t? this.colorVector\r\n\t\t\t\t: this.ambientColorVector\r\n\t\t\t)\r\n\t\t\tcolorRGB =()=>vector.getGlslComponentsValue('rgb')\r\n\t\t\tcolorA   =()=>vector.getGlslComponentsValue('a')\r\n\t\t\tcolorRGBA=()=>vector.getGlslValue()\r\n\t\t} else {\r\n\t\t\tcolorRGB =()=>\"interpolatedColor.rgb\" // TODO don't pass it as vec4 if light is on\r\n\t\t\tcolorA   =()=>\"interpolatedColor.a\"\r\n\t\t\tcolorRGBA=()=>\"interpolatedColor\"\r\n\t\t}\r\n\t\tif (this.light.type=='off') {\r\n\t\t\ta(\"gl_FragColor=\"+colorRGBA()+\";\")\r\n\t\t} else {\r\n\t\t\ta(\"vec3 N=normalize(interpolatedNormal);\")\r\n\t\t\tif (twoSided) {\r\n\t\t\t\ta(\"if (!gl_FrontFacing) N=-N;\")\r\n\t\t\t}\r\n\t\t\ta(\"vec3 L=normalize(\"+this.lightDirectionVector.getGlslValue()+\");\")\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"gl_FragColor=vec4(\"+colorRGB()+\"*max(0.0,dot(L,N)),\"+colorA()+\");\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\t\t\ta(\"vec3 V=normalize(interpolatedView);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 V=vec3(0.0,0.0,1.0);\")\r\n\t\t\t\t}\r\n\t\t\t\tlet specularDotArgs=\"H,N\"\r\n\t\t\t\tlet shininessCorrection=\"\"\r\n\t\t\t\tif (this.light.type=='blinn') {\r\n\t\t\t\t\ta(\"vec3 H=normalize(L+V);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 R=reflect(-L,N);\")\r\n\t\t\t\t\tspecularDotArgs=\"R,V\"\r\n\t\t\t\t\tshininessCorrection=\"/4.0\"\r\n\t\t\t\t}\r\n\t\t\t\ta(\"float shininess=100.0;\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\t\"gl_FragColor=vec4(\",\r\n\t\t\t\t\t\t\",1.0);\"\r\n\t\t\t\t\t).ae(this.material.scope=='global'\r\n\t\t\t\t\t\t? Lines.bae(\r\n\t\t\t\t\t\t\t\"+\"+this.specularColorVector.getGlslValue()+\"*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+\"+this.diffuseColorVector.getGlslValue()+\"*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+\"+this.ambientColorVector.getGlslValue()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: Lines.bae(\r\n\t\t\t\t\t\t\t\"+interpolatedSpecularColor*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+interpolatedDiffuseColor*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+interpolatedAmbientColor\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Illumination\r\n","'use strict'\r\n\r\nclass Base {\r\n\tconstructor(str) {\r\n\t\tthis._str=str\r\n\t}\r\n\ttoString() {\r\n\t\treturn this._str\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this._str\r\n\t}\r\n}\r\n\r\nclass Constant extends Base {\r\n}\r\n\r\nclass Variable extends Base {\r\n}\r\n\r\nclass Slider extends Variable {\r\n}\r\n\r\nclass MouseMove extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=str.slice(-1)\r\n\t}\r\n}\r\n\r\nclass Gamepad extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=Number(str.slice(-1))\r\n\t}\r\n}\r\n\r\nfunction createFromString(str) {\r\n\treturn new {\r\n\t\t'constant':   Constant,\r\n\t\t'slider':     Slider,\r\n\t\t'mousemovex': MouseMove,\r\n\t\t'mousemovey': MouseMove,\r\n\t\t'gamepad0':   Gamepad,\r\n\t\t'gamepad1':   Gamepad,\r\n\t\t'gamepad2':   Gamepad,\r\n\t\t'gamepad3':   Gamepad,\r\n\t}[str](str)\r\n}\r\n\r\nexports.Base=Base\r\nexports.Constant=Constant\r\nexports.Variable=Variable\r\nexports.Slider=Slider\r\nexports.MouseMove=MouseMove\r\nexports.Gamepad=Gamepad\r\nexports.createFromString=createFromString\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass IntFeature extends NumericFeature {\r\n\tconstructor(name,value) {\r\n\t\tsuper()\r\n\t\tthis.name=name\r\n\t\tthis.value=value\r\n\t}\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.value.input!='constant'\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tif (this.value.input!='constant') {\r\n\t\t\tfeatureContext.hasInputs=true\r\n\t\t}\r\n\t\tif (this.value.input=='slider') {\r\n\t\t\tfeatureContext.hasSliders=true\r\n\t\t}\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\ta(this.getHtmlControlMessageForValue(i18n,this.value,this.name))\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\tconst v=this.value\r\n\t\tif (v.input=='slider') {\r\n\t\t\ta(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\tLines.html`\t<label for=${this.name}>${i18n('options.'+this.name)}:</label>`,\r\n\t\t\t\t\"\t<span class=min>\"+i18n('options.'+this.name+'.value',v.min)+\"</span>\", // html inserted, no escaping\r\n\t\t\t\tLines.html`\t<input type=range id=${this.name} min=${v.min} max=${v.max} value=${v} />`,\r\n\t\t\t\t\"\t<span class=max>\"+i18n('options.'+this.name+'.value',v.max)+\"</span>\",\r\n\t\t\t\t\"</div>\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=IntFeature\r\n","'use strict'\r\n\r\nconst capitalize=require('crnx-base/fake-lodash/capitalize')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\n\r\nclass Base {\r\n\tconstructor() {\r\n\t\tthis.entries=[]\r\n\t}\r\n\tenter() {\r\n\t\tconst entry={\r\n\t\t\tpre: [],\r\n\t\t\tcond: null,\r\n\t\t\tlog: [],\r\n\t\t\tpost: [],\r\n\t\t}\r\n\t\tthis.entries.push(entry)\r\n\t\tfunction makePushArgs(where){\r\n\t\t\treturn function(){\r\n\t\t\t\twhere.push(...arguments)\r\n\t\t\t\treturn proxy\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst proxy={\r\n\t\t\tpre: makePushArgs(entry.pre),\r\n\t\t\tcond: function(cond){\r\n\t\t\t\tentry.cond=cond\r\n\t\t\t\treturn proxy\r\n\t\t\t},\r\n\t\t\tlog: makePushArgs(entry.log),\r\n\t\t\tpost: makePushArgs(entry.post),\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn []\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"\"\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn lines\r\n\t}\r\n\twrite(haveToUpdateCanvas,haveToLogInput) {\r\n\t\tconst statementsGraph={}\r\n\t\tconst statementsRoot=[]\r\n\t\tlet statementsPrev=null\r\n\t\tconst WHITE=0\r\n\t\tconst GRAY=1\r\n\t\tconst BLACK=2\r\n\t\tconst addStatement=(statement,cond)=>{\r\n\t\t\tlet vertex\r\n\t\t\tif (statement in statementsGraph) {\r\n\t\t\t\tvertex=statementsGraph[statement]\r\n\t\t\t} else {\r\n\t\t\t\tvertex=statementsGraph[statement]={\r\n\t\t\t\t\tprevs: [],\r\n\t\t\t\t\tconds: [],\r\n\t\t\t\t\tmark: WHITE,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\tif (cond===null) {\r\n\t\t\t\t\tvertex.conds=null\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvertex.conds.push(cond)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tvertex.prevs.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=statement\r\n\t\t}\r\n\t\tconst closeEntryStatements=()=>{\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tstatementsRoot.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=null\r\n\t\t}\r\n\t\tconst getStatements=()=>{\r\n\t\t\tconst statements=[]\r\n\t\t\tlet currentCond=null\r\n\t\t\tconst writeStatement=(statement,vertex)=>{\r\n\t\t\t\tlet newCond=null\r\n\t\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\t\tnewCond=vertex.conds.join(' || ')\r\n\t\t\t\t}\r\n\t\t\t\tif (newCond!=currentCond) {\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"}\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentCond=newCond\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"if (\"+currentCond+\") {\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\tstatements.push('\\t'+statement)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatements.push(statement)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst recVertex=(statement,vertex)=>{\r\n\t\t\t\tvertex.mark=GRAY\r\n\t\t\t\trecPrevs(vertex.prevs)\r\n\t\t\t\tvertex.mark=BLACK\r\n\t\t\t\twriteStatement(statement,vertex)\r\n\t\t\t}\r\n\t\t\tconst recPrevs=(prevs)=>{\r\n\t\t\t\tprevs.forEach((statement)=>{\r\n\t\t\t\t\tif (statementsGraph[statement].mark==WHITE) {\r\n\t\t\t\t\t\trecVertex(statement,statementsGraph[statement])\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\trecPrevs(statementsRoot)\r\n\t\t\tif (currentCond!==null) {\r\n\t\t\t\tstatements.push(\"}\")\r\n\t\t\t}\r\n\t\t\treturn statements\r\n\t\t}\r\n\t\tthis.entries.forEach((entry)=>{\r\n\t\t\tentry.pre.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,null)\r\n\t\t\t})\r\n\t\t\tif (haveToLogInput) {\r\n\t\t\t\tentry.log.forEach(statement=>{\r\n\t\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tentry.post.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t})\r\n\t\t\tif (haveToUpdateCanvas) {\r\n\t\t\t\taddStatement(\"scheduleFrame();\",entry.cond)\r\n\t\t\t}\r\n\t\t\tcloseEntryStatements()\r\n\t\t})\r\n\t\tconst br=this.bracketListener()\r\n\t\tlet statements=getStatements()\r\n\t\tif (statements.length>0) {\r\n\t\t\tstatements=[...this.prependedStatements(),...statements]\r\n\t\t}\r\n\t\tif (statements.length==1) {\r\n\t\t\tconst match=/^(\\w+)\\(\\);$/.exec(statements[0])\r\n\t\t\tif (match) {\r\n\t\t\t\treturn this.wrapCall(\r\n\t\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\tbr[0]+match[1]+br[1]\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t// TODO what if no match?\r\n\t\t}\r\n\t\tif (statements.length>0) {\r\n\t\t\treturn this.wrapCall(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(br[0]+\"function(\"+this.bracketFnArg()+\"){\"),\r\n\t\t\t\t\tJsLines.bae(\"}\"+br[1])\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tJsLines.bae(...statements)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Slider extends Base {\r\n\tconstructor(id) {\r\n\t\tsuper()\r\n\t\tthis.id=id\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"document.getElementById('\"+this.id+\"').addEventListener('change',\",\");\"]\r\n\t}\r\n}\r\n\r\nclass MultipleSlider extends Base {\r\n\tconstructor(query) {\r\n\t\tsuper()\r\n\t\tthis.query=query\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"el.addEventListener('change',\",\");\"]\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\";[].forEach.call(document.querySelectorAll('\"+this.query+\"'),function(el){\"),\r\n\t\t\tJsLines.bae(\"});\")\r\n\t\t).ae(lines)\r\n\t}\r\n}\r\n\r\nclass CanvasMousemove extends Base {\r\n\tenter() {\r\n\t\tconst proxy=super.enter()\r\n\t\tconst floatHelper=(minMaxFlag,varFlag,inputType,varName,minValue,maxValue)=>{\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\tlet dest\r\n\t\t\tif (minValue==0 && maxValue==1) {\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=\"\r\n\t\t\t} else {\r\n\t\t\t\tproxy.pre(\"var min\"+VarName+\"=\"+minValue+\";\")\r\n\t\t\t\tproxy.pre(\"var max\"+VarName+\"=\"+maxValue+\";\")\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\")*\"\r\n\t\t\t}\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\tdest+\"(ev.clientX-rect.left)/(rect.width-1);\",\r\n\t\t\t\tdest+\"(rect.bottom-1-ev.clientY)/(rect.height-1);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tproxy.prexy=function(inputType,xStatement,yStatement){\r\n\t\t\tif (inputType.axis=='x') {\r\n\t\t\t\treturn proxy.pre(xStatement)\r\n\t\t\t} else if (inputType.axis=='y') {\r\n\t\t\t\treturn proxy.pre(yStatement)\r\n\t\t\t}\r\n\t\t\treturn proxy\r\n\t\t}\r\n\t\tproxy.minMaxFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,false,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.minMaxVarFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,true,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.newVarInt=function(inputType,varName){\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(ev.clientX-rect.left)/rect.width);\",\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(rect.bottom-1-ev.clientY)/rect.height);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"canvas.addEventListener('mousemove',\",\");\"]\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"ev\"\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn [\r\n\t\t\t\"var rect=this.getBoundingClientRect();\",\r\n\t\t]\r\n\t}\r\n}\r\n\r\nexports.Slider=Slider\r\nexports.MultipleSlider=MultipleSlider\r\nexports.CanvasMousemove=CanvasMousemove\r\n","'use strict'\r\n\r\nlet idCounter=0\r\nfunction generateId() {\r\n\treturn 'webgl-starter-id-'+(idCounter++)\r\n}\r\n\r\nconst i18n=require('./i18n')\r\nconst Options=require('./options')\r\nconst Code=require('./code')\r\nconst OptionsOutput=require('./options-output')\r\nconst CodeOutput=require('crnx-base/code-output')\r\n\r\nfunction getHtmlDataUri(html) {\r\n\t// with base64: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/btoa\r\n\t//return \"data:text/html;charset=utf-8;base64,\"+window.btoa(unescape(encodeURIComponent(str)));\r\n\t// without base64: https://en.wikipedia.org/wiki/Data_URI_scheme\r\n\treturn 'data:text/html;charset=utf-8,'+encodeURIComponent(html)\r\n}\r\n\r\n$(function(){\r\n\t$('.webgl-starter').each(function(){\r\n\t\tconst $container=$(this)\r\n\t\tconst options=new Options()\r\n\t\tconst codeOutput=new CodeOutput(()=>new Code(options.fix(),i18n),i18n)\r\n\t\toptions.updateCallback=codeOutput.update\r\n\t\tconst optionsOutput=new OptionsOutput(options,generateId,i18n)\r\n\t\t$container.empty().append(\r\n\t\t\toptionsOutput.$output,\r\n\t\t\tcodeOutput.$output\r\n\t\t)\r\n\t})\r\n})\r\n","'use strict'\r\n\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\n\r\nclass NumericFeature extends Feature {\r\n\t// private:\r\n\tgetHtmlControlMessageForValue(i18n,value,name) {\r\n\t\tif (value.input instanceof Input.MouseMove) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"<li>\"+i18n('controls.type.'+value.input)+\" \"+i18n('controls.to')+\" <strong>\"+i18n('options.'+name)+\"</strong></li>\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=NumericFeature\r\n","'use strict'\r\n\r\nconst Input=require('./input-classes')\r\nconst Option=Object.create(require('crnx-base/option-classes'))\r\n\r\nclass FixedLiveNumber {\r\n\tconstructor(src,setToDefault) {\r\n\t\tif (!setToDefault) {\r\n\t\t\tthis.value=src.value\r\n\t\t\tthis.min=src.min\r\n\t\t\tthis.max=src.max\r\n\t\t\tthis.input=Input.createFromString(src.input)\r\n\t\t} else {\r\n\t\t\tthis.value=src.defaultValue\r\n\t\t\tthis.min=src.availableMin\r\n\t\t\tthis.max=src.availableMax\r\n\t\t\tthis.input=Input.createFromString('constant')\r\n\t\t}\r\n\t\t// TODO remove it - needed for formatting and to decide on clamp()/wrap():\r\n\t\tthis.availableMin=src.availableMin\r\n\t\tthis.availableMax=src.availableMax\r\n\t\tthis.precision=src.precision\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value\r\n\t}\r\n\ttoString() {\r\n\t\treturn String(this.value)\r\n\t}\r\n}\r\n\r\n// abstract classes\r\n\r\nOption.LiveNumber = class extends Option.Number {\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tlet dataValue,dataMin,dataMax,dataInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value\r\n\t\t\tdataMin  =data.min\r\n\t\t\tdataMax  =data.max\r\n\t\t\tdataInput=data.input\r\n\t\t} else {\r\n\t\t\tdataValue=data\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._min=(dataMin!==undefined)?dataMin:this.availableMin\r\n\t\tthis._max=(dataMax!==undefined)?dataMax:this.availableMax\r\n\t\tthis._input=(dataInput!==undefined)?dataInput:'constant'\r\n\t\tthis._$range=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tif (this._$range) this._$range.toggle(this._input!='constant')\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget min() {\r\n\t\treturn this._min\r\n\t}\r\n\tset min(min) {\r\n\t\tthis._min=min\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget max() {\r\n\t\treturn this._max\r\n\t}\r\n\tset max(max) {\r\n\t\tthis._max=max\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget $range() {\r\n\t\treturn this._$range\r\n\t}\r\n\tset $range($range) {\r\n\t\tthis._$range=$range\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texportHelper(src) {\r\n\t\tconst data={}\r\n\t\tif (src.value!=src.defaultValue) data.value=src.value\r\n\t\tif (src.min!=src.availableMin) data.min=src.min\r\n\t\tif (src.max!=src.availableMax) data.max=src.max\r\n\t\tif (src.input!='constant') data.input=src.input\r\n\t\treturn data\r\n\t}\r\n\texport() {\r\n\t\treturn this.exportHelper(this)\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=new FixedLiveNumber(this)\r\n\t\tfixed.name=this.name\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.LiveInt = class extends Option.LiveNumber {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey']\r\n\t}\r\n}\r\n\r\nOption.CanvasLiveInt = class extends Option.LiveInt {\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider']\r\n\t}\r\n}\r\n\r\nOption.LiveFloat = class extends Option.LiveNumber {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.speed===undefined) settings.speed={}\r\n\t\tif (settings.speed.availableMin===undefined) settings.speed.availableMin=arrayArg[2]\r\n\t\tif (settings.speed.availableMax===undefined) settings.speed.availableMax=arrayArg[3]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tlet dataSpeedValue,dataSpeedMin,dataSpeedMax,dataSpeedInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tif (typeof data.speed == 'object') {\r\n\t\t\t\tdataSpeedValue=data.speed.value\r\n\t\t\t\tdataSpeedMin  =data.speed.min\r\n\t\t\t\tdataSpeedMax  =data.speed.max\r\n\t\t\t\tdataSpeedInput=data.speed.input\r\n\t\t\t} else {\r\n\t\t\t\tdataSpeedValue=data.speed\r\n\t\t\t}\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._speedAvailableMin=settings.speed.availableMin\r\n\t\tthis._speedAvailableMax=settings.speed.availableMax\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._speedValue=(dataSpeedValue!==undefined)?dataSpeedValue:0\r\n\t\tthis._speedMin=(dataSpeedMin!==undefined)?dataSpeedMin:this._speedAvailableMin\r\n\t\tthis._speedMax=(dataSpeedMax!==undefined)?dataSpeedMax:this._speedAvailableMax\r\n\t\tthis._speedInput=(dataSpeedInput!==undefined)?dataSpeedInput:'constant'\r\n\t\tthis._addSpeed=!(\r\n\t\t\tthis._speedValue==0 &&\r\n\t\t\tthis._speedMin==this._speedAvailableMin &&\r\n\t\t\tthis._speedMax==this._speedAvailableMax &&\r\n\t\t\tthis._speedInput=='constant'\r\n\t\t)\r\n\t\tthis._speed$=null\r\n\t\tthis._speed$range=null\r\n\t\tthis._$addSpeed=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tsuper.updateInternalVisibility()\r\n\t\tif (this._speed$range) this._speed$range.toggle(this._speedInput!='constant')\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this._input)<0\r\n\t\tif (this._speed$) this._speed$.toggle(\r\n\t\t\tthis._addSpeed && notGamepad\r\n\t\t)\r\n\t\tif (this._$addSpeed) this._$addSpeed.toggle(notGamepad)\r\n\t}\r\n\tget addSpeed() {\r\n\t\treturn this._addSpeed\r\n\t}\r\n\tset addSpeed(addSpeed) {\r\n\t\tthis._addSpeed=addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey','gamepad0','gamepad1','gamepad2','gamepad3']\r\n\t}\r\n\tget speed() {\r\n\t\tconst option=this\r\n\t\treturn {\r\n\t\t\tget fullName() {\r\n\t\t\t\treturn option.fullName+'.speed'\r\n\t\t\t},\r\n\t\t\tget defaultValue() {\r\n\t\t\t\treturn 0\r\n\t\t\t},\r\n\t\t\tget value() {\r\n\t\t\t\treturn option._speedValue\r\n\t\t\t},\r\n\t\t\tset value(value) {\r\n\t\t\t\toption._speedValue=value\r\n\t\t\t\toption.updateCallback()\r\n\t\t\t},\r\n\t\t\tget input() {\r\n\t\t\t\treturn option._speedInput\r\n\t\t\t},\r\n\t\t\tset input(input) {\r\n\t\t\t\toption._speedInput=input\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t\toption.updateCallback()\r\n\t\t\t},\r\n\t\t\tget availableMin() {\r\n\t\t\t\treturn option._speedAvailableMin\r\n\t\t\t},\r\n\t\t\tget availableMax() {\r\n\t\t\t\treturn option._speedAvailableMax\r\n\t\t\t},\r\n\t\t\tget min() {\r\n\t\t\t\treturn option._speedMin\r\n\t\t\t},\r\n\t\t\tset min(min) {\r\n\t\t\t\toption._speedMin=min\r\n\t\t\t\toption.updateCallback()\r\n\t\t\t},\r\n\t\t\tget max() {\r\n\t\t\t\treturn option._speedMax\r\n\t\t\t},\r\n\t\t\tset max(max) {\r\n\t\t\t\toption._speedMax=max\r\n\t\t\t\toption.updateCallback()\r\n\t\t\t},\r\n\t\t\tget precision() {\r\n\t\t\t\treturn option.precision\r\n\t\t\t},\r\n\t\t\tget availableInputTypes() {\r\n\t\t\t\treturn option.availableInputTypes\r\n\t\t\t},\r\n\t\t\tget $() {\r\n\t\t\t\treturn option._speed$\r\n\t\t\t},\r\n\t\t\tset $($) {\r\n\t\t\t\toption._speed$=$\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t},\r\n\t\t\tget $range() {\r\n\t\t\t\treturn option._speed$range\r\n\t\t\t},\r\n\t\t\tset $range($range) {\r\n\t\t\t\toption._speed$range=$range\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $addSpeed() {\r\n\t\treturn this._$addSpeed\r\n\t}\r\n\tset $addSpeed($addSpeed) {\r\n\t\tthis._$addSpeed=$addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texport() {\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tconst data=this.exportHelper(this)\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tthis.shortenExportAssign(this.exportHelper(this.speed),data,'speed')\r\n\t\t}\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed)\r\n\t\t} else {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed,true)\r\n\t\t}\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.LiveColor = class extends Option.Group {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.componentDefaultValues===undefined) settings.componentDefaultValues=arrayArg\r\n\t\tconst cs='rgba'\r\n\t\tsettings.descriptions=settings.componentDefaultValues.map((defaultValue,i)=>{\r\n\t\t\tconst c=cs.charAt(i)\r\n\t\t\treturn ['LiveFloat',c,[0,1,-1,+1],defaultValue]\r\n\t\t})\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst BaseOptionsOutput=require('crnx-base/options-output')\r\n\r\nclass OptionsOutput extends BaseOptionsOutput {\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\tsuper.setOptionClassWriters(optionClassWriters)\r\n\t\tconst baseSelectWriter=optionClassWriters.get(Option.Select)\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst $option=baseSelectWriter(option,writeOption,i18n,generateId)\r\n\t\t\tif (option.name=='elements') {\r\n\t\t\t\t$option.append(\" \"+i18n('options-output.elements'))\r\n\t\t\t}\r\n\t\t\treturn $option\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.LiveNumber,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst writeSubOption=option=>{\r\n\t\t\t\tconst p=option.precision\r\n\t\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\t\tconst writeMinMaxInput=minOrMax=>setInputAttrs($(\"<input type='number' required>\"))\r\n\t\t\t\t\t.val(option[minOrMax])\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\t\toption[minOrMax]=parseFloat(this.value)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\tconst id=generateId()\r\n\t\t\t\tconst inputSelectId=generateId()\r\n\t\t\t\tlet $inputSelect,$rangeMinInput,$rangeMaxInput\r\n\t\t\t\tconst $output=optionClassWriters.get(Option.Number)(option,writeOption,i18n,generateId)\r\n\t\t\t\t$output.find('button').before(\r\n\t\t\t\t\t\" <label for='\"+inputSelectId+\"'>\"+i18n('options-output.inputs')+\":</label> \",\r\n\t\t\t\t\t$inputSelect=$(\"<select id='\"+inputSelectId+\"'>\").append(\r\n\t\t\t\t\t\toption.availableInputTypes.map(availableInputType=>\r\n\t\t\t\t\t\t\t$(\"<option>\").val(availableInputType).html(i18n('options-output.inputs.'+availableInputType))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t).val(option.input).change(function(){\r\n\t\t\t\t\t\toption.input=this.value\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t\" \",\r\n\t\t\t\t\toption.$range=$(\"<span class='range'>\")\r\n\t\t\t\t\t\t.append(i18n('options-output.range')+\" \")\r\n\t\t\t\t\t\t.append($rangeMinInput=writeMinMaxInput('min'))\r\n\t\t\t\t\t\t.append(\" .. \")\r\n\t\t\t\t\t\t.append($rangeMaxInput=writeMinMaxInput('max')),\r\n\t\t\t\t\t\" \"\r\n\t\t\t\t).click(function(){\r\n\t\t\t\t\t$inputSelect.val('constant').change()\r\n\t\t\t\t\t$rangeMinInput.val(option.availableMin).change()\r\n\t\t\t\t\t$rangeMaxInput.val(option.availableMax).change()\r\n\t\t\t\t})\r\n\t\t\t\treturn $output\r\n\t\t\t}\r\n\t\t\tif (option instanceof Option.LiveFloat) {\r\n\t\t\t\treturn option.$=$(\"<div>\").append(\r\n\t\t\t\t\twriteSubOption(option).append(\r\n\t\t\t\t\t\t\" \",\r\n\t\t\t\t\t\toption.$addSpeed=$(\"<label> \"+i18n('options-output.addSpeed')+\"</label>\").prepend(\r\n\t\t\t\t\t\t\t$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t\t.prop('checked',option.addSpeed)\r\n\t\t\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\t\t\toption.addSpeed=this.checked\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\toption.speed.$=writeSubOption(option.speed)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\treturn option.$=writeSubOption(option)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nconst BaseOptions=require('crnx-base/options')\r\n\r\nclass Options extends BaseOptions {\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn [\r\n\t\t\t['Group','canvas',[\r\n\t\t\t\t['CanvasLiveInt','width',[1,1024],512],\r\n\t\t\t\t['CanvasLiveInt','height',[1,1024],512],\r\n\t\t\t]],\r\n\t\t\t['Group','background',[\r\n\t\t\t\t['Select','type',['none','solid']],\r\n\t\t\t\t['LiveColor','color',[1,1,1,1],{\r\n\t\t\t\t\tvisibilityData: {'background.type':'solid'},\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','material',[\r\n\t\t\t\t['Select','scope',['global','vertex','face']], // partly related to shape\r\n\t\t\t\t['Select','data',['one','sda']], // partly related to shape\r\n\t\t\t\t['LiveColor','color',[1,0,0,1],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'one'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','specularColor',[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','diffuseColor' ,[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','ambientColor' ,[0.2,0.2,0.2],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','light',[\r\n\t\t\t\t['Select','type',['off','phong','blinn']],\r\n\t\t\t\t['Group','direction',[\r\n\t\t\t\t\t['LiveFloat','x',[-4,+4,-4,+4],-1],\r\n\t\t\t\t\t['LiveFloat','y',[-4,+4,-4,+4],+1],\r\n\t\t\t\t\t['LiveFloat','z',[-4,+4,-4,+4],+1],\r\n\t\t\t\t],{\r\n\t\t\t\t\tvisibilityData: {'light.type':['phong','blinn']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','shape',[\r\n\t\t\t\t['Select','type',['square','triangle','gasket','cube','hat','terrain']],\r\n\t\t\t\t['Select','elements',['0','8','16','32']],\r\n\t\t\t\t['LiveInt','lod',[0,10],6,{\r\n\t\t\t\t\tvisibilityData: {'shape.type':['gasket','hat','terrain']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','transforms',[\r\n\t\t\t\t['Select','projection',['ortho','perspective']],\r\n\t\t\t\t['Array','model',[\r\n\t\t\t\t\t['LiveFloat','rotate.x',[-180,+180,-360,+360],0],\r\n\t\t\t\t\t['LiveFloat','rotate.y',[-180,+180,-360,+360],0],\r\n\t\t\t\t\t['LiveFloat','rotate.z',[-180,+180,-360,+360],0],\r\n\t\t\t\t]],\r\n\t\t\t]],\r\n\t\t\t['Group','debug',[\r\n\t\t\t\t['Checkbox','shaders',true],\r\n\t\t\t\t['Checkbox','arrays'],\r\n\t\t\t\t['Checkbox','inputs'], // TODO hide if no inputs?\r\n\t\t\t\t['Checkbox','animations'],\r\n\t\t\t]],\r\n\t\t]\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nexports.square=require('./shapes/square')\r\nexports.triangle=require('./shapes/triangle')\r\nexports.gasket=require('./shapes/gasket')\r\nexports.cube=require('./shapes/cube')\r\nexports.hat=require('./shapes/hat')\r\nexports.terrain=require('./shapes/terrain')\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Cube extends Shape {\r\n\tget dim() { return 3 }\r\n\tget twoSided() { return false }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(\r\n\t\t\tthis.colorAttrs,\r\n\t\t\t0, // TODO remove 'clean' colors after bilinear interp is implemented\r\n\t\t\tthis.hasColorsPerFace?undefined:[\r\n\t\t\t\t[0.0, 0.0, 0.0],\r\n\t\t\t\t[1.0, 0.0, 0.0],\r\n\t\t\t\t[0.0, 1.0, 0.0],\r\n\t\t\t\t[1.0, 1.0, 0.0],\r\n\t\t\t\t[0.0, 0.0, 1.0],\r\n\t\t\t\t[1.0, 0.0, 1.0],\r\n\t\t\t\t[0.0, 1.0, 1.0],\r\n\t\t\t\t[1.0, 1.0, 1.0],\r\n\t\t\t]\r\n\t\t)\r\n\t\tconst nCubeVertices=8\r\n\t\tconst cubeColors=[]\r\n\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\tcubeColors.push(colorgen.getNextColorString())\r\n\t\t}\r\n\t\tconst cubeVertexPositions=[\r\n\t\t\t\"-0.5,-0.5,-0.5,\",\r\n\t\t\t\"+0.5,-0.5,-0.5,\",\r\n\t\t\t\"-0.5,+0.5,-0.5,\",\r\n\t\t\t\"+0.5,+0.5,-0.5,\",\r\n\t\t\t\"-0.5,-0.5,+0.5,\",\r\n\t\t\t\"+0.5,-0.5,+0.5,\",\r\n\t\t\t\"-0.5,+0.5,+0.5,\",\r\n\t\t\t\"+0.5,+0.5,+0.5,\",\r\n\t\t]\r\n\t\tconst nCubeFaces=6\r\n\t\tconst cubeFaceNames=[\r\n\t\t\t\"left\",\r\n\t\t\t\"right\",\r\n\t\t\t\"bottom\",\r\n\t\t\t\"top\",\r\n\t\t\t\"back\",\r\n\t\t\t\"front\",\r\n\t\t]\r\n\t\tconst cubeFaceNormals=[\r\n\t\t\t\"-1.0, 0.0, 0.0,\",\r\n\t\t\t\"+1.0, 0.0, 0.0,\",\r\n\t\t\t\" 0.0,-1.0, 0.0,\",\r\n\t\t\t\" 0.0,+1.0, 0.0,\",\r\n\t\t\t\" 0.0, 0.0,-1.0,\",\r\n\t\t\t\" 0.0, 0.0,+1.0,\",\r\n\t\t]\r\n\t\tconst cubeFaceVertices=[\r\n\t\t\t[4, 6, 0, 2],\r\n\t\t\t[1, 3, 5, 7],\r\n\t\t\t[0, 1, 4, 5],\r\n\t\t\t[2, 6, 3, 7],\r\n\t\t\t[0, 2, 1, 3],\r\n\t\t\t[5, 7, 4, 6],\r\n\t\t]\r\n\t\tconst quadToTriangleMap=[0, 1, 2, 2, 1, 3]\r\n\t\tconst vertexCtor=JsLines.b()\r\n\t\tvertexCtor(\"// x    y    z\")\r\n\t\tif (this.hasNormals) {\r\n\t\t\tvertexCtor.t(\"  n.x  n.y  n.z\")\r\n\t\t}\r\n\t\tvertexCtor.t(colorgen.getHeaderString())\r\n\t\tconst appendVertex=(iFace,iVertex,firstInFace)=>{\r\n\t\t\tvertexCtor(cubeVertexPositions[iVertex])\r\n\t\t\tif (this.hasNormals) {\r\n\t\t\t\tvertexCtor.t(cubeFaceNormals[iFace])\r\n\t\t\t}\r\n\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iVertex])\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iFace])\r\n\t\t\t}\r\n\t\t\tif (firstInFace) {\r\n\t\t\t\tvertexCtor.t(\" // \"+cubeFaceNames[iFace]+\" face\")\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst wrapVertices=()=>WrapLines.b(\r\n\t\t\tJsLines.bae(\"var vertices=new Float32Array([\"),\r\n\t\t\tJsLines.bae(\"]);\")\r\n\t\t).ae(\r\n\t\t\tvertexCtor.e()\r\n\t\t)\r\n\t\tif (!this.usesElements()) {\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tquadToTriangleMap.forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,cubeFaceVertices[i][j],k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t\"var nVertices=36;\",\r\n\t\t\t\twrapVertices()\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace || this.hasNormals) {\r\n\t\t\t// elements, face data\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tcubeFaceVertices[i].forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,j,k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([\",\r\n\t\t\t\t\"\t 0,  1,  2,  2,  1,  3, // left face\",\r\n\t\t\t\t\"\t 4,  5,  6,  6,  5,  7, // right face\",\r\n\t\t\t\t\"\t 8,  9, 10, 10,  9, 11, // bottom face\",\r\n\t\t\t\t\"\t12, 13, 14, 14, 13, 15, // top face\",\r\n\t\t\t\t\"\t16, 17, 18, 18, 17, 19, // back face\",\r\n\t\t\t\t\"\t20, 21, 22, 22, 21, 23, // front face\",\r\n\t\t\t\t\"]);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\t// elements, no face data\r\n\t\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\t\tvertexCtor(cubeVertexPositions[i])\r\n\t\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\t\tvertexCtor.t(cubeColors[i])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst elementCtor=JsLines.b()\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\telementCtor(\"\")\r\n\t\t\t\tquadToTriangleMap.forEach(function(j){\r\n\t\t\t\t\telementCtor.t(cubeFaceVertices[i][j]+\", \")\r\n\t\t\t\t})\r\n\t\t\t\telementCtor.t(\"// \"+cubeFaceNames[i]+\" face\")\r\n\t\t\t}\r\n\t\t\tconst wrapElements=()=>WrapLines.b(\r\n\t\t\t\tJsLines.bae(\"var elements=new \"+this.getElementIndexJsArray()+\"([\"),\r\n\t\t\t\tJsLines.bae(\"]);\")\r\n\t\t\t).ae(\r\n\t\t\t\telementCtor.e()\r\n\t\t\t)\r\n\t\t\treturn new Lines(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\twrapElements()\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Cube\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Gasket extends LodShape {\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"(Math.pow(3,\"+lodSymbol+\"+1)+3)/2\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\twriteStoreShape() {\r\n\t\tconst writePushVertex=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[0];\",\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[1];\"\r\n\t\t\t)\r\n\t\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\"colors[nextIndexIntoColors]\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"colors[nextElement%colors.length]\")\r\n\t\t\t\t}\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\".forEach(function(cc){\",\r\n\t\t\t\t\t\"\tvertices[nextIndexIntoVertices++]=cc;\",\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"return nextElement++;\")\r\n\t\t\t} else if (this.hasColorsPerVertex) {\r\n\t\t\t\ta(\"nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\")\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeTriangle=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"if (depth<=0) {\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p0));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p1));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p2));\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tif (es[0]===null) es[0]=pushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tif (es[1]===null) es[1]=pushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tif (es[2]===null) es[2]=pushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[0]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[1]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[2]);\",\r\n\t\t\t\t\t\t\"\treturn es;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"} else {\",\r\n\t\t\t\t\"\tvar p01=mix(p0,p1);\",\r\n\t\t\t\t\"\tvar p12=mix(p1,p2);\",\r\n\t\t\t\t\"\tvar p20=mix(p2,p0);\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\ttriangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);\",\r\n\t\t\t\t\t\"\treturn [es0[0],es1[0],es2[0]];\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeInitialTriangleCall=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"shapeLod,\",\r\n\t\t\t\t\"[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements() && !this.hasColorsPerFace) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\",\",\"[null,null,null]\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var nextIndexIntoVertices=0;\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"var nextIndexIntoElements=0;\")\r\n\t\t\ta(\"var nextElement=0;\")\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(\"// p = position, cc = color component, e = element, es = elements\")\r\n\t\t\ta(this.writeColorData())\r\n\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\ta(\"var nextIndexIntoColors=0;\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\"// p = position, e = element, es = elements\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"function pushVertex(p) {\"),\r\n\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t).ae(\r\n\t\t\t\twritePushVertex()\r\n\t\t\t)\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function pushElement(e) {\",\r\n\t\t\t\t\"\telements[nextIndexIntoElements++]=e;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"function mix(pa,pb) {\",\r\n\t\t\t\"\treturn [\",\r\n\t\t\t\"\t\t(pa[0]+pb[0])/2,\",\r\n\t\t\t\"\t\t(pa[1]+pb[1])/2,\",\r\n\t\t\t\"\t];\",\r\n\t\t\t\"}\",\r\n\t\t\t((!this.usesElements() || this.hasColorsPerFace)\r\n\t\t\t\t? WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t\t: WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2,es) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\twriteTriangle()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"triangle(\"),\r\n\t\t\t\tJsLines.bae(\");\")\r\n\t\t\t).ae(\r\n\t\t\t\twriteInitialTriangleCall()\r\n\t\t\t)\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Gasket\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Hat extends Mesh {\r\n\twriteMeshInit() {\r\n\t\treturn JsLines.bae(\r\n\t\t\t\"var xyRange=4;\",\r\n\t\t\t\"var xyScale=1/(4*Math.sqrt(2));\"\r\n\t\t)\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet iv=0\r\n\t\ta(\r\n\t\t\t\"var r2=(x*x+y*y)/2;\",\r\n\t\t\t\"var A=Math.exp(-r2)/Math.PI;\",\r\n\t\t\t\"var z=A*(1-r2);\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=x*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=y*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=z;\"\r\n\t\t)\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Hat\r\n","'use strict'\r\n\r\nconst fixOptHelp=require('../fixed-options-helpers')\r\nconst Input=require('../input-classes')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst Listener=require('../listener-classes')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\nconst IntFeature=require('../int-feature')\r\n\r\nclass LodShape extends Shape {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs)\r\n\t\tthis.lod=fixOptHelp.capNumber(options.lod,this.getMaxPossibleLod(options.lod.max))\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('shape.lod',this.lod)\r\n\t\t)\r\n\t}\r\n\tgetMaxPossibleLod(requestedMaxLod) { // due to element index type\r\n\t\tif (!this.usesElements() || this.elementIndexBits>=31) { // 1<<31 is a negative number, can't compare with it\r\n\t\t\treturn requestedMaxLod // no need to limit lod if elements are not used or index type is large enough\r\n\t\t}\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst indexLimit=1<<this.elementIndexBits\r\n\t\tfor (let m=requestedMaxLod;m>=0;m--) {\r\n\t\t\tlet n=eval(nVerticesFn(m))\r\n\t\t\tif (n<=indexLimit) {\r\n\t\t\t\treturn m\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO fail here\r\n\t}\r\n\twriteColorData() {\r\n\t\tconst a=JsLines.b()\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tfor (let i=0;i<4;i++) {\r\n\t\t\ta(\"[\"+colorgen.getNextColorString().slice(1,-1)+\"],\")\r\n\t\t}\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\"var colors=[\"),\r\n\t\t\tJsLines.bae(\"];\")\r\n\t\t).ae(a.e())\r\n\t}\r\n\t// abstract getDistinctVertexCount(lodSymbol) {} // # of distinct vertices where one vertex can be shared between different faces and output primitives\r\n\t// abstract getFaceVertexCount(lodSymbol) {} // # of distinct (vertex,face) pairs that still can be shared between output primitives\r\n\t// abstract getTotalVertexCount(lodSymbol) {} // # of vertices in output primitives = # of elements when element arrays are in use\r\n\t// abstract writeStoreShape() {}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\r\n\t\t\t\t\"var minShapeLod=\"+this.lod.min+\";\",\r\n\t\t\t\t\"var maxShapeLod=\"+this.lod.max+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+nVerticesFn(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nMaxElements=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nMaxElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices,nElements;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"\tnElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var shapeLod=\"+this.lod+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta(\r\n\t\t\tIndentLines.bae(this.writeStoreShape()),\r\n\t\t\tIndentLines.bae(this.writeBufferData()),\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\"storeShape(\"+this.lod+\");\")\r\n\t\t} else {\r\n\t\t\ta(\"storeShape();\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.lod.input=='slider') {\r\n\t\t\tvar listener=new Listener.Slider('shape.lod')\r\n\t\t\tlistener.enter()\r\n\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t.post(\"storeShape(parseInt(this.value));\")\r\n\t\t\ta(\r\n\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t)\r\n\t\t} else if (this.lod.input instanceof Input.MouseMove) {\r\n\t\t\tfeatureContext.canvasMousemoveListener.enter()\r\n\t\t\t\t.newVarInt(this.lod.input,'shapeLod')\r\n\t\t\t\t.cond(\"newShapeLod!=shapeLod\")\r\n\t\t\t\t.log(\"console.log('shapeLod input value:',newShapeLod);\")\r\n\t\t\t\t.post(\"storeShape(newShapeLod);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=LodShape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Mesh extends LodShape {\r\n\tget dim() { return 3 }\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\")+1,2)\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*4\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*6\"\r\n\t}\r\n\twriteMeshVertexColors(iv) {\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t((!this.usesElements() && !this.hasColorsPerFace)\r\n\t\t\t\t\t?\"var ic=((i+di)&1)*2+((j+dj)&1);\"\r\n\t\t\t\t\t:\"var ic=(i&1)*2+(j&1);\"\r\n\t\t\t\t),\r\n\t\t\t\t\"colors[ic].forEach(function(cc,icc){\",\r\n\t\t\t\t\"\tvertices[vertexOffset+\"+iv+\"+icc]=cc;\",\r\n\t\t\t\t\"});\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n\t// abstract writeMeshInit() {}\r\n\t// abstract writeMeshVertex() {}\r\n\twriteStoreShape() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var res=(1<<shapeLod);\")\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*6+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*4+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j) {\",\r\n\t\t\t\t\"\treturn i*(res+1)+j;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"function normalize(v) {\",\r\n\t\t\t\t\"\tvar l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);\",\r\n\t\t\t\t\"\treturn [v[0]/l,v[1]/l,v[2]/l];\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(this.writeColorData())\r\n\t\t}\r\n\t\ta(this.writeMeshInit())\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (var i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (var j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<6;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<4;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i,j,0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i,j,3);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<=res;i++) {\",\r\n\t\t\t\t\"\tvar y=i/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\tfor (j=0;j<=res;j++) {\",\r\n\t\t\t\t\"\t\tvar x=j/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\tvar vertexOffset=vertexElement(i,j)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(2).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i+0,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i+1,j+1);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Mesh\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('../feature')\r\n\r\nclass Shape extends Feature {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper()\r\n\t\tthis.elementIndexBits=parseInt(options.elements) // 0 if don't want element arrays; 8, 16 or 32 bits per element index, limits lod of shape\r\n\t\tthis.hasNormals=(hasReflections && this.dim==3) // true = need normals, unless shape is flat\r\n\t\tthis.hasColorsPerVertex=hasColorsPerVertex // TODO support for both hasColorsPerVertex and hasColorsPerFace == true\r\n\t\tthis.hasColorsPerFace=hasColorsPerFace\r\n\t\tthis.colorAttrs=colorAttrs // array of color attribute structs {name,enabled,weight}\r\n\t}\r\n\tget dim() { return 2 }\r\n\tget twoSided() { return true } // triangles can be viewed from both sides\r\n\tget glPrimitive() { return 'TRIANGLES' }\r\n\tusesElements() { // TODO convert to getter\r\n\t\treturn this.elementIndexBits>0\r\n\t}\r\n\tgetNumbersPerVertex() {\r\n\t\treturn this.dim+(this.hasNormals?3:0)+this.colorAttrs.length*3\r\n\t}\r\n\tgetElementIndexJsArray() {\r\n\t\treturn \"Uint\"+this.elementIndexBits+\"Array\"\r\n\t}\r\n\tgetElementIndexGlType() {\r\n\t\tif (this.elementIndexBits==8) {\r\n\t\t\treturn \"gl.UNSIGNED_BYTE\" // not recommended by ms [https://msdn.microsoft.com/en-us/library/dn798776%28v=vs.85%29.aspx]\r\n\t\t} else if (this.elementIndexBits==16) {\r\n\t\t\treturn \"gl.UNSIGNED_SHORT\" // mozilla examples use this\r\n\t\t} else if (this.elementIndexBits==32) {\r\n\t\t\treturn \"gl.UNSIGNED_INT\" // needs extension\r\n\t\t}\r\n\t}\r\n\twriteDebug(debugArrays) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (debugArrays) {\r\n\t\t\ta(\"console.log('vertex array byte length:',vertices.byteLength);\")\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"console.log('element array byte length:',elements.byteLength);\")\r\n\t\t\t\ta(\"console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);\")\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteBufferData() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\treturn JsLines.bae(\r\n\t\t\tthis.writeArrays(),\r\n\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\tthis.writeBufferData()\r\n\t\t)\r\n\t}\r\n\t// public:\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst writeVertexAttribArrays=(attrs)=>{\r\n\t\t\tconst cmpSize=attrs[0][0]\r\n\t\t\tconst allSameSize=attrs.every((attr)=>{\r\n\t\t\t\tvar size=attr[0]\r\n\t\t\t\treturn size==cmpSize\r\n\t\t\t})\r\n\t\t\tlet allEnabled=true\r\n\t\t\tconst arrayLines=JsLines.bae(...attrs.map(attr=>{\r\n\t\t\t\tconst size=attr[0], name=attr[1], enabled=attr[2]\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"'\"+name+\"',\"\r\n\t\t\t\t\t\t: \"[\"+size+\",'\"+name+\"'],\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tallEnabled=false\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"null,\"\r\n\t\t\t\t\t\t: \"[\"+size+\",null],\"\r\n\t\t\t\t\t)+\" // attribute \"+name+\" disabled\"\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t\tlet foreachEnableLines=JsLines.bae(\r\n\t\t\t\t\"var attrLoc=gl.getAttribLocation(program,attrName);\",\r\n\t\t\t\t\"gl.vertexAttribPointer(\",\r\n\t\t\t\t\"\tattrLoc,attrSize,gl.FLOAT,false,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferStride,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferOffset\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(attrLoc);\"\r\n\t\t\t)\r\n\t\t\tif (!allEnabled) {\r\n\t\t\t\tforeachEnableLines=WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"if (name!==null) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tforeachEnableLines\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tconst foreachLines=JsLines.bae(\r\n\t\t\t\t...allSameSize?[\r\n\t\t\t\t\t\"var attrSize=\"+cmpSize+\";\"\r\n\t\t\t\t]:[\r\n\t\t\t\t\t\"var attrSize=attr[0];\",\r\n\t\t\t\t\t\"var attrName=attr[1];\"\r\n\t\t\t\t],\r\n\t\t\t\tforeachEnableLines,\r\n\t\t\t\t\"bufferOffset+=attrSize;\"\r\n\t\t\t)\r\n\t\t\treturn WrapLines.b(\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"var bufferStride=\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\t\t\"var bufferOffset=0;\",\r\n\t\t\t\t\t\";[\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"].forEach(function(\"+(allSameSize?\"attrName\":\"attr\")+\"){\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\tarrayLines,\r\n\t\t\t\tforeachLines\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.elementIndexBits==32) {\r\n\t\t\ta(\"gl.getExtension('OES_element_index_uint');\") // TODO check if null is returned and don't allow more elements\r\n\t\t}\r\n\t\tif (this.dim>2) {\r\n\t\t\ta(\"gl.enable(gl.DEPTH_TEST);\")\r\n\t\t}\r\n\t\ta(\"gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\t}\r\n\t\ta(this.writeArraysAndBufferData(featureContext.debugOptions.arrays))\r\n\t\tif (!this.hasNormals && this.colorAttrs.length<=0) {\r\n\t\t\ta(\r\n\t\t\t\t\"var positionLoc=gl.getAttribLocation(program,'position');\",\r\n\t\t\t\t\"gl.vertexAttribPointer(positionLoc,\"+this.dim+\",gl.FLOAT,false,0,0);\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(positionLoc);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(writeVertexAttribArrays([\r\n\t\t\t\t[this.dim,'position',true],\r\n\t\t\t\t...this.hasNormals?[[3,'normal',true]]:[],\r\n\t\t\t\t...this.colorAttrs.map(attr=>[3,attr.name,attr.enabled])\r\n\t\t\t]))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.drawElements(gl.\"+this.glPrimitive+\",nElements,\"+this.getElementIndexGlType()+\",0);\")\r\n\t\t} else {\r\n\t\t\ta(\"gl.drawArrays(gl.\"+this.glPrimitive+\",0,nVertices);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Shape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Square extends Shape {\r\n\tget glPrimitive() { return 'TRIANGLE_FAN' }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=4;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t// x    y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"\t-0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=4;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2,3]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Square\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Terrain extends Mesh {\r\n\twriteMeshInit() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"var xyRange=1/Math.sqrt(2);\",\r\n\t\t\t\"var zRange=xyRange;\",\r\n\t\t\t\"var mask=res-1;\",\r\n\t\t\t\"function zOffset(i,j) {\",\r\n\t\t\t\"\treturn vertexElement(i,j\"+(noFaces?\"\":\",0\")+\")*\"+this.getNumbersPerVertex()+\"+2;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"function noise(depth) {\",\r\n\t\t\t\"\tvar r=zRange/Math.pow(2,shapeLod-depth-1);\",\r\n\t\t\t\"\treturn Math.random()*2*r-r;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"vertices[2]=0.0;\",\r\n\t\t\t\"var i0,i1,i2,i3;\",\r\n\t\t\t\"var j0,j1,j2,j3;\",\r\n\t\t\t\"for (var depth=shapeLod-1;depth>=0;depth--) {\",\r\n\t\t\t\"\tvar d=1<<depth;\",\r\n\t\t\t\"\t// diamond step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti1=i2-d;\",\r\n\t\t\t\"\t\t\tj1=j2-d;\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"\t// square step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti0=(i2-2*d)&mask;\",\r\n\t\t\t\"\t\t\tj0=(j2-2*d)&mask;\",\r\n\t\t\t\"\t\t\ti1=(i2-d);\",\r\n\t\t\t\"\t\t\tj1=(j2-d);\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j1)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i1,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (noFaces) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];\",\r\n\t\t\t\t\"for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];\",\r\n\t\t\t\t\"vertices[zOffset(res,res)]=vertices[zOffset(0,0)];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"vertices[vertexOffset+0]=x;\",\r\n\t\t\t\"vertices[vertexOffset+1]=y;\",\r\n\t\t\t(noFaces\r\n\t\t\t\t?\"// vertices[vertexOffset+2] already written\"\r\n\t\t\t\t:\"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];\"\r\n\t\t\t)\r\n\t\t)\r\n\t\tlet iv=3\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var d=4*xyRange/res;\",\r\n\t\t\t\t\"var normal=normalize([\",\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t\"1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Terrain\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Triangle extends Shape {\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=3;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t//                   x                      y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=3;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Triangle\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Transforms extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.rotateVectorEntries=[] // [{vector,suffix}] like features, but vectors have additional methods that don't follow feature interfaces\r\n\t\tthis.transformSequence=new Array(options.model.entries.length) // [{vector,component,suffix}]\r\n\t\tconst possibleComponents=['x','y','z']\r\n\t\tconst rotate=[[],[],[]]\r\n\t\toptions.model.entries.forEach((tr,iTr)=>{\r\n\t\t\tconst trData={\r\n\t\t\t\ttransform: tr,\r\n\t\t\t\tindex: iTr,\r\n\t\t\t}\r\n\t\t\tif (tr.type=='rotate.x') {\r\n\t\t\t\trotate[0].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.y') {\r\n\t\t\t\trotate[1].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.z') {\r\n\t\t\t\trotate[2].push(trData)\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst nLayers=Math.max.apply(null,rotate.map(r=>r.length))\r\n\t\tfor (let i=0;i<nLayers;i++) {\r\n\t\t\tlet isInGap=false\r\n\t\t\tlet isStraight=true\r\n\t\t\tlet lastStraightIndex=-1\r\n\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\tif (isInGap) {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tisStraight=false\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tlastStraightIndex=j\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisInGap=true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst suffix=(nLayers>1?String(i):'')\r\n\t\t\tconst makeVector=(values,names)=>{\r\n\t\t\t\tconst vector=new GlslVector('rotate'+(nLayers>1?'.'+i:''),values,true)\r\n\t\t\t\tvector.i18nId='transforms.model.rotate'\r\n\t\t\t\tthis.features.push(vector)\r\n\t\t\t\tthis.rotateVectorEntries.push({\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t})\r\n\t\t\t\treturn vector\r\n\t\t\t}\r\n\t\t\tconst storeSequenceElement=(vector,j)=>{\r\n\t\t\t\tthis.transformSequence[rotate[j][i].index]={\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tcomponent: possibleComponents[j],\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (isStraight) {\r\n\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\trotate.slice(0,lastStraightIndex+1).map(r=>r[i].transform),\r\n\t\t\t\t\tpossibleComponents.slice(0,lastStraightIndex+1)\r\n\t\t\t\t)\r\n\t\t\t\tfor (let j=0;j<=lastStraightIndex;j++) {\r\n\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\t\t\t[rotate[j][i].transform],\r\n\t\t\t\t\t\t\tpossibleComponents.slice(j,j+1)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget eyeAtInfinity() {\r\n\t\treturn this.options.projection=='ortho'\r\n\t}\r\n\t// private:\r\n\tuse2dTransform(flatShape) { // has flat shape and exactly one z rotation TODO multiple z rotations\r\n\t\treturn flatShape && this.options.model.length==1 && this.options.model[0].type=='rotate.z'\r\n\t}\r\n\tgetTransformMatricesLines(dim) { // dim==3 for normal transform, dim==4 for position transform\r\n\t\tconst a=Lines.ba(\"\")\r\n\t\tconst maxSuffixLength=1 // TODO calculate it\r\n\t\tconst width=4+maxSuffixLength // 1(sign)+3(c.x)+(max suffix length)\r\n\t\tconst pad=e=>{ // TODO (fake-)lodash pad\r\n\t\t\tif (e.length<width) {\r\n\t\t\t\treturn (\"          \"+e).slice(-width)\r\n\t\t\t} else {\r\n\t\t\t\treturn e\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst mat=(rows,comment)=>{\r\n\t\t\ta.t(\"*mat\"+dim+\"( // \"+comment)\r\n\t\t\trows.forEach((row,i)=>{\r\n\t\t\t\tif (i>=dim) return\r\n\t\t\t\ta(\"\t\")\r\n\t\t\t\trow.forEach((e,j)=>{\r\n\t\t\t\t\tif (j>=dim) return\r\n\t\t\t\t\ta.t(pad(e))\r\n\t\t\t\t\tif (i<dim-1 || j<dim-1) a.t(\",\")\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\ta(\")\")\r\n\t\t}\r\n\t\tthis.transformSequence.forEach(ts=>{\r\n\t\t\tif (!ts) return\r\n\t\t\tconst c=ts.vector.getGlslMapComponentValue('c'+ts.suffix,ts.component)\r\n\t\t\tconst s=ts.vector.getGlslMapComponentValue('s'+ts.suffix,ts.component)\r\n\t\t\tif (ts.component=='x') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    c,\"-\"+s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    s,    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around x axis\")\r\n\t\t\t} else if (ts.component=='y') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"0.0\",    s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"-\"+s,\"0.0\",    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around y axis\")\r\n\t\t\t} else if (ts.component=='z') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"-\"+s,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[    s,    c,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around z axis\")\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (dim==4 && this.options.projection=='perspective') {\r\n\t\t\tmat([\r\n\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"-(near+far)/2.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t],\"move center of coords inside view\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\t// public:\r\n\tgetGlslVertexDeclarationLines(flatShape) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(rve.vector.getGlslDeclarationLines())\r\n\t\t})\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta(\"attribute vec2 position;\")\r\n\t\t} else {\r\n\t\t\ta(\"attribute vec4 position;\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(flatShape,receivesAspect,needTransformedPosition) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('c'+rve.suffix,v=>`cos(radians(${v}))`),\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('s'+rve.suffix,v=>`sin(radians(${v}))`)\r\n\t\t\t)\r\n\t\t})\r\n\t\tif (this.options.projection=='perspective') {\r\n\t\t\ta(\r\n\t\t\t\t\"float fovy=45.0;\",\r\n\t\t\t\t\"float near=1.0/tan(radians(fovy)/2.0);\",\r\n\t\t\t\t\"float far=near+2.0;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta(\"vec4 transformedPosition=\")\r\n\t\t} else {\r\n\t\t\ta(\"gl_Position=\")\r\n\t\t}\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta.t(\r\n\t\t\t\t\"vec4(position*mat2(\",\r\n\t\t\t\t\"\tcz, -sz,\",\r\n\t\t\t\t\"\tsz,  cz\",\r\n\t\t\t\t\"),0,1)\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta.t(\"position\")\r\n\t\t\ta.t(this.getTransformMatricesLines(4))\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta.t(\";\")\r\n\t\t\ta(\"gl_Position=transformedPosition\")\r\n\t\t}\r\n\t\tif (this.options.projection=='ortho') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\"*vec4(1.0/aspect,1.0,-1.0,1.0)\") // correct aspect ratio and make coords right-handed\r\n\t\t\t} else if (!flatShape) {\r\n\t\t\t\ta.t(\"*vec4(1.0,1.0,-1.0,1.0)\") // make coords right-handed for 3d shapes\r\n\t\t\t}\r\n\t\t} else if (this.options.projection=='perspective') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear/aspect, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.t(\";\")\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexNormalTransformLines() {\r\n\t\treturn this.getTransformMatricesLines(3)\r\n\t}\r\n}\r\n\r\nmodule.exports=Transforms\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\n\r\nclass VectorComponent {\r\n\tconstructor(value,vectorName,wrapMode) {\r\n\t\tthis.value=value // value from options.fix()\r\n\t\tthis.vectorName=vectorName\r\n\t\tthis.wrapMode=!!wrapMode // if true and components min/max == their default values, use wrap() instead of clamp()\r\n\t}\r\n\tget suffix() {\r\n\t\tconst dotIndex=this.value.name.lastIndexOf('.')\r\n\t\tif (dotIndex<0) {\r\n\t\t\treturn this.value.name\r\n\t\t} else {\r\n\t\t\treturn this.value.name.slice(dotIndex+1)\r\n\t\t}\r\n\t}\r\n\tget name() { return this.vectorName+'.'+this.suffix }\r\n\tget varName() { return camelCase(this.name) }\r\n\tget varNameLoc() { return this.varName+'Loc' }\r\n\tget varNameSpeed() { return this.varName+'Speed' }\r\n\tget varNameInput() { return this.varName+'Input' }\r\n\tget minVarName() { return camelCase('min.'+this.name) }\r\n\tget maxVarName() { return camelCase('max.'+this.name) }\r\n\tget variable() {\r\n\t\treturn this.value.input!='constant' || this.hasSpeed()\r\n\t}\r\n\thasSpeed() {\r\n\t\treturn this.value.speed!=0 || this.value.speed.input!='constant'\r\n\t}\r\n\thasInput() {\r\n\t\treturn this.value.input!='constant' || this.value.speed.input!='constant'\r\n\t}\r\n\thasInputClass(inputClass) {\r\n\t\treturn this.value.input instanceof inputClass || this.value.speed.input instanceof inputClass\r\n\t}\r\n\tusesStartTime() {\r\n\t\treturn (this.value.input=='constant' && this.value.speed!=0) && this.value.speed.input=='constant'\r\n\t}\r\n\tusesPrevTime() {\r\n\t\treturn (this.value.input!='constant' && this.value.speed!=0) || this.value.speed.input!='constant'\r\n\t}\r\n\tget wrapReady() {\r\n\t\treturn (\r\n\t\t\tthis.wrapMode &&\r\n\t\t\tthis.value.min==this.value.availableMin && this.value.max==this.value.availableMax && // can wrap only if limits are not changed\r\n\t\t\tthis.value.min==-this.value.max // currently can limit only by absolute value\r\n\t\t)\r\n\t}\r\n\tget wrapped() {\r\n\t\treturn this.hasSpeed() && this.wrapReady && this.value.input=='slider' // need to wrap only if input with state is used\r\n\t}\r\n\tget clamped() {\r\n\t\treturn !this.wrapped && this.value.speed.input!='constant' && !this.wrapReady\r\n\t}\r\n\tget capped() {\r\n\t\treturn !this.wrapped && !this.clamped && this.hasSpeed() && !this.wrapReady\r\n\t}\r\n}\r\n\r\nmodule.exports=VectorComponent\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\nconst fixOptHelp=require('./fixed-options-helpers')\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Listener=require('./listener-classes')\r\nconst VectorComponent=require('./vector-component')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass Vector extends NumericFeature {\r\n\tconstructor(name,values,wrapMode) {\r\n\t\tsuper()\r\n\t\tthis.name=name // name with dots like \"material.color\", transformed into \"materialColor\" for js var names\r\n\t\tthis.components=[]\r\n\t\tthis.componentsBySuffix={}\r\n\t\tvalues.forEach(v=>{\r\n\t\t\tconst component=new VectorComponent(v,name,wrapMode)\r\n\t\t\tthis.components.push(component)\r\n\t\t\tthis.componentsBySuffix[component.suffix]=component\r\n\t\t})\r\n\t\t// { TODO extra ctor args\r\n\t\tthis.i18nId=name\r\n\t\t// }\r\n\t\tthis.nVars=0\r\n\t\tthis.modeConstant=true // all vector components are constants\r\n\t\tthis.modeFloats=false // one/some vector components are variable, such components get their own glsl vars\r\n\t\tthis.components.forEach((component,i)=>{\r\n\t\t\tif (component.variable) {\r\n\t\t\t\tthis.modeConstant=false\r\n\t\t\t\tif (this.nVars++!=i) {\r\n\t\t\t\t\tthis.modeFloats=true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.nVars==1) {\r\n\t\t\tthis.modeFloats=true\r\n\t\t}\r\n\t\tthis.modeVector=(!this.modeConstant && !this.modeFloats) // first consecutive components are variable, packed into one glsl vector\r\n\t}\r\n\tget varName() { // js/glsl var name\r\n\t\treturn camelCase(this.name)\r\n\t}\r\n\tget updateFnName() {\r\n\t\treturn camelCase('update.'+this.name)\r\n\t}\r\n\t// fns that can be mapped over components:\r\n\tmakeInitialComponentValue() {\r\n\t\treturn component=>{\r\n\t\t\tif (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\" // b/c slider could be init'd to a value different than the default\r\n\t\t\t} else {\r\n\t\t\t\treturn fixOptHelp.formatNumber(component.value)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tmakeUpdatedComponentValue() {\r\n\t\treturn component=>{\r\n\t\t\tif (\r\n\t\t\t\tcomponent.value.speed!=0 || component.value.speed.input!='constant' ||\r\n\t\t\t\tcomponent.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad\r\n\t\t\t) {\r\n\t\t\t\treturn component.varName\r\n\t\t\t} else if (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\"\r\n\t\t\t} else {\r\n\t\t\t\treturn fixOptHelp.formatNumber(component.value)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// abstract fns:\r\n\tgetJsDeclarationLines() { return JsLines.be() } // Locs etc\r\n\tgetJsUpdateLines(componentValue) { return JsLines.be() }\r\n\taddPostToListenerEntryForComponent(entry,component) {} // do necessary entry.post()\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {} // TODO check if we need componentValue - GlslVector doesn't use it\r\n\t// public:\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.components.some(component=>component.hasInput())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (component.hasInput()) featureContext.hasInputs=true\r\n\t\t\tif (component.hasInputClass(Input.Slider)) featureContext.hasSliders=true\r\n\t\t\tif (component.hasInputClass(Input.Gamepad)) featureContext.pollsGamepad=true\r\n\t\t\tif (component.usesStartTime()) featureContext.hasStartTime=true\r\n\t\t\tif (component.usesPrevTime()) featureContext.hasPrevTime=true\r\n\t\t\tif (component.wrapped) featureContext.hasWrapFn=true\r\n\t\t\tif (component.clamped) featureContext.hasClampFn=true\r\n\t\t})\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\ta(\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value,this.i18nId+'.'+component.suffix),\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value.speed,this.i18nId+'.'+component.suffix+'.speed')\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\tconst writeInput=(v,opName,htmlName)=>{\r\n\t\t\tif (v.input!='slider') return\r\n\t\t\tconst fmt=fixOptHelp.makeFormatNumber(v)\r\n\t\t\ta(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\tLines.html`\t<label for=${htmlName}>${i18n(opName)}</label>`,\r\n\t\t\t\tLines.html`\t<span class=min>${i18n(opName+'.value',v.min)}</span>`,\r\n\t\t\t\tLines.html`\t<input type=range id=${htmlName} min=${fmt(v.min)} max=${fmt(v.max)} value=${fmt(v)} step=any />`,\r\n\t\t\t\tLines.html`\t<span class=max>${i18n(opName+'.value',v.max)}</span>`,\r\n\t\t\t\t\"</div>\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\twriteInput(\r\n\t\t\t\tcomponent.value,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix,\r\n\t\t\t\tcomponent.name\r\n\t\t\t)\r\n\t\t\twriteInput(\r\n\t\t\t\tcomponent.value.speed,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix+'.speed',\r\n\t\t\t\tcomponent.name+'.speed'\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst getSliderListenerLines=(doUpdate)=>{\r\n\t\t\tconst getManyListenersLines=()=>{\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\tconst writeListener=(v,htmlName)=>{\r\n\t\t\t\t\tif (v.input!='slider') return\r\n\t\t\t\t\tconst listener=new Listener.Slider(htmlName)\r\n\t\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\ta(featureContext.getListenerLines(listener))\r\n\t\t\t\t}\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\twriteListener(component.value,component.name)\r\n\t\t\t\t\twriteListener(component.value.speed,component.name+'.speed')\r\n\t\t\t\t})\r\n\t\t\t\treturn a.e()\r\n\t\t\t}\r\n\t\t\tconst getOneListenerLines=()=>{\r\n\t\t\t\tconst listener=new Listener.MultipleSlider(\"[id^=\\\"\"+this.name+\".\\\"]\") // will also handle speed sliders, but it's ok\r\n\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t\treturn featureContext.getListenerLines(listener)\r\n\t\t\t}\r\n\t\t\tconst manyListenersLines=getManyListenersLines()\r\n\t\t\tconst oneListenerLines=getOneListenerLines()\r\n\t\t\treturn manyListenersLines.count()<=oneListenerLines.count() ? manyListenersLines : oneListenerLines\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\ta(this.getJsDeclarationLines())\r\n\t\tif (this.modeConstant) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst someSpeeds=this.components.some(component=>component.hasSpeed())\r\n\t\tconst someValueSliders=this.components.some(component=>component.value.input=='slider')\r\n\t\tconst someGamepads=this.components.some(component=>component.hasInputClass(Input.Gamepad))\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (\r\n\t\t\t\t(component.value.input instanceof Input.MouseMove && (someValueSliders || someSpeeds || someGamepads)) || // mouse input required elsewhere\r\n\t\t\t\t(component.value.speed.input!='constant' && component.value.input!='slider') // variable speed and no value input capable of storing the state\r\n\t\t\t) {\r\n\t\t\t\ta(\"var \"+component.varName+\"=\"+fixOptHelp.formatNumber(component.value)+\";\")\r\n\t\t\t}\r\n\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\ta(\"var \"+component.varNameSpeed+\"=\"+fixOptHelp.formatNumber(component.value.speed)+\";\")\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (!someSpeeds && someValueSliders && !someGamepads) {\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function \"+this.updateFnName+\"() {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.getJsUpdateLines(this.makeUpdatedComponentValue())\r\n\t\t\t\t),\r\n\t\t\t\tthis.updateFnName+\"();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(getSliderListenerLines(!someSpeeds && !someGamepads))\r\n\t\tif (this.components.some(component=>(component.value.input instanceof Input.MouseMove))) {\r\n\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\t}\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.value.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tconst fmt=fixOptHelp.makeFormatNumber(component.value)\r\n\t\t\t\t\t;((!someSpeeds && !someValueSliders && !someGamepads) ? entry.minMaxVarFloat : entry.minMaxFloat)(\r\n\t\t\t\t\t\tcomponent.value.input,component.varName,\r\n\t\t\t\t\t\tfmt(component.value.min),\r\n\t\t\t\t\t\tfmt(component.value.max)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tentry.log(\"console.log('\"+component.name+\" input value:',\"+component.varName+\");\")\r\n\t\t\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\t\t\tthis.addPostToListenerEntryForComponent(entry,component)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (!someSpeeds && !someGamepads) {\r\n\t\t\t\tif (!someValueSliders) {\r\n\t\t\t\t\tthis.addPostToListenerEntryAfterComponents(entry,this.makeUpdatedComponentValue())\r\n\t\t\t\t} else {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.components.some(component=>(component.value.speed.input instanceof Input.MouseMove))) {\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tconst fmt=fixOptHelp.makeFormatNumber(component.value.speed)\r\n\t\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tentry.minMaxFloat(component.value.speed.input,component.varNameSpeed,fmt(component.value.speed.min),fmt(component.value.speed.max))\r\n\t\t\t\t\t\t.log(\"console.log('\"+component.name+\".speed input value:',\"+component.varNameSpeed+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tconst add=(s)=>{\r\n\t\t\tconst c=s.charAt(0)\r\n\t\t\tif (c=='-' || c=='+') {\r\n\t\t\t\treturn s\r\n\t\t\t} else {\r\n\t\t\t\treturn \"+\"+s\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet needUpdate=false\r\n\t\tconst writeGamepad=(component,v,dotSuffix,varSuffix)=>{\r\n\t\t\tif (v.input instanceof Input.Gamepad) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tconst fmt=fixOptHelp.makeFormatNumber(v)\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var \"+component.minVarName+varSuffix+\"=\"+fmt(v.min)+\";\",\r\n\t\t\t\t\t\"var \"+component.maxVarName+varSuffix+\"=\"+fmt(v.max)+\";\",\r\n\t\t\t\t\t\"var \"+component.varName+varSuffix+\"=\"+fmt(v)+\";\",\r\n\t\t\t\t\t\"if (gamepad && gamepad.axes.length>\"+v.input.axis+\") {\",\r\n\t\t\t\t\t\"\t\"+component.varName+varSuffix+\"=\"+component.minVarName+varSuffix+\"+(\"+component.maxVarName+varSuffix+\"-\"+component.minVarName+varSuffix+\")*(gamepad.axes[\"+v.input.axis+\"]+1)/2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.inputs) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+dotSuffix+\" input value:',\"+component.varName+varSuffix+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tconst v=component.value\r\n\t\t\twriteGamepad(component,v,'','')\r\n\t\t\twriteGamepad(component,v.speed,'.speed','Speed')\r\n\t\t\tif (component.hasSpeed()) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tconst fmt=fixOptHelp.makeFormatNumber(v)\r\n\t\t\t\tconst sfmt=fixOptHelp.makeFormatNumber(v.speed)\r\n\t\t\t\tlet addSpeed\r\n\t\t\t\tif (v.speed.input=='slider') {\r\n\t\t\t\t\taddSpeed=\"+parseFloat(document.getElementById('\"+component.name+\".speed').value)\"\r\n\t\t\t\t} else if (v.speed.input instanceof Input.MouseMove || v.speed.input instanceof Input.Gamepad) {\r\n\t\t\t\t\taddSpeed=\"+\"+component.varNameSpeed\r\n\t\t\t\t} else {\r\n\t\t\t\t\taddSpeed=add(sfmt(v.speed))\r\n\t\t\t\t}\r\n\t\t\t\tlet limitFn=(x,dx)=>{\r\n\t\t\t\t\tif (x==component.varName) {\r\n\t\t\t\t\t\treturn dx.charAt(0)+\"=\"+dx.slice(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"=\"+x+dx\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (component.wrapped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=wrap(\"+x+dx+\",\"+fmt(v.max)+\")\"\r\n\t\t\t\t} else if (component.clamped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=clamp(\"+x+dx+\",\"+fmt(v.min)+\",\"+fmt(v.max)+\")\"\r\n\t\t\t\t} else if (component.capped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=Math.\"+(v.speed<0?\"max\":\"min\")+\"(\"+x+dx+\",\"+(v.speed<0?fmt(v.min):fmt(v.max))+\")\"\r\n\t\t\t\t}\r\n\t\t\t\tconst incrementLine=(base,dt)=>component.varName+limitFn(base,addSpeed+\"*\"+dt+\"/1000\")+\";\"\r\n\t\t\t\tif (v.input=='slider') {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"var \"+component.varNameInput+\"=document.getElementById('\"+component.name+\"');\",\r\n\t\t\t\t\t\t\"var \"+incrementLine(\"parseFloat(\"+component.varNameInput+\".value)\",\"(time-prevTime)\"),\r\n\t\t\t\t\t\tcomponent.varNameInput+\".value=\"+component.varName+\";\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (v.input instanceof Input.MouseMove || v.speed.input!='constant') {\r\n\t\t\t\t\ta(incrementLine(component.varName,\"(time-prevTime)\"))\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"var \"+incrementLine(fmt(v),\"(time-startTime)\"))\r\n\t\t\t\t}\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.animations) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+\" animation value:',\"+component.varName+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (needUpdate) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeUpdatedComponentValue()))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Vector\r\n"],"sourceRoot":"."}