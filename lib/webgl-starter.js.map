{"version":3,"sources":["webgl-starter.js","node_modules/browser-pack/_prelude.js","node_modules/crnx-base/array-option-output.js","node_modules/crnx-base/code-output-i18n.js","node_modules/crnx-base/code-output.js","node_modules/crnx-base/code-section.js","node_modules/crnx-base/details-polyfill.js","node_modules/crnx-base/fake-lodash/camelcase.js","node_modules/crnx-base/fake-lodash/capitalize.js","node_modules/crnx-base/fake-lodash/debounce.js","node_modules/crnx-base/fake-lodash/escape.js","node_modules/crnx-base/fake-lodash/repeat.js","node_modules/crnx-base/format-number.js","node_modules/crnx-base/format-numbers.js","node_modules/crnx-base/group-option-output.js","node_modules/crnx-base/i18n-expand-curly.js","node_modules/crnx-base/i18n-link-wikipedia.js","node_modules/crnx-base/i18n.js","node_modules/crnx-base/indent-lines.js","node_modules/crnx-base/interleave-lines.js","node_modules/crnx-base/js-lines.js","node_modules/crnx-base/lines.js","node_modules/crnx-base/nose-wrap-lines.js","node_modules/crnx-base/option-classes.js","node_modules/crnx-base/options-output-i18n.js","node_modules/crnx-base/options-output.js","node_modules/crnx-base/options.js","node_modules/crnx-base/tip.js","node_modules/crnx-base/web-code.js","node_modules/crnx-base/wrap-lines.js","src/background.js","src/call-vector.js","src/canvas.js","src/code.js","src/colorgen.js","src/feature-context.js","src/feature.js","src/glsl-vector.js","src/i18n.js","src/illumination.js","src/input-classes.js","src/int-feature.js","src/listener-classes.js","src/main.js","src/numeric-feature.js","src/option-classes.js","src/options-output.js","src/options.js","src/shape-classes.js","src/shapes/cube.js","src/shapes/gasket.js","src/shapes/hat.js","src/shapes/lodshape.js","src/shapes/mesh.js","src/shapes/shape.js","src/shapes/square.js","src/shapes/terrain.js","src/shapes/triangle.js","src/transforms.js","src/vector-component.js","src/vector.js"],"names":["babelHelpers","typeof","obj","Symbol","constructor","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","classCallCheck","instance","TypeError","possibleConstructorReturn","self","call","ReferenceError","inherits","subClass","superClass","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","undefined","create","taggedTemplateLiteralLoose","strings","raw","e","t","n","r","s","o","u","a","require","f","Error","code","l","exports",1,"module","ArrayOptionOutput","option","writeOption","i18n","generateId","_this","this","$dragged","$entries","$","append","entries","map","subOption","writeDraggableSubOption","$buttons","availableTypes","forEach","type","html","fullName","click","makeEntry","updateArrayEntries","$output","canDeleteEntry","$entry","children","data","get","_this2","moveUp","$moved","prev","before","moveDown","next","after","attemptDelete","remove","This","on","ev","parent","originalEvent","dataTransfer","effectAllowed","setData","name","setDragImage","setTimeout","addClass","$sorted","h","height","offset","top","y","touches","pageY","$prev","$next","removeClass","keydown","$handle","keyCode","focus","preventDefault","dropEffect","$target","is","dh","nextAll","th","_dh","_y","prevAll",2,"lang","additionalStringsPrefix","additionalStrings","en","save","run","open.codepen","open.jsfiddle","open.plunker","section.html","section.css","section.js","embedded","mode.full","mode.body","mode.embed","mode.paste","mode.file","formatting","formatting.indent","formatting.indentNumber","formatting.jsSemicolons","warning.no-hljs","ru","id",3,"debounce","repeat","detailsPolyfill","getHtmlDataUri","encodeURIComponent","makeObjectWithSetters","values","setCallback","_loop","prop","set","v","CodeOutput","generateCode","defaultFormatting","update","flush","applyUpdatedCode","sectionModes","css","js","_code","initDomProps","writeFormattingControls","$indentCheckbox","$indentNumber","updateIndent","indent","checkValidity","Number","val","change","jsSemicolons","checked","each","writeSection","sectionName","writeSectionSummary","$sectionCode","writeButtons","window","hljs","$saveButtons","sections","extractSections","empty","$code","getHtml","join","highlightBlock","postData","url","$form","attr","appendTo","submit","navigator","msSaveOrOpenBlob","w","open","document","write","close","getSection","JSON","stringify","title","wrap","_postData","filename","$summary","mode","section","blob","Blob","mimeType","$a","URL","createObjectURL","10","5","8",4,"CodeSection","lines","detailsSupported","createElement","$details","toggleOpen","removeAttr","keyCodeEnter","keyCodeSpace","handleEvent","closest",6,"capitalize","split","7","charAt","toUpperCase","slice","func","wait","timeoutId","debounced","clearTimeout",9,"entityMap","&","<",">","\"","'","String","replace","m","Array",11,"formatNumbers","formatNumber","number","precision","glsl","12","formatNumbersInternal","numbers","keepDot","noPlus","maxPrecision","hasNegative","p","toFixed","match","ss","isArray","_i","_number","_s",13,"GroupOptionOutput",14,"inStrings","expandIdAndString","string","expandRegexp","exec","idStart","idMids","idEnd","stringStart","stringMidsStr","stringMids","stringEnd","idMid","stringMid",15,"p1","link","text","indexOf",16,"escape","langStrings","defaultLang","has","pluralSuffix","ns","nn","Math","abs","teen","plural","numberWithUnits","unit","abbrFn","abbr","expansion","test",17,"Lines","IndentLines","_Lines","level","doGet","indentStr","20",18,"InterleaveLines","apply","arguments","out","first","fp","push","item","subOut",19,"JsLines","processStringInGet","TO","isDataEmpty","isEmpty","addTo","pop","shift","b","_arguments","makeLines","Function","bind","concat","ae","ba","_b","be","bae","_b2","count","_arguments2","reduce",21,"WrapLines","NoseWrapLines","_WrapLines","28",22,"Option","Base","_class","settings","visibilityManager","updateCallbacks","_$","isVisible","register","visibilityData","visibilityDataLogic","testName","options","declareAffectedBy","make","nScalars","nArrays","nObjects","scalarArg","arrayArg","objectArg","arg","optionClass","collectArgs","updateVisibility","toggle","updateCallback","addUpdateCallback","shortenExport","dataKeys","shortenExportAssign","parentData","Input","_Option$Base","_class2","defaultValue","_value","Boolean","_Option$Input","_class3","fix","NonBoolean","_Option$Input2","_class4","valueOf","toString","Factor","_Option$NonBoolean","_class5","_this4","availableValues","_Option$NonBoolean2","_class6","_this5","availableMin","availableMax","fixed","Collection","_Option$Base2","_class7","_this6","descriptions","x","subName","subData","entry","fixedEntries","Void","_Option$Base3","_class8","Checkbox","_Option$Boolean","_class9","Select","_Option$Factor","_class10","Text","_Option$Factor2","_class11","Int","_Option$Number","_class12","Float","_Option$Number2","_class13","_this12","Root","_Option$Collection","_class14","Group","_Option$Collection2","_class15","_Option$Base4","_class16","_this15","availableConstructors","Map","enterArray","ctor","exitArray","typePropertyName","_entries","subDatas","defaultType","subType","subCtor","_this16","_this17","subFixed","types","_",23,"reset","drag","drag.tip","delete","delete.tip",24,"writeTip","OptionsOutput","optionProto","getPrototypeOf","optionClassWriter","optionClassWriters","setOptionClassWriters","root","getLeadLabel","valueId","valueInfoId","$select","availableValue","some","$tip","handler","find","listId","setInputAttrs","$input","pow","setInputAttrsAndListeners","getOtherInput","$that","parseFloat","$sliderInput","$numberInput","fmt","min","max","infoId","26",25,"OptionVisibilityManager","affects","inArray","updateVisibilityAffectedBy","byFullName","Options","optionClasses","description","_Option$className","className","makeArgs","entriesDescription","tipClass","tipContent","popupTimeoutId","popupLevel","handlePopup","dLevel","delay","mouseenter","focusin",27,"_templateObject","_templateObject2","_templateObject3","WebCode","getLines","stylePlaceLines","cachedStyleLines","styleExtractLines","getSectionPasteComment","basename","scriptPlaceLines","cachedScriptLines","scriptExtractLines","htmlExtractLines","getBodyHtmlSectionLines","getFullHtmlSectionLines","cachedHeadLines","cachedBodyLines","_styleLines","styleLines","_headLines","headLines","_bodyLines","bodyLines","_scriptLines","scriptLines","wrappers","pushWrapper",29,"Feature","CallVector","Background","_Feature","isSolid","features","color","getJsLoopLines","featureContext","30","35","Vector","_Vector","calledFn","calledFnDefaultArgs","getJsUpdateLines","componentValue","nValueSliders","components","component","input","modeConstant","every","dotIndex","lastIndexOf","suffixArray","suffix","addPostToListenerEntryAfterComponents","post","59",31,"Listener","IntFeature","Canvas","width","getHtmlCanvasLines","getGlslVertexDeclarationLines","hasInputs","getGlslVertexOutputLines","needAspectConstant","providesAspect","getJsInitLines","canvasUpdater","canvasListener","wh","listener","Slider","enter","log","getListenerLines","40","41",32,"Shape","FeatureContext","Transforms","Illumination","BaseWebCode","Code","_BaseWebCode","debug","canvas","background","transforms","illumination","material","light","makeShape","shape","scope","getColorAttrs","featureNames","feature","requestFeatureContext","hasSliders","getVertexShaderLines","needTransformedPosition","wantsTransformedPosition","eyeAtInfinity","dim","hasNormals","getGlslVertexNormalTransformLines","getFragmentShaderLines","getGlslFragmentDeclarationLines","getGlslFragmentOutputLines","twoSided","_NoseWrapLines$b","_this3","getHtmlControlMessageLines","getHtmlInputLines","getMakeProgramLines","debugShaders","addWithCommentIfNotEmpty","featureLines","comment","getJsAfterInitLines","getJsInnerLoopLines","hasClampFn","hasWrapFn","pollsGamepad","hasStartTime","hasPrevTime","isAnimated","hasTime","34","38","47","57",33,"colorgenCounter","SingleColorgen","weight","noise","baseColors","defaultBaseColors","colorgenNumber","nextIndex","getNextColorString","baseColor","ci","sin","co","Colorgen","colorAttrs","singleColorgens","getHeaderString","singleColorgen","debugOptions","canvasMousemoveListener","CanvasMousemove","inputs","getRecursiveLines","method","args",36,"GlslVector","wrapRange","getGlslDeclarationLines","modeFloats","nVars","varName","_ret","variable","getGlslValue","getGlslComponentsValue","selectedComponents","results","j","c","componentsBySuffix","modeVector","prevResult","allSuffixString","allSameConstant","cmp","result","showResult","getGlslMapDeclarationLines","mapName","mapFn","getGlslMapComponentValue","selectedComponent","getJsDeclarationLines","varNameLoc","addPostToListenerEntryForComponent","vs",37,"options.canvas","options.canvas.{width,height}","options.background","options.background.type","options.background.type.none","options.background.type.solid","options.background.color","options.background.color.{r,g,b,a}","options.background.color.{r,g,b,a}.speed","options.material","options.material.scope","options.material.scope.global","options.material.scope.vertex","options.material.scope.face","options.material.data","options.material.data.one","options.material.data.sda","options.material.color","options.material.color.{r,g,b,a}","options.material.color.{r,g,b,a}.speed","options.material.{specular,diffuse,ambient}Color","options.material.{specular,diffuse,ambient}Color.{r,g,b}","options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed","options-info.material.data.sda","options.light","options.light.type","options.light.type.off","options.light.type.phong","options.light.type.blinn","options.light.direction","options.light.direction.{x,y,z}","options.light.direction.{x,y,z}.speed","options-info.light.type.phong","options-info.light.type.blinn","options.shape","options.shape.type","options.shape.type.square","options.shape.type.triangle","options.shape.type.gasket","options.shape.type.cube","options.shape.type.hat","options.shape.type.terrain","options.shape.elements","options.shape.elements.0","options.shape.elements.{8,16,32}","options.shape.lod","options-info.shape.type.gasket","options-info.shape.type.hat","options-info.shape.type.terrain","options-info.shape.elements.{8,16}","options.transforms","options.transforms.projection","options.transforms.projection.ortho","options.transforms.projection.perspective","options.transforms.model","options.transforms.model.rotate.{x,y,z}.add","options.transforms.model.rotate.{x,y,z}","options.transforms.model.rotate.{x,y,z}.speed","options-info.transforms.projection.ortho","options-info.transforms.projection.perspective","options.debug","options.debug.shaders","options.debug.arrays","options.debug.inputs","options.debug.animations","options-output.inputs","options-output.inputs.constant","options-output.inputs.slider","options-output.inputs.mousemove{x,y}","options-output.inputs.gamepad{0,1,2,3}","options-output.range","options-output.addSpeed","controls.type.mousemove{x,y}","controls.to","units.pixel.a","units.pixel.{1,2}","units.°/second.a","units.°/second.{1,2}","units.second.a","units.1/second.{1,2}","options.material.specularColor.{r,g,b}","options.material.diffuseColor.{r,g,b}","options.material.ambientColor.{r,g,b}","options.material.specularColor.{r,g,b}.speed","options.material.diffuseColor.{r,g,b}.speed","options.material.ambientColor.{r,g,b}.speed","units.pixel.{1,2,5}","units.°/second.{1,2,5}","units.1/second.{1,2,5}","colorVector","specularColorVector","specularColor","diffuseColorVector","diffuseColor","ambientColorVector","ambientColor","LiveFloat","lightDirectionVector","direction","enabled","hasNormalAttr","normalTransformLines","colorRGB","colorA","colorRGBA","vector","specularDotArgs","shininessCorrection","44",39,"createFromString","str","constant","Constant","slider","mousemovex","MouseMove","mousemovey","gamepad0","Gamepad","gamepad1","gamepad2","gamepad3","_str","_Base","Variable","_Base2","_Variable","_Variable2","axis","_Variable3","NumericFeature","_NumericFeature","getHtmlControlMessageForValue","getHtmlSliderLines","43","makePushArgs","where","proxy","pre","cond","prependedStatements","bracketFnArg","wrapCall","haveToUpdateCanvas","haveToLogInput","statementsGraph","statementsRoot","statementsPrev","WHITE","GRAY","BLACK","addStatement","statement","vertex","prevs","conds","mark","closeEntryStatements","getStatements","statements","currentCond","writeStatement","newCond","recVertex","recPrevs","br","bracketListener","MultipleSlider","query","_Base3","floatHelper","minMaxFlag","varFlag","inputType","minValue","maxValue","VarName","dest","prexy","xStatement","yStatement","minMaxFloat","minMaxVarFloat","newVarInt",42,"idCounter","i18ns","$container","codeOutput","optionsOutput","45","46","opName","htmlName","step","fmtAttrs","fmtLabels","minMax","FixedLiveNumber","src","setToDefault","LiveNumber","dataValue","dataMin","dataMax","dataInput","_min","_max","_input","_$range","updateInternalVisibility","exportHelper","$range","LiveInt","_Option$LiveNumber","CanvasLiveInt","_Option$LiveInt","_Option$LiveNumber2","dataSpeedValue","dataSpeedMin","dataSpeedMax","dataSpeedInput","speed","_speedAvailableMin","_speedAvailableMax","_speedValue","_speedMin","_speedMax","_speedInput","_addSpeed","_speed$","_speed$range","_$addSpeed","notGamepad","addSpeed","availableInputTypes","$addSpeed","LiveColor","_Option$Group","componentDefaultValues","cs","BaseOptionsOutput","_BaseOptionsOutput","writeSubOption","writeMinMaxInput","minOrMax","$inputSelect","$rangeMinInput","$rangeMaxInput","availableInputType","BaseOptions","_BaseOptions","background.type","material.scope","material.data","light.type","shape.type","square","triangle","gasket","cube","hat","terrain","48","49","50","54","55","56","Cube","_Shape","writeArrays","colorgen","hasColorsPerFace","nCubeVertices","cubeColors","cubeVertexPositions","nCubeFaces","cubeFaceNames","cubeFaceNormals","cubeFaceVertices","quadToTriangleMap","vertexCtor","appendVertex","iFace","iVertex","firstInFace","hasColorsPerVertex","wrapVertices","usesElements","k","_loop2","_i2","getElementIndexJsArray","_ret3","_i3","elementCtor","_loop3","_i4","wrapElements","53","LodShape","Gasket","_LodShape","getDistinctVertexCount","lodSymbol","getFaceVertexCount","getTotalVertexCount","writeStoreShape","writePushVertex","writeTriangle","writeInitialTriangleCall","writeColorData","51","Mesh","Hat","_Mesh","writeMeshInit","writeMeshVertex","iv","writeMeshVertexColors","52","hasReflections","maxLod","getMaxPossibleLod","lod","cap","requestedMaxLod","elementIndexBits","nVerticesFn","indexLimit","eval","writeArraysAndBufferData","debugArrays","getNumbersPerVertex","writeDebug","writeBufferData","parseInt","elements","getElementIndexGlType","writeVertexAttribArrays","attrs","cmpSize","allSameSize","size","allEnabled","arrayLines","foreachEnableLines","foreachLines","arrays","glPrimitive","Square","colorDataForFace","Terrain","noFaces","Triangle","rotateVectorEntries","transformSequence","model","possibleComponents","rotate","tr","iTr","trData","transform","index","nLayers","isInGap","isStraight","lastStraightIndex","makeVector","names","i18nId","storeSequenceElement","_j","_j2","_has","_vector","use2dTransform","flatShape","getTransformMatricesLines","maxSuffixLength","pad","mat","rows","row","ts","projection","rve","receivesAspect",58,"camelCase","VectorComponent","vectorName","hasSpeed","hasInput","hasInputClass","inputClass","usesStartTime","usesPrevTime","wrapReady","wrapped","clamped","makeInitialComponentValue","makeUpdatedComponentValue","getSliderListenerLines","doUpdate","getManyListenersLines","writeListener","updateFnName","getOneListenerLines","manyListenersLines","oneListenerLines","someSpeeds","someValueSliders","someGamepads","writeVarLines","sfmt","snumbers","writes","swrites","varNameSpeed","add","needUpdate","writeGamepad","dotSuffix","varSuffix","minVarName","maxVarName","limitFn","dx","capped","incrementLine","base","dt","varNameInput","animations"],"mappings":"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","file":"webgl-starter.js","sourcesContent":["(function () {\n    var babelHelpers = {\n        typeof: function (obj) {\n            return obj && typeof Symbol !== 'undefined' && obj.constructor === Symbol ? 'symbol' : typeof obj;\n        },\n        createClass: function () {\n            function defineProperties(target, props) {\n                for (var i = 0; i < props.length; i++) {\n                    var descriptor = props[i];\n                    descriptor.enumerable = descriptor.enumerable || false;\n                    descriptor.configurable = true;\n                    if ('value' in descriptor)\n                        descriptor.writable = true;\n                    Object.defineProperty(target, descriptor.key, descriptor);\n                }\n            }\n            return function (Constructor, protoProps, staticProps) {\n                if (protoProps)\n                    defineProperties(Constructor.prototype, protoProps);\n                if (staticProps)\n                    defineProperties(Constructor, staticProps);\n                return Constructor;\n            };\n        }(),\n        classCallCheck: function (instance, Constructor) {\n            if (!(instance instanceof Constructor)) {\n                throw new TypeError('Cannot call a class as a function');\n            }\n        },\n        possibleConstructorReturn: function (self, call) {\n            if (!self) {\n                throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n            }\n            return call && (typeof call === 'object' || typeof call === 'function') ? call : self;\n        },\n        inherits: function (subClass, superClass) {\n            function defaults(obj, defaults) {\n                var keys = Object.getOwnPropertyNames(defaults);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = keys[i];\n                    var value = Object.getOwnPropertyDescriptor(defaults, key);\n                    if (value && value.configurable && obj[key] === undefined) {\n                        Object.defineProperty(obj, key, value);\n                    }\n                }\n                return obj;\n            }\n            ;\n            if (typeof superClass !== 'function' && superClass !== null) {\n                throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n            }\n            subClass.prototype = Object.create(superClass && superClass.prototype, {\n                constructor: {\n                    value: subClass,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true\n                }\n            });\n            if (superClass)\n                defaults(subClass, superClass);\n        },\n        taggedTemplateLiteralLoose: function (strings, raw) {\n            strings.raw = raw;\n            return strings;\n        }\n    };\n    (function e(t, n, r) {\n        function s(o, u) {\n            if (!n[o]) {\n                if (!t[o]) {\n                    var a = typeof require == 'function' && require;\n                    if (!u && a)\n                        return a(o, !0);\n                    if (i)\n                        return i(o, !0);\n                    var f = new Error('Cannot find module \\'' + o + '\\'');\n                    throw f.code = 'MODULE_NOT_FOUND', f;\n                }\n                var l = n[o] = { exports: {} };\n                t[o][0].call(l.exports, function (e) {\n                    var n = t[o][1][e];\n                    return s(n ? n : e);\n                }, l, l.exports, e, t, n, r);\n            }\n            return n[o].exports;\n        }\n        var i = typeof require == 'function' && require;\n        for (var o = 0; o < r.length; o++)\n            s(r[o]);\n        return s;\n    }({\n        1: [\n            function (require, module, exports) {\n                'use strict';\n                var ArrayOptionOutput = function () {\n                    function ArrayOptionOutput(option, writeOption, i18n, generateId) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, ArrayOptionOutput);\n                        this.option = option;\n                        this.$dragged = null;\n                        this.$entries = $('<div>').append(option.entries.map(function (subOption) {\n                            return _this.writeDraggableSubOption(subOption, writeOption, i18n);\n                        }));\n                        var $buttons = $('<div class=\\'buttons\\'>');\n                        option.availableTypes.forEach(function (type, i) {\n                            if (i)\n                                $buttons.append(' ');\n                            $buttons.append($('<button type=\\'button\\'>').html(i18n('options.' + option.fullName + '.' + type + '.add')).click(function () {\n                                //option.addEntry(type,entry=>this.$entries.append(this.writeDraggableSubOption(entry,writeOption,i18n)))\n                                _this.$entries.append(_this.writeDraggableSubOption(option.makeEntry(type), writeOption, i18n));\n                                _this.updateArrayEntries();\n                            }));\n                        });\n                        this.$output = option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>', this.$entries, $buttons);\n                    }\n                    ArrayOptionOutput.prototype.canDeleteEntry = function canDeleteEntry($entry) {\n                        return true;\n                    };\n                    ArrayOptionOutput.prototype.updateArrayEntries = function updateArrayEntries() {\n                        this.option.entries = this.$entries.children().map(function () {\n                            return $(this).data('option');\n                        }).get();\n                    };\n                    ArrayOptionOutput.prototype.writeDraggableSubOption = function writeDraggableSubOption(subOption, writeOption, i18n) {\n                        var _this2 = this;\n                        // have to make drag handler 'draggable', not the whole item\n                        // because inputs and labels don't like to be inside 'draggable'\n                        // http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\n                        var moveUp = function ($moved) {\n                            $moved.prev().before($moved);\n                            _this2.updateArrayEntries();\n                        };\n                        var moveDown = function ($moved) {\n                            $moved.next().after($moved);\n                            _this2.updateArrayEntries();\n                        };\n                        var attemptDelete = function ($entry) {\n                            if (_this2.canDeleteEntry($entry)) {\n                                $entry.remove();\n                                _this2.updateArrayEntries();\n                            }\n                        };\n                        var This = this;\n                        return $('<div class=\\'draggable-with-handle\\'>').data('option', subOption).append(writeOption(subOption), ' ', $('<span draggable=\\'true\\' tabindex=\\'0\\' title=\\'' + i18n('options-output.drag.tip') + '\\'>').append('<span>' + i18n('options-output.drag') + '</span>').on('dragstart', function (ev) {\n                            This.$dragged = $(this).parent();\n                            ev.originalEvent.dataTransfer.effectAllowed = 'move';\n                            ev.originalEvent.dataTransfer.setData('Text', name);\n                            if (ev.originalEvent.dataTransfer.setDragImage) {\n                                // doesn't work in IE\n                                ev.originalEvent.dataTransfer.setDragImage(This.$dragged[0], 0, 0);\n                            }\n                            setTimeout(function () {\n                                This.$dragged.addClass('ghost');\n                            }, 0);\n                        }).on('touchstart', function (ev) {\n                            var $sorted = $(this).parent();\n                            $sorted.addClass('ghost');\n                            return false;    // disable touch panning on Firefox\n                        }).on('touchmove', function (ev) {\n                            var $sorted = $(this).parent();\n                            var h = $sorted.height();\n                            var t = $sorted.offset().top;\n                            var y = ev.originalEvent.touches[0].pageY;\n                            // TODO test if length of touches is 1\n                            var $prev = $sorted.prev();\n                            if ($prev.length && y < t && y - $prev.offset().top < h) {\n                                moveUp($sorted);\n                            }\n                            var $next = $sorted.next();\n                            if ($next.length && y > t + h && y - $next.offset().top > $next.height() - h) {\n                                moveDown($sorted);\n                            }\n                            return false;    // disable touch panning\n                        }).on('touchend touchcancel', function (ev) {\n                            var $sorted = $(this).parent();\n                            $sorted.removeClass('ghost');\n                        }).keydown(function (ev) {\n                            var $handle = $(this);\n                            var $sorted = $handle.parent();\n                            if (ev.keyCode == 38) {\n                                moveUp($sorted);\n                                $handle.focus();\n                                return false;\n                            } else if (ev.keyCode == 40) {\n                                moveDown($sorted);\n                                $handle.focus();\n                                return false;\n                            }\n                        }), ' ', $('<button class=\\'delete\\' title=\\'' + i18n('options-output.delete.tip') + '\\'>').append('<span>' + i18n('options-output.delete') + '</span>').click(function () {\n                            attemptDelete($(this).parent());\n                        }).keydown(function (ev) {\n                            if (ev.keyCode == 13 || ev.keyCode == 32) {\n                                attemptDelete($(this).parent());\n                                return false;\n                            }\n                        })).on('dragover', function (ev) {\n                            ev.preventDefault();\n                            ev.originalEvent.dataTransfer.dropEffect = 'move';\n                            var $target = $(this);\n                            if (This.$dragged) {\n                                if ($target.next().is(This.$dragged)) {\n                                    var dh = This.$dragged.height();\n                                    var y = ev.pageY - $target.offset().top;\n                                    if (y < dh) {\n                                        moveUp(This.$dragged);\n                                    }\n                                } else if ($target.nextAll().is(This.$dragged)) {\n                                    moveUp(This.$dragged);\n                                } else if ($target.prev().is(This.$dragged)) {\n                                    var th = $target.height();\n                                    var _dh = This.$dragged.height();\n                                    var _y = ev.pageY - $target.offset().top;\n                                    if (_y > th - _dh) {\n                                        moveDown(This.$dragged);\n                                    }\n                                } else if ($target.prevAll().is(This.$dragged)) {\n                                    moveDown(This.$dragged);\n                                }\n                            }\n                        }).on('drop', function (ev) {\n                            ev.preventDefault();\n                        }).on('dragend', function (ev) {\n                            ev.preventDefault();\n                            if (This.$dragged) {\n                                This.$dragged.removeClass('ghost');\n                                This.$dragged = null;\n                            }\n                        });\n                    };\n                    return ArrayOptionOutput;\n                }();\n                module.exports = ArrayOptionOutput;\n            },\n            {}\n        ],\n        2: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (lang) {\n                    return function (strings) {\n                        var additionalStringsPrefix = 'code-output';\n                        var additionalStrings = {\n                            en: {\n                                'save': 'Save source code',\n                                'run': 'Run in new window',\n                                'open.codepen': 'Open in CodePen',\n                                'open.jsfiddle': 'Open in JSFiddle',\n                                'open.plunker': 'Open in Plunker',\n                                'section.html': 'HTML',\n                                'section.css': 'CSS',\n                                'section.js': 'JavaScript',\n                                'embedded': 'embedded in HTML source code',\n                                'mode.full': 'complete HTML',\n                                'mode.body': 'only HTML body',\n                                'mode.embed': 'embed in HTML',\n                                'mode.paste': 'extract to paste into HTML later',\n                                'mode.file': 'extract to load as external resource',\n                                'formatting': 'Formatting',\n                                'formatting.indent': 'indent with tabs',\n                                'formatting.indentNumber': 'spaces per indent',\n                                'formatting.jsSemicolons': 'JavaScript semicolons',\n                                'warning.no-hljs': '<a href=https://highlightjs.org/>highlight.js</a> (hosted on <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) is not loaded. Syntax highlighting is disabled.'\n                            },\n                            ru: {\n                                'save': 'Сохранить исходный код',\n                                'run': 'Запустить в новом окне',\n                                'open.codepen': 'Открыть в CodePen',\n                                'open.jsfiddle': 'Открыть в JSFiddle',\n                                'open.plunker': 'Открыть в Plunker',\n                                'section.html': 'HTML',\n                                'section.css': 'CSS',\n                                'section.js': 'JavaScript',\n                                'embedded': 'встроен в код HTML',\n                                'mode.full': 'полностью',\n                                'mode.body': 'только <code>body</code>',\n                                'mode.embed': 'встроить в HTML',\n                                'mode.paste': 'извлечь для последующей вставки в HTML',\n                                'mode.file': 'извлечь для загрузки в качестве внешнего ресурса',\n                                'formatting': 'Форматирование',\n                                'formatting.indent': 'отступы с помощью tab',\n                                'formatting.indentNumber': 'пробелов в отступе',\n                                'formatting.jsSemicolons': '<code>;</code> в JavaScript',\n                                'warning.no-hljs': '<a href=https://highlightjs.org/>highlight.js</a> (с сервера <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) не загружен. Подсветка синтаксиса отключена.'\n                            }\n                        };\n                        for (var id in additionalStrings[lang]) {\n                            strings[additionalStringsPrefix + '.' + id] = additionalStrings[lang][id];\n                        }\n                        return strings;\n                    };\n                };\n            },\n            {}\n        ],\n        3: [\n            function (require, module, exports) {\n                'use strict';\n                var debounce = require(8);\n                var repeat = require(10);\n                var detailsPolyfill = require(5);\n                var getHtmlDataUri = function (html) {\n                    return 'data:text/html;charset=utf-8,' + encodeURIComponent(html);\n                };\n                var makeObjectWithSetters = function (values, setCallback) {\n                    var obj = {};\n                    var _loop = function (prop) {\n                        Object.defineProperty(obj, prop, {\n                            get: function () {\n                                return values[prop];\n                            },\n                            set: function (v) {\n                                values[prop] = v;\n                                setCallback();\n                            }\n                        });\n                    };\n                    for (var prop in values) {\n                        _loop(prop);\n                    }\n                    return obj;\n                };\n                var CodeOutput = function () {\n                    function CodeOutput(generateCode, i18n) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, CodeOutput);\n                        this.formatting = makeObjectWithSetters(this.defaultFormatting, function () {\n                            _this.update.flush();\n                            _this.applyUpdatedCode(i18n);\n                        });\n                        this.sectionModes = makeObjectWithSetters({\n                            html: 'full',\n                            css: 'embed',\n                            js: 'embed'\n                        }, function () {\n                            _this.update.flush();\n                            _this.applyUpdatedCode(i18n);\n                        });\n                        this._code = generateCode();\n                        this.update = debounce(function () {\n                            _this._code = generateCode();\n                            _this.applyUpdatedCode(i18n);\n                        }, 200);\n                        this.initDomProps();\n                        var writeFormattingControls = function () {\n                            var This = _this;\n                            var $indentCheckbox = undefined, $indentNumber = undefined;\n                            var updateIndent = function () {\n                                var indent = '\\t';\n                                if (!$indentCheckbox.prop('checked')) {\n                                    var n = 4;\n                                    if ($indentNumber[0].checkValidity()) {\n                                        n = Number($indentNumber.val());\n                                    }\n                                    indent = repeat(' ', n);\n                                }\n                                _this.formatting.indent = indent;\n                            };\n                            return $('<details>').append('<summary>' + i18n('code-output.formatting') + '</summary>', $('<div>').append($('<label>').append($indentCheckbox = $('<input type=\\'checkbox\\'>').prop('checked', _this.formatting.indent == '\\t').change(updateIndent), ' ' + i18n('code-output.formatting.indent'))), $('<div>').append($('<label>').append($indentNumber = $('<input type=\\'number\\' min=\\'0\\' max=\\'32\\' required>').val(_this.formatting.indent == '\\t' ? 4 : _this.formatting.indent.length).on('input change', updateIndent), ' ' + i18n('code-output.formatting.indentNumber'))), $('<div>').append($('<label>').append($('<input type=\\'checkbox\\'>').prop('checked', _this.formatting.jsSemicolons).change(function () {\n                                This.formatting.jsSemicolons = this.checked;\n                            }), ' ' + i18n('code-output.formatting.jsSemicolons')))).each(detailsPolyfill);\n                        };\n                        var writeSection = function (sectionName) {\n                            return $('<details open>').append(_this.writeSectionSummary(sectionName, i18n), _this.$sectionCode[sectionName] = $('<div class=\\'code\\'>')).each(detailsPolyfill);\n                        };\n                        var $output = $('<div class=\\'code-output\\'>').append(this.writeButtons(i18n)).append(writeFormattingControls(), writeSection('html'), writeSection('css'), writeSection('js'));\n                        if (!window.hljs) {\n                            $output.append('<p>' + i18n('code-output.warning.no-hljs') + '</p>');\n                        }\n                        $output.append(this.writeButtons(i18n));\n                        this.applyUpdatedCode(i18n);\n                        // public interface:\n                        // this.update\n                        this.$output = $output;\n                    }\n                    // private interface:\n                    CodeOutput.prototype.initDomProps = function initDomProps() {\n                        this.$sectionCode = {};\n                        this.$saveButtons = {};\n                    };\n                    CodeOutput.prototype.applyUpdatedCode = function applyUpdatedCode(i18n) {\n                        // TODO pass code to avoid recursion on accessing this.code... or not b/c reading this.sectionModes and like\n                        var sections = this.code.extractSections(this.sectionModes);\n                        for (var sectionName in sections) {\n                            if (this.sectionModes[sectionName] == 'embed') {\n                                this.$sectionCode[sectionName].empty().append('<p>' + i18n('code-output.embedded') + '</p>');\n                            } else {\n                                var $code = undefined;\n                                this.$sectionCode[sectionName].empty().append($('<pre>').append($code = $('<code class=\\'' + sectionName + '\\'>')));\n                                $code.html(sections[sectionName].getHtml(this.formatting).join('\\n'));\n                                if (window.hljs) {\n                                    hljs.highlightBlock($code[0]);\n                                }\n                            }\n                            if (sectionName != 'html') {\n                                // extractable section\n                                this.$saveButtons[sectionName].prop('disabled', this.sectionModes[sectionName] == 'embed');\n                            }\n                        }\n                    };\n                    CodeOutput.prototype.writeButtons = function writeButtons(i18n) {\n                        var This = this;\n                        var postData = function (url, target, data) {\n                            var $form = $('<form method=\\'post\\' action=\\'' + url + '\\' target=\\'' + target + '\\'>');\n                            for (var name in data) {\n                                $form.append($('<input type=\\'hidden\\'>').attr('name', name).val(data[name]));\n                            }\n                            $form.appendTo('body').submit().remove();\n                        };\n                        return $('<div>').append($('<button type=\\'button\\'>' + i18n('code-output.run') + '</button>').click(function () {\n                            var html = This.code.get(This.formatting).join('\\n');\n                            if (navigator.msSaveOrOpenBlob) {\n                                // has drawbacks:\n                                // * Firefox and Chrome have trouble showing the source\n                                // * weird bug in Firefox:\n                                //   in webgl-starter: add z-rotation, slider input, add speed, slider input, run, change rotation range, run again\n                                // * Firefox shows url of a generator page\n                                var w = window.open('', 'generatedCode');\n                                w.document.open();\n                                w.document.write(html);\n                                w.document.close();\n                            } else {\n                                // has drawbacks:\n                                // * doesn't work in IE b/c they decided it's security risk\n                                // * long url\n                                window.open(getHtmlDataUri(html), 'generatedCode');\n                            }\n                        }), ' ', $('<button type=\\'button\\'>' + i18n('code-output.open.codepen') + '</button>').click(function () {\n                            // http://blog.codepen.io/documentation/api/prefill/\n                            var sections = This.code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(This.formatting).join('\\n');\n                            };\n                            postData('http://codepen.io/pen/define/', 'codepenGeneratedCode', {\n                                data: JSON.stringify({\n                                    html: getSection('html'),\n                                    css: getSection('css'),\n                                    js: getSection('js'),\n                                    title: This.code.title\n                                })\n                            });\n                        }), // doesn't work?\n                        ' ', $('<button type=\\'button\\'>' + i18n('code-output.open.jsfiddle') + '</button>').click(function () {\n                            // http://doc.jsfiddle.net/api/post.html\n                            var sections = This.code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(This.formatting).join('\\n');\n                            };\n                            postData('http://jsfiddle.net/api/post/library/pure/', 'jsfiddleGeneratedCode', {\n                                html: getSection('html'),\n                                css: getSection('css'),\n                                js: getSection('js'),\n                                title: This.code.title,\n                                wrap: 'b'\n                            });\n                        }), ' ', $('<button type=\\'button\\'>' + i18n('code-output.open.plunker') + '</button>').click(function () {\n                            var _postData;\n                            // https://github.com/angular/angular.js/blob/489835dd0b36a108bedd5ded439a186aca4fa739/docs/app/src/examples.js#L139-L157\n                            var sections = This.code.extractSections({\n                                html: 'full',\n                                css: 'file',\n                                js: 'file'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(This.formatting).join('\\n');\n                            };\n                            postData('http://plnkr.co/edit/?p=preview', 'plunkerGeneratedCode', (_postData = {}, _postData['files[index.html]'] = getSection('html'), _postData['files[' + sections['css'].filename + ']'] = getSection('css'), _postData['files[' + sections['js'].filename + ']'] = getSection('js'), _postData['private'] = true, _postData));\n                        }));\n                    };\n                    CodeOutput.prototype.writeSectionSummary = function writeSectionSummary(sectionName, i18n) {\n                        var This = this;\n                        var $summary = $('<summary>' + i18n('code-output.section.' + sectionName) + '</summary>');\n                        $summary.append(' ', $('<select>').append((sectionName == 'html' ? [\n                            'full',\n                            'body'\n                        ] : [\n                            'embed',\n                            'paste',\n                            'file'\n                        ]).map(function (mode) {\n                            return $('<option>').val(mode).html(i18n('code-output.mode.' + mode));\n                        })).val(this.sectionModes[sectionName]).change(function () {\n                            This.sectionModes[sectionName] = this.value;\n                        }), ' ', // doesn't work in IE\n                        //$(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\n                        //\t// yes I want a button, but download attr is only available for links\n                        //\t$(this).attr('href',getHtmlDataUri(\n                        //\t\tsection.get(this.formatting).join(\"\\n\")\n                        //\t))\n                        //})\n                        this.$saveButtons[sectionName] = $('<button type=\\'button\\'>' + i18n('code-output.save') + '</button>').click(function () {\n                            var section = This.code.extractSections(This.sectionModes)[sectionName];\n                            // http://stackoverflow.com/a/24354303\n                            var blob = new Blob([section.get(This.formatting).join('\\n')], { type: section.mimeType });\n                            if (navigator.msSaveOrOpenBlob) {\n                                navigator.msSaveOrOpenBlob(blob, section.filename);\n                            } else {\n                                var $a = $('<a>').attr('download', section.filename).attr('href', URL.createObjectURL(blob)).appendTo('body');\n                                $a.get(0).click();\n                                $a.remove();\n                            }\n                        }));\n                        return $summary;\n                    };\n                    babelHelpers.createClass(CodeOutput, [\n                        {\n                            key: 'code',\n                            get: function () {\n                                this.update.flush();\n                                return this._code;\n                            }    // extend/override fns:\n                        },\n                        {\n                            key: 'defaultFormatting',\n                            get: function () {\n                                return {\n                                    indent: '\\t',\n                                    jsSemicolons: false\n                                };\n                            }\n                        }\n                    ]);\n                    return CodeOutput;\n                }();\n                module.exports = CodeOutput;\n            },\n            {\n                '10': 10,\n                '5': 5,\n                '8': 8\n            }\n        ],\n        4: [\n            function (require, module, exports) {\n                'use strict';\n                var CodeSection = function () {\n                    function CodeSection(filename, mimeType, lines) {\n                        babelHelpers.classCallCheck(this, CodeSection);\n                        this.filename = filename;\n                        this.mimeType = mimeType;\n                        this.lines = lines;\n                    }\n                    CodeSection.prototype.get = function get(formatting) {\n                        return this.lines.get(formatting);\n                    };\n                    CodeSection.prototype.getHtml = function getHtml(formatting) {\n                        return this.lines.getHtml(formatting);\n                    };\n                    return CodeSection;\n                }();\n                module.exports = CodeSection;\n            },\n            {}\n        ],\n        5: [\n            function (require, module, exports) {\n                'use strict';\n                var detailsSupported = 'open' in document.createElement('details');\n                // http://thenewcode.com/680/Feature-Detection-and-Styling-For-The-HTML5-details-Element\n                module.exports = function () {\n                    // to be called in .each()\n                    if (detailsSupported)\n                        return;\n                    var $details = $(this);\n                    var toggleOpen = function () {\n                        if (!$details.attr('open')) {\n                            $details.attr('open', '');\n                        } else {\n                            $details.removeAttr('open');\n                        }\n                    };\n                    var keyCodeEnter = 13;\n                    var keyCodeSpace = 32;\n                    var handleEvent = function (ev) {\n                        return $(ev.target).closest('summary, :input, a[href]').is('summary');\n                    };\n                    // check if event target is not an input/link, also check its ancestors (jQuery doesn't include <option> in :input selector)\n                    $details.addClass('polyfill').children('summary').attr('tabindex', 0).click(function (ev) {\n                        if (handleEvent(ev)) {\n                            toggleOpen();\n                        }\n                    }).keydown(function (ev) {\n                        if (handleEvent(ev) && (ev.keyCode == keyCodeEnter || ev.keyCode == keyCodeSpace)) {\n                            toggleOpen();\n                            return false;\n                        }\n                    });\n                };\n            },\n            {}\n        ],\n        6: [\n            function (require, module, exports) {\n                // assumes string is dot-separated, like this: \"some.html.id\"\n                var capitalize = require(7);\n                module.exports = function (s) {\n                    return s.split('.').map(function (w, i) {\n                        return i > 0 ? capitalize(w) : w;\n                    }).join('');\n                };\n            },\n            { '7': 7 }\n        ],\n        7: [\n            function (require, module, exports) {\n                // assumes string is lowercase\n                module.exports = function (s) {\n                    return s.charAt(0).toUpperCase() + s.slice(1);\n                };\n            },\n            {}\n        ],\n        8: [\n            function (require, module, exports) {\n                // no options\n                module.exports = function (func, wait) {\n                    var timeoutId = null;\n                    var debounced = function () {\n                        clearTimeout(timeoutId);\n                        timeoutId = setTimeout(function () {\n                            timeoutId = null;\n                            func();\n                        }, wait);\n                    };\n                    debounced.flush = function () {\n                        if (timeoutId) {\n                            timeoutId = null;\n                            func();\n                        }\n                    };\n                    return debounced;\n                };\n            },\n            {}\n        ],\n        9: [\n            function (require, module, exports) {\n                module.exports = function (s) {\n                    var entityMap = {\n                        '&': '&amp;',\n                        '<': '&lt;',\n                        '>': '&gt;',\n                        '\"': '&quot;',\n                        '\\'': '&#39;'\n                    };\n                    // lodash also escapes `\n                    return String(s).replace(/[&<>\"']/g, function (m) {\n                        return entityMap[m];\n                    });\n                };\n            },\n            {}\n        ],\n        10: [\n            function (require, module, exports) {\n                module.exports = function (s, n) {\n                    return Array(n + 1).join(s);\n                };\n            },\n            {}\n        ],\n        11: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbers = require(12);\n                var formatNumber = function (number, precision) {\n                    return formatNumbers([number], precision)[0];\n                };\n                formatNumber.html = function (number, precision) {\n                    return formatNumbers.html([number], precision)[0];\n                };\n                formatNumber.js = function (number, precision) {\n                    return formatNumbers.js([number], precision)[0];\n                };\n                formatNumber.glsl = function (number, precision) {\n                    return formatNumbers.glsl([number], precision)[0];\n                };\n                module.exports = formatNumber;\n            },\n            { '12': 12 }\n        ],\n        12: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbersInternal = function (numbers, precision, keepDot, noPlus) {\n                    var maxPrecision = 0;\n                    if (keepDot) {\n                        maxPrecision = 1;\n                    }\n                    var hasNegative = false;\n                    for (var i in numbers) {\n                        var p = undefined;\n                        if (precision !== undefined) {\n                            p = precision;\n                        } else if (numbers[i].precision !== undefined) {\n                            p = numbers[i].precision;\n                        } else {\n                            throw new Error('formatNumbers received no precision');\n                        }\n                        var number = Number(numbers[i]);\n                        var s = number.toFixed(p);\n                        if (Number(s) < 0) {\n                            // protects against negative zero\n                            hasNegative = true;\n                        }\n                        if (p > 0) {\n                            p -= s.match(/0*$/)[0].length;\n                        }\n                        if (p > maxPrecision) {\n                            maxPrecision = p;\n                        }\n                    }\n                    var ss = Array.isArray(numbers) ? [] : {};\n                    for (var _i in numbers) {\n                        var _number = Number(numbers[_i]);\n                        var _s = _number.toFixed(maxPrecision);\n                        if (Number(_s) >= 0 && _s.charAt(0) == '-') {\n                            // protects against negative zero\n                            _s = _s.slice(1);\n                        }\n                        if (!noPlus && hasNegative && _number > 0) {\n                            _s = '+' + _s;\n                        }\n                        ss[_i] = _s;\n                    }\n                    return ss;\n                };\n                var formatNumbers = function (number, precision) {\n                    return formatNumbersInternal(number, precision);\n                };\n                formatNumbers.html = function (number, precision) {\n                    return formatNumbersInternal(number, precision, false, true);\n                };\n                formatNumbers.js = function (number, precision) {\n                    return formatNumbersInternal(number, precision);\n                };\n                formatNumbers.glsl = function (number, precision) {\n                    return formatNumbersInternal(number, precision, true);\n                };\n                module.exports = formatNumbers;\n            },\n            {}\n        ],\n        13: [\n            function (require, module, exports) {\n                'use strict';\n                var GroupOptionOutput = function GroupOptionOutput(option, writeOption, i18n, generateId) {\n                    babelHelpers.classCallCheck(this, GroupOptionOutput);\n                    this.option = option;\n                    this.$output = option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append(option.entries.map(writeOption));\n                };\n                module.exports = GroupOptionOutput;\n            },\n            {}\n        ],\n        14: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (inStrings) {\n                    var strings = {};\n                    var expandRegexp = /^([^{]*)\\{([^}]*)\\}(.*)$/;\n                    function expandIdAndString(id, string) {\n                        var match = undefined;\n                        if (match = expandRegexp.exec(id)) {\n                            (function () {\n                                var idStart = match[1];\n                                var idMids = match[2].split(',');\n                                var idEnd = match[3];\n                                if (match = expandRegexp.exec(string)) {\n                                    (function () {\n                                        var stringStart = match[1];\n                                        var stringMidsStr = match[2];\n                                        var stringMids = stringMidsStr.split(',');\n                                        var stringEnd = match[3];\n                                        idMids.forEach(function (idMid, i) {\n                                            var stringMid = stringMids[i];\n                                            if (stringMidsStr != '') {\n                                                expandIdAndString(idStart + idMid + idEnd, stringStart + stringMid + stringEnd);\n                                            } else {\n                                                expandIdAndString(idStart + idMid + idEnd, stringStart + idMid + stringEnd);\n                                            }\n                                        });\n                                    }());\n                                } else {\n                                    idMids.forEach(function (idMid) {\n                                        expandIdAndString(idStart + idMid + idEnd, string);\n                                    });\n                                }\n                            }());\n                        } else {\n                            strings[id] = string;\n                        }\n                    }\n                    for (var id in inStrings) {\n                        expandIdAndString(id, inStrings[id]);\n                    }\n                    return strings;\n                };\n            },\n            {}\n        ],\n        15: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (lang) {\n                    return function (strings) {\n                        for (var id in strings) {\n                            strings[id] = strings[id].replace(/\\[\\[(.*?)\\]\\]/g, function (match, p1) {\n                                var link = undefined, text = undefined;\n                                var i = p1.indexOf('|');\n                                if (i < 0) {\n                                    link = p1;\n                                    text = p1;\n                                } else {\n                                    link = p1.slice(0, i);\n                                    text = p1.slice(i + 1);\n                                }\n                                return '<a href=\\'https://' + lang + '.wikipedia.org/wiki/' + link.replace(/ /g, '_') + '\\'>' + text + '</a>';\n                            });\n                        }\n                        return strings;\n                    };\n                };\n            },\n            {}\n        ],\n        16: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(9);\n                module.exports = function (langStrings) {\n                    return function (lang) {\n                        var defaultLang = 'en';\n                        lang = lang || defaultLang;\n                        lang = lang.split('-')[0];\n                        // get primary language subtag\n                        var strings = langStrings[lang];\n                        if (strings === undefined) {\n                            lang = defaultLang;\n                            strings = langStrings[lang];\n                        }\n                        var i18n = function (id) {\n                            if (strings[id] !== undefined) {\n                                return strings[id];\n                            } else {\n                                throw new Error('undefined string ' + id);\n                            }\n                        };\n                        i18n.lang = lang;\n                        i18n.has = function (id) {\n                            return strings[id] !== undefined;\n                        };\n                        if (lang == 'en') {\n                            i18n.number = function (n) {\n                                return String(n).replace('-', '\\u2212');\n                            };\n                            i18n.pluralSuffix = function (n) {\n                                var ns = String(n);\n                                if (ns.indexOf('.') < 0) {\n                                    var nn = Number(n);\n                                    if (Math.abs(nn) == 1) {\n                                        return '1';\n                                    } else {\n                                        return '2';\n                                    }\n                                } else {\n                                    return '2';\n                                }\n                            };\n                        } else if (lang == 'ru') {\n                            i18n.number = function (n) {\n                                return String(n).replace('-', '\\u2212').replace('.', ',');\n                            };\n                            i18n.pluralSuffix = function (n) {\n                                var ns = String(n);\n                                if (ns.indexOf('.') < 0) {\n                                    var teen = ns.slice(-2, -1) === '1';\n                                    if (ns.slice(-1) === '1' && !teen) {\n                                        return '1';\n                                    } else if ('234'.indexOf(ns.slice(-1)) >= 0 && !teen) {\n                                        return '2';\n                                    } else {\n                                        return '5';\n                                    }\n                                } else {\n                                    return '2';\n                                }\n                            };\n                        }\n                        i18n.plural = function (n, id) {\n                            return this(id + '.' + this.pluralSuffix(n));\n                        };\n                        i18n.numberWithUnits = function (n, unit, abbrFn) {\n                            if (abbrFn === undefined) {\n                                // codegen needs its own fn\n                                abbrFn = function (abbr, expansion) {\n                                    return '<abbr title=\\'' + escape(expansion) + '\\'>' + abbr + '</abbr>';\n                                };    // expansion is html for stuff like s^(-1)\n                            }\n                            var s = this.number(n);\n                            if (unit !== undefined) {\n                                if (unit.length == 1 && /^\\W/.test(unit)) {\n                                    s += unit;\n                                } else {\n                                    s += ' ';\n                                    // nbsp\n                                    var abbr = undefined;\n                                    if (unit == '1/second') {\n                                        abbr = i18n('units.second.a') + '<sup>\\u22121</sup>';\n                                    } else {\n                                        abbr = i18n('units.' + unit + '.a');\n                                    }\n                                    var expansion = this.plural(n, 'units.' + unit);\n                                    s += abbrFn(abbr, expansion);\n                                }\n                            }\n                            return s;\n                        };\n                        return i18n;\n                    };\n                };\n            },\n            { '9': 9 }\n        ],\n        17: [\n            function (require, module, exports) {\n                'use strict';\n                var repeat = require(10);\n                var Lines = require(20);\n                var IndentLines = function (_Lines) {\n                    babelHelpers.inherits(IndentLines, _Lines);\n                    function IndentLines(data, level) {\n                        babelHelpers.classCallCheck(this, IndentLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        if (level !== undefined) {\n                            _this.level = level;\n                        } else {\n                            _this.level = 1;\n                        }\n                        return _this;\n                    }\n                    IndentLines.prototype.doGet = function doGet(formatting, html) {\n                        var indent = '\\t';\n                        if (formatting.indent !== undefined) {\n                            indent = formatting.indent;\n                        }\n                        var indentStr = repeat(indent, this.level);\n                        return _Lines.prototype.doGet.call(this, formatting, html).map(function (s) {\n                            return indentStr + s;\n                        });\n                    };\n                    return IndentLines;\n                }(Lines);\n                module.exports = IndentLines;\n            },\n            {\n                '10': 10,\n                '20': 20\n            }\n        ],\n        18: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(9);\n                var Lines = require(20);\n                var InterleaveLines = function (_Lines) {\n                    babelHelpers.inherits(InterleaveLines, _Lines);\n                    function InterleaveLines() {\n                        babelHelpers.classCallCheck(this, InterleaveLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    InterleaveLines.prototype.doGet = function doGet(formatting, html) {\n                        var out = [];\n                        var first = true;\n                        var fp = function () {\n                            if (first) {\n                                first = false;\n                            } else {\n                                out.push('');\n                            }\n                        };\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (subOut.length > 0) {\n                                    fp();\n                                    out.push.apply(out, subOut);\n                                }\n                            } else if (typeof item == 'string') {\n                                fp();\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                        });\n                        return out;\n                    };\n                    return InterleaveLines;\n                }(Lines);\n                module.exports = InterleaveLines;\n            },\n            {\n                '20': 20,\n                '9': 9\n            }\n        ],\n        19: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(20);\n                var JsLines = function (_Lines) {\n                    babelHelpers.inherits(JsLines, _Lines);\n                    function JsLines() {\n                        babelHelpers.classCallCheck(this, JsLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    JsLines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        if (formatting.jsSemicolons) {\n                            return s.replace(/^;/, '');\n                        } else {\n                            return s.replace(/;$/, '');\n                        }\n                    };\n                    return JsLines;\n                }(Lines);\n                module.exports = JsLines;\n            },\n            { '20': 20 }\n        ],\n        20: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\n                var escape = require(9);\n                var repeat = require(10);\n                var TO = {};\n                // TODO Symbol\n                var Lines = function () {\n                    // lines private interface:\n                    function Lines(data) {\n                        babelHelpers.classCallCheck(this, Lines);\n                        if (!Array.isArray(data)) {\n                            throw new TypeError('attempted to construct Lines with non-array data argument');\n                        }\n                        this.data = data;\n                    }\n                    Lines.prototype.isDataEmpty = function isDataEmpty() {\n                        for (var i = 0; i < this.data.length; i++) {\n                            var item = this.data[i];\n                            if (item instanceof Lines) {\n                                if (!item.isEmpty()) {\n                                    return false;\n                                }\n                            } else if (typeof item == 'string') {\n                                return false;\n                            }\n                        }\n                        return true;\n                    };\n                    Lines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        return s;\n                    };\n                    Lines.prototype.doGet = function doGet(formatting, html) {\n                        var _this = this;\n                        var out = [];\n                        var addTo = false;\n                        this.data.forEach(function (item) {\n                            if (item === TO) {\n                                addTo = true;\n                            } else if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (addTo && subOut.length > 0) {\n                                    out.push(out.pop() + subOut.shift());\n                                }\n                                out.push.apply(out, subOut);\n                                addTo = false;\n                            } else if (typeof item == 'string') {\n                                var s = _this.processStringInGet(item, formatting);\n                                if (formatting.indent !== undefined && formatting.indent != '\\t') {\n                                    s = s.replace(/^(\\t)+/, function (match) {\n                                        return repeat(formatting.indent, match.length);\n                                    });\n                                }\n                                s = html ? escape(s) : s;\n                                if (addTo) {\n                                    out.push(out.pop() + s);\n                                } else {\n                                    out.push(s);\n                                }\n                                addTo = false;\n                            }\n                        });\n                        return out;\n                    };\n                    // lines public interface:\n                    Lines.b = function b() {\n                        var _this2 = this, _arguments = arguments;\n                        var data = [];\n                        var makeLines = function () {\n                            return new (Function.prototype.bind.apply(_this2, [null].concat([data], Array.prototype.slice.call(_arguments))))();\n                        };\n                        var a = function () {\n                            return a.a.apply(a, arguments);\n                        };\n                        a.a = function () {\n                            data.push.apply(data, arguments);\n                            return this;\n                        };\n                        a.t = function () {\n                            data.push.apply(data, [TO].concat(Array.prototype.slice.call(arguments)));\n                            return this;\n                        };\n                        a.e = makeLines;\n                        a.ae = function () {\n                            return this.a.apply(this, arguments).e();\n                        };\n                        return a;\n                    };\n                    Lines.ba = function ba() {\n                        var _b;\n                        return (_b = this.b()).a.apply(_b, arguments);\n                    };\n                    Lines.be = function be() {\n                        return this.b().e();\n                    };\n                    Lines.bae = function bae() {\n                        var _b2;\n                        return (_b2 = this.b()).a.apply(_b2, arguments).e();\n                    };\n                    Lines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    Lines.prototype.get = function get(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, false);\n                    };\n                    Lines.prototype.getHtml = function getHtml(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, true);\n                    };\n                    Lines.prototype.count = function count() {\n                        return this.doGet({}, false).length;    // can be faster b/c don't need to output stuff\n                    };\n                    // TODO make HtmlLines\n                    Lines.html = function html(strings) {\n                        var _arguments2 = arguments;\n                        // html template tag\n                        // usage example for attributes: Lines.html`<input type=text value=${value}>`\n                        // usage example for elements: Lines.html`<option>${option}</option>`\n                        return strings.reduce(function (r, s, i) {\n                            var v = _arguments2[i];\n                            switch (r.slice(-1)) {\n                            case '=':\n                                if (v === false) {\n                                    return r.replace(/\\s+[a-zA-Z0-9-]+=$/, '') + s;    // TODO more permitting attr name regexp\n                                } else if (v === true) {\n                                    return r.replace(/=$/, '') + s;\n                                }\n                                v = String(v).replace(/&/g, '&amp;');\n                                if (v == '') {\n                                    return r.replace(/=$/, '') + s;\n                                } else if (!/[\\s\"'=<>`]/.test(v)) {\n                                    return r + v + s;\n                                } else if (!/'/.test(v)) {\n                                    return r + '\\'' + v + '\\'' + s;\n                                } else {\n                                    v = v.replace(/\"/g, '&quot;');\n                                    return r + '\"' + v + '\"' + s;\n                                }\n                            case '>':\n                                v = String(v).replace(/&/g, '&amp;').replace(/</g, '&lt;');\n                                return r + v + s;\n                            }\n                            throw new Error('invalid character before substitution');\n                        });\n                    };\n                    return Lines;\n                }();\n                module.exports = Lines;\n            },\n            {\n                '10': 10,\n                '9': 9\n            }\n        ],\n        21: [\n            function (require, module, exports) {\n                'use strict';\n                var WrapLines = require(28);\n                var NoseWrapLines = function (_WrapLines) {\n                    babelHelpers.inherits(NoseWrapLines, _WrapLines);\n                    function NoseWrapLines() {\n                        babelHelpers.classCallCheck(this, NoseWrapLines);\n                        return babelHelpers.possibleConstructorReturn(this, _WrapLines.apply(this, arguments));\n                    }\n                    NoseWrapLines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    NoseWrapLines.prototype.doGet = function doGet(formatting, html) {\n                        if (this.isEmpty()) {\n                            return [];\n                        } else {\n                            return _WrapLines.prototype.doGet.call(this, formatting, html);\n                        }\n                    };\n                    return NoseWrapLines;\n                }(WrapLines);\n                module.exports = NoseWrapLines;\n            },\n            { '28': 28 }\n        ],\n        22: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\n                var Option = {};\n                // abstract classes\n                Option.Base = function () {\n                    _class.make = function make(name) {\n                        var nScalars = 0, nArrays = 0, nObjects = 0;\n                        var scalarArg = undefined, arrayArg = [], objectArg = {};\n                        for (var i = 1; i < arguments.length; i++) {\n                            var arg = arguments[i];\n                            if (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\n                                if (nScalars++ == 0)\n                                    scalarArg = arg;\n                            } else if (Array.isArray(arg)) {\n                                if (nArrays++ == 0)\n                                    arrayArg = arg;\n                            } else if (arg instanceof Object) {\n                                if (nObjects++ == 0)\n                                    objectArg = arg;\n                            }\n                        }\n                        var optionClass = this;\n                        var settings = this.collectArgs(scalarArg, arrayArg, objectArg);\n                        return function (data, parent, visibilityManager, makeEntry) {\n                            return new optionClass(name, settings, data, parent, visibilityManager, makeEntry);\n                        };\n                    };\n                    _class.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return settings;\n                    };\n                    function _class(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class);\n                        this.parent = parent;\n                        this.name = name;\n                        this.fullName = name;\n                        if (parent && parent.fullName !== null) {\n                            this.fullName = parent.fullName + '.' + name;\n                        }\n                        this.updateCallbacks = [];\n                        this._$ = null;\n                        // visibility and callbacks\n                        this.isVisible = function () {\n                            return true;\n                        };\n                        if (visibilityManager) {\n                            visibilityManager.register(this);\n                            if (settings.visibilityData !== undefined) {\n                                if (settings.visibilityDataLogic != 'or') {\n                                    this.isVisible = function () {\n                                        for (var testName in settings.visibilityData) {\n                                            var value = visibilityManager.options[testName].value;\n                                            if (settings.visibilityData[testName].indexOf(value) < 0) {\n                                                return false;\n                                            }\n                                        }\n                                        return true;\n                                    };\n                                } else {\n                                    this.isVisible = function () {\n                                        for (var testName in settings.visibilityData) {\n                                            var value = visibilityManager.options[testName].value;\n                                            if (settings.visibilityData[testName].indexOf(value) >= 0) {\n                                                return true;\n                                            }\n                                        }\n                                        return false;\n                                    };\n                                }\n                                for (var testName in settings.visibilityData) {\n                                    visibilityManager.declareAffectedBy(this, testName);\n                                }\n                            }\n                        }\n                    }\n                    _class.prototype.updateVisibility = function updateVisibility() {\n                        if (this.$)\n                            this.$.toggle(this.isVisible());\n                    };\n                    _class.prototype.update = function update() {\n                        this.updateCallbacks.forEach(function (updateCallback) {\n                            updateCallback();\n                        });\n                        if (this.parent) {\n                            this.parent.update();\n                        }\n                    };\n                    _class.prototype.addUpdateCallback = function addUpdateCallback(updateCallback) {\n                        this.updateCallbacks.push(updateCallback);\n                    };\n                    _class.prototype.shortenExport = function shortenExport(data) {\n                        // used by parent\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            return data.value;\n                        } else {\n                            return data;\n                        }\n                    };\n                    _class.prototype.shortenExportAssign = function shortenExportAssign(data, parentData, name) {\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            parentData[name] = data.value;\n                        } else if (dataKeys.length > 0) {\n                            parentData[name] = data;\n                        }\n                    };\n                    babelHelpers.createClass(_class, [{\n                            key: '$',\n                            get: function () {\n                                return this._$;\n                            },\n                            set: function ($) {\n                                this._$ = $;\n                                this.updateVisibility();\n                            }\n                        }]);\n                    return _class;\n                }();\n                Option.Input = function (_Option$Base) {\n                    babelHelpers.inherits(_class2, _Option$Base);\n                    _class2.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.defaultValue === undefined)\n                            settings.defaultValue = scalarArg;\n                        return _Option$Base.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class2(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class2);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Base.apply(this, arguments));\n                        _this.defaultValue = settings.defaultValue;\n                        if (typeof data == 'object') {\n                            data = data.value;\n                        }\n                        if (data !== undefined) {\n                            _this._value = data;\n                        } else {\n                            _this._value = _this.defaultValue;\n                        }\n                        return _this;\n                    }\n                    _class2.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        return data;\n                    };\n                    babelHelpers.createClass(_class2, [{\n                            key: 'value',\n                            get: function () {\n                                return this._value;\n                            },\n                            set: function (value) {\n                                this._value = value;\n                                this.update();\n                            }\n                        }]);\n                    return _class2;\n                }(Option.Base);\n                Option.Boolean = function (_Option$Input) {\n                    babelHelpers.inherits(_class3, _Option$Input);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input.apply(this, arguments));\n                    }\n                    _class3.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return _Option$Input.collectArgs.call(this, !!scalarArg, arrayArg, settings);\n                    };\n                    _class3.prototype.fix = function fix() {\n                        return this.value;\n                    };\n                    return _class3;\n                }(Option.Input);\n                Option.NonBoolean = function (_Option$Input2) {\n                    babelHelpers.inherits(_class4, _Option$Input2);\n                    function _class4() {\n                        babelHelpers.classCallCheck(this, _class4);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input2.apply(this, arguments));\n                    }\n                    _class4.prototype.fix = function fix() {\n                        var value = this.value;\n                        return {\n                            // can't use fixed value in boolean context\n                            name: this.name,\n                            value: value,\n                            valueOf: function () {\n                                return value;\n                            },\n                            toString: function () {\n                                return String(value);\n                            }\n                        };\n                    };\n                    return _class4;\n                }(Option.Input);\n                Option.Factor = function (_Option$NonBoolean) {\n                    babelHelpers.inherits(_class5, _Option$NonBoolean);\n                    _class5.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableValues === undefined)\n                            settings.availableValues = arrayArg;\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableValues[0];\n                        return _Option$NonBoolean.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class5(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class5);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean.apply(this, arguments));\n                        _this4.availableValues = settings.availableValues;\n                        return _this4;\n                    }\n                    return _class5;\n                }(Option.NonBoolean);\n                Option.Number = function (_Option$NonBoolean2) {\n                    babelHelpers.inherits(_class6, _Option$NonBoolean2);\n                    // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\n                    _class6.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableMin === undefined)\n                            settings.availableMin = arrayArg[0];\n                        if (settings.availableMax === undefined)\n                            settings.availableMax = arrayArg[1];\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableMin;\n                        return _Option$NonBoolean2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class6(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class6);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean2.apply(this, arguments));\n                        _this5.availableMin = settings.availableMin;\n                        _this5.availableMax = settings.availableMax;\n                        _this5.unit = settings.unit;\n                        return _this5;\n                    }\n                    _class6.prototype.fix = function fix() {\n                        var fixed = _Option$NonBoolean2.prototype.fix.call(this);\n                        fixed.precision = this.precision;\n                        fixed.unit = this.unit;\n                        return fixed;\n                    };\n                    return _class6;\n                }(Option.NonBoolean);\n                Option.Collection = function (_Option$Base2) {\n                    babelHelpers.inherits(_class7, _Option$Base2);\n                    _class7.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        return _Option$Base2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class7(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class7);\n                        var _this6 = babelHelpers.possibleConstructorReturn(this, _Option$Base2.apply(this, arguments));\n                        _this6.entries = settings.descriptions.map(function (x) {\n                            var subName = x[1];\n                            var subData = undefined;\n                            if (typeof data == 'object')\n                                subData = data[subName];\n                            return makeEntry(x, subData, _this6, visibilityManager);    // nested option\n                        });\n                        return _this6;\n                    }\n                    _class7.prototype.export = function _export() {\n                        var data = {};\n                        this.entries.forEach(function (entry) {\n                            entry.shortenExportAssign(entry.export(), data, entry.name);\n                        });\n                        return data;\n                    };\n                    _class7.prototype.fix = function fix() {\n                        var fixedEntries = [];\n                        var fixed = {\n                            name: this.name,\n                            entries: fixedEntries\n                        };\n                        this.entries.forEach(function (entry) {\n                            fixedEntries.push(fixed[entry.name] = entry.fix());\n                        });\n                        return fixed;\n                    };\n                    return _class7;\n                }(Option.Base);\n                // concrete classes\n                Option.Void = function (_Option$Base3) {\n                    babelHelpers.inherits(_class8, _Option$Base3);\n                    function _class8() {\n                        babelHelpers.classCallCheck(this, _class8);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Base3.apply(this, arguments));\n                    }\n                    // useful as array entry w/o settings\n                    _class8.prototype.export = function _export() {\n                        return {};\n                    };\n                    _class8.prototype.fix = function fix() {\n                        return { name: this.name };\n                    };\n                    return _class8;\n                }(Option.Base);\n                Option.Checkbox = function (_Option$Boolean) {\n                    babelHelpers.inherits(_class9, _Option$Boolean);\n                    function _class9() {\n                        babelHelpers.classCallCheck(this, _class9);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Boolean.apply(this, arguments));\n                    }\n                    return _class9;\n                }(Option.Boolean);\n                Option.Select = function (_Option$Factor) {\n                    babelHelpers.inherits(_class10, _Option$Factor);\n                    function _class10() {\n                        babelHelpers.classCallCheck(this, _class10);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor.apply(this, arguments));\n                    }\n                    return _class10;\n                }(Option.Factor);\n                Option.Text = function (_Option$Factor2) {\n                    babelHelpers.inherits(_class11, _Option$Factor2);\n                    function _class11() {\n                        babelHelpers.classCallCheck(this, _class11);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor2.apply(this, arguments));\n                    }\n                    return _class11;\n                }(Option.Factor);\n                Option.Int = function (_Option$Number) {\n                    babelHelpers.inherits(_class12, _Option$Number);\n                    function _class12() {\n                        babelHelpers.classCallCheck(this, _class12);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class12, [{\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        }]);\n                    return _class12;\n                }(Option.Number);\n                Option.Float = function (_Option$Number2) {\n                    babelHelpers.inherits(_class13, _Option$Number2);\n                    function _class13(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class13);\n                        var _this12 = babelHelpers.possibleConstructorReturn(this, _Option$Number2.apply(this, arguments));\n                        if (settings.precision !== undefined) {\n                            _this12.precision = settings.precision;\n                        } else {\n                            if (_this12.availableMax >= 100) {\n                                _this12.precision = 1;\n                            } else if (_this12.availableMax >= 10) {\n                                _this12.precision = 2;\n                            } else {\n                                _this12.precision = 3;\n                            }\n                        }\n                        return _this12;\n                    }\n                    return _class13;\n                }(Option.Number);\n                Option.Root = function (_Option$Collection) {\n                    babelHelpers.inherits(_class14, _Option$Collection);\n                    function _class14() {\n                        babelHelpers.classCallCheck(this, _class14);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection.apply(this, arguments));\n                    }\n                    return _class14;\n                }(Option.Collection);\n                Option.Group = function (_Option$Collection2) {\n                    babelHelpers.inherits(_class15, _Option$Collection2);\n                    function _class15() {\n                        babelHelpers.classCallCheck(this, _class15);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection2.apply(this, arguments));\n                    }\n                    return _class15;\n                }(Option.Collection);\n                Option.Array = function (_Option$Base4) {\n                    babelHelpers.inherits(_class16, _Option$Base4);\n                    // TODO consider extending Collection\n                    _class16.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        if (settings.typePropertyName === undefined)\n                            settings.typePropertyName = scalarArg;\n                        return _Option$Base4.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class16(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class16);\n                        var _this15 = babelHelpers.possibleConstructorReturn(this, _Option$Base4.apply(this, arguments));\n                        _this15.availableConstructors = new Map();\n                        if (visibilityManager)\n                            visibilityManager.enterArray();\n                        settings.descriptions.forEach(function (x) {\n                            // TODO test array inside array\n                            var type = x[1];\n                            var ctor = function (subData) {\n                                return makeEntry(x, subData, _this15, visibilityManager);\n                            };\n                            _this15.availableConstructors.set(type, ctor);\n                        });\n                        if (visibilityManager)\n                            visibilityManager.exitArray();\n                        if (settings.typePropertyName !== undefined) {\n                            _this15.typePropertyName = settings.typePropertyName;\n                        } else {\n                            _this15.typePropertyName = 'type';\n                        }\n                        // populate array entries from data:\n                        _this15._entries = [];\n                        var subDatas = [];\n                        if (Array.isArray(data)) {\n                            subDatas = data;\n                        } else if (typeof data == 'object') {\n                            subDatas = data.value;\n                        }\n                        var defaultType = _this15.availableTypes[0];\n                        for (var i = 0; i < subDatas.length; i++) {\n                            var subData = subDatas[i];\n                            var subType = defaultType;\n                            if (typeof subData == 'object' && subData[_this15.typePropertyName] !== undefined) {\n                                subType = subData[_this15.typePropertyName];\n                            }\n                            var subCtor = _this15.availableConstructors.get(subType);\n                            if (subCtor) {\n                                _this15._entries.push(subCtor(subData));\n                            }\n                        }\n                        return _this15;\n                    }\n                    _class16.prototype.makeEntry = function makeEntry(type, data) {\n                        return this.availableConstructors.get(type)(data);\n                    };\n                    _class16.prototype.export = function _export() {\n                        var _this16 = this;\n                        var defaultType = this.availableTypes[0];\n                        return {\n                            value: this._entries.map(function (entry) {\n                                var subData = entry.export();\n                                var subType = entry.name;\n                                if (subType != defaultType)\n                                    subData[_this16.typePropertyName] = subType;\n                                return entry.shortenExport(subData);\n                            })\n                        };\n                    };\n                    _class16.prototype.fix = function fix() {\n                        var _this17 = this;\n                        return {\n                            name: this.name,\n                            entries: this._entries.map(function (entry) {\n                                var subFixed = entry.fix();\n                                if (typeof subFixed == 'object')\n                                    subFixed[_this17.typePropertyName] = entry.name;\n                                return subFixed;\n                            })\n                        };\n                    };\n                    babelHelpers.createClass(_class16, [\n                        {\n                            key: 'availableTypes',\n                            get: function () {\n                                var types = [];\n                                this.availableConstructors.forEach(function (_, type) {\n                                    types.push(type);\n                                });\n                                return types;\n                            }\n                        },\n                        {\n                            key: 'entries',\n                            get: function () {\n                                return this._entries;\n                            },\n                            set: function (entries) {\n                                this._entries = entries;\n                                this.update();\n                            }\n                        }\n                    ]);\n                    return _class16;\n                }(Option.Base);\n                module.exports = Option;\n            },\n            {}\n        ],\n        23: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (lang) {\n                    return function (strings) {\n                        var additionalStringsPrefix = 'options-output';\n                        var additionalStrings = {\n                            en: {\n                                'reset': 'Reset',\n                                'drag': 'Drag',\n                                'drag.tip': 'Drag or press \\u2191/\\u2193 while in focus to reorder items',\n                                'delete': 'Delete',\n                                'delete.tip': 'Delete item'\n                            },\n                            ru: {\n                                'reset': 'Сбросить',\n                                'drag': 'Перетащить',\n                                'drag.tip': 'Перетаскивайте или нажимайте \\u2191/\\u2193, пока элемент в фокусе, чтобы изменить порядок элементов',\n                                'delete': 'Удалить',\n                                'delete.tip': 'Удалить элемент'\n                            }\n                        };\n                        for (var id in additionalStrings[lang]) {\n                            strings[additionalStringsPrefix + '.' + id] = additionalStrings[lang][id];\n                        }\n                        return strings;\n                    };\n                };\n            },\n            {}\n        ],\n        24: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbers = require(12);\n                var writeTip = require(26);\n                var Option = require(22);\n                var ArrayOptionOutput = require(1);\n                var GroupOptionOutput = require(13);\n                var OptionsOutput = function () {\n                    function OptionsOutput(options, generateId, i18n) {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        var optionClassWriters = new Map();\n                        this.setOptionClassWriters(optionClassWriters);\n                        function writeOption(option) {\n                            var optionProto = option;\n                            while (optionProto = Object.getPrototypeOf(optionProto)) {\n                                var optionClassWriter = optionClassWriters.get(optionProto.constructor);\n                                if (optionClassWriter) {\n                                    return optionClassWriter(option, writeOption, i18n, generateId);\n                                }\n                            }\n                        }\n                        // public prop:\n                        this.$output = writeOption(options.root);\n                    }\n                    OptionsOutput.prototype.getLeadLabel = function getLeadLabel(id, i18n, option) {\n                        return '<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label><span class=\\'space\\'> </span>';\n                    };\n                    // override this fn for custom writers\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        var _this = this;\n                        optionClassWriters.set(Option.Root, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'options-output\\'>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Group, function () {\n                            return new (Function.prototype.bind.apply(GroupOptionOutput, [null].concat(Array.prototype.slice.call(arguments))))().$output;\n                        });\n                        optionClassWriters.set(Option.Void, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'option no-lead\\'>').html(i18n('options.' + option.fullName));\n                        });\n                        optionClassWriters.set(Option.Checkbox, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option no-lead\\'>').append($('<input type=\\'checkbox\\' id=\\'' + id + '\\'>').prop('checked', option.value).change(function () {\n                                option.value = $(this).prop('checked');\n                            }), ' <label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + '</label>');\n                        });\n                        optionClassWriters.set(Option.Select, function (option, writeOption, i18n, generateId) {\n                            var valueId = function (value) {\n                                return 'options.' + option.fullName + '.' + value;\n                            };\n                            var valueInfoId = function (value) {\n                                return 'options-info.' + option.fullName + '.' + value;\n                            };\n                            var id = generateId();\n                            var $select = undefined;\n                            option.$ = $('<div class=\\'option\\'>').append(_this.getLeadLabel(id, i18n, option), $select = $('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n(valueId(availableValue)));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            }));\n                            if (option.availableValues.some(function (availableValue) {\n                                    return i18n.has(valueInfoId(availableValue));\n                                })) {\n                                (function () {\n                                    var $tip = writeTip('info', '');\n                                    option.$.append(' ', $tip);\n                                    var handler = function () {\n                                        if (i18n.has(valueInfoId(this.value))) {\n                                            $tip.find('.tip-content').html(i18n(valueInfoId(this.value)));\n                                            $tip.css('display', '');    // $tip.show() won't work right with inline-block\n                                        } else {\n                                            $tip.css('display', 'none');\n                                            $tip.find('.tip-content').empty();\n                                        }\n                                    };\n                                    handler.call($select[0]);\n                                    $select.change(handler);\n                                }());\n                            }\n                            return option.$;\n                        });\n                        optionClassWriters.set(Option.Text, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var listId = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append(_this.getLeadLabel(id, i18n, option), $('<input type=\\'text\\' id=\\'' + id + '\\' list=\\'' + listId + '\\' />').val(option.value).on('input change', function () {\n                                option.value = this.value;\n                            }), ' ', $('<datalist id=\\'' + listId + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').text(availableValue);\n                            })));\n                        });\n                        optionClassWriters.set(Option.Number, function (option, writeOption, i18n, generateId) {\n                            var p = option.precision;\n                            var setInputAttrs = function ($input) {\n                                return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                            };\n                            var setInputAttrsAndListeners = function ($input, getOtherInput) {\n                                return setInputAttrs($input).val(option.value).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        var $that = getOtherInput();\n                                        $that.val(this.value);\n                                        option.value = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var id = generateId();\n                            var $sliderInput = undefined, $numberInput = undefined;\n                            var $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                            var fmt = formatNumbers({\n                                min: option.availableMin,\n                                max: option.availableMax\n                            }, option.precision);\n                            option.$ = $('<div class=\\'option\\'>').append(_this.getLeadLabel(id, i18n, option), $('<span class=\\'nowrap\\'>').append('<span class=\\'min\\'>' + i18n.numberWithUnits(fmt.min, option.unit) + '</span> ', $sliderInput = setInputAttrsAndListeners($('<input type=\\'range\\' id=\\'' + id + '\\'>'), function () {\n                                return $numberInput;\n                            }), ' <span class=\\'max\\'>' + i18n.numberWithUnits(fmt.max, option.unit) + '</span>'), ' ', $numberInput = setInputAttrsAndListeners($('<input type=\\'number\\' required>'), function () {\n                                return $sliderInput;\n                            }), ' ', $('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $sliderInput.val(option.defaultValue).change();\n                            }));\n                            var infoId = 'options-info.' + option.fullName;\n                            if (i18n.has(infoId)) {\n                                option.$.append(' ', writeTip('info', i18n(infoId)));\n                            }\n                            return option.$;\n                        });\n                        optionClassWriters.set(Option.Array, function () {\n                            return new (Function.prototype.bind.apply(ArrayOptionOutput, [null].concat(Array.prototype.slice.call(arguments))))().$output;\n                        });\n                    };\n                    return OptionsOutput;\n                }();\n                module.exports = OptionsOutput;\n            },\n            {\n                '1': 1,\n                '12': 12,\n                '13': 13,\n                '22': 22,\n                '26': 26\n            }\n        ],\n        25: [\n            function (require, module, exports) {\n                'use strict';\n                var OptionVisibilityManager = function () {\n                    function OptionVisibilityManager() {\n                        babelHelpers.classCallCheck(this, OptionVisibilityManager);\n                        this.options = {};\n                        this.affects = {};\n                        this.inArray = 0;\n                    }\n                    OptionVisibilityManager.prototype.register = function register(option) {\n                        var _this = this;\n                        if (!this.inArray) {\n                            this.options[option.fullName] = option;\n                            option.addUpdateCallback(function () {\n                                _this.updateVisibilityAffectedBy(option.fullName);\n                            });\n                        }\n                    };\n                    OptionVisibilityManager.prototype.declareAffectedBy = function declareAffectedBy(option, byFullName) {\n                        if (this.affects[byFullName] === undefined) {\n                            this.affects[byFullName] = [];\n                        }\n                        this.affects[byFullName].push(option);\n                    };\n                    OptionVisibilityManager.prototype.updateVisibilityAffectedBy = function updateVisibilityAffectedBy(byFullName) {\n                        if (this.affects[byFullName] !== undefined) {\n                            this.affects[byFullName].forEach(function (option) {\n                                option.updateVisibility();\n                            });\n                        }\n                    };\n                    OptionVisibilityManager.prototype.enterArray = function enterArray() {\n                        this.inArray += 1;\n                    };\n                    OptionVisibilityManager.prototype.exitArray = function exitArray() {\n                        this.inArray -= 1;\n                    };\n                    return OptionVisibilityManager;\n                }();\n                var Options = function () {\n                    function Options(data) {\n                        babelHelpers.classCallCheck(this, Options);\n                        // data = imported values, import is done in ctor to avoid calling updateCallback later\n                        var Option = this.optionClasses;\n                        var makeEntry = function (description, data, parent, visibilityManager) {\n                            var _Option$className;\n                            var className = description[0];\n                            if (Option[className] === undefined) {\n                                throw new Error('invalid option type \\'' + className + '\\'');\n                            }\n                            var makeArgs = description.slice(1);\n                            return (_Option$className = Option[className]).make.apply(_Option$className, makeArgs)(data, parent, visibilityManager, makeEntry);\n                        };\n                        this.root = Option.Root.make(null, this.entriesDescription)(data, null, new OptionVisibilityManager(), makeEntry);\n                    }\n                    // methods to be redefined by subclasses\n                    // TODO make them static?\n                    // public methods\n                    Options.prototype.addUpdateCallback = function addUpdateCallback(updateCallback) {\n                        this.root.addUpdateCallback(updateCallback);\n                    };\n                    Options.prototype.export = function _export() {\n                        return this.root.shortenExport(this.root.export());\n                    };\n                    Options.prototype.fix = function fix() {\n                        return this.root.fix();\n                    };\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(22);\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }();\n                module.exports = Options;\n            },\n            { '22': 22 }\n        ],\n        26: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (tipClass, tipContent) {\n                    var $tip = $('<span class=\\'tip-' + tipClass + '\\' tabindex=\\'0\\'><span class=\\'tip-content\\'>' + tipContent + '</span></span>');\n                    var popupTimeoutId = null;\n                    var popupLevel = 0;\n                    var handlePopup = function (dLevel, delay) {\n                        if (delay === undefined) {\n                            delay = 200;\n                        }\n                        if (dLevel == +1 && popupLevel == 0) {\n                            clearTimeout(popupTimeoutId);\n                            popupTimeoutId = setTimeout(function () {\n                                // sort of hoverintent, simple delay will do b/c tip icon is small\n                                $tip.addClass('open');\n                            }, delay);\n                        } else if (dLevel == -1 && popupLevel == 1) {\n                            clearTimeout(popupTimeoutId);\n                            popupTimeoutId = setTimeout(function () {\n                                $tip.removeClass('open');\n                            }, delay);\n                        }\n                        popupLevel += dLevel;\n                    };\n                    $tip.mouseenter(function () {\n                        handlePopup(+1);\n                    }).focusin(function () {\n                        handlePopup(+1, 0);    // need immediate popup on focusin\n                    }).on('mouseleave focusout', function () {\n                        handlePopup(-1);\n                    });\n                    return $tip;\n                };\n            },\n            {}\n        ],\n        27: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ], [\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<script src=',\n                        '></script>'\n                    ], [\n                        '<script src=',\n                        '></script>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<html lang=',\n                        '>'\n                    ], [\n                        '<html lang=',\n                        '>'\n                    ]);\n                var Lines = require(20);\n                var NoseWrapLines = require(21);\n                var CodeSection = require(4);\n                var WebCode = function () {\n                    function WebCode() {\n                        babelHelpers.classCallCheck(this, WebCode);\n                    }\n                    WebCode.prototype.get = function get(formatting) {\n                        return this.getLines().get(formatting);\n                    };\n                    WebCode.prototype.getHtml = function getHtml(formatting) {\n                        return this.getLines().getHtml(formatting);\n                    };\n                    WebCode.prototype.extractSections = function extractSections(sectionModes) {\n                        if (sectionModes === undefined) {\n                            sectionModes = {};\n                        }\n                        var stylePlaceLines = NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines);\n                        var styleExtractLines = Lines.be();\n                        if (sectionModes.css == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                stylePlaceLines = Lines.be();\n                            } else {\n                                stylePlaceLines = Lines.bae('<!-- <style> ' + this.getSectionPasteComment('css') + ' </style> -->');\n                            }\n                            styleExtractLines = this.cachedStyleLines;\n                        } else if (sectionModes.css == 'file') {\n                            stylePlaceLines = Lines.bae(Lines.html(_templateObject, this.basename + '.css'));\n                            styleExtractLines = this.cachedStyleLines;\n                        }\n                        var scriptPlaceLines = NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines);\n                        var scriptExtractLines = Lines.be();\n                        if (sectionModes.js == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                scriptPlaceLines = Lines.be();\n                            } else {\n                                scriptPlaceLines = Lines.bae('<!-- <script> ' + this.getSectionPasteComment('js') + ' </script> -->');\n                            }\n                            scriptExtractLines = this.cachedScriptLines;\n                        } else if (sectionModes.js == 'file') {\n                            scriptPlaceLines = Lines.bae(Lines.html(_templateObject2, this.basename + '.js'));\n                            scriptExtractLines = this.cachedScriptLines;\n                        }\n                        var htmlExtractLines = undefined;\n                        if (sectionModes.html == 'body') {\n                            htmlExtractLines = this.getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        } else {\n                            htmlExtractLines = this.getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        }\n                        var type = function (sectionName) {\n                            return 'text/' + (sectionName == 'js' ? 'javascript' : sectionName);\n                        };\n                        return {\n                            html: new CodeSection(this.filename, type('html'), htmlExtractLines),\n                            css: new CodeSection(this.basename + '.css', type('css'), styleExtractLines),\n                            js: new CodeSection(this.basename + '.js', type('js'), scriptExtractLines)\n                        };\n                    };\n                    // get title()\n                    // private:\n                    WebCode.prototype.getLines = function getLines() {\n                        return this.getFullHtmlSectionLines(NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines), NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines));\n                    };\n                    WebCode.prototype.getFullHtmlSectionLines = function getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        var a = Lines.b();\n                        a('<!DOCTYPE html>');\n                        if (this.lang !== null) {\n                            a(Lines.html(_templateObject3, this.lang));\n                        } else {\n                            a('<html>');\n                        }\n                        a('<head>', '<meta charset=utf-8>');\n                        if (this.title !== null) {\n                            a('<title>' + this.title + '</title>');\n                        }\n                        a(stylePlaceLines, this.cachedHeadLines, '</head>', '<body>', this.cachedBodyLines, scriptPlaceLines, '</body>', '</html>');\n                        return a.e();\n                    };\n                    WebCode.prototype.getBodyHtmlSectionLines = function getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        return Lines.bae(stylePlaceLines, this.cachedHeadLines, this.cachedBodyLines, scriptPlaceLines);\n                    };\n                    WebCode.prototype.getSectionPasteComment = function getSectionPasteComment(sectionName) {\n                        // section placeholder comment in paste mode - likely to be overridden with i18n\n                        return sectionName + ' goes here';\n                    };\n                    babelHelpers.createClass(WebCode, [\n                        {\n                            key: 'filename',\n                            // public:\n                            get: function () {\n                                return this.basename + '.html';\n                            }\n                        },\n                        {\n                            key: 'mimeType',\n                            get: function () {\n                                return 'text/html';\n                            }\n                        },\n                        {\n                            key: 'cachedStyleLines',\n                            get: function () {\n                                if (!this._styleLines)\n                                    this._styleLines = this.styleLines;\n                                return this._styleLines;\n                            }\n                        },\n                        {\n                            key: 'cachedHeadLines',\n                            get: function () {\n                                if (!this._headLines)\n                                    this._headLines = this.headLines;\n                                return this._headLines;\n                            }\n                        },\n                        {\n                            key: 'cachedBodyLines',\n                            get: function () {\n                                if (!this._bodyLines)\n                                    this._bodyLines = this.bodyLines;\n                                return this._bodyLines;\n                            }\n                        },\n                        {\n                            key: 'cachedScriptLines',\n                            get: function () {\n                                if (!this._scriptLines)\n                                    this._scriptLines = this.scriptLines;\n                                return this._scriptLines;\n                            }    // to be redefined in subclasses:\n                        },\n                        {\n                            key: 'basename',\n                            get: function () {\n                                // filename base\n                                return 'source';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                // language tag for <html lang=xx> or null to skip it - likely read from i18n\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                // page title or null to skip it\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                // contents of <style>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'headLines',\n                            get: function () {\n                                // contents of <head> following <style>, goes to <body> in html body mode\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                // contents of <body> preceding <script>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                // contents of <script>\n                                return Lines.be();\n                            }\n                        }\n                    ]);\n                    return WebCode;\n                }();\n                module.exports = WebCode;\n            },\n            {\n                '20': 20,\n                '21': 21,\n                '4': 4\n            }\n        ],\n        28: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(9);\n                var Lines = require(20);\n                var WrapLines = function (_Lines) {\n                    babelHelpers.inherits(WrapLines, _Lines);\n                    function WrapLines(data) {\n                        babelHelpers.classCallCheck(this, WrapLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        _this.wrappers = [];\n                        for (var i = 1; i < arguments.length; i++) {\n                            _this.wrappers.push(arguments[i]);\n                        }\n                        return _this;\n                    }\n                    WrapLines.prototype.isEmpty = function isEmpty() {\n                        return false;\n                    };\n                    WrapLines.prototype.doGet = function doGet(formatting, html) {\n                        var _this2 = this;\n                        var indent = '\\t';\n                        if (formatting.indent !== undefined) {\n                            indent = formatting.indent;\n                        }\n                        var out = [];\n                        var i = 0;\n                        var pushWrapper = function () {\n                            var item = _this2.wrappers[i];\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut);\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                            i++;\n                        };\n                        pushWrapper();\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut.map(function (s) {\n                                    return indent + s;\n                                }));\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(indent + s);\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            }\n                        });\n                        if (this.wrappers.length == 2) {\n                            pushWrapper();\n                        }\n                        return out;\n                    };\n                    return WrapLines;\n                }(Lines);\n                module.exports = WrapLines;\n            },\n            {\n                '20': 20,\n                '9': 9\n            }\n        ],\n        29: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var Feature = require(35);\n                var CallVector = require(30);\n                var Background = function (_Feature) {\n                    babelHelpers.inherits(Background, _Feature);\n                    function Background(options) {\n                        babelHelpers.classCallCheck(this, Background);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.isSolid = options.type == 'solid';\n                        if (_this.isSolid) {\n                            _this.features.push(new CallVector('background.color', options.color.entries, 'gl.clearColor', [\n                                0,\n                                0,\n                                0,\n                                0\n                            ]));\n                        }\n                        return _this;\n                    }\n                    Background.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_Feature.prototype.getJsLoopLines.call(this, featureContext));\n                        if (this.isSolid) {\n                            a('gl.clear(gl.COLOR_BUFFER_BIT);');\n                        }\n                        return a.e();\n                    };\n                    return Background;\n                }(Feature);\n                module.exports = Background;\n            },\n            {\n                '19': 19,\n                '30': 30,\n                '35': 35\n            }\n        ],\n        30: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var Vector = require(59);\n                var CallVector = function (_Vector) {\n                    babelHelpers.inherits(CallVector, _Vector);\n                    function CallVector(name, values, calledFn, calledFnDefaultArgs) {\n                        babelHelpers.classCallCheck(this, CallVector);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Vector.call(this, name, values));\n                        _this.calledFn = calledFn;\n                        _this.calledFnDefaultArgs = calledFnDefaultArgs;\n                        return _this;\n                    }\n                    // private:\n                    CallVector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        var _this2 = this;\n                        var a = JsLines.b();\n                        var nValueSliders = 0;\n                        this.components.forEach(function (component) {\n                            nValueSliders += component.value.input == 'slider';\n                        });\n                        if (this.modeConstant && this.components.every(function (component, i) {\n                                return component.value == _this2.calledFnDefaultArgs[i];\n                            })) {\n                        } else if (nValueSliders <= 1) {\n                            a(this.calledFn + '(' + this.components.map(componentValue).join(',') + ');');\n                        } else if (this.components.every(function (component) {\n                                return component.value.input == 'slider';\n                            })) {\n                            var obj = this.calledFn;\n                            var dotIndex = obj.lastIndexOf('.');\n                            if (dotIndex >= 0) {\n                                obj = obj.slice(0, dotIndex);\n                            }\n                            var suffixArray = '[' + this.components.map(function (component) {\n                                return '\\'' + component.suffix + '\\'';\n                            }).join(',') + ']';\n                            a(this.calledFn + '.apply(' + obj + ',' + suffixArray + '.map(function(c){', '\\treturn parseFloat(document.getElementById(\\'' + this.name + '.\\'+c).value);', '}));');\n                        } else {\n                            a(this.calledFn + '(');\n                            this.components.forEach(function (component, i) {\n                                if (i > 0) {\n                                    a.t(',');\n                                }\n                                a('\\t' + componentValue(component));\n                            });\n                            a(');');\n                        }\n                        return a.e();\n                    };\n                    CallVector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                        entry.post(this.calledFn + '(' + this.components.map(componentValue).join(',') + ');');\n                    };\n                    return CallVector;\n                }(Vector);\n                module.exports = CallVector;\n            },\n            {\n                '19': 19,\n                '59': 59\n            }\n        ],\n        31: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                    '\\t<canvas id=myCanvas width=',\n                    ' height=',\n                    '></canvas>'\n                ], [\n                    '\\t<canvas id=myCanvas width=',\n                    ' height=',\n                    '></canvas>'\n                ]);\n                var Lines = require(20);\n                var JsLines = require(19);\n                var Listener = require(41);\n                var Feature = require(35);\n                var IntFeature = require(40);\n                var Canvas = function (_Feature) {\n                    babelHelpers.inherits(Canvas, _Feature);\n                    function Canvas(options) {\n                        babelHelpers.classCallCheck(this, Canvas);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.width = options.width;\n                        _this.height = options.height;\n                        _this.features.push(new IntFeature('canvas.width', options.width), new IntFeature('canvas.height', options.height));\n                        return _this;\n                    }\n                    Canvas.prototype.getHtmlCanvasLines = function getHtmlCanvasLines() {\n                        return Lines.bae('<div>', Lines.html(_templateObject, this.width, this.height), '</div>');\n                    };\n                    Canvas.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines() {\n                        if (this.hasInputs()) {\n                            return Lines.bae('uniform float aspect;');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    Canvas.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines() {\n                        var needAspectConstant = !this.hasInputs() && Number(this.width) != Number(this.height);\n                        if (needAspectConstant) {\n                            return Lines.bae('float aspect=' + this.width + '.0/' + this.height + '.0;');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    Canvas.prototype.providesAspect = function providesAspect() {\n                        return this.hasInputs() || Number(this.width) != Number(this.height);\n                    };\n                    Canvas.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this2 = this;\n                        var a = JsLines.ba(_Feature.prototype.getJsInitLines.call(this, featureContext));\n                        var canvasUpdater = function () {\n                            a('function updateAspect() {', '\\tgl.viewport(0,0,canvas.width,canvas.height);', '\\tgl.uniform1f(aspectLoc,canvas.width/canvas.height);', '}', 'updateAspect();');\n                        };\n                        var canvasListener = function (wh) {\n                            if (_this2[wh].input == 'slider') {\n                                var listener = new Listener.Slider('canvas.' + wh);\n                                listener.enter().log('console.log(this.id,\\'input value:\\',parseInt(this.value));').post('canvas.' + wh + '=parseInt(this.value);').post('updateAspect();');\n                                a(featureContext.getListenerLines(listener));\n                            }\n                        };\n                        if (this.hasInputs()) {\n                            a('var aspectLoc=gl.getUniformLocation(program,\\'aspect\\');');\n                            canvasUpdater();\n                            canvasListener('width');\n                            canvasListener('height');\n                        }\n                        return a.e();\n                    };\n                    return Canvas;\n                }(Feature);\n                module.exports = Canvas;\n            },\n            {\n                '19': 19,\n                '20': 20,\n                '35': 35,\n                '40': 40,\n                '41': 41\n            }\n        ],\n        32: [\n            function (require, module, exports) {\n                'use strict';\n                var Shape = require(47);\n                var FeatureContext = require(34);\n                var Canvas = require(31);\n                var Background = require(29);\n                var Transforms = require(57);\n                var Illumination = require(38);\n                var Lines = require(20);\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var NoseWrapLines = require(21);\n                var InterleaveLines = require(18);\n                var IndentLines = require(17);\n                var BaseWebCode = require(27);\n                var Code = function (_BaseWebCode) {\n                    babelHelpers.inherits(Code, _BaseWebCode);\n                    function Code(options, i18n) {\n                        babelHelpers.classCallCheck(this, Code);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _BaseWebCode.call(this));\n                        _this.options = options;\n                        _this.i18n = i18n;\n                        _this.featureContext = new FeatureContext(options.debug);\n                        _this.canvas = new Canvas(options.canvas);\n                        _this.background = new Background(options.background);\n                        _this.transforms = new Transforms(options.transforms);\n                        _this.illumination = new Illumination(options.material, options.light);\n                        var makeShape = function () {\n                            return new Shape[(String(options.shape.type))](options.shape, options.light.type != 'off', options.material.scope == 'vertex', options.material.scope == 'face', _this.illumination.getColorAttrs());\n                        };\n                        _this.shape = makeShape();\n                        _this.features = [\n                            _this.canvas,\n                            _this.background,\n                            _this.transforms,\n                            _this.illumination,\n                            _this.shape\n                        ];\n                        _this.featureNames = [\n                            'canvas',\n                            'background',\n                            'transforms',\n                            'illumination',\n                            'shape'\n                        ];\n                        _this.features.forEach(function (feature) {\n                            feature.requestFeatureContext(_this.featureContext);\n                        });\n                        return _this;\n                    }\n                    babelHelpers.createClass(Code, [\n                        {\n                            key: 'basename',\n                            get: function () {\n                                return 'webgl';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                return 'en';\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                return 'WebGL example - Generated code';\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                var a = Lines.b();\n                                if (this.featureContext.hasSliders) {\n                                    a('label {', '\\tdisplay: inline-block;', '\\twidth: 15em;', '\\ttext-align: right;', '}', '.min {', '\\tdisplay: inline-block;', '\\twidth: 5em;', '\\ttext-align: right;', '}', '.max {', '\\tdisplay: inline-block;', '\\twidth: 5em;', '\\ttext-align: left;', '}');\n                                }\n                                return a.e();\n                            }\n                        },\n                        {\n                            key: 'headLines',\n                            get: function () {\n                                var _this2 = this;\n                                var getVertexShaderLines = function () {\n                                    var needTransformedPosition = _this2.illumination.wantsTransformedPosition(_this2.transforms.eyeAtInfinity);\n                                    return Lines.bae(_this2.canvas.getGlslVertexDeclarationLines(), _this2.transforms.getGlslVertexDeclarationLines(_this2.shape.dim == 2), _this2.illumination.getGlslVertexDeclarationLines(_this2.transforms.eyeAtInfinity, _this2.shape.dim > 2), WrapLines.b('void main() {', '}').ae(_this2.canvas.getGlslVertexOutputLines(), _this2.transforms.getGlslVertexOutputLines(_this2.shape.dim == 2, _this2.canvas.providesAspect(), needTransformedPosition), _this2.illumination.getGlslVertexOutputLines(_this2.transforms.eyeAtInfinity, _this2.shape.hasNormals, _this2.transforms.getGlslVertexNormalTransformLines())));\n                                };\n                                var getFragmentShaderLines = function () {\n                                    return Lines.bae('precision mediump float;', _this2.illumination.getGlslFragmentDeclarationLines(_this2.transforms.eyeAtInfinity), WrapLines.b('void main() {', '}').ae(_this2.illumination.getGlslFragmentOutputLines(_this2.transforms.eyeAtInfinity, _this2.shape.twoSided)));\n                                };\n                                return Lines.bae(WrapLines.b('<script id=myVertexShader type=x-shader/x-vertex>', '</script>').ae(getVertexShaderLines()), WrapLines.b('<script id=myFragmentShader type=x-shader/x-fragment>', '</script>').ae(getFragmentShaderLines()));\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                var _NoseWrapLines$b, _this3 = this;\n                                return Lines.bae.apply(Lines, [\n                                    this.canvas.getHtmlCanvasLines(),\n                                    (_NoseWrapLines$b = NoseWrapLines.b('<ul>', '</ul>')).ae.apply(_NoseWrapLines$b, this.features.map(function (feature) {\n                                        return feature.getHtmlControlMessageLines(_this3.i18n);\n                                    }))\n                                ].concat(this.features.map(function (feature) {\n                                    return feature.getHtmlInputLines(_this3.i18n);\n                                })));\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                var _this4 = this;\n                                var getMakeProgramLines = function () {\n                                    var a = JsLines.b();\n                                    a('var vertexShader=gl.createShader(gl.VERTEX_SHADER);', 'gl.shaderSource(vertexShader,vertexShaderSrc);', 'gl.compileShader(vertexShader);');\n                                    if (_this4.options.debugShaders) {\n                                        a('if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));');\n                                    }\n                                    a('var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);', 'gl.shaderSource(fragmentShader,fragmentShaderSrc);', 'gl.compileShader(fragmentShader);');\n                                    if (_this4.options.debugShaders) {\n                                        a('if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));');\n                                    }\n                                    a('var program=gl.createProgram();', 'gl.attachShader(program,vertexShader);', 'gl.attachShader(program,fragmentShader);', 'gl.linkProgram(program);', 'return program;');\n                                    return a.e();\n                                };\n                                var getJsInitLines = function () {\n                                    var a = JsLines.b();\n                                    a(WrapLines.b(JsLines.bae('function makeProgram(vertexShaderSrc,fragmentShaderSrc) {'), JsLines.bae('}')).ae(getMakeProgramLines()), 'var canvas=document.getElementById(\\'myCanvas\\');', 'var gl=canvas.getContext(\\'webgl\\')||canvas.getContext(\\'experimental-webgl\\');', 'var program=makeProgram(', '\\tdocument.getElementById(\\'myVertexShader\\').text,', '\\tdocument.getElementById(\\'myFragmentShader\\').text', ');', 'gl.useProgram(program);');\n                                    var addWithCommentIfNotEmpty = function (featureLines, comment) {\n                                        if (featureLines.count() > 0) {\n                                            a('', '// ' + comment, // TODO i18n\n                                            featureLines);\n                                        }\n                                    };\n                                    _this4.features.forEach(function (feature, i) {\n                                        addWithCommentIfNotEmpty(feature.getJsInitLines(_this4.featureContext), 'init ' + _this4.featureNames[i]);\n                                    });\n                                    addWithCommentIfNotEmpty(_this4.featureContext.getJsAfterInitLines(), 'init mousemove listener');\n                                    return a.e();\n                                };\n                                var getJsInnerLoopLines = function () {\n                                    var a = JsLines.b();\n                                    if (_this4.featureContext.hasClampFn) {\n                                        a('function clamp(v,min,max) {', '\\treturn Math.min(Math.max(v,min),max);', '}');\n                                    }\n                                    if (_this4.featureContext.hasWrapFn) {\n                                        a('function wrap(v,maxAbs) {', '\\tv%=maxAbs*2;', '\\tif (Math.abs(v)<=maxAbs) return v;', '\\treturn v-(v>0?1:-1)*maxAbs*2;', '}');\n                                    }\n                                    if (_this4.featureContext.pollsGamepad) {\n                                        a('var gamepad;', 'var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);', 'for (var i=0;i<gamepads.length;i++) {', '\\tif (gamepads[i]) {', '\\t\\tgamepad=gamepads[i];', '\\t\\tbreak;', '\\t}', '}');\n                                    }\n                                    a.apply(undefined, _this4.features.map(function (feature) {\n                                        return feature.getJsLoopLines(_this4.featureContext);\n                                    }));\n                                    return a.e();\n                                };\n                                var getJsLoopLines = function () {\n                                    var a = JsLines.b();\n                                    if (_this4.featureContext.hasStartTime && _this4.featureContext.hasPrevTime) {\n                                        a('var startTime=performance.now();');\n                                        a('var prevTime=startTime;');\n                                    } else if (_this4.featureContext.hasStartTime) {\n                                        a('var startTime=performance.now();');\n                                    } else if (_this4.featureContext.hasPrevTime) {\n                                        a('var prevTime=performance.now();');\n                                    }\n                                    // wrap inner render lines in function if needed\n                                    if (_this4.featureContext.isAnimated) {\n                                        if (_this4.featureContext.hasTime) {\n                                            a('function renderFrame(time) {');\n                                        } else {\n                                            a('function renderFrame() {');\n                                        }\n                                        a(IndentLines.bae(getJsInnerLoopLines()));\n                                        if (_this4.featureContext.hasPrevTime) {\n                                            a('\\tprevTime=time;');\n                                        }\n                                        a('\\trequestAnimationFrame(renderFrame);', '}', 'requestAnimationFrame(renderFrame);');\n                                    } else if (_this4.featureContext.hasInputs) {\n                                        a('var frameId=null;', 'function renderFrame() {', IndentLines.bae(getJsInnerLoopLines()), '\\tframeId=null;', '}', 'function scheduleFrame() {', '\\tif (frameId===null) {', '\\t\\tframeId=requestAnimationFrame(renderFrame);', '\\t}', '}', 'scheduleFrame();');\n                                    } else {\n                                        a(getJsInnerLoopLines());\n                                    }\n                                    return a.e();\n                                };\n                                return InterleaveLines.bae(getJsInitLines(), getJsLoopLines());\n                            }\n                        }\n                    ]);\n                    return Code;\n                }(BaseWebCode);\n                module.exports = Code;\n            },\n            {\n                '17': 17,\n                '18': 18,\n                '19': 19,\n                '20': 20,\n                '21': 21,\n                '27': 27,\n                '28': 28,\n                '29': 29,\n                '31': 31,\n                '34': 34,\n                '38': 38,\n                '47': 47,\n                '57': 57\n            }\n        ],\n        33: [\n            function (require, module, exports) {\n                var colorgenCounter = 0;\n                var SingleColorgen = function (weight, noise, baseColors) {\n                    this.weight = weight;\n                    this.noise = noise;\n                    if (noise === undefined)\n                        this.noise = 0.4;\n                    this.baseColors = baseColors || this.defaultBaseColors;\n                    this.colorgenNumber = colorgenCounter++;\n                    this.nextIndex = 0;\n                };\n                SingleColorgen.prototype.defaultBaseColors = [\n                    [\n                        1,\n                        0,\n                        0\n                    ],\n                    // TODO 'cube' color order, when cube is not ugly\n                    [\n                        0,\n                        1,\n                        0\n                    ],\n                    [\n                        0,\n                        0,\n                        1\n                    ],\n                    [\n                        1,\n                        1,\n                        0\n                    ],\n                    [\n                        1,\n                        0,\n                        1\n                    ],\n                    [\n                        0,\n                        1,\n                        1\n                    ]\n                ];\n                SingleColorgen.prototype.getNextColorString = function () {\n                    var baseColor = this.baseColors[this.nextIndex];\n                    this.nextIndex = (this.nextIndex + 1) % this.baseColors.length;\n                    return baseColor.map(function (ci, i) {\n                        var s = Math.sin(this.colorgenNumber * 9000 + this.nextIndex * 400 + i * 100);\n                        var co = (ci * (1 - this.noise) + s * s * this.noise) * this.weight;\n                        return ' ' + co.toFixed(1) + ',';\n                    }, this).join('');\n                };\n                var Colorgen = function (colorAttrs, noise, baseColors) {\n                    this.colorAttrs = colorAttrs;\n                    this.singleColorgens = this.colorAttrs.map(function (attr) {\n                        return new SingleColorgen(attr.weight, noise, baseColors);\n                    });\n                };\n                Colorgen.prototype.getHeaderString = function () {\n                    return this.colorAttrs.map(function () {\n                        return '    r    g    b';\n                    }).join('');\n                };\n                Colorgen.prototype.getNextColorString = function () {\n                    return this.singleColorgens.map(function (singleColorgen) {\n                        return singleColorgen.getNextColorString();\n                    }).join('');\n                };\n                module.exports = Colorgen;\n            },\n            {}\n        ],\n        34: [\n            function (require, module, exports) {\n                'use strict';\n                var Listener = require(41);\n                var FeatureContext = function () {\n                    function FeatureContext(debugOptions) {\n                        babelHelpers.classCallCheck(this, FeatureContext);\n                        this.debugOptions = debugOptions;\n                        this.canvasMousemoveListener = new Listener.CanvasMousemove();\n                        //// to be set by features:\n                        // for html:\n                        this.hasSliders = false;\n                        // for js:\n                        this.hasInputs = false;\n                        // must have renderFrame()\n                        this.hasStartTime = false;\n                        this.hasPrevTime = false;\n                        this.pollsGamepad = false;\n                        this.hasClampFn = false;\n                        this.hasWrapFn = false;\n                    }\n                    FeatureContext.prototype.getJsAfterInitLines = function getJsAfterInitLines() {\n                        return this.canvasMousemoveListener.write(!this.isAnimated, this.debugOptions.inputs);\n                    };\n                    FeatureContext.prototype.getListenerLines = function getListenerLines(listener) {\n                        return listener.write(!this.isAnimated, this.debugOptions.inputs);\n                    };\n                    babelHelpers.createClass(FeatureContext, [\n                        {\n                            key: 'hasTime',\n                            get: function () {\n                                return this.hasStartTime || this.hasPrevTime;\n                            }\n                        },\n                        {\n                            key: 'isAnimated',\n                            get: function () {\n                                return this.hasStartTime || this.hasPrevTime || this.pollsGamepad;\n                            }\n                        }\n                    ]);\n                    return FeatureContext;\n                }();\n                module.exports = FeatureContext;\n            },\n            { '41': 41 }\n        ],\n        35: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(20);\n                var Feature = function () {\n                    function Feature() {\n                        babelHelpers.classCallCheck(this, Feature);\n                        this.features = [];\n                    }\n                    // private:\n                    Feature.prototype.getRecursiveLines = function getRecursiveLines(method, args) {\n                        return Lines.bae.apply(Lines, this.features.map(function (feature) {\n                            return feature[method].apply(feature, args);\n                        }));\n                    };\n                    // methods to be redefined:\n                    Feature.prototype.hasInputs = function hasInputs() {\n                        return this.features.some(function (feature) {\n                            return feature.hasInputs();\n                        });\n                    };\n                    Feature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        this.features.forEach(function (feature) {\n                            feature.requestFeatureContext(featureContext);\n                        });\n                    };\n                    Feature.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        return this.getRecursiveLines('getHtmlInputLines', arguments);\n                    };\n                    Feature.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        return this.getRecursiveLines('getHtmlControlMessageLines', arguments);\n                    };\n                    Feature.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        return this.getRecursiveLines('getJsInitLines', arguments);\n                    };\n                    Feature.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        return this.getRecursiveLines('getJsLoopLines', arguments);\n                    };\n                    return Feature;\n                }();\n                module.exports = Feature;\n            },\n            { '20': 20 }\n        ],\n        36: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbers = require(12);\n                var Lines = require(20);\n                var JsLines = require(19);\n                var Vector = require(59);\n                var GlslVector = function (_Vector) {\n                    babelHelpers.inherits(GlslVector, _Vector);\n                    function GlslVector(name, values, wrapRange) {\n                        babelHelpers.classCallCheck(this, GlslVector);\n                        return babelHelpers.possibleConstructorReturn(this, _Vector.call(this, name, values, wrapRange));\n                    }\n                    // public:\n                    GlslVector.prototype.getGlslDeclarationLines = function getGlslDeclarationLines() {\n                        var _this2 = this;\n                        if (this.modeConstant) {\n                            return Lines.be();\n                        } else if (this.modeFloats) {\n                            var _ret = function () {\n                                var a = Lines.b();\n                                _this2.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a('uniform float ' + component.varName + ';');\n                                    }\n                                });\n                                return { v: a.e() };\n                            }();\n                            if (typeof _ret === 'object')\n                                return _ret.v;\n                        } else {\n                            return Lines.bae('uniform vec' + this.nVars + ' ' + this.varName + ';');\n                        }\n                    };\n                    GlslVector.prototype.getGlslValue = function getGlslValue() {\n                        return this.getGlslComponentsValue(this.components.map(function (component) {\n                            return component.suffix;\n                        }).join(''));\n                    };\n                    GlslVector.prototype.getGlslComponentsValue = function getGlslComponentsValue(selectedComponents) {\n                        var _this3 = this;\n                        var numbers = {};\n                        var results = [];\n                        // [[isConstant,componentName]]\n                        for (var j = 0; j < selectedComponents.length; j++) {\n                            var c = selectedComponents.charAt(j);\n                            if (!this.componentsBySuffix[c].variable) {\n                                numbers[c] = this.componentsBySuffix[c].value;\n                                results.push([\n                                    true,\n                                    c\n                                ]);\n                            } else {\n                                if (this.modeVector && results.length > 0) {\n                                    var prevResult = results.pop();\n                                    if (prevResult[0]) {\n                                        results.push(prevResult, [\n                                            false,\n                                            c\n                                        ]);    // prev is constant, don't merge\n                                    } else {\n                                        results.push([\n                                            prevResult[0],\n                                            prevResult[1] + c\n                                        ]);    // merge\n                                    }\n                                } else {\n                                    results.push([\n                                        false,\n                                        c\n                                    ]);\n                                }\n                            }\n                        }\n                        var fmt = formatNumbers.glsl(numbers);\n                        var allSuffixString = this.components.map(function (component) {\n                            return component.suffix;\n                        }).slice(0, this.nVars).join('');\n                        var allSameConstant = function () {\n                            if (!results[0][0])\n                                return false;\n                            var cmp = fmt[results[0][1]];\n                            return results.every(function (result) {\n                                return result[0] && fmt[result[1]] == cmp;\n                            });\n                        };\n                        var showResult = function (result) {\n                            if (result[0]) {\n                                return fmt[result[1]];\n                            } else {\n                                if (_this3.modeVector) {\n                                    if (result[1] == allSuffixString) {\n                                        return _this3.varName;\n                                    } else {\n                                        return _this3.varName + '.' + result[1];\n                                    }\n                                } else {\n                                    return _this3.componentsBySuffix[result[1]].varName;\n                                }\n                            }\n                        };\n                        if (results.length == 1) {\n                            if (this.modeVector && selectedComponents == allSuffixString) {\n                                return this.varName;\n                            } else {\n                                return showResult(results[0]);\n                            }\n                        } else {\n                            if (allSameConstant()) {\n                                return 'vec' + selectedComponents.length + '(' + showResult(results[0]) + ')';    // see OpenGL ES SL section 5.4.2\n                            } else {\n                                return 'vec' + selectedComponents.length + '(' + results.map(showResult).join(',') + ')';\n                            }\n                        }\n                    };\n                    GlslVector.prototype.getGlslMapDeclarationLines = function getGlslMapDeclarationLines(mapName, mapFn) {\n                        if (this.components.length > 1) {\n                            return Lines.bae('vec' + this.components.length + ' ' + mapName + '=' + mapFn(this.getGlslValue()) + ';');\n                        } else {\n                            return Lines.bae('float ' + mapName + this.components[0].suffix + '=' + mapFn(this.getGlslValue()) + ';');\n                        }\n                    };\n                    GlslVector.prototype.getGlslMapComponentValue = function getGlslMapComponentValue(mapName, selectedComponent) {\n                        if (this.components.length > 1) {\n                            return mapName + '.' + selectedComponent;\n                        } else {\n                            return mapName + selectedComponent;\n                        }\n                    };\n                    // private:\n                    GlslVector.prototype.getJsDeclarationLines = function getJsDeclarationLines() {\n                        var a = JsLines.b();\n                        if (this.modeConstant) {\n                            return a.e();\n                        }\n                        if (this.modeFloats) {\n                            this.components.forEach(function (component) {\n                                if (component.variable) {\n                                    a('var ' + component.varNameLoc + '=gl.getUniformLocation(program,\\'' + component.varName + '\\');');\n                                }\n                            });\n                        } else {\n                            a('var ' + this.varName + 'Loc=gl.getUniformLocation(program,\\'' + this.varName + '\\');');\n                        }\n                        return a.e();\n                    };\n                    GlslVector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        var a = JsLines.b();\n                        if (this.modeVector) {\n                            a('gl.uniform' + this.nVars + 'f(' + this.varName + 'Loc');\n                            if (this.components.every(function (component) {\n                                    return component.value.input != 'slider';\n                                })) {\n                                // all values are short, no getElement... queries\n                                this.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a.t(',' + componentValue(component));\n                                    }\n                                });\n                                a.t(');');\n                            } else {\n                                this.components.forEach(function (component) {\n                                    if (component.variable) {\n                                        a.t(',', '\\t' + componentValue(component));\n                                    }\n                                });\n                                a(');');\n                            }\n                        } else {\n                            this.components.forEach(function (component) {\n                                if (component.variable) {\n                                    a('gl.uniform1f(' + component.varNameLoc + ',' + componentValue(component) + ');');\n                                }\n                            });\n                        }\n                        return a.e();\n                    };\n                    GlslVector.prototype.addPostToListenerEntryForComponent = function addPostToListenerEntryForComponent(entry, component) {\n                        if (this.modeVector) {\n                        } else {\n                            entry.post('gl.uniform1f(' + component.varNameLoc + ',' + component.varName + ');');\n                        }\n                    };\n                    GlslVector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                        var _this4 = this;\n                        if (this.modeVector) {\n                            (function () {\n                                var vs = [];\n                                _this4.components.forEach(function (component, i) {\n                                    if (i < _this4.nVars) {\n                                        vs.push(component.varName);\n                                    }\n                                });\n                                entry.post('gl.uniform' + _this4.nVars + 'f(' + _this4.varName + 'Loc,' + vs.join(',') + ');');\n                            }());\n                        }\n                    };\n                    return GlslVector;\n                }(Vector);\n                module.exports = GlslVector;\n            },\n            {\n                '12': 12,\n                '19': 19,\n                '20': 20,\n                '59': 59\n            }\n        ],\n        37: [\n            function (require, module, exports) {\n                'use strict';\n                var langStrings = {\n                    en: {\n                        'options.canvas': 'Canvas',\n                        'options.canvas.{width,height}': 'Canvas {}',\n                        'options.background': 'Background',\n                        'options.background.type': 'Background type',\n                        'options.background.type.none': 'none (transparent)',\n                        'options.background.type.solid': 'solid color',\n                        'options.background.color': 'Background color',\n                        'options.background.color.{r,g,b,a}': 'Background color {red,green,blue,alpha} component',\n                        'options.background.color.{r,g,b,a}.speed': 'Background color {red,green,blue,alpha} speed',\n                        'options.material': 'Material',\n                        'options.material.scope': 'Set material color for objects',\n                        'options.material.scope.global': 'entire scene',\n                        'options.material.scope.vertex': 'shape vertices',\n                        'options.material.scope.face': 'shape faces',\n                        'options.material.data': 'For each object have',\n                        'options.material.data.one': 'one color',\n                        'options.material.data.sda': 'specular/diffuse/ambient colors',\n                        'options.material.color': 'Material color',\n                        'options.material.color.{r,g,b,a}': 'Material color {red,green,blue,alpha} component',\n                        'options.material.color.{r,g,b,a}.speed': 'Material color {red,green,blue,alpha} speed',\n                        'options.material.{specular,diffuse,ambient}Color': 'Material {} color',\n                        'options.material.{specular,diffuse,ambient}Color.{r,g,b}': '{Specular,Diffuse,Ambient} color {red,green,blue} component',\n                        'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed': 'Material {} color {red,green,blue,alpha} speed',\n                        'options-info.material.data.sda': 'for use with Phong/Blinn\\u2013Phong shading models selected by <em>light type</em>',\n                        'options.light': 'Light',\n                        'options.light.type': 'Light type',\n                        'options.light.type.off': 'off',\n                        'options.light.type.phong': 'on with Phong reflections',\n                        'options.light.type.blinn': 'on with Blinn\\u2013Phong reflections',\n                        'options.light.direction': 'Light direction',\n                        'options.light.direction.{x,y,z}': 'Light direction {} component',\n                        'options.light.direction.{x,y,z}.speed': 'Light direction {} speed',\n                        'options-info.light.type.phong': '[[Shading#Directional_lighting|directional light]] with [[Phong reflection model]]',\n                        'options-info.light.type.blinn': '[[Shading#Directional_lighting|directional light]] with [[Blinn\\u2013Phong shading model|Blinn\\u2013Phong reflection model]]',\n                        'options.shape': 'Shape',\n                        'options.shape.type': 'Shape to draw',\n                        'options.shape.type.square': 'square',\n                        'options.shape.type.triangle': 'triangle',\n                        'options.shape.type.gasket': 'Sierpinski gasket',\n                        'options.shape.type.cube': 'cube',\n                        'options.shape.type.hat': 'Mexican hat function',\n                        'options.shape.type.terrain': 'diamond-square fractal terrain',\n                        'options.shape.elements': 'Element array',\n                        'options.shape.elements.0': 'not used',\n                        'options.shape.elements.{8,16,32}': 'with {}-bit index',\n                        'options.shape.lod': 'Shape detail level',\n                        // recursion depth for fractal shapes\n                        'options-info.shape.type.gasket': '[[Sierpinski triangle]]',\n                        'options-info.shape.type.hat': '[[Mexican hat wavelet]]',\n                        'options-info.shape.type.terrain': 'generated with the [[Diamond-square algorithm|diamond-square algorithm]]',\n                        'options-info.shape.elements.{8,16}': 'choosing 8- or 16-bit index may limit available shape detail levels',\n                        'options.transforms': 'Transforms',\n                        'options.transforms.projection': 'Projection',\n                        'options.transforms.projection.ortho': 'orthogonal',\n                        'options.transforms.projection.perspective': 'perspective',\n                        'options.transforms.model': 'Model transform',\n                        'options.transforms.model.rotate.{x,y,z}.add': 'Add rotation around {} axis',\n                        'options.transforms.model.rotate.{x,y,z}': 'Angle of rotation around {} axis',\n                        'options.transforms.model.rotate.{x,y,z}.speed': 'Speed of rotation around {} axis',\n                        'options-info.transforms.projection.ortho': '[[Orthographic projection|orthographic projection]]',\n                        'options-info.transforms.projection.perspective': '[[Transformation_matrix#Perspective_projection|perspective projection]]',\n                        'options.debug': 'Debug options',\n                        'options.debug.shaders': 'Log shader compilation errors',\n                        'options.debug.arrays': 'Log allocated array sizes',\n                        'options.debug.inputs': 'Log input values',\n                        'options.debug.animations': 'Log animated values',\n                        'options-output.inputs': 'Input method',\n                        'options-output.inputs.constant': 'none',\n                        'options-output.inputs.slider': 'slider',\n                        'options-output.inputs.mousemove{x,y}': 'mouse {} axis',\n                        'options-output.inputs.gamepad{0,1,2,3}': 'gamepad {} axis',\n                        'options-output.range': 'with range',\n                        'options-output.addSpeed': 'Add speed',\n                        'controls.type.mousemove{x,y}': 'Move the mouse pointer {horizontally,vertically} over the canvas',\n                        'controls.to': 'to update',\n                        'units.pixel.a': 'px',\n                        'units.pixel.{1,2}': 'pixel{,s}',\n                        'units.\\xB0/second.a': '\\xB0/s',\n                        'units.\\xB0/second.{1,2}': 'degree{,s} per second',\n                        'units.second.a': 's',\n                        'units.1/second.{1,2}': 'unit{,s} per second'\n                    },\n                    ru: {\n                        'options.canvas': 'Элемент <code>canvas</code>',\n                        'options.canvas.{width,height}': '{Ширина,Высота} элемента <code>canvas</code>',\n                        'options.background': 'Фон',\n                        'options.background.type': 'Тип фона',\n                        'options.background.type.none': 'прозрачный',\n                        'options.background.type.solid': 'закрашенный',\n                        'options.background.color': 'Цвет фона',\n                        'options.background.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал фона',\n                        'options.background.color.{r,g,b,a}.speed': 'Скорость {красного ,зелёного ,синего ,альфа-}канала фона',\n                        'options.material': 'Материал',\n                        'options.material.scope': 'Задавать цвета данных объектов',\n                        'options.material.scope.global': 'всей сцены',\n                        'options.material.scope.vertex': 'вершин фигур',\n                        'options.material.scope.face': 'граней фигур',\n                        'options.material.data': 'Задавать для каждого объекта',\n                        'options.material.data.one': 'один цвет',\n                        'options.material.data.sda': 'бликовую/рассеянную/фоновую составляющие',\n                        'options.material.color': 'Цвет материала',\n                        'options.material.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал материала',\n                        'options.material.color.{r,g,b,a}.speed': 'Скорость {красного ,зелёного ,синего ,альфа-}канала материала',\n                        'options.material.{specular,diffuse,ambient}Color': '{Бликовая,Рассеянная,Фоновая} составляющая цвета материала',\n                        'options.material.specularColor.{r,g,b}': '{Красный,Зелёный,Синий} канал бликовой составляющей',\n                        'options.material.diffuseColor.{r,g,b}': '{Красный,Зелёный,Синий} канал рассеянной составляющей',\n                        'options.material.ambientColor.{r,g,b}': '{Красный,Зелёный,Синий} канал фоновой составляющей',\n                        'options.material.specularColor.{r,g,b}.speed': 'Скорость {красного,зелёного,синего} канала бликовой составляющей',\n                        'options.material.diffuseColor.{r,g,b}.speed': 'Скорость {красного,зелёного,синего} канала рассеянной составляющей',\n                        'options.material.ambientColor.{r,g,b}.speed': 'Скорость {красного,зелёного,синего} канала фоновой составляющей',\n                        'options-info.material.data.sda': 'для использования с моделями освещения Фонга/Блинна-Фонга, задаваемыми <em>типом света</em>',\n                        'options.light': 'Свет',\n                        'options.light.type': 'Тип света',\n                        'options.light.type.off': 'отключен',\n                        'options.light.type.phong': 'включен с отражениями по Фонгу',\n                        'options.light.type.blinn': 'включен с отражениями по Блинну-Фонгу',\n                        'options.light.direction': 'Направление света',\n                        'options.light.direction.{x,y,z}': '{}-компонент направления света',\n                        'options.light.direction.{x,y,z}.speed': 'скорость {}-компонента направления света',\n                        'options-info.light.type.phong': 'направленный свет с [[Затенение_по_Фонгу#.D0.9C.D0.BE.D0.B4.D0.B5.D0.BB.D1.8C_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F|моделью освещения Фонга]]',\n                        'options-info.light.type.blinn': 'направленный свет с моделью освещения Блинна-Фонга',\n                        'options.shape': 'Фигура',\n                        'options.shape.type': 'Рисовать фигуру',\n                        'options.shape.type.square': 'квадрат',\n                        'options.shape.type.triangle': 'треугольник',\n                        'options.shape.type.gasket': 'салфетка Серпинского',\n                        'options.shape.type.cube': 'куб',\n                        'options.shape.type.hat': 'Mexican hat function',\n                        'options.shape.type.terrain': 'фрактальный ландшафт',\n                        'options.shape.elements': 'Element array',\n                        'options.shape.elements.0': 'не используется',\n                        'options.shape.elements.{8,16,32}': 'с {}-битным индексом',\n                        'options.shape.lod': 'Уровень детализации',\n                        // recursion depth for fractal shapes\n                        'options-info.shape.type.gasket': '[[Треугольник Серпинского|треугольник Серпинского]]',\n                        'options-info.shape.type.terrain': 'сгенерирован [[Алгоритм Diamond-Square|алгоритмом diamond-square]]',\n                        'options-info.shape.elements.{8,16}': 'выбор 8- или 16-битного индекса может ограничить доступные уровни детализации',\n                        'options.transforms': 'Преобразования',\n                        'options.transforms.projection': 'Проекция',\n                        'options.transforms.projection.ortho': 'ортогональная',\n                        'options.transforms.projection.perspective': 'перспективная',\n                        'options.transforms.model': 'Преобразование модели',\n                        'options.transforms.model.rotate.{x,y,z}.add': 'Добавить вращение вокруг оси {}',\n                        'options.transforms.model.rotate.{x,y,z}': 'Угол поворота вокруг оси {}',\n                        'options.transforms.model.rotate.{x,y,z}.speed': 'Скорость поворота вокруг оси {}',\n                        'options.debug': 'Отладка',\n                        'options.debug.shaders': 'Выводить ошибки компиляции шейдеров',\n                        'options.debug.arrays': 'Выводить размеры выделенных массивов',\n                        'options.debug.inputs': 'Выводить значения вводов',\n                        'options.debug.animations': 'Выводить анимированные значения',\n                        'options-output.inputs': 'Способ ввода',\n                        'options-output.inputs.constant': 'нет',\n                        'options-output.inputs.slider': 'ползунок',\n                        'options-output.inputs.mousemove{x,y}': 'ось {} мыши',\n                        'options-output.inputs.gamepad{0,1,2,3}': 'ось {} геймпада',\n                        'options-output.range': 'с диапазоном',\n                        'options-output.addSpeed': 'Добавить скорость',\n                        'controls.type.mousemove{x,y}': 'Перемещайте указатель мыши над элементом <code>canvas</code> в {горизонтальном,вертикальном} направлении,',\n                        'controls.to': 'чтобы изменить',\n                        'units.pixel.a': 'px',\n                        'units.pixel.{1,2,5}': 'пиксел{ь,я,ей}',\n                        'units.\\xB0/second.a': '\\xB0/с',\n                        'units.\\xB0/second.{1,2,5}': 'градус{,а,ов} в секунду',\n                        'units.second.a': 'с',\n                        'units.1/second.{1,2,5}': 'единиц{а,ы,} в секунду'\n                    }\n                };\n                for (var lang in langStrings) {\n                    var strings = langStrings[lang];\n                    strings = require(14)(strings);\n                    strings = require(15)(lang)(strings);\n                    strings = require(23)(lang)(strings);\n                    strings = require(2)(lang)(strings);\n                    langStrings[lang] = strings;\n                }\n                module.exports = require(16)(langStrings);\n            },\n            {\n                '14': 14,\n                '15': 15,\n                '16': 16,\n                '2': 2,\n                '23': 23\n            }\n        ],\n        38: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(44);\n                var Lines = require(20);\n                var WrapLines = require(28);\n                var Feature = require(35);\n                var GlslVector = require(36);\n                var Illumination = function (_Feature) {\n                    babelHelpers.inherits(Illumination, _Feature);\n                    function Illumination(material, light) {\n                        babelHelpers.classCallCheck(this, Illumination);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.material = material;\n                        _this.light = light;\n                        // possible options checks:\n                        // material.scope=='global': constant or user input -> uniform\n                        // material.scope!='global': colors in model data -> attribute\n                        // material.data=='one': one color\n                        // material.data!='one': s/d/a colors\n                        // light.type=='off'\n                        // light.type!='off'\n                        // light.type=='blinn'\n                        if (material.scope == 'global') {\n                            if (material.data == 'one') {\n                                _this.features.push(_this.colorVector = new GlslVector('material.color', material.color.entries));\n                            } else if (light.type != 'off') {\n                                _this.features.push(_this.specularColorVector = new GlslVector('material.specularColor', material.specularColor.entries), _this.diffuseColorVector = new GlslVector('material.diffuseColor', material.diffuseColor.entries), _this.ambientColorVector = new GlslVector('material.ambientColor', material.ambientColor.entries));\n                            } else {\n                                _this.features.push(_this.ambientColorVector = new GlslVector('material.ambientColor', [].concat(material.ambientColor.entries, [Option.LiveFloat.make('a', [\n                                        0,\n                                        1,\n                                        -1,\n                                        +1\n                                    ], 1)().fix()])));    // TODO consider extendind .specularColor and .diffuseColor, b/c they would be present if vertex scope is chosen\n                            }\n                        }\n                        if (light.type != 'off') {\n                            _this.features.push(_this.lightDirectionVector = new GlslVector('light.direction', light.direction.entries));\n                        }\n                        return _this;\n                    }\n                    Illumination.prototype.getColorAttrs = function getColorAttrs() {\n                        if (this.material.scope == 'global') {\n                            return [];\n                        } else {\n                            if (this.material.data == 'one') {\n                                return [{\n                                        name: 'color',\n                                        enabled: true,\n                                        weight: 1\n                                    }];\n                            } else {\n                                return [\n                                    {\n                                        name: 'specularColor',\n                                        enabled: this.light.type != 'off',\n                                        weight: 0.4\n                                    },\n                                    {\n                                        name: 'diffuseColor',\n                                        enabled: this.light.type != 'off',\n                                        weight: 0.4\n                                    },\n                                    {\n                                        name: 'ambientColor',\n                                        enabled: true,\n                                        weight: 0.2\n                                    }\n                                ];\n                            }\n                        }\n                    };\n                    Illumination.prototype.wantsTransformedPosition = function wantsTransformedPosition(eyeAtInfinity) {\n                        return !eyeAtInfinity && this.light.type != 'off' && this.material.data != 'one';\n                    };\n                    Illumination.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines(eyeAtInfinity, hasNormalAttr) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('varying vec3 interpolatedView;');\n                        }\n                        if (this.light.type != 'off') {\n                            if (hasNormalAttr) {\n                                a('attribute vec3 normal;');\n                            }\n                            a('varying vec3 interpolatedNormal;');\n                        }\n                        if (this.material.scope != 'global') {\n                            if (this.material.data == 'one') {\n                                a('attribute vec4 color;');\n                                a('varying vec4 interpolatedColor;');\n                            } else {\n                                if (this.light.type == 'off') {\n                                    a('attribute vec4 ambientColor;');\n                                    a('varying vec4 interpolatedColor;');\n                                } else {\n                                    a('attribute vec3 specularColor;', 'attribute vec3 diffuseColor;', 'attribute vec3 ambientColor;', 'varying vec3 interpolatedSpecularColor;', 'varying vec3 interpolatedDiffuseColor;', 'varying vec3 interpolatedAmbientColor;');\n                                }\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines(eyeAtInfinity, hasNormalAttr, normalTransformLines) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('interpolatedView=-transformedPosition.xyz;');\n                        }\n                        if (this.light.type != 'off') {\n                            a('interpolatedNormal=');\n                            if (hasNormalAttr) {\n                                a.t('normal');\n                            } else {\n                                a.t('vec3(0.0,0.0,1.0)');\n                            }\n                            a.t(normalTransformLines);\n                            a.t(';');\n                        }\n                        if (this.material.scope != 'global') {\n                            if (this.material.data == 'one') {\n                                a('interpolatedColor=color;');\n                            } else {\n                                if (this.light.type == 'off') {\n                                    a('interpolatedColor=ambientColor;');\n                                } else {\n                                    a('interpolatedSpecularColor=specularColor;', 'interpolatedDiffuseColor=diffuseColor;', 'interpolatedAmbientColor=ambientColor;');\n                                }\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslFragmentDeclarationLines = function getGlslFragmentDeclarationLines(eyeAtInfinity) {\n                        var a = Lines.b();\n                        if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                            a('varying vec3 interpolatedView;');\n                        }\n                        if (this.light.type != 'off') {\n                            a(this.lightDirectionVector.getGlslDeclarationLines(), 'varying vec3 interpolatedNormal;');\n                        }\n                        if (this.material.scope == 'global') {\n                            if (this.material.data == 'one') {\n                                a(this.colorVector.getGlslDeclarationLines());\n                            } else {\n                                if (this.light.type != 'off') {\n                                    a(this.specularColorVector.getGlslDeclarationLines());\n                                    a(this.diffuseColorVector.getGlslDeclarationLines());\n                                }\n                                a(this.ambientColorVector.getGlslDeclarationLines());\n                            }\n                        } else {\n                            if (this.material.data == 'one' || this.light.type == 'off') {\n                                a('varying vec4 interpolatedColor;');\n                            } else {\n                                a('varying vec3 interpolatedSpecularColor;', 'varying vec3 interpolatedDiffuseColor;', 'varying vec3 interpolatedAmbientColor;');\n                            }\n                        }\n                        return a.e();\n                    };\n                    Illumination.prototype.getGlslFragmentOutputLines = function getGlslFragmentOutputLines(eyeAtInfinity, twoSided) {\n                        var _this2 = this;\n                        var a = Lines.b();\n                        var colorRGB = undefined, colorA = undefined, colorRGBA = undefined;\n                        if (this.material.scope == 'global') {\n                            (function () {\n                                var vector = _this2.material.data == 'one' ? _this2.colorVector : _this2.ambientColorVector;\n                                colorRGB = function () {\n                                    return vector.getGlslComponentsValue('rgb');\n                                };\n                                colorA = function () {\n                                    return vector.getGlslComponentsValue('a');\n                                };\n                                colorRGBA = function () {\n                                    return vector.getGlslValue();\n                                };\n                            }());\n                        } else {\n                            colorRGB = function () {\n                                return 'interpolatedColor.rgb';\n                            };\n                            // TODO don't pass it as vec4 if light is on\n                            colorA = function () {\n                                return 'interpolatedColor.a';\n                            };\n                            colorRGBA = function () {\n                                return 'interpolatedColor';\n                            };\n                        }\n                        if (this.light.type == 'off') {\n                            a('gl_FragColor=' + colorRGBA() + ';');\n                        } else {\n                            a('vec3 N=normalize(interpolatedNormal);');\n                            if (twoSided) {\n                                a('if (!gl_FrontFacing) N=-N;');\n                            }\n                            a('vec3 L=normalize(' + this.lightDirectionVector.getGlslValue() + ');');\n                            if (this.material.data == 'one') {\n                                a('gl_FragColor=vec4(' + colorRGB() + '*max(0.0,dot(L,N)),' + colorA() + ');');\n                            } else {\n                                if (this.wantsTransformedPosition(eyeAtInfinity)) {\n                                    a('vec3 V=normalize(interpolatedView);');\n                                } else {\n                                    a('vec3 V=vec3(0.0,0.0,1.0);');\n                                }\n                                var specularDotArgs = 'H,N';\n                                var shininessCorrection = '';\n                                if (this.light.type == 'blinn') {\n                                    a('vec3 H=normalize(L+V);');\n                                } else {\n                                    a('vec3 R=reflect(-L,N);');\n                                    specularDotArgs = 'R,V';\n                                    shininessCorrection = '/4.0';\n                                }\n                                a('float shininess=100.0;');\n                                a(WrapLines.b('gl_FragColor=vec4(', ',1.0);').ae(this.material.scope == 'global' ? Lines.bae('+' + this.specularColorVector.getGlslValue() + '*pow(max(0.0,dot(' + specularDotArgs + ')),shininess' + shininessCorrection + ')', '+' + this.diffuseColorVector.getGlslValue() + '*max(0.0,dot(L,N))', '+' + this.ambientColorVector.getGlslValue()) : Lines.bae('+interpolatedSpecularColor*pow(max(0.0,dot(' + specularDotArgs + ')),shininess' + shininessCorrection + ')', '+interpolatedDiffuseColor*max(0.0,dot(L,N))', '+interpolatedAmbientColor')));\n                            }\n                        }\n                        return a.e();\n                    };\n                    return Illumination;\n                }(Feature);\n                module.exports = Illumination;\n            },\n            {\n                '20': 20,\n                '28': 28,\n                '35': 35,\n                '36': 36,\n                '44': 44\n            }\n        ],\n        39: [\n            function (require, module, exports) {\n                'use strict';\n                var Base = function () {\n                    function Base(str) {\n                        babelHelpers.classCallCheck(this, Base);\n                        this._str = str;\n                    }\n                    Base.prototype.toString = function toString() {\n                        return this._str;\n                    };\n                    Base.prototype.valueOf = function valueOf() {\n                        return this._str;\n                    };\n                    return Base;\n                }();\n                var Constant = function (_Base) {\n                    babelHelpers.inherits(Constant, _Base);\n                    function Constant() {\n                        babelHelpers.classCallCheck(this, Constant);\n                        return babelHelpers.possibleConstructorReturn(this, _Base.apply(this, arguments));\n                    }\n                    return Constant;\n                }(Base);\n                var Variable = function (_Base2) {\n                    babelHelpers.inherits(Variable, _Base2);\n                    function Variable() {\n                        babelHelpers.classCallCheck(this, Variable);\n                        return babelHelpers.possibleConstructorReturn(this, _Base2.apply(this, arguments));\n                    }\n                    return Variable;\n                }(Base);\n                var Slider = function (_Variable) {\n                    babelHelpers.inherits(Slider, _Variable);\n                    function Slider() {\n                        babelHelpers.classCallCheck(this, Slider);\n                        return babelHelpers.possibleConstructorReturn(this, _Variable.apply(this, arguments));\n                    }\n                    return Slider;\n                }(Variable);\n                var MouseMove = function (_Variable2) {\n                    babelHelpers.inherits(MouseMove, _Variable2);\n                    function MouseMove(str) {\n                        babelHelpers.classCallCheck(this, MouseMove);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Variable2.call(this, str));\n                        _this4.axis = str.slice(-1);\n                        return _this4;\n                    }\n                    return MouseMove;\n                }(Variable);\n                var Gamepad = function (_Variable3) {\n                    babelHelpers.inherits(Gamepad, _Variable3);\n                    function Gamepad(str) {\n                        babelHelpers.classCallCheck(this, Gamepad);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Variable3.call(this, str));\n                        _this5.axis = Number(str.slice(-1));\n                        return _this5;\n                    }\n                    return Gamepad;\n                }(Variable);\n                function createFromString(str) {\n                    return new {\n                        'constant': Constant,\n                        'slider': Slider,\n                        'mousemovex': MouseMove,\n                        'mousemovey': MouseMove,\n                        'gamepad0': Gamepad,\n                        'gamepad1': Gamepad,\n                        'gamepad2': Gamepad,\n                        'gamepad3': Gamepad\n                    }[str](str);\n                }\n                exports.Base = Base;\n                exports.Constant = Constant;\n                exports.Variable = Variable;\n                exports.Slider = Slider;\n                exports.MouseMove = MouseMove;\n                exports.Gamepad = Gamepad;\n                exports.createFromString = createFromString;\n            },\n            {}\n        ],\n        40: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbers = require(12);\n                var Lines = require(20);\n                var NumericFeature = require(43);\n                var IntFeature = function (_NumericFeature) {\n                    babelHelpers.inherits(IntFeature, _NumericFeature);\n                    function IntFeature(name, value) {\n                        babelHelpers.classCallCheck(this, IntFeature);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _NumericFeature.call(this));\n                        _this.name = name;\n                        _this.value = value;\n                        return _this;\n                    }\n                    IntFeature.prototype.hasInputs = function hasInputs() {\n                        return _NumericFeature.prototype.hasInputs.call(this) || this.value.input != 'constant';\n                    };\n                    IntFeature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        _NumericFeature.prototype.requestFeatureContext.call(this, featureContext);\n                        if (this.value.input != 'constant') {\n                            featureContext.hasInputs = true;\n                        }\n                        if (this.value.input == 'slider') {\n                            featureContext.hasSliders = true;\n                        }\n                    };\n                    IntFeature.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlControlMessageLines.call(this, i18n));\n                        a(this.getHtmlControlMessageForValue(i18n, this.value, this.name));\n                        return a.e();\n                    };\n                    IntFeature.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlInputLines.call(this, i18n));\n                        a(this.getHtmlSliderLines(i18n, this.value, 'options.' + this.name, this.name, false));\n                        return a.e();\n                    };\n                    return IntFeature;\n                }(NumericFeature);\n                module.exports = IntFeature;\n            },\n            {\n                '12': 12,\n                '20': 20,\n                '43': 43\n            }\n        ],\n        41: [\n            function (require, module, exports) {\n                'use strict';\n                var capitalize = require(7);\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var Base = function () {\n                    function Base() {\n                        babelHelpers.classCallCheck(this, Base);\n                        this.entries = [];\n                    }\n                    Base.prototype.enter = function enter() {\n                        var entry = {\n                            pre: [],\n                            cond: null,\n                            log: [],\n                            post: []\n                        };\n                        this.entries.push(entry);\n                        function makePushArgs(where) {\n                            return function () {\n                                where.push.apply(where, arguments);\n                                return proxy;\n                            };\n                        }\n                        var proxy = {\n                            pre: makePushArgs(entry.pre),\n                            cond: function (cond) {\n                                entry.cond = cond;\n                                return proxy;\n                            },\n                            log: makePushArgs(entry.log),\n                            post: makePushArgs(entry.post)\n                        };\n                        return proxy;\n                    };\n                    Base.prototype.prependedStatements = function prependedStatements() {\n                        return [];\n                    };\n                    Base.prototype.bracketFnArg = function bracketFnArg() {\n                        return '';\n                    };\n                    Base.prototype.wrapCall = function wrapCall(lines) {\n                        return lines;\n                    };\n                    Base.prototype.write = function write(haveToUpdateCanvas, haveToLogInput) {\n                        var statementsGraph = {};\n                        var statementsRoot = [];\n                        var statementsPrev = null;\n                        var WHITE = 0;\n                        var GRAY = 1;\n                        var BLACK = 2;\n                        var addStatement = function (statement, cond) {\n                            var vertex = undefined;\n                            if (statement in statementsGraph) {\n                                vertex = statementsGraph[statement];\n                            } else {\n                                vertex = statementsGraph[statement] = {\n                                    prevs: [],\n                                    conds: [],\n                                    mark: WHITE\n                                };\n                            }\n                            if (vertex.conds !== null) {\n                                if (cond === null) {\n                                    vertex.conds = null;\n                                } else {\n                                    vertex.conds.push(cond);\n                                }\n                            }\n                            if (statementsPrev !== null) {\n                                vertex.prevs.push(statementsPrev);\n                            }\n                            statementsPrev = statement;\n                        };\n                        var closeEntryStatements = function () {\n                            if (statementsPrev !== null) {\n                                statementsRoot.push(statementsPrev);\n                            }\n                            statementsPrev = null;\n                        };\n                        var getStatements = function () {\n                            var statements = [];\n                            var currentCond = null;\n                            var writeStatement = function (statement, vertex) {\n                                var newCond = null;\n                                if (vertex.conds !== null) {\n                                    newCond = vertex.conds.join(' || ');\n                                }\n                                if (newCond != currentCond) {\n                                    if (currentCond !== null) {\n                                        statements.push('}');\n                                    }\n                                    currentCond = newCond;\n                                    if (currentCond !== null) {\n                                        statements.push('if (' + currentCond + ') {');\n                                    }\n                                }\n                                if (currentCond !== null) {\n                                    statements.push('\\t' + statement);\n                                } else {\n                                    statements.push(statement);\n                                }\n                            };\n                            var recVertex = function (statement, vertex) {\n                                vertex.mark = GRAY;\n                                recPrevs(vertex.prevs);\n                                vertex.mark = BLACK;\n                                writeStatement(statement, vertex);\n                            };\n                            var recPrevs = function (prevs) {\n                                prevs.forEach(function (statement) {\n                                    if (statementsGraph[statement].mark == WHITE) {\n                                        recVertex(statement, statementsGraph[statement]);\n                                    }\n                                });\n                            };\n                            recPrevs(statementsRoot);\n                            if (currentCond !== null) {\n                                statements.push('}');\n                            }\n                            return statements;\n                        };\n                        this.entries.forEach(function (entry) {\n                            entry.pre.forEach(function (statement) {\n                                addStatement(statement, null);\n                            });\n                            if (haveToLogInput) {\n                                entry.log.forEach(function (statement) {\n                                    addStatement(statement, entry.cond);\n                                });\n                            }\n                            entry.post.forEach(function (statement) {\n                                addStatement(statement, entry.cond);\n                            });\n                            if (haveToUpdateCanvas) {\n                                addStatement('scheduleFrame();', entry.cond);\n                            }\n                            closeEntryStatements();\n                        });\n                        var br = this.bracketListener();\n                        var statements = getStatements();\n                        if (statements.length > 0) {\n                            statements = [].concat(this.prependedStatements(), statements);\n                        }\n                        if (statements.length == 1) {\n                            var match = /^(\\w+)\\(\\);$/.exec(statements[0]);\n                            if (match) {\n                                return this.wrapCall(JsLines.bae(br[0] + match[1] + br[1]));\n                            }    // TODO what if no match?\n                        }\n                        if (statements.length > 0) {\n                            return this.wrapCall(WrapLines.b(JsLines.bae(br[0] + 'function(' + this.bracketFnArg() + '){'), JsLines.bae('}' + br[1])).ae(JsLines.bae.apply(JsLines, statements)));\n                        } else {\n                            return JsLines.be();\n                        }\n                    };\n                    return Base;\n                }();\n                var Slider = function (_Base) {\n                    babelHelpers.inherits(Slider, _Base);\n                    function Slider(id) {\n                        babelHelpers.classCallCheck(this, Slider);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Base.call(this));\n                        _this.id = id;\n                        return _this;\n                    }\n                    Slider.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'document.getElementById(\\'' + this.id + '\\').addEventListener(\\'change\\',',\n                            ');'\n                        ];\n                    };\n                    return Slider;\n                }(Base);\n                var MultipleSlider = function (_Base2) {\n                    babelHelpers.inherits(MultipleSlider, _Base2);\n                    function MultipleSlider(query) {\n                        babelHelpers.classCallCheck(this, MultipleSlider);\n                        var _this2 = babelHelpers.possibleConstructorReturn(this, _Base2.call(this));\n                        _this2.query = query;\n                        return _this2;\n                    }\n                    MultipleSlider.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'el.addEventListener(\\'change\\',',\n                            ');'\n                        ];\n                    };\n                    MultipleSlider.prototype.wrapCall = function wrapCall(lines) {\n                        return WrapLines.b(JsLines.bae(';[].forEach.call(document.querySelectorAll(\\'' + this.query + '\\'),function(el){'), JsLines.bae('});')).ae(lines);\n                    };\n                    return MultipleSlider;\n                }(Base);\n                var CanvasMousemove = function (_Base3) {\n                    babelHelpers.inherits(CanvasMousemove, _Base3);\n                    function CanvasMousemove() {\n                        babelHelpers.classCallCheck(this, CanvasMousemove);\n                        return babelHelpers.possibleConstructorReturn(this, _Base3.apply(this, arguments));\n                    }\n                    CanvasMousemove.prototype.enter = function enter() {\n                        var proxy = _Base3.prototype.enter.call(this);\n                        var floatHelper = function (minMaxFlag, varFlag, inputType, varName, minValue, maxValue) {\n                            var VarName = capitalize(varName);\n                            var dest = undefined;\n                            if (minValue == 0 && maxValue == 1) {\n                                dest = (varFlag ? 'var ' : '') + varName + '=';\n                            } else {\n                                proxy.pre('var min' + VarName + '=' + minValue + ';');\n                                proxy.pre('var max' + VarName + '=' + maxValue + ';');\n                                dest = (varFlag ? 'var ' : '') + varName + '=min' + VarName + '+(max' + VarName + '-min' + VarName + ')*';\n                            }\n                            return proxy.prexy(inputType, dest + '(ev.clientX-rect.left)/(rect.width-1);', dest + '(rect.bottom-1-ev.clientY)/(rect.height-1);');\n                        };\n                        proxy.prexy = function (inputType, xStatement, yStatement) {\n                            if (inputType.axis == 'x') {\n                                return proxy.pre(xStatement);\n                            } else if (inputType.axis == 'y') {\n                                return proxy.pre(yStatement);\n                            }\n                            return proxy;\n                        };\n                        proxy.minMaxFloat = function (inputType, varName, minValue, maxValue) {\n                            return floatHelper(true, false, inputType, varName, minValue, maxValue);\n                        };\n                        proxy.minMaxVarFloat = function (inputType, varName, minValue, maxValue) {\n                            return floatHelper(true, true, inputType, varName, minValue, maxValue);\n                        };\n                        proxy.newVarInt = function (inputType, varName) {\n                            var VarName = capitalize(varName);\n                            return proxy.prexy(inputType, 'var new' + VarName + '=Math.floor(min' + VarName + '+(max' + VarName + '-min' + VarName + '+1)*(ev.clientX-rect.left)/rect.width);', 'var new' + VarName + '=Math.floor(min' + VarName + '+(max' + VarName + '-min' + VarName + '+1)*(rect.bottom-1-ev.clientY)/rect.height);');\n                        };\n                        return proxy;\n                    };\n                    CanvasMousemove.prototype.bracketListener = function bracketListener() {\n                        return [\n                            'canvas.addEventListener(\\'mousemove\\',',\n                            ');'\n                        ];\n                    };\n                    CanvasMousemove.prototype.bracketFnArg = function bracketFnArg() {\n                        return 'ev';\n                    };\n                    CanvasMousemove.prototype.prependedStatements = function prependedStatements() {\n                        return ['var rect=this.getBoundingClientRect();'];\n                    };\n                    return CanvasMousemove;\n                }(Base);\n                exports.Slider = Slider;\n                exports.MultipleSlider = MultipleSlider;\n                exports.CanvasMousemove = CanvasMousemove;\n            },\n            {\n                '19': 19,\n                '28': 28,\n                '7': 7\n            }\n        ],\n        42: [\n            function (require, module, exports) {\n                'use strict';\n                var idCounter = 0;\n                function generateId() {\n                    return 'webgl-starter-id-' + idCounter++;\n                }\n                var i18ns = require(37);\n                var Options = require(46);\n                var Code = require(32);\n                var OptionsOutput = require(45);\n                var CodeOutput = require(3);\n                $(function () {\n                    $('.webgl-starter').each(function () {\n                        var $container = $(this);\n                        var lang = $container.closest('[lang]').attr('lang');\n                        var i18n = i18ns(lang);\n                        var options = new Options();\n                        var codeOutput = new CodeOutput(function () {\n                            return new Code(options.fix(), i18n);\n                        }, i18n);\n                        options.addUpdateCallback(codeOutput.update);\n                        var optionsOutput = new OptionsOutput(options, generateId, i18n);\n                        $container.empty().append(optionsOutput.$output, codeOutput.$output);\n                    });\n                });\n            },\n            {\n                '3': 3,\n                '32': 32,\n                '37': 37,\n                '45': 45,\n                '46': 46\n            }\n        ],\n        43: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<abbr title=',\n                        '>'\n                    ], [\n                        '<abbr title=',\n                        '>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<label for=',\n                        '>'\n                    ], [\n                        '\\t<label for=',\n                        '>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' step=',\n                        '>'\n                    ], [\n                        '\\t<input type=range id=',\n                        ' min=',\n                        ' max=',\n                        ' value=',\n                        ' step=',\n                        '>'\n                    ]);\n                var formatNumbers = require(12);\n                var Input = require(39);\n                var Lines = require(20);\n                var Feature = require(35);\n                var NumericFeature = function (_Feature) {\n                    babelHelpers.inherits(NumericFeature, _Feature);\n                    function NumericFeature() {\n                        babelHelpers.classCallCheck(this, NumericFeature);\n                        return babelHelpers.possibleConstructorReturn(this, _Feature.apply(this, arguments));\n                    }\n                    // private:\n                    NumericFeature.prototype.getHtmlControlMessageForValue = function getHtmlControlMessageForValue(i18n, value, name) {\n                        if (value.input instanceof Input.MouseMove) {\n                            return Lines.bae('<li>' + i18n('controls.type.' + value.input) + ' ' + i18n('controls.to') + ' <strong>' + i18n('options.' + name) + '</strong></li>');\n                        } else {\n                            return Lines.be();\n                        }\n                    };\n                    NumericFeature.prototype.getHtmlSliderLines = function getHtmlSliderLines(i18n, value, opName, htmlName, step) {\n                        var a = Lines.b();\n                        if (value.input == 'slider') {\n                            var fmtAttrs = formatNumbers.html({\n                                min: value.min,\n                                max: value.max,\n                                value: value.value\n                            }, value.precision);\n                            var fmtLabels = formatNumbers({\n                                min: value.min,\n                                max: value.max\n                            }, value.precision);\n                            var minMax = function (n) {\n                                return i18n.numberWithUnits(n, value.unit, function (a, e) {\n                                    return Lines.html(_templateObject, e) + a + '</abbr>';\n                                });\n                            };\n                            a('<div>', Lines.html(_templateObject2, htmlName) + i18n(opName) + '</label>', '\\t<span class=min>' + minMax(fmtLabels.min) + '</span>', Lines.html(_templateObject3, htmlName, fmtAttrs.min, fmtAttrs.max, fmtAttrs.value, step), '\\t<span class=max>' + minMax(fmtLabels.max) + '</span>', '</div>');\n                        }\n                        return a.e();\n                    };\n                    return NumericFeature;\n                }(Feature);\n                module.exports = NumericFeature;\n            },\n            {\n                '12': 12,\n                '20': 20,\n                '35': 35,\n                '39': 39\n            }\n        ],\n        44: [\n            function (require, module, exports) {\n                'use strict';\n                var Input = require(39);\n                var Option = Object.create(require(22));\n                var FixedLiveNumber = function () {\n                    function FixedLiveNumber(src, setToDefault) {\n                        babelHelpers.classCallCheck(this, FixedLiveNumber);\n                        if (!setToDefault) {\n                            this.value = src.value;\n                            this.min = src.min;\n                            this.max = src.max;\n                            this.input = Input.createFromString(src.input);\n                        } else {\n                            this.value = src.defaultValue;\n                            this.min = src.availableMin;\n                            this.max = src.availableMax;\n                            this.input = Input.createFromString('constant');\n                        }\n                        this.precision = src.precision;\n                        this.unit = src.unit;\n                    }\n                    FixedLiveNumber.prototype.valueOf = function valueOf() {\n                        return this.value;\n                    };\n                    FixedLiveNumber.prototype.toString = function toString() {\n                        return String(this.value);\n                    };\n                    return FixedLiveNumber;\n                }();\n                // abstract classes\n                Option.LiveNumber = function (_Option$Number) {\n                    babelHelpers.inherits(_class, _Option$Number);\n                    function _class(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class);\n                        var dataValue = undefined, dataMin = undefined, dataMax = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataMin = data.min;\n                            dataMax = data.max;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                        _this._min = dataMin !== undefined ? dataMin : _this.availableMin;\n                        _this._max = dataMax !== undefined ? dataMax : _this.availableMax;\n                        _this._input = dataInput !== undefined ? dataInput : 'constant';\n                        _this._$range = null;\n                        return _this;\n                    }\n                    _class.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        if (this._$range)\n                            this._$range.toggle(this._input != 'constant');\n                    };\n                    _class.prototype.exportHelper = function exportHelper(src) {\n                        var data = {};\n                        if (src.value != src.defaultValue)\n                            data.value = src.value;\n                        if (src.min != src.availableMin)\n                            data.min = src.min;\n                        if (src.max != src.availableMax)\n                            data.max = src.max;\n                        if (src.input != 'constant')\n                            data.input = src.input;\n                        return data;\n                    };\n                    _class.prototype.export = function _export() {\n                        return this.exportHelper(this);\n                    };\n                    _class.prototype.fix = function fix() {\n                        var fixed = new FixedLiveNumber(this);\n                        fixed.name = this.name;\n                        return fixed;\n                    };\n                    babelHelpers.createClass(_class, [\n                        {\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateInternalVisibility();\n                                this.update();\n                            }\n                        },\n                        {\n                            key: 'min',\n                            get: function () {\n                                return this._min;\n                            },\n                            set: function (min) {\n                                this._min = min;\n                                this.update();\n                            }\n                        },\n                        {\n                            key: 'max',\n                            get: function () {\n                                return this._max;\n                            },\n                            set: function (max) {\n                                this._max = max;\n                                this.update();\n                            }\n                        },\n                        {\n                            key: '$range',\n                            get: function () {\n                                return this._$range;\n                            },\n                            set: function ($range) {\n                                this._$range = $range;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class;\n                }(Option.Number);\n                // concrete classes\n                Option.LiveInt = function (_Option$LiveNumber) {\n                    babelHelpers.inherits(_class2, _Option$LiveNumber);\n                    function _class2() {\n                        babelHelpers.classCallCheck(this, _class2);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class2, [\n                        {\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        },\n                        {\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider',\n                                    'mousemovex',\n                                    'mousemovey'\n                                ];\n                            }\n                        }\n                    ]);\n                    return _class2;\n                }(Option.LiveNumber);\n                Option.CanvasLiveInt = function (_Option$LiveInt) {\n                    babelHelpers.inherits(_class3, _Option$LiveInt);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveInt.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class3, [{\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider'\n                                ];\n                            }\n                        }]);\n                    return _class3;\n                }(Option.LiveInt);\n                Option.LiveFloat = function (_Option$LiveNumber2) {\n                    babelHelpers.inherits(_class4, _Option$LiveNumber2);\n                    _class4.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.speed === undefined)\n                            settings.speed = {};\n                        if (settings.speed.availableMin === undefined)\n                            settings.speed.availableMin = arrayArg[2];\n                        if (settings.speed.availableMax === undefined)\n                            settings.speed.availableMax = arrayArg[3];\n                        return _Option$LiveNumber2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class4(name, settings, data, parent, visibilityManager, makeEntry) {\n                        babelHelpers.classCallCheck(this, _class4);\n                        var dataSpeedValue = undefined, dataSpeedMin = undefined, dataSpeedMax = undefined, dataSpeedInput = undefined;\n                        if (typeof data == 'object') {\n                            if (typeof data.speed == 'object') {\n                                dataSpeedValue = data.speed.value;\n                                dataSpeedMin = data.speed.min;\n                                dataSpeedMax = data.speed.max;\n                                dataSpeedInput = data.speed.input;\n                            } else {\n                                dataSpeedValue = data.speed;\n                            }\n                        }\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber2.apply(this, arguments));\n                        _this4._speedAvailableMin = settings.speed.availableMin;\n                        _this4._speedAvailableMax = settings.speed.availableMax;\n                        if (settings.precision !== undefined) {\n                            _this4.precision = settings.precision;\n                        } else {\n                            if (_this4.availableMax >= 100) {\n                                _this4.precision = 1;\n                            } else if (_this4.availableMax >= 10) {\n                                _this4.precision = 2;\n                            } else {\n                                _this4.precision = 3;\n                            }\n                        }\n                        _this4._speedValue = dataSpeedValue !== undefined ? dataSpeedValue : 0;\n                        _this4._speedMin = dataSpeedMin !== undefined ? dataSpeedMin : _this4._speedAvailableMin;\n                        _this4._speedMax = dataSpeedMax !== undefined ? dataSpeedMax : _this4._speedAvailableMax;\n                        _this4._speedInput = dataSpeedInput !== undefined ? dataSpeedInput : 'constant';\n                        _this4._addSpeed = !(_this4._speedValue == 0 && _this4._speedMin == _this4._speedAvailableMin && _this4._speedMax == _this4._speedAvailableMax && _this4._speedInput == 'constant');\n                        _this4._speed$ = null;\n                        _this4._speed$range = null;\n                        _this4._$addSpeed = null;\n                        return _this4;\n                    }\n                    _class4.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        _Option$LiveNumber2.prototype.updateInternalVisibility.call(this);\n                        if (this._speed$range)\n                            this._speed$range.toggle(this._speedInput != 'constant');\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this._input) < 0;\n                        if (this._speed$)\n                            this._speed$.toggle(this._addSpeed && notGamepad);\n                        if (this._$addSpeed)\n                            this._$addSpeed.toggle(notGamepad);\n                    };\n                    _class4.prototype.export = function _export() {\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this.input) < 0;\n                        var data = this.exportHelper(this);\n                        if (notGamepad && this.addSpeed) {\n                            this.shortenExportAssign(this.exportHelper(this.speed), data, 'speed');\n                        }\n                        return data;\n                    };\n                    _class4.prototype.fix = function fix() {\n                        var fixed = _Option$LiveNumber2.prototype.fix.call(this);\n                        var notGamepad = [\n                            'gamepad0',\n                            'gamepad1',\n                            'gamepad2',\n                            'gamepad3'\n                        ].indexOf(this.input) < 0;\n                        if (notGamepad && this.addSpeed) {\n                            fixed.speed = new FixedLiveNumber(this.speed);\n                        } else {\n                            fixed.speed = new FixedLiveNumber(this.speed, true);\n                        }\n                        return fixed;\n                    };\n                    babelHelpers.createClass(_class4, [\n                        {\n                            key: 'addSpeed',\n                            get: function () {\n                                return this._addSpeed;\n                            },\n                            set: function (addSpeed) {\n                                this._addSpeed = addSpeed;\n                                this.updateInternalVisibility();\n                                this.update();\n                            }\n                        },\n                        {\n                            key: 'availableInputTypes',\n                            get: function () {\n                                return [\n                                    'constant',\n                                    'slider',\n                                    'mousemovex',\n                                    'mousemovey',\n                                    'gamepad0',\n                                    'gamepad1',\n                                    'gamepad2',\n                                    'gamepad3'\n                                ];\n                            }\n                        },\n                        {\n                            key: 'speed',\n                            get: function () {\n                                var option = this;\n                                return {\n                                    get fullName() {\n                                        return option.fullName + '.speed';\n                                    },\n                                    get defaultValue() {\n                                        return 0;\n                                    },\n                                    get value() {\n                                        return option._speedValue;\n                                    },\n                                    set value(value) {\n                                        option._speedValue = value;\n                                        option.update();\n                                    },\n                                    get input() {\n                                        return option._speedInput;\n                                    },\n                                    set input(input) {\n                                        option._speedInput = input;\n                                        option.updateInternalVisibility();\n                                        option.update();\n                                    },\n                                    get availableMin() {\n                                        return option._speedAvailableMin;\n                                    },\n                                    get availableMax() {\n                                        return option._speedAvailableMax;\n                                    },\n                                    get min() {\n                                        return option._speedMin;\n                                    },\n                                    set min(min) {\n                                        option._speedMin = min;\n                                        option.update();\n                                    },\n                                    get max() {\n                                        return option._speedMax;\n                                    },\n                                    set max(max) {\n                                        option._speedMax = max;\n                                        option.update();\n                                    },\n                                    get precision() {\n                                        return option.precision;\n                                    },\n                                    get unit() {\n                                        if (option.unit !== undefined) {\n                                            return option.unit + '/second';\n                                        } else {\n                                            return '1/second';\n                                        }\n                                    },\n                                    get availableInputTypes() {\n                                        return option.availableInputTypes;\n                                    },\n                                    get $() {\n                                        return option._speed$;\n                                    },\n                                    set $($) {\n                                        option._speed$ = $;\n                                        option.updateInternalVisibility();\n                                    },\n                                    get $range() {\n                                        return option._speed$range;\n                                    },\n                                    set $range($range) {\n                                        option._speed$range = $range;\n                                        option.updateInternalVisibility();\n                                    }\n                                };\n                            }\n                        },\n                        {\n                            key: '$addSpeed',\n                            get: function () {\n                                return this._$addSpeed;\n                            },\n                            set: function ($addSpeed) {\n                                this._$addSpeed = $addSpeed;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class4;\n                }(Option.LiveNumber);\n                Option.LiveColor = function (_Option$Group) {\n                    babelHelpers.inherits(_class5, _Option$Group);\n                    function _class5() {\n                        babelHelpers.classCallCheck(this, _class5);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Group.apply(this, arguments));\n                    }\n                    _class5.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.componentDefaultValues === undefined)\n                            settings.componentDefaultValues = arrayArg;\n                        var cs = 'rgba';\n                        settings.descriptions = settings.componentDefaultValues.map(function (defaultValue, i) {\n                            var c = cs.charAt(i);\n                            return [\n                                'LiveFloat',\n                                c,\n                                [\n                                    0,\n                                    1,\n                                    -1,\n                                    +1\n                                ],\n                                defaultValue\n                            ];\n                        });\n                        return _Option$Group.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    return _class5;\n                }(Option.Group);\n                module.exports = Option;\n            },\n            {\n                '22': 22,\n                '39': 39\n            }\n        ],\n        45: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(44);\n                var BaseOptionsOutput = require(24);\n                var OptionsOutput = function (_BaseOptionsOutput) {\n                    babelHelpers.inherits(OptionsOutput, _BaseOptionsOutput);\n                    function OptionsOutput() {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptionsOutput.apply(this, arguments));\n                    }\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        _BaseOptionsOutput.prototype.setOptionClassWriters.call(this, optionClassWriters);\n                        var baseSelectWriter = optionClassWriters.get(Option.Select);\n                        optionClassWriters.set(Option.LiveNumber, function (option, writeOption, i18n, generateId) {\n                            var writeSubOption = function (option) {\n                                var p = option.precision;\n                                var setInputAttrs = function ($input) {\n                                    return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                                };\n                                var writeMinMaxInput = function (minOrMax) {\n                                    return setInputAttrs($('<input type=\\'number\\' required>')).val(option[minOrMax]).on('input change', function () {\n                                        if (this.checkValidity()) {\n                                            option[minOrMax] = parseFloat(this.value);\n                                        }\n                                    });\n                                };\n                                var id = generateId();\n                                var $inputSelect = undefined, $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                                var $output = optionClassWriters.get(Option.Number)(option, writeOption, i18n, generateId);\n                                $output.find('button').before($('<label class=\\'nowrap\\'>').append(i18n('options-output.inputs') + ': ', $inputSelect = $('<select>').append(option.availableInputTypes.map(function (availableInputType) {\n                                    return $('<option>').val(availableInputType).html(i18n('options-output.inputs.' + availableInputType));\n                                })).val(option.input).change(function () {\n                                    option.input = this.value;\n                                })), ' ', option.$range = $('<span class=\\'range\\'>').append(i18n('options-output.range') + ' ', $('<span class=\\'nowrap\\'>').append($rangeMinInput = writeMinMaxInput('min'), ' .. ', $rangeMaxInput = writeMinMaxInput('max'))), ' ').click(function () {\n                                    $inputSelect.val('constant').change();\n                                    $rangeMinInput.val(option.availableMin).change();\n                                    $rangeMaxInput.val(option.availableMax).change();\n                                });\n                                return $output;\n                            };\n                            if (option instanceof Option.LiveFloat) {\n                                return option.$ = $('<div>').append(writeSubOption(option).append(' ', option.$addSpeed = $('<label class=\\'nowrap\\'>').append($('<input type=\\'checkbox\\'>').prop('checked', option.addSpeed).change(function () {\n                                    option.addSpeed = this.checked;\n                                }), ' ' + i18n('options-output.addSpeed'))), option.speed.$ = writeSubOption(option.speed));\n                            } else {\n                                return option.$ = writeSubOption(option);\n                            }\n                        });\n                    };\n                    return OptionsOutput;\n                }(BaseOptionsOutput);\n                module.exports = OptionsOutput;\n            },\n            {\n                '24': 24,\n                '44': 44\n            }\n        ],\n        46: [\n            function (require, module, exports) {\n                'use strict';\n                var BaseOptions = require(25);\n                var Options = function (_BaseOptions) {\n                    babelHelpers.inherits(Options, _BaseOptions);\n                    function Options() {\n                        babelHelpers.classCallCheck(this, Options);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptions.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(44);\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [\n                                    [\n                                        'Group',\n                                        'canvas',\n                                        [\n                                            [\n                                                'CanvasLiveInt',\n                                                'width',\n                                                [\n                                                    1,\n                                                    1024\n                                                ],\n                                                512,\n                                                { unit: 'pixel' }\n                                            ],\n                                            [\n                                                'CanvasLiveInt',\n                                                'height',\n                                                [\n                                                    1,\n                                                    1024\n                                                ],\n                                                512,\n                                                { unit: 'pixel' }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'background',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'none',\n                                                    'solid'\n                                                ]\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'color',\n                                                [\n                                                    1,\n                                                    1,\n                                                    1,\n                                                    1\n                                                ],\n                                                { visibilityData: { 'background.type': 'solid' } }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'material',\n                                        [\n                                            [\n                                                'Select',\n                                                'scope',\n                                                [\n                                                    'global',\n                                                    'vertex',\n                                                    'face'\n                                                ]\n                                            ],\n                                            // partly related to shape\n                                            [\n                                                'Select',\n                                                'data',\n                                                [\n                                                    'one',\n                                                    'sda'\n                                                ]\n                                            ],\n                                            // partly related to shape\n                                            [\n                                                'LiveColor',\n                                                'color',\n                                                [\n                                                    1,\n                                                    0,\n                                                    0,\n                                                    1\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'one'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'specularColor',\n                                                [\n                                                    0.4,\n                                                    0.4,\n                                                    0.4\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'diffuseColor',\n                                                [\n                                                    0.4,\n                                                    0.4,\n                                                    0.4\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ],\n                                            [\n                                                'LiveColor',\n                                                'ambientColor',\n                                                [\n                                                    0.2,\n                                                    0.2,\n                                                    0.2\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'material.scope': 'global',\n                                                        'material.data': 'sda'\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'light',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'off',\n                                                    'phong',\n                                                    'blinn'\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'direction',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'x',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        -1\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'y',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        +1\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'z',\n                                                        [\n                                                            -4,\n                                                            +4,\n                                                            -4,\n                                                            +4\n                                                        ],\n                                                        +1\n                                                    ]\n                                                ],\n                                                {\n                                                    visibilityData: {\n                                                        'light.type': [\n                                                            'phong',\n                                                            'blinn'\n                                                        ]\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'shape',\n                                        [\n                                            [\n                                                'Select',\n                                                'type',\n                                                [\n                                                    'square',\n                                                    'triangle',\n                                                    'gasket',\n                                                    'cube',\n                                                    'hat',\n                                                    'terrain'\n                                                ]\n                                            ],\n                                            [\n                                                'Select',\n                                                'elements',\n                                                [\n                                                    '0',\n                                                    '8',\n                                                    '16',\n                                                    '32'\n                                                ]\n                                            ],\n                                            [\n                                                'LiveInt',\n                                                'lod',\n                                                [\n                                                    0,\n                                                    10\n                                                ],\n                                                6,\n                                                {\n                                                    visibilityData: {\n                                                        'shape.type': [\n                                                            'gasket',\n                                                            'hat',\n                                                            'terrain'\n                                                        ]\n                                                    }\n                                                }\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'transforms',\n                                        [\n                                            [\n                                                'Select',\n                                                'projection',\n                                                [\n                                                    'ortho',\n                                                    'perspective'\n                                                ]\n                                            ],\n                                            [\n                                                'Array',\n                                                'model',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.x',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0,\n                                                        { unit: '\\xB0' }\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.y',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0,\n                                                        { unit: '\\xB0' }\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'rotate.z',\n                                                        [\n                                                            -180,\n                                                            +180,\n                                                            -360,\n                                                            +360\n                                                        ],\n                                                        0,\n                                                        { unit: '\\xB0' }\n                                                    ]\n                                                ]\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'debug',\n                                        [\n                                            [\n                                                'Checkbox',\n                                                'shaders',\n                                                true\n                                            ],\n                                            [\n                                                'Checkbox',\n                                                'arrays'\n                                            ],\n                                            [\n                                                'Checkbox',\n                                                'inputs'\n                                            ],\n                                            // TODO hide if no inputs?\n                                            [\n                                                'Checkbox',\n                                                'animations'\n                                            ]\n                                        ]\n                                    ]\n                                ];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }(BaseOptions);\n                module.exports = Options;\n            },\n            {\n                '25': 25,\n                '44': 44\n            }\n        ],\n        47: [\n            function (require, module, exports) {\n                'use strict';\n                exports.square = require(54);\n                exports.triangle = require(56);\n                exports.gasket = require(49);\n                exports.cube = require(48);\n                exports.hat = require(50);\n                exports.terrain = require(55);\n            },\n            {\n                '48': 48,\n                '49': 49,\n                '50': 50,\n                '54': 54,\n                '55': 55,\n                '56': 56\n            }\n        ],\n        48: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var Colorgen = require(33);\n                var Shape = require(53);\n                var Cube = function (_Shape) {\n                    babelHelpers.inherits(Cube, _Shape);\n                    function Cube() {\n                        babelHelpers.classCallCheck(this, Cube);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Cube.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0, // TODO remove 'clean' colors after bilinear interp is implemented\n                        this.hasColorsPerFace ? undefined : [\n                            [\n                                0,\n                                0,\n                                0\n                            ],\n                            [\n                                1,\n                                0,\n                                0\n                            ],\n                            [\n                                0,\n                                1,\n                                0\n                            ],\n                            [\n                                1,\n                                1,\n                                0\n                            ],\n                            [\n                                0,\n                                0,\n                                1\n                            ],\n                            [\n                                1,\n                                0,\n                                1\n                            ],\n                            [\n                                0,\n                                1,\n                                1\n                            ],\n                            [\n                                1,\n                                1,\n                                1\n                            ]\n                        ]);\n                        var nCubeVertices = 8;\n                        var cubeColors = [];\n                        for (var i = 0; i < nCubeVertices; i++) {\n                            cubeColors.push(colorgen.getNextColorString());\n                        }\n                        var cubeVertexPositions = [\n                            '-0.5,-0.5,-0.5,',\n                            '+0.5,-0.5,-0.5,',\n                            '-0.5,+0.5,-0.5,',\n                            '+0.5,+0.5,-0.5,',\n                            '-0.5,-0.5,+0.5,',\n                            '+0.5,-0.5,+0.5,',\n                            '-0.5,+0.5,+0.5,',\n                            '+0.5,+0.5,+0.5,'\n                        ];\n                        var nCubeFaces = 6;\n                        var cubeFaceNames = [\n                            'left',\n                            'right',\n                            'bottom',\n                            'top',\n                            'back',\n                            'front'\n                        ];\n                        var cubeFaceNormals = [\n                            '-1.0, 0.0, 0.0,',\n                            '+1.0, 0.0, 0.0,',\n                            ' 0.0,-1.0, 0.0,',\n                            ' 0.0,+1.0, 0.0,',\n                            ' 0.0, 0.0,-1.0,',\n                            ' 0.0, 0.0,+1.0,'\n                        ];\n                        var cubeFaceVertices = [\n                            [\n                                4,\n                                6,\n                                0,\n                                2\n                            ],\n                            [\n                                1,\n                                3,\n                                5,\n                                7\n                            ],\n                            [\n                                0,\n                                1,\n                                4,\n                                5\n                            ],\n                            [\n                                2,\n                                6,\n                                3,\n                                7\n                            ],\n                            [\n                                0,\n                                2,\n                                1,\n                                3\n                            ],\n                            [\n                                5,\n                                7,\n                                4,\n                                6\n                            ]\n                        ];\n                        var quadToTriangleMap = [\n                            0,\n                            1,\n                            2,\n                            2,\n                            1,\n                            3\n                        ];\n                        var vertexCtor = JsLines.b();\n                        vertexCtor('// x    y    z');\n                        if (this.hasNormals) {\n                            vertexCtor.t('  n.x  n.y  n.z');\n                        }\n                        vertexCtor.t(colorgen.getHeaderString());\n                        var appendVertex = function (iFace, iVertex, firstInFace) {\n                            vertexCtor(cubeVertexPositions[iVertex]);\n                            if (_this2.hasNormals) {\n                                vertexCtor.t(cubeFaceNormals[iFace]);\n                            }\n                            if (_this2.hasColorsPerVertex) {\n                                vertexCtor.t(cubeColors[iVertex]);\n                            } else if (_this2.hasColorsPerFace) {\n                                vertexCtor.t(cubeColors[iFace]);\n                            }\n                            if (firstInFace) {\n                                vertexCtor.t(' // ' + cubeFaceNames[iFace] + ' face');\n                            }\n                        };\n                        var wrapVertices = function () {\n                            return WrapLines.b(JsLines.bae('var vertices=new Float32Array(['), JsLines.bae(']);')).ae(vertexCtor.e());\n                        };\n                        if (!this.usesElements()) {\n                            var _loop = function (_i) {\n                                quadToTriangleMap.forEach(function (j, k) {\n                                    appendVertex(_i, cubeFaceVertices[_i][j], k == 0);\n                                });\n                            };\n                            for (var _i = 0; _i < nCubeFaces; _i++) {\n                                _loop(_i);\n                            }\n                            return JsLines.bae('var nVertices=36;', wrapVertices());\n                        } else if (this.hasColorsPerFace || this.hasNormals) {\n                            var _loop2 = function (_i2) {\n                                cubeFaceVertices[_i2].forEach(function (j, k) {\n                                    appendVertex(_i2, j, k == 0);\n                                });\n                            };\n                            // elements, face data\n                            for (var _i2 = 0; _i2 < nCubeFaces; _i2++) {\n                                _loop2(_i2);\n                            }\n                            return JsLines.bae(wrapVertices(), 'var nElements=36;', 'var elements=new ' + this.getElementIndexJsArray() + '([', '\\t 0,  1,  2,  2,  1,  3, // left face', '\\t 4,  5,  6,  6,  5,  7, // right face', '\\t 8,  9, 10, 10,  9, 11, // bottom face', '\\t12, 13, 14, 14, 13, 15, // top face', '\\t16, 17, 18, 18, 17, 19, // back face', '\\t20, 21, 22, 22, 21, 23, // front face', ']);');\n                        } else {\n                            var _ret3 = function () {\n                                // elements, no face data\n                                for (var _i3 = 0; _i3 < nCubeVertices; _i3++) {\n                                    vertexCtor(cubeVertexPositions[_i3]);\n                                    if (_this2.hasColorsPerVertex) {\n                                        vertexCtor.t(cubeColors[_i3]);\n                                    }\n                                }\n                                var elementCtor = JsLines.b();\n                                var _loop3 = function (_i4) {\n                                    elementCtor('');\n                                    quadToTriangleMap.forEach(function (j) {\n                                        elementCtor.t(cubeFaceVertices[_i4][j] + ', ');\n                                    });\n                                    elementCtor.t('// ' + cubeFaceNames[_i4] + ' face');\n                                };\n                                for (var _i4 = 0; _i4 < nCubeFaces; _i4++) {\n                                    _loop3(_i4);\n                                }\n                                var wrapElements = function () {\n                                    return WrapLines.b(JsLines.bae('var elements=new ' + _this2.getElementIndexJsArray() + '(['), JsLines.bae(']);')).ae(elementCtor.e());\n                                };\n                                return { v: new Lines(wrapVertices(), 'var nElements=36;', wrapElements()) };\n                            }();\n                            if (typeof _ret3 === 'object')\n                                return _ret3.v;\n                        }\n                    };\n                    babelHelpers.createClass(Cube, [\n                        {\n                            key: 'dim',\n                            get: function () {\n                                return 3;\n                            }\n                        },\n                        {\n                            key: 'twoSided',\n                            get: function () {\n                                return false;\n                            }\n                        }\n                    ]);\n                    return Cube;\n                }(Shape);\n                module.exports = Cube;\n            },\n            {\n                '19': 19,\n                '28': 28,\n                '33': 33,\n                '53': 53\n            }\n        ],\n        49: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var LodShape = require(51);\n                var Gasket = function (_LodShape) {\n                    babelHelpers.inherits(Gasket, _LodShape);\n                    function Gasket() {\n                        babelHelpers.classCallCheck(this, Gasket);\n                        return babelHelpers.possibleConstructorReturn(this, _LodShape.apply(this, arguments));\n                    }\n                    Gasket.prototype.getDistinctVertexCount = function getDistinctVertexCount(lodSymbol) {\n                        return '(Math.pow(3,' + lodSymbol + '+1)+3)/2';\n                    };\n                    Gasket.prototype.getFaceVertexCount = function getFaceVertexCount(lodSymbol) {\n                        return 'Math.pow(3,' + lodSymbol + ')*3';\n                    };\n                    Gasket.prototype.getTotalVertexCount = function getTotalVertexCount(lodSymbol) {\n                        return 'Math.pow(3,' + lodSymbol + ')*3';\n                    };\n                    Gasket.prototype.writeStoreShape = function writeStoreShape() {\n                        var _this2 = this;\n                        var writePushVertex = function () {\n                            var a = JsLines.b();\n                            a('vertices[nextIndexIntoVertices++]=p[0];', 'vertices[nextIndexIntoVertices++]=p[1];');\n                            if (_this2.hasColorsPerVertex || _this2.hasColorsPerFace) {\n                                if (!_this2.usesElements() || _this2.hasColorsPerFace) {\n                                    a('colors[nextIndexIntoColors]');\n                                } else {\n                                    a('colors[nextElement%colors.length]');\n                                }\n                                a.t('.forEach(function(cc){', '\\tvertices[nextIndexIntoVertices++]=cc;', '});');\n                            }\n                            if (_this2.usesElements()) {\n                                a('return nextElement++;');\n                            } else if (_this2.hasColorsPerVertex) {\n                                a('nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                            }\n                            return a.e();\n                        };\n                        var writeTriangle = function () {\n                            var a = JsLines.b();\n                            a('if (depth<=0) {');\n                            if (!_this2.usesElements()) {\n                                if (_this2.hasColorsPerFace) {\n                                    a('\\tpushVertex(p0);', '\\tpushVertex(p1);', '\\tpushVertex(p2);', '\\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                                } else {\n                                    a('\\tpushVertex(p0);', '\\tpushVertex(p1);', '\\tpushVertex(p2);');\n                                }\n                            } else {\n                                if (_this2.hasColorsPerFace) {\n                                    a('\\tpushElement(pushVertex(p0));', '\\tpushElement(pushVertex(p1));', '\\tpushElement(pushVertex(p2));', '\\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;');\n                                } else {\n                                    a('\\tif (es[0]===null) es[0]=pushVertex(p0);', '\\tif (es[1]===null) es[1]=pushVertex(p1);', '\\tif (es[2]===null) es[2]=pushVertex(p2);', '\\tpushElement(es[0]);', '\\tpushElement(es[1]);', '\\tpushElement(es[2]);', '\\treturn es;');\n                                }\n                            }\n                            a('} else {', '\\tvar p01=mix(p0,p1);', '\\tvar p12=mix(p1,p2);', '\\tvar p20=mix(p2,p0);');\n                            if (!_this2.usesElements()) {\n                                a('\\ttriangle(depth-1,p0,p01,p20);', '\\ttriangle(depth-1,p1,p12,p01);', '\\ttriangle(depth-1,p2,p20,p12);');\n                            } else if (_this2.hasColorsPerFace) {\n                                a('\\tvar es0=triangle(depth-1,p0,p01,p20);', '\\tvar es1=triangle(depth-1,p1,p12,p01);', '\\tvar es2=triangle(depth-1,p2,p20,p12);');\n                            } else {\n                                a('\\tvar es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);', '\\tvar es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);', '\\tvar es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);', '\\treturn [es0[0],es1[0],es2[0]];');\n                            }\n                            a('}');\n                            return a.e();\n                        };\n                        var writeInitialTriangleCall = function () {\n                            var a = JsLines.b();\n                            a('shapeLod,', '[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],', '[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],', '[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]');\n                            if (_this2.usesElements() && !_this2.hasColorsPerFace) {\n                                a.t(',', '[null,null,null]');\n                            }\n                            return a.e();\n                        };\n                        var a = JsLines.b();\n                        a('var nextIndexIntoVertices=0;');\n                        if (this.usesElements()) {\n                            a('var nextIndexIntoElements=0;');\n                            a('var nextElement=0;');\n                        }\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            a('// p = position, cc = color component, e = element, es = elements');\n                            a(this.writeColorData());\n                            if (!this.usesElements() || this.hasColorsPerFace) {\n                                a('var nextIndexIntoColors=0;');\n                            }\n                        } else {\n                            a('// p = position, e = element, es = elements');\n                        }\n                        a(WrapLines.b(JsLines.bae('function pushVertex(p) {'), JsLines.bae('}')).ae(writePushVertex()));\n                        if (this.usesElements()) {\n                            a('function pushElement(e) {', '\\telements[nextIndexIntoElements++]=e;', '}');\n                        }\n                        a('function mix(pa,pb) {', '\\treturn [', '\\t\\t(pa[0]+pb[0])/2,', '\\t\\t(pa[1]+pb[1])/2,', '\\t];', '}', (!this.usesElements() || this.hasColorsPerFace ? WrapLines.b(JsLines.bae('function triangle(depth,p0,p1,p2) {'), JsLines.bae('}')) : WrapLines.b(JsLines.bae('function triangle(depth,p0,p1,p2,es) {'), JsLines.bae('}'))).ae(writeTriangle()), WrapLines.b(JsLines.bae('triangle('), JsLines.bae(');')).ae(writeInitialTriangleCall()));\n                        return a.e();\n                    };\n                    return Gasket;\n                }(LodShape);\n                module.exports = Gasket;\n            },\n            {\n                '19': 19,\n                '28': 28,\n                '51': 51\n            }\n        ],\n        50: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(20);\n                var Mesh = require(52);\n                var Hat = function (_Mesh) {\n                    babelHelpers.inherits(Hat, _Mesh);\n                    function Hat() {\n                        babelHelpers.classCallCheck(this, Hat);\n                        return babelHelpers.possibleConstructorReturn(this, _Mesh.apply(this, arguments));\n                    }\n                    Hat.prototype.writeMeshInit = function writeMeshInit() {\n                        return JsLines.bae('var xyRange=4;', 'var xyScale=1/(4*Math.sqrt(2));');\n                    };\n                    Hat.prototype.writeMeshVertex = function writeMeshVertex() {\n                        var a = JsLines.b();\n                        var iv = 0;\n                        a('var r2=(x*x+y*y)/2;', 'var A=Math.exp(-r2)/Math.PI;', 'var z=A*(1-r2);', 'vertices[vertexOffset+' + iv++ + ']=x*xyScale;', 'vertices[vertexOffset+' + iv++ + ']=y*xyScale;', 'vertices[vertexOffset+' + iv++ + ']=z;');\n                        if (this.hasNormals) {\n                            a('var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);', 'vertices[vertexOffset+' + iv++ + ']=normal[0];', 'vertices[vertexOffset+' + iv++ + ']=normal[1];', 'vertices[vertexOffset+' + iv++ + ']=normal[2];');\n                        }\n                        a(this.writeMeshVertexColors(iv));\n                        return a.e();\n                    };\n                    return Hat;\n                }(Mesh);\n                module.exports = Hat;\n            },\n            {\n                '20': 20,\n                '52': 52\n            }\n        ],\n        51: [\n            function (require, module, exports) {\n                'use strict';\n                var Input = require(39);\n                var Option = require(44);\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var IndentLines = require(17);\n                var Listener = require(41);\n                var Colorgen = require(33);\n                var Shape = require(53);\n                var IntFeature = require(40);\n                var LodShape = function (_Shape) {\n                    babelHelpers.inherits(LodShape, _Shape);\n                    function LodShape(options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs) {\n                        babelHelpers.classCallCheck(this, LodShape);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Shape.call(this, options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs));\n                        var maxLod = _this.getMaxPossibleLod(options.lod.max);\n                        var cap = function (v) {\n                            return Math.min(maxLod, v);\n                        };\n                        _this.lod = Option.LiveInt.make('lod', [\n                            0,\n                            10\n                        ], 6)({\n                            value: cap(options.lod.value),\n                            min: cap(options.lod.min),\n                            max: cap(options.lod.max),\n                            input: String(options.lod.input)\n                        }).fix();\n                        _this.features.push(new IntFeature('shape.lod', _this.lod));\n                        return _this;\n                    }\n                    LodShape.prototype.getMaxPossibleLod = function getMaxPossibleLod(requestedMaxLod) {\n                        // due to element index type\n                        if (!this.usesElements() || this.elementIndexBits >= 31) {\n                            // 1<<31 is a negative number, can't compare with it\n                            return requestedMaxLod;    // no need to limit lod if elements are not used or index type is large enough\n                        }\n                        var nVerticesFn = this.hasColorsPerFace ? this.getFaceVertexCount : this.getDistinctVertexCount;\n                        var indexLimit = 1 << this.elementIndexBits;\n                        for (var m = requestedMaxLod; m >= 0; m--) {\n                            var n = eval(nVerticesFn(m));\n                            if (n <= indexLimit) {\n                                return m;\n                            }\n                        }    // TODO fail here\n                    };\n                    LodShape.prototype.writeColorData = function writeColorData() {\n                        var a = JsLines.b();\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        for (var i = 0; i < 4; i++) {\n                            a('[' + colorgen.getNextColorString().slice(1, -1) + '],');\n                        }\n                        return WrapLines.b(JsLines.bae('var colors=['), JsLines.bae('];')).ae(a.e());\n                    };\n                    // abstract getDistinctVertexCount(lodSymbol) {} // # of distinct vertices where one vertex can be shared between different faces and output primitives\n                    // abstract getFaceVertexCount(lodSymbol) {} // # of distinct (vertex,face) pairs that still can be shared between output primitives\n                    // abstract getTotalVertexCount(lodSymbol) {} // # of vertices in output primitives = # of elements when element arrays are in use\n                    // abstract writeStoreShape() {}\n                    LodShape.prototype.writeArraysAndBufferData = function writeArraysAndBufferData(debugArrays) {\n                        var nVerticesFn = this.hasColorsPerFace ? this.getFaceVertexCount : this.getDistinctVertexCount;\n                        var a = JsLines.b();\n                        if (this.lod.input != 'constant') {\n                            a('var minShapeLod=' + this.lod.min + ';', 'var maxShapeLod=' + this.lod.max + ';');\n                            if (this.usesElements()) {\n                                a('var nMaxVertices=' + nVerticesFn('maxShapeLod') + ';', 'var vertices=new Float32Array(nMaxVertices*' + this.getNumbersPerVertex() + ');', 'var nMaxElements=' + this.getTotalVertexCount('maxShapeLod') + ';', 'var elements=new ' + this.getElementIndexJsArray() + '(nMaxElements);', this.writeDebug(debugArrays), 'var shapeLod,nVertices,nElements;', 'function storeShape(newShapeLod) {', '\\tshapeLod=newShapeLod;', '\\tnVertices=' + nVerticesFn('shapeLod') + ';', '\\tnElements=' + this.getTotalVertexCount('shapeLod') + ';');\n                            } else {\n                                a('var nMaxVertices=' + this.getTotalVertexCount('maxShapeLod') + ';', 'var vertices=new Float32Array(nMaxVertices*' + this.getNumbersPerVertex() + ');', this.writeDebug(debugArrays), 'var shapeLod,nVertices;', 'function storeShape(newShapeLod) {', '\\tshapeLod=newShapeLod;', '\\tnVertices=' + this.getTotalVertexCount('shapeLod') + ';');\n                            }\n                        } else {\n                            a('var shapeLod=' + this.lod + ';');\n                            if (this.usesElements()) {\n                                a('var nVertices=' + nVerticesFn('shapeLod') + ';', 'var vertices=new Float32Array(nVertices*' + this.getNumbersPerVertex() + ');', 'var nElements=' + this.getTotalVertexCount('shapeLod') + ';', 'var elements=new ' + this.getElementIndexJsArray() + '(nElements);', this.writeDebug(debugArrays), 'function storeShape() {');\n                            } else {\n                                a('var nVertices=' + this.getTotalVertexCount('shapeLod') + ';', 'var vertices=new Float32Array(nVertices*' + this.getNumbersPerVertex() + ');', this.writeDebug(debugArrays), 'function storeShape() {');\n                            }\n                        }\n                        a(IndentLines.bae(this.writeStoreShape()), IndentLines.bae(this.writeBufferData()), '}');\n                        if (this.lod.input != 'constant') {\n                            a('storeShape(' + this.lod + ');');\n                        } else {\n                            a('storeShape();');\n                        }\n                        return a.e();\n                    };\n                    LodShape.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var a = JsLines.ba(_Shape.prototype.getJsInitLines.call(this, featureContext));\n                        if (this.lod.input == 'slider') {\n                            var listener = new Listener.Slider('shape.lod');\n                            listener.enter().log('console.log(this.id,\\'input value:\\',parseInt(this.value));').post('storeShape(parseInt(this.value));');\n                            a(featureContext.getListenerLines(listener));\n                        } else if (this.lod.input instanceof Input.MouseMove) {\n                            featureContext.canvasMousemoveListener.enter().newVarInt(this.lod.input, 'shapeLod').cond('newShapeLod!=shapeLod').log('console.log(\\'shapeLod input value:\\',newShapeLod);').post('storeShape(newShapeLod);');\n                        }\n                        return a.e();\n                    };\n                    return LodShape;\n                }(Shape);\n                module.exports = LodShape;\n            },\n            {\n                '17': 17,\n                '19': 19,\n                '28': 28,\n                '33': 33,\n                '39': 39,\n                '40': 40,\n                '41': 41,\n                '44': 44,\n                '53': 53\n            }\n        ],\n        52: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var IndentLines = require(17);\n                var LodShape = require(51);\n                var Mesh = function (_LodShape) {\n                    babelHelpers.inherits(Mesh, _LodShape);\n                    function Mesh() {\n                        babelHelpers.classCallCheck(this, Mesh);\n                        return babelHelpers.possibleConstructorReturn(this, _LodShape.apply(this, arguments));\n                    }\n                    Mesh.prototype.getDistinctVertexCount = function getDistinctVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + ')+1,2)';\n                    };\n                    Mesh.prototype.getFaceVertexCount = function getFaceVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + '),2)*4';\n                    };\n                    Mesh.prototype.getTotalVertexCount = function getTotalVertexCount(lodSymbol) {\n                        return 'Math.pow((1<<' + lodSymbol + '),2)*6';\n                    };\n                    Mesh.prototype.writeMeshVertexColors = function writeMeshVertexColors(iv) {\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            return JsLines.bae(!this.usesElements() && !this.hasColorsPerFace ? 'var ic=((i+di)&1)*2+((j+dj)&1);' : 'var ic=(i&1)*2+(j&1);', 'colors[ic].forEach(function(cc,icc){', '\\tvertices[vertexOffset+' + iv + '+icc]=cc;', '});');\n                        } else {\n                            return JsLines.be();\n                        }\n                    };\n                    // abstract writeMeshInit() {}\n                    // abstract writeMeshVertex() {}\n                    Mesh.prototype.writeStoreShape = function writeStoreShape() {\n                        var a = JsLines.b();\n                        a('var res=(1<<shapeLod);');\n                        if (!this.usesElements()) {\n                            a('function vertexElement(i,j,k) {', '\\treturn (i*res+j)*6+k;', '}');\n                        } else if (this.hasColorsPerFace) {\n                            a('function vertexElement(i,j,k) {', '\\treturn (i*res+j)*4+k;', '}');\n                        } else {\n                            a('function vertexElement(i,j) {', '\\treturn i*(res+1)+j;', '}');\n                        }\n                        if (this.hasNormals) {\n                            a('function normalize(v) {', '\\tvar l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);', '\\treturn [v[0]/l,v[1]/l,v[2]/l];', '}');\n                        }\n                        if (this.hasColorsPerVertex || this.hasColorsPerFace) {\n                            a(this.writeColorData());\n                        }\n                        a(this.writeMeshInit());\n                        if (!this.usesElements()) {\n                            a('for (var i=0;i<res;i++) {', '\\tfor (var j=0;j<res;j++) {', '\\t\\tfor (var k=0;k<6;k++) {', '\\t\\t\\tvar di=[0,0,1,1,0,1][k];', '\\t\\t\\tvar dj=[0,1,0,0,1,1][k];', '\\t\\t\\tvar y=(i+di)/res*xyRange*2-xyRange;', '\\t\\t\\tvar x=(j+dj)/res*xyRange*2-xyRange;', '\\t\\t\\tvar vertexOffset=vertexElement(i,j,k)*' + this.getNumbersPerVertex() + ';', IndentLines.b(3).ae(this.writeMeshVertex()), '\\t\\t}', '\\t}', '}');\n                        } else if (this.hasColorsPerFace) {\n                            a('var i,j;', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tfor (var k=0;k<4;k++) {', '\\t\\t\\tvar di=[0,0,1,1][k];', '\\t\\t\\tvar dj=[0,1,0,1][k];', '\\t\\t\\tvar y=(i+di)/res*xyRange*2-xyRange;', '\\t\\t\\tvar x=(j+dj)/res*xyRange*2-xyRange;', '\\t\\t\\tvar vertexOffset=vertexElement(i,j,k)*' + this.getNumbersPerVertex() + ';', IndentLines.b(3).ae(this.writeMeshVertex()), '\\t\\t}', '\\t}', '}', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tvar elementOffset=(i*res+j)*6;', '\\t\\telements[elementOffset+0]=vertexElement(i,j,0);', '\\t\\telements[elementOffset+1]=vertexElement(i,j,1);', '\\t\\telements[elementOffset+2]=vertexElement(i,j,2);', '\\t\\telements[elementOffset+3]=vertexElement(i,j,2);', '\\t\\telements[elementOffset+4]=vertexElement(i,j,1);', '\\t\\telements[elementOffset+5]=vertexElement(i,j,3);', '\\t}', '}');\n                        } else {\n                            a('var i,j;', 'for (i=0;i<=res;i++) {', '\\tvar y=i/res*xyRange*2-xyRange;', '\\tfor (j=0;j<=res;j++) {', '\\t\\tvar x=j/res*xyRange*2-xyRange;', '\\t\\tvar vertexOffset=vertexElement(i,j)*' + this.getNumbersPerVertex() + ';', IndentLines.b(2).ae(this.writeMeshVertex()), '\\t}', '}', 'for (i=0;i<res;i++) {', '\\tfor (j=0;j<res;j++) {', '\\t\\tvar elementOffset=(i*res+j)*6;', '\\t\\telements[elementOffset+0]=vertexElement(i+0,j+0);', '\\t\\telements[elementOffset+1]=vertexElement(i+0,j+1);', '\\t\\telements[elementOffset+2]=vertexElement(i+1,j+0);', '\\t\\telements[elementOffset+3]=vertexElement(i+1,j+0);', '\\t\\telements[elementOffset+4]=vertexElement(i+0,j+1);', '\\t\\telements[elementOffset+5]=vertexElement(i+1,j+1);', '\\t}', '}');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Mesh, [{\n                            key: 'dim',\n                            get: function () {\n                                return 3;\n                            }\n                        }]);\n                    return Mesh;\n                }(LodShape);\n                module.exports = Mesh;\n            },\n            {\n                '17': 17,\n                '19': 19,\n                '51': 51\n            }\n        ],\n        53: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var Feature = require(35);\n                var Shape = function (_Feature) {\n                    babelHelpers.inherits(Shape, _Feature);\n                    function Shape(options, hasReflections, hasColorsPerVertex, hasColorsPerFace, colorAttrs) {\n                        babelHelpers.classCallCheck(this, Shape);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.elementIndexBits = parseInt(options.elements);\n                        // 0 if don't want element arrays; 8, 16 or 32 bits per element index, limits lod of shape\n                        _this.hasNormals = hasReflections && _this.dim == 3;\n                        // true = need normals, unless shape is flat\n                        _this.hasColorsPerVertex = hasColorsPerVertex;\n                        // TODO support for both hasColorsPerVertex and hasColorsPerFace == true\n                        _this.hasColorsPerFace = hasColorsPerFace;\n                        _this.colorAttrs = colorAttrs;\n                        // array of color attribute structs {name,enabled,weight}\n                        return _this;\n                    }\n                    Shape.prototype.usesElements = function usesElements() {\n                        // TODO convert to getter\n                        return this.elementIndexBits > 0;\n                    };\n                    Shape.prototype.getNumbersPerVertex = function getNumbersPerVertex() {\n                        return this.dim + (this.hasNormals ? 3 : 0) + this.colorAttrs.length * 3;\n                    };\n                    Shape.prototype.getElementIndexJsArray = function getElementIndexJsArray() {\n                        return 'Uint' + this.elementIndexBits + 'Array';\n                    };\n                    Shape.prototype.getElementIndexGlType = function getElementIndexGlType() {\n                        if (this.elementIndexBits == 8) {\n                            return 'gl.UNSIGNED_BYTE';    // not recommended by ms [https://msdn.microsoft.com/en-us/library/dn798776%28v=vs.85%29.aspx]\n                        } else if (this.elementIndexBits == 16) {\n                            return 'gl.UNSIGNED_SHORT';    // mozilla examples use this\n                        } else if (this.elementIndexBits == 32) {\n                            return 'gl.UNSIGNED_INT';    // needs extension\n                        }\n                    };\n                    Shape.prototype.writeDebug = function writeDebug(debugArrays) {\n                        var a = JsLines.b();\n                        if (debugArrays) {\n                            a('console.log(\\'vertex array byte length:\\',vertices.byteLength);');\n                            if (this.usesElements()) {\n                                a('console.log(\\'element array byte length:\\',elements.byteLength);');\n                                a('console.log(\\'vertex+element array byte length:\\',vertices.byteLength+elements.byteLength);');\n                            }\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.writeBufferData = function writeBufferData() {\n                        var a = JsLines.b();\n                        a('gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);');\n                        if (this.usesElements()) {\n                            a('gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);');\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.writeArraysAndBufferData = function writeArraysAndBufferData(debugArrays) {\n                        return JsLines.bae(this.writeArrays(), this.writeDebug(debugArrays), this.writeBufferData());\n                    };\n                    // public:\n                    Shape.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this2 = this;\n                        var writeVertexAttribArrays = function (attrs) {\n                            var cmpSize = attrs[0][0];\n                            var allSameSize = attrs.every(function (attr) {\n                                var size = attr[0];\n                                return size == cmpSize;\n                            });\n                            var allEnabled = true;\n                            var arrayLines = JsLines.bae.apply(JsLines, attrs.map(function (attr) {\n                                var size = attr[0], name = attr[1], enabled = attr[2];\n                                if (enabled) {\n                                    return allSameSize ? '\\'' + name + '\\',' : '[' + size + ',\\'' + name + '\\'],';\n                                } else {\n                                    allEnabled = false;\n                                    return (allSameSize ? 'null,' : '[' + size + ',null],') + ' // attribute ' + name + ' disabled';\n                                }\n                            }));\n                            var foreachEnableLines = JsLines.bae('var attrLoc=gl.getAttribLocation(program,attrName);', 'gl.vertexAttribPointer(', '\\tattrLoc,attrSize,gl.FLOAT,false,', '\\tFloat32Array.BYTES_PER_ELEMENT*bufferStride,', '\\tFloat32Array.BYTES_PER_ELEMENT*bufferOffset', ');', 'gl.enableVertexAttribArray(attrLoc);');\n                            if (!allEnabled) {\n                                foreachEnableLines = WrapLines.b(JsLines.bae('if (name!==null) {'), JsLines.bae('}')).ae(foreachEnableLines);\n                            }\n                            var foreachLines = JsLines.bae.apply(JsLines, (allSameSize ? ['var attrSize=' + cmpSize + ';'] : [\n                                'var attrSize=attr[0];',\n                                'var attrName=attr[1];'\n                            ]).concat([\n                                foreachEnableLines,\n                                'bufferOffset+=attrSize;'\n                            ]));\n                            return WrapLines.b(JsLines.bae('var bufferStride=' + _this2.getNumbersPerVertex() + ';', 'var bufferOffset=0;', ';['), JsLines.bae('].forEach(function(' + (allSameSize ? 'attrName' : 'attr') + '){'), JsLines.bae('});')).ae(arrayLines, foreachLines);\n                        };\n                        var a = JsLines.ba(_Feature.prototype.getJsInitLines.call(this, featureContext));\n                        if (this.elementIndexBits == 32) {\n                            a('gl.getExtension(\\'OES_element_index_uint\\');');    // TODO check if null is returned and don't allow more elements\n                        }\n                        if (this.dim > 2) {\n                            a('gl.enable(gl.DEPTH_TEST);');\n                        }\n                        a('gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());');\n                        if (this.usesElements()) {\n                            a('gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());');\n                        }\n                        a(this.writeArraysAndBufferData(featureContext.debugOptions.arrays));\n                        if (!this.hasNormals && this.colorAttrs.length <= 0) {\n                            a('var positionLoc=gl.getAttribLocation(program,\\'position\\');', 'gl.vertexAttribPointer(positionLoc,' + this.dim + ',gl.FLOAT,false,0,0);', 'gl.enableVertexAttribArray(positionLoc);');\n                        } else {\n                            a(writeVertexAttribArrays([[\n                                    this.dim,\n                                    'position',\n                                    true\n                                ]].concat(this.hasNormals ? [[\n                                    3,\n                                    'normal',\n                                    true\n                                ]] : [], this.colorAttrs.map(function (attr) {\n                                return [\n                                    3,\n                                    attr.name,\n                                    attr.enabled\n                                ];\n                            }))));\n                        }\n                        return a.e();\n                    };\n                    Shape.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_Feature.prototype.getJsLoopLines.call(this, featureContext));\n                        if (this.usesElements()) {\n                            a('gl.drawElements(gl.' + this.glPrimitive + ',nElements,' + this.getElementIndexGlType() + ',0);');\n                        } else {\n                            a('gl.drawArrays(gl.' + this.glPrimitive + ',0,nVertices);');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Shape, [\n                        {\n                            key: 'dim',\n                            get: function () {\n                                return 2;\n                            }\n                        },\n                        {\n                            key: 'twoSided',\n                            get: function () {\n                                return true;\n                            }    // triangles can be viewed from both sides\n                        },\n                        {\n                            key: 'glPrimitive',\n                            get: function () {\n                                return 'TRIANGLES';\n                            }\n                        }\n                    ]);\n                    return Shape;\n                }(Feature);\n                module.exports = Shape;\n            },\n            {\n                '19': 19,\n                '28': 28,\n                '35': 35\n            }\n        ],\n        54: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var Colorgen = require(33);\n                var Shape = require(53);\n                var Square = function (_Shape) {\n                    babelHelpers.inherits(Square, _Shape);\n                    function Square() {\n                        babelHelpers.classCallCheck(this, Square);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Square.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        var colorDataForFace = undefined;\n                        var writeColorData = function () {\n                            if (_this2.hasColorsPerFace && !_this2.hasColorsPerVertex) {\n                                if (colorDataForFace === undefined) {\n                                    colorDataForFace = colorgen.getNextColorString();\n                                }\n                                return colorDataForFace;\n                            } else {\n                                return colorgen.getNextColorString();\n                            }\n                        };\n                        var a = JsLines.ba('var nVertices=4;', 'var vertices=new Float32Array([', '\\t// x    y' + colorgen.getHeaderString(), '\\t-0.5,-0.5,' + writeColorData(), '\\t+0.5,-0.5,' + writeColorData(), '\\t+0.5,+0.5,' + writeColorData(), '\\t-0.5,+0.5,' + writeColorData(), ']);');\n                        if (this.usesElements()) {\n                            a('var nElements=4;', 'var elements=new ' + this.getElementIndexJsArray() + '([0,1,2,3]);');\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Square, [{\n                            key: 'glPrimitive',\n                            get: function () {\n                                return 'TRIANGLE_FAN';\n                            }\n                        }]);\n                    return Square;\n                }(Shape);\n                module.exports = Square;\n            },\n            {\n                '19': 19,\n                '33': 33,\n                '53': 53\n            }\n        ],\n        55: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var Mesh = require(52);\n                var Terrain = function (_Mesh) {\n                    babelHelpers.inherits(Terrain, _Mesh);\n                    function Terrain() {\n                        babelHelpers.classCallCheck(this, Terrain);\n                        return babelHelpers.possibleConstructorReturn(this, _Mesh.apply(this, arguments));\n                    }\n                    Terrain.prototype.writeMeshInit = function writeMeshInit() {\n                        var noFaces = this.usesElements() && !this.hasColorsPerFace;\n                        var a = JsLines.b();\n                        a('var xyRange=1/Math.sqrt(2);', 'var zRange=xyRange;', 'var mask=res-1;', 'function zOffset(i,j) {', '\\treturn vertexElement(i,j' + (noFaces ? '' : ',0') + ')*' + this.getNumbersPerVertex() + '+2;', '}', 'function noise(depth) {', '\\tvar r=zRange/Math.pow(2,shapeLod-depth-1);', '\\treturn Math.random()*2*r-r;', '}', 'vertices[2]=0.0;', 'var i0,i1,i2,i3;', 'var j0,j1,j2,j3;', 'for (var depth=shapeLod-1;depth>=0;depth--) {', '\\tvar d=1<<depth;', '\\t// diamond step', '\\tfor (i2=d;i2<res;i2+=2*d) {', '\\t\\tfor (j2=d;j2<res;j2+=2*d) {', '\\t\\t\\ti1=i2-d;', '\\t\\t\\tj1=j2-d;', '\\t\\t\\ti3=(i2+d)&mask;', '\\t\\t\\tj3=(j2+d)&mask;', '\\t\\t\\tvertices[zOffset(i2,j2)]=(', '\\t\\t\\t\\tvertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+', '\\t\\t\\t\\tvertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t}', '\\t}', '\\t// square step', '\\tfor (i2=d;i2<res;i2+=2*d) {', '\\t\\tfor (j2=d;j2<res;j2+=2*d) {', '\\t\\t\\ti0=(i2-2*d)&mask;', '\\t\\t\\tj0=(j2-2*d)&mask;', '\\t\\t\\ti1=(i2-d);', '\\t\\t\\tj1=(j2-d);', '\\t\\t\\ti3=(i2+d)&mask;', '\\t\\t\\tj3=(j2+d)&mask;', '\\t\\t\\tvertices[zOffset(i2,j1)]=(', '\\t\\t\\t\\tvertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+', '\\t\\t\\t\\tvertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t\\tvertices[zOffset(i1,j2)]=(', '\\t\\t\\t\\tvertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+', '\\t\\t\\t\\tvertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]', '\\t\\t\\t)/4+noise(depth);', '\\t\\t}', '\\t}', '}');\n                        if (noFaces) {\n                            a('for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];', 'for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];', 'vertices[zOffset(res,res)]=vertices[zOffset(0,0)];');\n                        }\n                        return a.e();\n                    };\n                    Terrain.prototype.writeMeshVertex = function writeMeshVertex() {\n                        var noFaces = this.usesElements() && !this.hasColorsPerFace;\n                        var a = JsLines.b();\n                        a('vertices[vertexOffset+0]=x;', 'vertices[vertexOffset+1]=y;', noFaces ? '// vertices[vertexOffset+2] already written' : 'vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];');\n                        var iv = 3;\n                        if (this.hasNormals) {\n                            a('var d=4*xyRange/res;', 'var normal=normalize([', noFaces ? '\\t(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,' : '\\t(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,', noFaces ? '\\t(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,' : '\\t(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,', '1]);', 'vertices[vertexOffset+' + iv++ + ']=normal[0];', 'vertices[vertexOffset+' + iv++ + ']=normal[1];', 'vertices[vertexOffset+' + iv++ + ']=normal[2];');\n                        }\n                        a(this.writeMeshVertexColors(iv));\n                        return a.e();\n                    };\n                    return Terrain;\n                }(Mesh);\n                module.exports = Terrain;\n            },\n            {\n                '19': 19,\n                '52': 52\n            }\n        ],\n        56: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(19);\n                var Colorgen = require(33);\n                var Shape = require(53);\n                var Triangle = function (_Shape) {\n                    babelHelpers.inherits(Triangle, _Shape);\n                    function Triangle() {\n                        babelHelpers.classCallCheck(this, Triangle);\n                        return babelHelpers.possibleConstructorReturn(this, _Shape.apply(this, arguments));\n                    }\n                    Triangle.prototype.writeArrays = function writeArrays() {\n                        var _this2 = this;\n                        var colorgen = new Colorgen(this.colorAttrs, 0);\n                        var colorDataForFace = undefined;\n                        var writeColorData = function () {\n                            if (_this2.hasColorsPerFace && !_this2.hasColorsPerVertex) {\n                                if (colorDataForFace === undefined) {\n                                    colorDataForFace = colorgen.getNextColorString();\n                                }\n                                return colorDataForFace;\n                            } else {\n                                return colorgen.getNextColorString();\n                            }\n                        };\n                        var a = JsLines.ba('var nVertices=3;', 'var vertices=new Float32Array([', '\\t//                   x                      y' + colorgen.getHeaderString(), '\\t-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),' + writeColorData(), '\\t-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),' + writeColorData(), '\\t-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),' + writeColorData(), ']);');\n                        if (this.usesElements()) {\n                            a('var nElements=3;', 'var elements=new ' + this.getElementIndexJsArray() + '([0,1,2]);');\n                        }\n                        return a.e();\n                    };\n                    return Triangle;\n                }(Shape);\n                module.exports = Triangle;\n            },\n            {\n                '19': 19,\n                '33': 33,\n                '53': 53\n            }\n        ],\n        57: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(20);\n                var Feature = require(35);\n                var GlslVector = require(36);\n                var Transforms = function (_Feature) {\n                    babelHelpers.inherits(Transforms, _Feature);\n                    function Transforms(options) {\n                        babelHelpers.classCallCheck(this, Transforms);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.options = options;\n                        _this.rotateVectorEntries = [];\n                        // [{vector,suffix}] like features, but vectors have additional methods that don't follow feature interfaces\n                        _this.transformSequence = new Array(options.model.entries.length);\n                        // [{vector,component,suffix}]\n                        var possibleComponents = [\n                            'x',\n                            'y',\n                            'z'\n                        ];\n                        var rotate = [\n                            [],\n                            [],\n                            []\n                        ];\n                        options.model.entries.forEach(function (tr, iTr) {\n                            var trData = {\n                                transform: tr,\n                                index: iTr\n                            };\n                            if (tr.type == 'rotate.x') {\n                                rotate[0].push(trData);\n                            } else if (tr.type == 'rotate.y') {\n                                rotate[1].push(trData);\n                            } else if (tr.type == 'rotate.z') {\n                                rotate[2].push(trData);\n                            }\n                        });\n                        var nLayers = Math.max.apply(null, rotate.map(function (r) {\n                            return r.length;\n                        }));\n                        var _loop = function (i) {\n                            var isInGap = false;\n                            var isStraight = true;\n                            var lastStraightIndex = -1;\n                            for (var j = 0; j < 3; j++) {\n                                var has = i < rotate[j].length;\n                                if (isInGap) {\n                                    if (has) {\n                                        isStraight = false;\n                                        break;\n                                    }\n                                } else {\n                                    if (has) {\n                                        lastStraightIndex = j;\n                                    } else {\n                                        isInGap = true;\n                                    }\n                                }\n                            }\n                            var suffix = nLayers > 1 ? String(i) : '';\n                            var makeVector = function (values, names) {\n                                var vector = new GlslVector('rotate' + (nLayers > 1 ? '.' + i : ''), values, 180);\n                                vector.i18nId = 'transforms.model.rotate';\n                                _this.features.push(vector);\n                                _this.rotateVectorEntries.push({\n                                    vector: vector,\n                                    suffix: suffix\n                                });\n                                return vector;\n                            };\n                            var storeSequenceElement = function (vector, j) {\n                                _this.transformSequence[rotate[j][i].index] = {\n                                    vector: vector,\n                                    component: possibleComponents[j],\n                                    suffix: suffix\n                                };\n                            };\n                            if (isStraight) {\n                                var vector = makeVector(rotate.slice(0, lastStraightIndex + 1).map(function (r) {\n                                    return r[i].transform;\n                                }), possibleComponents.slice(0, lastStraightIndex + 1));\n                                for (var _j = 0; _j <= lastStraightIndex; _j++) {\n                                    storeSequenceElement(vector, _j);\n                                }\n                            } else {\n                                for (var _j2 = 0; _j2 < 3; _j2++) {\n                                    var _has = i < rotate[_j2].length;\n                                    if (_has) {\n                                        var _vector = makeVector([rotate[_j2][i].transform], possibleComponents.slice(_j2, _j2 + 1));\n                                        storeSequenceElement(_vector, _j2);\n                                    }\n                                }\n                            }\n                        };\n                        for (var i = 0; i < nLayers; i++) {\n                            _loop(i);\n                        }\n                        return _this;\n                    }\n                    // private:\n                    Transforms.prototype.use2dTransform = function use2dTransform(flatShape) {\n                        // has flat shape and exactly one z rotation TODO multiple z rotations\n                        return flatShape && this.options.model.entries.length == 1 && this.options.model.entries[0].type == 'rotate.z';\n                    };\n                    Transforms.prototype.getTransformMatricesLines = function getTransformMatricesLines(dim) {\n                        // dim==3 for normal transform, dim==4 for position transform\n                        var a = Lines.ba('');\n                        var maxSuffixLength = 1;\n                        // TODO calculate it\n                        var width = 4 + maxSuffixLength;\n                        // 1(sign)+3(c.x)+(max suffix length)\n                        var pad = function (e) {\n                            // TODO (fake-)lodash pad\n                            if (e.length < width) {\n                                return ('          ' + e).slice(-width);\n                            } else {\n                                return e;\n                            }\n                        };\n                        var mat = function (rows, comment) {\n                            a.t('*mat' + dim + '( // ' + comment);\n                            rows.forEach(function (row, i) {\n                                if (i >= dim)\n                                    return;\n                                a('\\t');\n                                row.forEach(function (e, j) {\n                                    if (j >= dim)\n                                        return;\n                                    a.t(pad(e));\n                                    if (i < dim - 1 || j < dim - 1)\n                                        a.t(',');\n                                });\n                            });\n                            a(')');\n                        };\n                        this.transformSequence.forEach(function (ts) {\n                            if (!ts)\n                                return;\n                            var c = ts.vector.getGlslMapComponentValue('c' + ts.suffix, ts.component);\n                            var s = ts.vector.getGlslMapComponentValue('s' + ts.suffix, ts.component);\n                            if (ts.component == 'x') {\n                                mat([\n                                    [\n                                        '1.0',\n                                        '0.0',\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        c,\n                                        '-' + s,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        s,\n                                        c,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around x axis');\n                            } else if (ts.component == 'y') {\n                                mat([\n                                    [\n                                        c,\n                                        '0.0',\n                                        s,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '1.0',\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '-' + s,\n                                        '0.0',\n                                        c,\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around y axis');\n                            } else if (ts.component == 'z') {\n                                mat([\n                                    [\n                                        c,\n                                        '-' + s,\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        s,\n                                        c,\n                                        '0.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '1.0',\n                                        '0.0'\n                                    ],\n                                    [\n                                        '0.0',\n                                        '0.0',\n                                        '0.0',\n                                        '1.0'\n                                    ]\n                                ], 'rotate around z axis');\n                            }\n                        });\n                        if (dim == 4 && this.options.projection == 'perspective') {\n                            mat([\n                                [\n                                    '1.0',\n                                    '0.0',\n                                    '0.0',\n                                    '0.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '1.0',\n                                    '0.0',\n                                    '0.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '0.0',\n                                    '1.0',\n                                    '-(near+far)/2.0'\n                                ],\n                                [\n                                    '0.0',\n                                    '0.0',\n                                    '0.0',\n                                    '1.0'\n                                ]\n                            ], 'move center of coords inside view');\n                        }\n                        return a.e();\n                    };\n                    // public:\n                    Transforms.prototype.getGlslVertexDeclarationLines = function getGlslVertexDeclarationLines(flatShape) {\n                        var a = Lines.b();\n                        this.rotateVectorEntries.forEach(function (rve) {\n                            a(rve.vector.getGlslDeclarationLines());\n                        });\n                        if (this.use2dTransform(flatShape)) {\n                            a('attribute vec2 position;');\n                        } else {\n                            a('attribute vec4 position;');\n                        }\n                        return a.e();\n                    };\n                    Transforms.prototype.getGlslVertexOutputLines = function getGlslVertexOutputLines(flatShape, receivesAspect, needTransformedPosition) {\n                        var a = Lines.b();\n                        this.rotateVectorEntries.forEach(function (rve) {\n                            a(rve.vector.getGlslMapDeclarationLines('c' + rve.suffix, function (v) {\n                                return 'cos(radians(' + v + '))';\n                            }), rve.vector.getGlslMapDeclarationLines('s' + rve.suffix, function (v) {\n                                return 'sin(radians(' + v + '))';\n                            }));\n                        });\n                        if (this.options.projection == 'perspective') {\n                            a('float fovy=45.0;', 'float near=1.0/tan(radians(fovy)/2.0);', 'float far=near+2.0;');\n                        }\n                        if (needTransformedPosition) {\n                            a('vec4 transformedPosition=');\n                        } else {\n                            a('gl_Position=');\n                        }\n                        if (this.use2dTransform(flatShape)) {\n                            a.t('vec4(position*mat2(', '\\tcz, -sz,', '\\tsz,  cz', '),0,1)');\n                        } else {\n                            a.t('position');\n                            a.t(this.getTransformMatricesLines(4));\n                        }\n                        if (needTransformedPosition) {\n                            a.t(';');\n                            a('gl_Position=transformedPosition');\n                        }\n                        if (this.options.projection == 'ortho') {\n                            if (receivesAspect) {\n                                a.t('*vec4(1.0/aspect,1.0,-1.0,1.0)');    // correct aspect ratio and make coords right-handed\n                            } else if (!flatShape) {\n                                a.t('*vec4(1.0,1.0,-1.0,1.0)');    // make coords right-handed for 3d shapes\n                            }\n                        } else if (this.options.projection == 'perspective') {\n                            if (receivesAspect) {\n                                a.t('*mat4(', '\\tnear/aspect, 0.0,  0.0,                   0.0,', '\\t0.0,         near, 0.0,                   0.0,', '\\t0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),', '\\t0.0,         0.0,  -1.0,                  0.0', ')');\n                            } else {\n                                a.t('*mat4(', '\\tnear, 0.0,  0.0,                   0.0,', '\\t0.0,  near, 0.0,                   0.0,', '\\t0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),', '\\t0.0,  0.0,  -1.0,                  0.0', ')');\n                            }\n                        }\n                        a.t(';');\n                        return a.e();\n                    };\n                    Transforms.prototype.getGlslVertexNormalTransformLines = function getGlslVertexNormalTransformLines() {\n                        return this.getTransformMatricesLines(3);\n                    };\n                    babelHelpers.createClass(Transforms, [{\n                            key: 'eyeAtInfinity',\n                            get: function () {\n                                return this.options.projection == 'ortho';\n                            }\n                        }]);\n                    return Transforms;\n                }(Feature);\n                module.exports = Transforms;\n            },\n            {\n                '20': 20,\n                '35': 35,\n                '36': 36\n            }\n        ],\n        58: [\n            function (require, module, exports) {\n                'use strict';\n                var camelCase = require(6);\n                var VectorComponent = function () {\n                    function VectorComponent(value, vectorName, wrapRange) {\n                        babelHelpers.classCallCheck(this, VectorComponent);\n                        this.value = value;\n                        // value from options.fix()\n                        this.vectorName = vectorName;\n                        this.wrapRange = wrapRange;    // if defined and components min/max == -/+ this value, use wrap() instead of clamp()\n                    }\n                    VectorComponent.prototype.hasSpeed = function hasSpeed() {\n                        return this.value.speed != 0 || this.value.speed.input != 'constant';\n                    };\n                    VectorComponent.prototype.hasInput = function hasInput() {\n                        return this.value.input != 'constant' || this.value.speed.input != 'constant';\n                    };\n                    VectorComponent.prototype.hasInputClass = function hasInputClass(inputClass) {\n                        return this.value.input instanceof inputClass || this.value.speed.input instanceof inputClass;\n                    };\n                    VectorComponent.prototype.usesStartTime = function usesStartTime() {\n                        return this.value.input == 'constant' && this.value.speed != 0 && this.value.speed.input == 'constant';\n                    };\n                    VectorComponent.prototype.usesPrevTime = function usesPrevTime() {\n                        return this.value.input != 'constant' && this.value.speed != 0 || this.value.speed.input != 'constant';\n                    };\n                    babelHelpers.createClass(VectorComponent, [\n                        {\n                            key: 'suffix',\n                            get: function () {\n                                var dotIndex = this.value.name.lastIndexOf('.');\n                                if (dotIndex < 0) {\n                                    return this.value.name;\n                                } else {\n                                    return this.value.name.slice(dotIndex + 1);\n                                }\n                            }\n                        },\n                        {\n                            key: 'name',\n                            get: function () {\n                                return this.vectorName + '.' + this.suffix;\n                            }\n                        },\n                        {\n                            key: 'varName',\n                            get: function () {\n                                return camelCase(this.name);\n                            }\n                        },\n                        {\n                            key: 'varNameLoc',\n                            get: function () {\n                                return this.varName + 'Loc';\n                            }\n                        },\n                        {\n                            key: 'varNameSpeed',\n                            get: function () {\n                                return this.varName + 'Speed';\n                            }\n                        },\n                        {\n                            key: 'varNameInput',\n                            get: function () {\n                                return this.varName + 'Input';\n                            }\n                        },\n                        {\n                            key: 'minVarName',\n                            get: function () {\n                                return camelCase('min.' + this.name);\n                            }\n                        },\n                        {\n                            key: 'maxVarName',\n                            get: function () {\n                                return camelCase('max.' + this.name);\n                            }\n                        },\n                        {\n                            key: 'variable',\n                            get: function () {\n                                return this.value.input != 'constant' || this.hasSpeed();\n                            }\n                        },\n                        {\n                            key: 'wrapReady',\n                            get: function () {\n                                return this.wrapRange && this.value.min == -this.wrapRange && this.value.max == +this.wrapRange;\n                            }\n                        },\n                        {\n                            key: 'wrapped',\n                            get: function () {\n                                return this.hasSpeed() && this.wrapReady && this.value.input == 'slider';    // need to wrap only if input with state is used\n                            }\n                        },\n                        {\n                            key: 'clamped',\n                            get: function () {\n                                return !this.wrapped && this.value.speed.input != 'constant' && !this.wrapReady;\n                            }\n                        },\n                        {\n                            key: 'capped',\n                            get: function () {\n                                return !this.wrapped && !this.clamped && this.hasSpeed() && !this.wrapReady;\n                            }\n                        }\n                    ]);\n                    return VectorComponent;\n                }();\n                module.exports = VectorComponent;\n            },\n            { '6': 6 }\n        ],\n        59: [\n            function (require, module, exports) {\n                'use strict';\n                var camelCase = require(6);\n                var formatNumber = require(11);\n                var formatNumbers = require(12);\n                var Input = require(39);\n                var Lines = require(20);\n                var JsLines = require(19);\n                var WrapLines = require(28);\n                var Listener = require(41);\n                var VectorComponent = require(58);\n                var NumericFeature = require(43);\n                var Vector = function (_NumericFeature) {\n                    babelHelpers.inherits(Vector, _NumericFeature);\n                    function Vector(name, values, wrapRange) {\n                        babelHelpers.classCallCheck(this, Vector);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _NumericFeature.call(this));\n                        _this.name = name;\n                        // name with dots like \"material.color\", transformed into \"materialColor\" for js var names\n                        _this.components = [];\n                        _this.componentsBySuffix = {};\n                        values.forEach(function (v) {\n                            var component = new VectorComponent(v, name, wrapRange);\n                            _this.components.push(component);\n                            _this.componentsBySuffix[component.suffix] = component;\n                        });\n                        // { TODO extra ctor args\n                        _this.i18nId = name;\n                        // }\n                        _this.nVars = 0;\n                        _this.modeConstant = true;\n                        // all vector components are constants\n                        _this.modeFloats = false;\n                        // one/some vector components are variable, such components get their own glsl vars\n                        _this.components.forEach(function (component, i) {\n                            if (component.variable) {\n                                _this.modeConstant = false;\n                                if (_this.nVars++ != i) {\n                                    _this.modeFloats = true;\n                                }\n                            }\n                        });\n                        if (_this.nVars == 1) {\n                            _this.modeFloats = true;\n                        }\n                        _this.modeVector = !_this.modeConstant && !_this.modeFloats;\n                        // first consecutive components are variable, packed into one glsl vector\n                        return _this;\n                    }\n                    // fns that can be mapped over components:\n                    Vector.prototype.makeInitialComponentValue = function makeInitialComponentValue() {\n                        var numbers = {};\n                        this.components.forEach(function (component) {\n                            if (component.value.input == 'slider') {\n                            } else {\n                                numbers[component.value.name] = component.value;\n                            }\n                        });\n                        var fmt = formatNumbers.js(numbers);\n                        return function (component) {\n                            if (component.value.input == 'slider') {\n                                return 'parseFloat(document.getElementById(\\'' + component.name + '\\').value)';    // b/c slider could be init'd to a value different than the default\n                            } else {\n                                return fmt[component.value.name];\n                            }\n                        };\n                    };\n                    Vector.prototype.makeUpdatedComponentValue = function makeUpdatedComponentValue() {\n                        var numbers = {};\n                        this.components.forEach(function (component) {\n                            if (component.value.speed != 0 || component.value.speed.input != 'constant' || component.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad) {\n                            } else if (component.value.input == 'slider') {\n                            } else {\n                                numbers[component.value.name] = component.value;\n                            }\n                        });\n                        var fmt = formatNumbers.js(numbers);\n                        return function (component) {\n                            if (component.value.speed != 0 || component.value.speed.input != 'constant' || component.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad) {\n                                return component.varName;\n                            } else if (component.value.input == 'slider') {\n                                return 'parseFloat(document.getElementById(\\'' + component.name + '\\').value)';\n                            } else {\n                                return fmt[component.value.name];\n                            }\n                        };\n                    };\n                    // abstract fns:\n                    Vector.prototype.getJsDeclarationLines = function getJsDeclarationLines() {\n                        return JsLines.be();\n                    };\n                    // Locs etc\n                    Vector.prototype.getJsUpdateLines = function getJsUpdateLines(componentValue) {\n                        return JsLines.be();\n                    };\n                    Vector.prototype.addPostToListenerEntryForComponent = function addPostToListenerEntryForComponent(entry, component) {\n                    };\n                    // do necessary entry.post()\n                    Vector.prototype.addPostToListenerEntryAfterComponents = function addPostToListenerEntryAfterComponents(entry, componentValue) {\n                    };\n                    // TODO check if we need componentValue - GlslVector doesn't use it\n                    // public:\n                    Vector.prototype.hasInputs = function hasInputs() {\n                        return _NumericFeature.prototype.hasInputs.call(this) || this.components.some(function (component) {\n                            return component.hasInput();\n                        });\n                    };\n                    Vector.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        _NumericFeature.prototype.requestFeatureContext.call(this, featureContext);\n                        this.components.forEach(function (component) {\n                            if (component.hasInput())\n                                featureContext.hasInputs = true;\n                            if (component.hasInputClass(Input.Slider))\n                                featureContext.hasSliders = true;\n                            if (component.hasInputClass(Input.Gamepad))\n                                featureContext.pollsGamepad = true;\n                            if (component.usesStartTime())\n                                featureContext.hasStartTime = true;\n                            if (component.usesPrevTime())\n                                featureContext.hasPrevTime = true;\n                            if (component.wrapped)\n                                featureContext.hasWrapFn = true;\n                            if (component.clamped)\n                                featureContext.hasClampFn = true;\n                        });\n                    };\n                    Vector.prototype.getHtmlControlMessageLines = function getHtmlControlMessageLines(i18n) {\n                        var _this2 = this;\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlControlMessageLines.call(this, i18n));\n                        this.components.forEach(function (component) {\n                            a(_this2.getHtmlControlMessageForValue(i18n, component.value, _this2.i18nId + '.' + component.suffix), _this2.getHtmlControlMessageForValue(i18n, component.value.speed, _this2.i18nId + '.' + component.suffix + '.speed'));\n                        });\n                        return a.e();\n                    };\n                    Vector.prototype.getHtmlInputLines = function getHtmlInputLines(i18n) {\n                        var _this3 = this;\n                        var a = Lines.ba(_NumericFeature.prototype.getHtmlInputLines.call(this, i18n));\n                        this.components.forEach(function (component) {\n                            return a(_this3.getHtmlSliderLines(i18n, component.value, 'options.' + _this3.i18nId + '.' + component.suffix, component.name, 'any'), _this3.getHtmlSliderLines(i18n, component.value.speed, 'options.' + _this3.i18nId + '.' + component.suffix + '.speed', component.name + '.speed', 'any'));\n                        });\n                        return a.e();\n                    };\n                    Vector.prototype.getJsInitLines = function getJsInitLines(featureContext) {\n                        var _this4 = this;\n                        var getSliderListenerLines = function (doUpdate) {\n                            var getManyListenersLines = function () {\n                                var a = JsLines.b();\n                                var writeListener = function (v, htmlName) {\n                                    if (v.input != 'slider')\n                                        return;\n                                    var listener = new Listener.Slider(htmlName);\n                                    var entry = listener.enter();\n                                    entry.log('console.log(this.id,\\'input value:\\',parseFloat(this.value));');\n                                    if (doUpdate) {\n                                        entry.post(_this4.updateFnName + '();');\n                                    }\n                                    a(featureContext.getListenerLines(listener));\n                                };\n                                _this4.components.forEach(function (component) {\n                                    writeListener(component.value, component.name);\n                                    writeListener(component.value.speed, component.name + '.speed');\n                                });\n                                return a.e();\n                            };\n                            var getOneListenerLines = function () {\n                                var listener = new Listener.MultipleSlider('[id^=\"' + _this4.name + '.\"]');\n                                // will also handle speed sliders, but it's ok\n                                var entry = listener.enter();\n                                entry.log('console.log(this.id,\\'input value:\\',parseFloat(this.value));');\n                                if (doUpdate) {\n                                    entry.post(_this4.updateFnName + '();');\n                                }\n                                return featureContext.getListenerLines(listener);\n                            };\n                            var manyListenersLines = getManyListenersLines();\n                            var oneListenerLines = getOneListenerLines();\n                            return manyListenersLines.count() <= oneListenerLines.count() ? manyListenersLines : oneListenerLines;\n                        };\n                        var a = JsLines.ba(_NumericFeature.prototype.getJsInitLines.call(this, featureContext));\n                        a(this.getJsDeclarationLines());\n                        if (this.modeConstant) {\n                            a(this.getJsUpdateLines(this.makeInitialComponentValue()));\n                            return a.e();\n                        }\n                        var someSpeeds = this.components.some(function (component) {\n                            return component.hasSpeed();\n                        });\n                        var someValueSliders = this.components.some(function (component) {\n                            return component.value.input == 'slider';\n                        });\n                        var someGamepads = this.components.some(function (component) {\n                            return component.hasInputClass(Input.Gamepad);\n                        });\n                        var writeVarLines = function () {\n                            var fmt = undefined, sfmt = undefined;\n                            var numbers = {}, snumbers = {};\n                            var writes = [], swrites = [];\n                            _this4.components.forEach(function (component) {\n                                if (component.value.input instanceof Input.MouseMove && (someValueSliders || someSpeeds || someGamepads) || // mouse input required elsewhere\n                                    component.value.speed.input != 'constant' && component.value.input != 'slider'    // variable speed and no value input capable of storing the state\n) {\n                                    numbers[component.value.name] = component.value;\n                                    writes.push(component);\n                                }\n                                if (component.value.speed.input instanceof Input.MouseMove) {\n                                    snumbers[component.value.name] = component.value.speed;\n                                    swrites.push(component);\n                                }\n                            });\n                            fmt = formatNumbers.js(numbers);\n                            sfmt = formatNumbers.js(snumbers);\n                            writes.forEach(function (component) {\n                                return a('var ' + component.varName + '=' + fmt[component.value.name] + ';');\n                            });\n                            swrites.forEach(function (component) {\n                                return a('var ' + component.varNameSpeed + '=' + sfmt[component.value.name] + ';');\n                            });\n                        };\n                        writeVarLines();\n                        if (!someSpeeds && someValueSliders && !someGamepads) {\n                            a(WrapLines.b(JsLines.bae('function ' + this.updateFnName + '() {'), JsLines.bae('}')).ae(this.getJsUpdateLines(this.makeUpdatedComponentValue())), this.updateFnName + '();');\n                        }\n                        a(getSliderListenerLines(!someSpeeds && !someGamepads));\n                        if (this.components.some(function (component) {\n                                return component.value.input instanceof Input.MouseMove;\n                            })) {\n                            (function () {\n                                if (!someSpeeds && !someValueSliders && !someGamepads) {\n                                    a(_this4.getJsUpdateLines(_this4.makeInitialComponentValue()));\n                                }\n                                var entry = featureContext.canvasMousemoveListener.enter();\n                                _this4.components.forEach(function (component) {\n                                    if (component.value.input instanceof Input.MouseMove) {\n                                        var fmt = formatNumbers.js({\n                                            min: component.value.min,\n                                            max: component.value.max\n                                        }, component.value.precision);\n                                        (!someSpeeds && !someValueSliders && !someGamepads ? entry.minMaxVarFloat : entry.minMaxFloat)(component.value.input, component.varName, fmt.min, fmt.max);\n                                        entry.log('console.log(\\'' + component.name + ' input value:\\',' + component.varName + ');');\n                                        if (!someSpeeds && !someValueSliders && !someGamepads) {\n                                            _this4.addPostToListenerEntryForComponent(entry, component);\n                                        }\n                                    }\n                                });\n                                if (!someSpeeds && !someGamepads) {\n                                    if (!someValueSliders) {\n                                        _this4.addPostToListenerEntryAfterComponents(entry, _this4.makeUpdatedComponentValue());\n                                    } else {\n                                        entry.post(_this4.updateFnName + '();');\n                                    }\n                                }\n                            }());\n                        }\n                        if (this.components.some(function (component) {\n                                return component.value.speed.input instanceof Input.MouseMove;\n                            })) {\n                            (function () {\n                                var entry = featureContext.canvasMousemoveListener.enter();\n                                _this4.components.forEach(function (component) {\n                                    var fmt = formatNumbers.js({\n                                        min: component.value.speed.min,\n                                        max: component.value.speed.max\n                                    }, component.value.speed.precision);\n                                    if (component.value.speed.input instanceof Input.MouseMove) {\n                                        entry.minMaxFloat(component.value.speed.input, component.varNameSpeed, fmt.min, fmt.max).log('console.log(\\'' + component.name + '.speed input value:\\',' + component.varNameSpeed + ');');\n                                    }\n                                });\n                            }());\n                        }\n                        return a.e();\n                    };\n                    Vector.prototype.getJsLoopLines = function getJsLoopLines(featureContext) {\n                        var a = JsLines.ba(_NumericFeature.prototype.getJsLoopLines.call(this, featureContext));\n                        var add = function (s) {\n                            var c = s.charAt(0);\n                            if (c == '-' || c == '+') {\n                                return s;\n                            } else {\n                                return '+' + s;\n                            }\n                        };\n                        var needUpdate = false;\n                        var writeGamepad = function (component, v, dotSuffix, varSuffix) {\n                            if (v.input instanceof Input.Gamepad) {\n                                needUpdate = true;\n                                var fmt = formatNumbers.js({\n                                    min: v.min,\n                                    max: v.max,\n                                    value: v.value\n                                }, v.precision);\n                                a('var ' + component.minVarName + varSuffix + '=' + fmt.min + ';', 'var ' + component.maxVarName + varSuffix + '=' + fmt.max + ';', 'var ' + component.varName + varSuffix + '=' + fmt.value + ';', 'if (gamepad && gamepad.axes.length>' + v.input.axis + ') {', '\\t' + component.varName + varSuffix + '=' + component.minVarName + varSuffix + '+(' + component.maxVarName + varSuffix + '-' + component.minVarName + varSuffix + ')*(gamepad.axes[' + v.input.axis + ']+1)/2;', '}');\n                                if (featureContext && featureContext.debugOptions.inputs) {\n                                    // TODO always pass featureContext\n                                    a('console.log(\\'' + component.name + dotSuffix + ' input value:\\',' + component.varName + varSuffix + ');');\n                                }\n                            }\n                        };\n                        this.components.forEach(function (component) {\n                            var v = component.value;\n                            writeGamepad(component, v, '', '');\n                            writeGamepad(component, v.speed, '.speed', 'Speed');\n                            if (component.hasSpeed()) {\n                                (function () {\n                                    needUpdate = true;\n                                    var addSpeed = undefined;\n                                    if (v.speed.input == 'slider') {\n                                        addSpeed = '+parseFloat(document.getElementById(\\'' + component.name + '.speed\\').value)';\n                                    } else if (v.speed.input instanceof Input.MouseMove || v.speed.input instanceof Input.Gamepad) {\n                                        addSpeed = '+' + component.varNameSpeed;\n                                    } else {\n                                        addSpeed = add(formatNumber.js(v.speed));\n                                    }\n                                    var limitFn = function (x, dx) {\n                                        if (x == component.varName) {\n                                            return dx.charAt(0) + '=' + dx.slice(1);\n                                        } else {\n                                            return '=' + x + dx;\n                                        }\n                                    };\n                                    if (component.wrapped) {\n                                        limitFn = function (x, dx) {\n                                            return '=wrap(' + x + dx + ',' + formatNumber.js(v.max, v.precision) + ')';\n                                        };\n                                    } else if (component.clamped) {\n                                        (function () {\n                                            var fmt = formatNumbers.js({\n                                                min: v.min,\n                                                max: v.max\n                                            }, v.precision);\n                                            limitFn = function (x, dx) {\n                                                return '=clamp(' + x + dx + ',' + fmt.min + ',' + fmt.max + ')';\n                                            };\n                                        }());\n                                    } else if (component.capped) {\n                                        limitFn = function (x, dx) {\n                                            return '=Math.' + (v.speed < 0 ? 'max' : 'min') + '(' + x + dx + ',' + formatNumber.js(v.speed < 0 ? v.min : v.max, v.precision) + ')';\n                                        };\n                                    }\n                                    var incrementLine = function (base, dt) {\n                                        return component.varName + limitFn(base, addSpeed + '*' + dt + '/1000') + ';';\n                                    };\n                                    if (v.input == 'slider') {\n                                        a('var ' + component.varNameInput + '=document.getElementById(\\'' + component.name + '\\');', 'var ' + incrementLine('parseFloat(' + component.varNameInput + '.value)', '(time-prevTime)'), component.varNameInput + '.value=' + component.varName + ';');\n                                    } else if (v.input instanceof Input.MouseMove || v.speed.input != 'constant') {\n                                        a(incrementLine(component.varName, '(time-prevTime)'));\n                                    } else {\n                                        a('var ' + incrementLine(formatNumber.js(v), '(time-startTime)'));\n                                    }\n                                    if (featureContext && featureContext.debugOptions.animations) {\n                                        // TODO always pass featureContext\n                                        a('console.log(\\'' + component.name + ' animation value:\\',' + component.varName + ');');\n                                    }\n                                }());\n                            }\n                        });\n                        if (needUpdate) {\n                            a(this.getJsUpdateLines(this.makeUpdatedComponentValue()));\n                        }\n                        return a.e();\n                    };\n                    babelHelpers.createClass(Vector, [\n                        {\n                            key: 'varName',\n                            get: function () {\n                                // js/glsl var name\n                                return camelCase(this.name);\n                            }\n                        },\n                        {\n                            key: 'updateFnName',\n                            get: function () {\n                                return camelCase('update.' + this.name);\n                            }\n                        }\n                    ]);\n                    return Vector;\n                }(NumericFeature);\n                module.exports = Vector;\n            },\n            {\n                '11': 11,\n                '12': 12,\n                '19': 19,\n                '20': 20,\n                '28': 28,\n                '39': 39,\n                '41': 41,\n                '43': 43,\n                '58': 58,\n                '6': 6\n            }\n        ]\n    }, {}, [42]));\n}());","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict'\r\n\r\nclass ArrayOptionOutput {\r\n\tconstructor(option,writeOption,i18n,generateId) {\r\n\t\tthis.option=option\r\n\t\tthis.$dragged=null\r\n\t\tthis.$entries=$(\"<div>\").append(\r\n\t\t\toption.entries.map(subOption=>this.writeDraggableSubOption(subOption,writeOption,i18n))\r\n\t\t)\r\n\t\tconst $buttons=$(\"<div class='buttons'>\")\r\n\t\toption.availableTypes.forEach((type,i)=>{\r\n\t\t\tif (i) $buttons.append(\" \")\r\n\t\t\t$buttons.append(\r\n\t\t\t\t$(\"<button type='button'>\").html(\r\n\t\t\t\t\ti18n('options.'+option.fullName+'.'+type+'.add')\r\n\t\t\t\t).click(()=>{\r\n\t\t\t\t\t//option.addEntry(type,entry=>this.$entries.append(this.writeDraggableSubOption(entry,writeOption,i18n)))\r\n\t\t\t\t\tthis.$entries.append(\r\n\t\t\t\t\t\tthis.writeDraggableSubOption(option.makeEntry(type),writeOption,i18n)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tthis.updateArrayEntries()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t\tthis.$output=option.$=$(\"<fieldset>\").append(\r\n\t\t\t\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\",\r\n\t\t\tthis.$entries,\r\n\t\t\t$buttons\r\n\t\t)\r\n\t}\r\n\tcanDeleteEntry($entry) {\r\n\t\treturn true\r\n\t}\r\n\tupdateArrayEntries() {\r\n\t\tthis.option.entries=this.$entries.children().map(function(){\r\n\t\t\treturn $(this).data('option')\r\n\t\t}).get()\r\n\t}\r\n\twriteDraggableSubOption(subOption,writeOption,i18n) {\r\n\t\t// have to make drag handler 'draggable', not the whole item\r\n\t\t// because inputs and labels don't like to be inside 'draggable'\r\n\t\t// http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\r\n\t\tconst moveUp=$moved=>{\r\n\t\t\t$moved.prev().before($moved)\r\n\t\t\tthis.updateArrayEntries()\r\n\t\t}\r\n\t\tconst moveDown=$moved=>{\r\n\t\t\t$moved.next().after($moved)\r\n\t\t\tthis.updateArrayEntries()\r\n\t\t}\r\n\t\tconst attemptDelete=$entry=>{\r\n\t\t\tif (this.canDeleteEntry($entry)) {\r\n\t\t\t\t$entry.remove()\r\n\t\t\t\tthis.updateArrayEntries()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst This=this\r\n\t\treturn $(\"<div class='draggable-with-handle'>\").data('option',subOption).append(\r\n\t\t\twriteOption(subOption),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<span draggable='true' tabindex='0' title='\"+i18n('options-output.drag.tip')+\"'>\").append(\r\n\t\t\t\t\"<span>\"+i18n('options-output.drag')+\"</span>\"\r\n\t\t\t).on('dragstart',function(ev){\r\n\t\t\t\tThis.$dragged=$(this).parent()\r\n\t\t\t\tev.originalEvent.dataTransfer.effectAllowed='move'\r\n\t\t\t\tev.originalEvent.dataTransfer.setData('Text',name)\r\n\t\t\t\tif (ev.originalEvent.dataTransfer.setDragImage) { // doesn't work in IE\r\n\t\t\t\t\tev.originalEvent.dataTransfer.setDragImage(This.$dragged[0],0,0)\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\tThis.$dragged.addClass('ghost')\r\n\t\t\t\t},0)\r\n\t\t\t}).on('touchstart',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\t$sorted.addClass('ghost')\r\n\t\t\t\treturn false // disable touch panning on Firefox\r\n\t\t\t}).on('touchmove',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\tconst h=$sorted.height()\r\n\t\t\t\tconst t=$sorted.offset().top\r\n\t\t\t\tconst y=ev.originalEvent.touches[0].pageY // TODO test if length of touches is 1\r\n\t\t\t\tconst $prev=$sorted.prev()\r\n\t\t\t\tif ($prev.length && y<t && y-$prev.offset().top<h) {\r\n\t\t\t\t\tmoveUp($sorted)\r\n\t\t\t\t}\r\n\t\t\t\tconst $next=$sorted.next()\r\n\t\t\t\tif ($next.length && y>t+h && y-$next.offset().top>$next.height()-h) {\r\n\t\t\t\t\tmoveDown($sorted)\r\n\t\t\t\t}\r\n\t\t\t\treturn false // disable touch panning\r\n\t\t\t}).on('touchend touchcancel',function(ev){\r\n\t\t\t\tconst $sorted=$(this).parent()\r\n\t\t\t\t$sorted.removeClass('ghost')\r\n\t\t\t}).keydown(function(ev){\r\n\t\t\t\tconst $handle=$(this)\r\n\t\t\t\tconst $sorted=$handle.parent()\r\n\t\t\t\tif (ev.keyCode==38) {\r\n\t\t\t\t\tmoveUp($sorted)\r\n\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\treturn false\r\n\t\t\t\t} else if (ev.keyCode==40) {\r\n\t\t\t\t\tmoveDown($sorted)\r\n\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button class='delete' title='\"+i18n('options-output.delete.tip')+\"'>\").append(\r\n\t\t\t\t\"<span>\"+i18n('options-output.delete')+\"</span>\"\r\n\t\t\t).click(function(){\r\n\t\t\t\tattemptDelete($(this).parent())\r\n\t\t\t}).keydown(function(ev){\r\n\t\t\t\tif (ev.keyCode==13 || ev.keyCode==32) {\r\n\t\t\t\t\tattemptDelete($(this).parent())\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t).on('dragover',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t\tev.originalEvent.dataTransfer.dropEffect='move'\r\n\t\t\tconst $target=$(this)\r\n\t\t\tif (This.$dragged) {\r\n\t\t\t\tif ($target.next().is(This.$dragged)) {\r\n\t\t\t\t\tconst dh=This.$dragged.height()\r\n\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\tif (y<dh) {\r\n\t\t\t\t\t\tmoveUp(This.$dragged)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ($target.nextAll().is(This.$dragged)) {\r\n\t\t\t\t\tmoveUp(This.$dragged)\r\n\t\t\t\t} else if ($target.prev().is(This.$dragged)) {\r\n\t\t\t\t\tconst th=$target.height()\r\n\t\t\t\t\tconst dh=This.$dragged.height()\r\n\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\tif (y>th-dh) {\r\n\t\t\t\t\t\tmoveDown(This.$dragged)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ($target.prevAll().is(This.$dragged)) {\r\n\t\t\t\t\tmoveDown(This.$dragged)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).on('drop',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t}).on('dragend',function(ev){\r\n\t\t\tev.preventDefault()\r\n\t\t\tif (This.$dragged) {\r\n\t\t\t\tThis.$dragged.removeClass('ghost')\r\n\t\t\t\tThis.$dragged=null\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=ArrayOptionOutput\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='code-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'save': \"Save source code\",\r\n\t\t\t'run': \"Run in new window\",\r\n\t\t\t'open.codepen': \"Open in CodePen\",\r\n\t\t\t'open.jsfiddle': \"Open in JSFiddle\",\r\n\t\t\t'open.plunker': \"Open in Plunker\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"embedded in HTML source code\",\r\n\t\t\t'mode.full': \"complete HTML\",\r\n\t\t\t'mode.body': \"only HTML body\",\r\n\t\t\t'mode.embed': \"embed in HTML\",\r\n\t\t\t'mode.paste': \"extract to paste into HTML later\",\r\n\t\t\t'mode.file': \"extract to load as external resource\",\r\n\t\t\t'formatting': \"Formatting\",\r\n\t\t\t'formatting.indent': \"indent with tabs\",\r\n\t\t\t'formatting.indentNumber': \"spaces per indent\",\r\n\t\t\t'formatting.jsSemicolons': \"JavaScript semicolons\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (hosted on <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) is not loaded. Syntax highlighting is disabled.\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'save': \"Сохранить исходный код\",\r\n\t\t\t'run': \"Запустить в новом окне\",\r\n\t\t\t'open.codepen': \"Открыть в CodePen\",\r\n\t\t\t'open.jsfiddle': \"Открыть в JSFiddle\",\r\n\t\t\t'open.plunker': \"Открыть в Plunker\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"встроен в код HTML\",\r\n\t\t\t'mode.full': \"полностью\",\r\n\t\t\t'mode.body': \"только <code>body</code>\",\r\n\t\t\t'mode.embed': \"встроить в HTML\",\r\n\t\t\t'mode.paste': \"извлечь для последующей вставки в HTML\",\r\n\t\t\t'mode.file': \"извлечь для загрузки в качестве внешнего ресурса\",\r\n\t\t\t'formatting': \"Форматирование\",\r\n\t\t\t'formatting.indent': \"отступы с помощью tab\",\r\n\t\t\t'formatting.indentNumber': \"пробелов в отступе\",\r\n\t\t\t'formatting.jsSemicolons': \"<code>;</code> в JavaScript\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (с сервера <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) не загружен. Подсветка синтаксиса отключена.\",\r\n\t\t},\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst debounce=require('./fake-lodash/debounce')\r\nconst repeat=require('./fake-lodash/repeat')\r\nconst detailsPolyfill=require('./details-polyfill')\r\n\r\nconst getHtmlDataUri=(html)=>'data:text/html;charset=utf-8,'+encodeURIComponent(html)\r\n\r\nconst makeObjectWithSetters=(values,setCallback)=>{\r\n\tconst obj={}\r\n\tfor (let prop in values) {\r\n\t\tObject.defineProperty(obj,prop,{\r\n\t\t\tget: ()=>values[prop],\r\n\t\t\tset: v=>{\r\n\t\t\t\tvalues[prop]=v\r\n\t\t\t\tsetCallback()\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\treturn obj\r\n}\r\n\r\nclass CodeOutput {\r\n\tconstructor(generateCode,i18n) {\r\n\t\tthis.formatting=makeObjectWithSetters(\r\n\t\t\tthis.defaultFormatting,\r\n\t\t\t()=>{\r\n\t\t\t\tthis.update.flush()\r\n\t\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t\t}\r\n\t\t)\r\n\t\tthis.sectionModes=makeObjectWithSetters(\r\n\t\t\t{html:'full',css:'embed',js:'embed'},\r\n\t\t\t()=>{\r\n\t\t\t\tthis.update.flush()\r\n\t\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t\t}\r\n\t\t)\r\n\t\tthis._code=generateCode()\r\n\t\tthis.update=debounce(()=>{\r\n\t\t\tthis._code=generateCode()\r\n\t\t\tthis.applyUpdatedCode(i18n)\r\n\t\t},200)\r\n\r\n\t\tthis.initDomProps()\r\n\t\tconst writeFormattingControls=()=>{\r\n\t\t\tconst This=this\r\n\t\t\tlet $indentCheckbox,$indentNumber\r\n\t\t\tconst updateIndent=()=>{\r\n\t\t\t\tlet indent='\\t'\r\n\t\t\t\tif (!$indentCheckbox.prop('checked')) {\r\n\t\t\t\t\tlet n=4\r\n\t\t\t\t\tif ($indentNumber[0].checkValidity()) {\r\n\t\t\t\t\t\tn=Number($indentNumber.val())\r\n\t\t\t\t\t}\r\n\t\t\t\t\tindent=repeat(' ',n)\r\n\t\t\t\t}\r\n\t\t\t\tthis.formatting.indent=indent\r\n\t\t\t}\r\n\t\t\treturn $(\"<details>\").append(\r\n\t\t\t\t\"<summary>\"+i18n('code-output.formatting')+\"</summary>\",\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentCheckbox=$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t.prop('checked',this.formatting.indent=='\\t')\r\n\t\t\t\t\t\t\t.change(updateIndent),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indent')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentNumber=$(\"<input type='number' min='0' max='32' required>\")\r\n\t\t\t\t\t\t\t.val(this.formatting.indent=='\\t'?4:this.formatting.indent.length)\r\n\t\t\t\t\t\t\t.on('input change',updateIndent),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indentNumber')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t.prop('checked',this.formatting.jsSemicolons)\r\n\t\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\t\tThis.formatting.jsSemicolons=this.checked\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.jsSemicolons')\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t).each(detailsPolyfill)\r\n\t\t}\r\n\t\tconst writeSection=(sectionName)=>{\r\n\t\t\treturn $(\"<details open>\").append(\r\n\t\t\t\tthis.writeSectionSummary(sectionName,i18n),\r\n\t\t\t\tthis.$sectionCode[sectionName]=$(\"<div class='code'>\")\r\n\t\t\t).each(detailsPolyfill)\r\n\t\t}\r\n\t\tconst $output=$(\"<div class='code-output'>\").append(this.writeButtons(i18n)).append(\r\n\t\t\twriteFormattingControls(),\r\n\t\t\twriteSection('html'),\r\n\t\t\twriteSection('css'),\r\n\t\t\twriteSection('js')\r\n\t\t)\r\n\t\tif (!window.hljs) {\r\n\t\t\t$output.append(\"<p>\"+i18n('code-output.warning.no-hljs')+\"</p>\")\r\n\t\t}\r\n\t\t$output.append(this.writeButtons(i18n))\r\n\t\tthis.applyUpdatedCode(i18n)\r\n\r\n\t\t// public interface:\r\n\t\t// this.update\r\n\t\tthis.$output=$output\r\n\t}\r\n\r\n\t// private interface:\r\n\tget code() {\r\n\t\tthis.update.flush()\r\n\t\treturn this._code\r\n\t}\r\n\r\n\t// extend/override fns:\r\n\tget defaultFormatting() {\r\n\t\treturn {\r\n\t\t\tindent: '\\t',\r\n\t\t\tjsSemicolons: false,\r\n\t\t}\r\n\t}\r\n\tinitDomProps() {\r\n\t\tthis.$sectionCode={}\r\n\t\tthis.$saveButtons={}\r\n\t}\r\n\tapplyUpdatedCode(i18n) { // TODO pass code to avoid recursion on accessing this.code... or not b/c reading this.sectionModes and like\r\n\t\tconst sections=this.code.extractSections(this.sectionModes)\r\n\t\tfor (let sectionName in sections) {\r\n\t\t\tif (this.sectionModes[sectionName]=='embed') {\r\n\t\t\t\tthis.$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\"<p>\"+i18n('code-output.embedded')+\"</p>\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tlet $code\r\n\t\t\t\tthis.$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t$(\"<pre>\").append(\r\n\t\t\t\t\t\t$code=$(\"<code class='\"+sectionName+\"'>\")\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\t$code.html(\r\n\t\t\t\t\tsections[sectionName].getHtml(this.formatting).join(\"\\n\")\r\n\t\t\t\t)\r\n\t\t\t\tif (window.hljs) {\r\n\t\t\t\t\thljs.highlightBlock($code[0])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (sectionName!='html') { // extractable section\r\n\t\t\t\tthis.$saveButtons[sectionName].prop('disabled',this.sectionModes[sectionName]=='embed')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\twriteButtons(i18n) {\r\n\t\tconst This=this\r\n\t\tconst postData=(url,target,data)=>{\r\n\t\t\tconst $form=$(`<form method='post' action='${url}' target='${target}'>`)\r\n\t\t\tfor (let name in data) {\r\n\t\t\t\t$form.append(\r\n\t\t\t\t\t$(\"<input type='hidden'>\").attr('name',name).val(data[name])\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t$form.appendTo('body').submit().remove()\r\n\t\t}\r\n\t\treturn $(\"<div>\").append(\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.run')+\"</button>\").click(function(){\r\n\t\t\t\tconst html=This.code.get(This.formatting).join(\"\\n\")\r\n\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * Firefox and Chrome have trouble showing the source\r\n\t\t\t\t\t// * weird bug in Firefox:\r\n\t\t\t\t\t//   in webgl-starter: add z-rotation, slider input, add speed, slider input, run, change rotation range, run again\r\n\t\t\t\t\t// * Firefox shows url of a generator page\r\n\t\t\t\t\tconst w=window.open(\"\",\"generatedCode\")\r\n\t\t\t\t\tw.document.open()\r\n\t\t\t\t\tw.document.write(html)\r\n\t\t\t\t\tw.document.close()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * doesn't work in IE b/c they decided it's security risk\r\n\t\t\t\t\t// * long url\r\n\t\t\t\t\twindow.open(getHtmlDataUri(html),\"generatedCode\")\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.codepen')+\"</button>\").click(function(){\r\n\t\t\t\t// http://blog.codepen.io/documentation/api/prefill/\r\n\t\t\t\tconst sections=This.code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://codepen.io/pen/define/','codepenGeneratedCode',{\r\n\t\t\t\t\tdata: JSON.stringify({\r\n\t\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\t\ttitle: This.code.title, // doesn't work?\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.jsfiddle')+\"</button>\").click(function(){\r\n\t\t\t\t// http://doc.jsfiddle.net/api/post.html\r\n\t\t\t\tconst sections=This.code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://jsfiddle.net/api/post/library/pure/','jsfiddleGeneratedCode',{\r\n\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\ttitle: This.code.title,\r\n\t\t\t\t\twrap: 'b',\r\n\t\t\t\t})\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.plunker')+\"</button>\").click(function(){\r\n\t\t\t\t// https://github.com/angular/angular.js/blob/489835dd0b36a108bedd5ded439a186aca4fa739/docs/app/src/examples.js#L139-L157\r\n\t\t\t\tconst sections=This.code.extractSections({html:'full',css:'file',js:'file'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(This.formatting).join(\"\\n\")\r\n\t\t\t\tpostData('http://plnkr.co/edit/?p=preview','plunkerGeneratedCode',{\r\n\t\t\t\t\t//['files['+sections['html'].filename+']']: getSection('html'), // wants index.html\r\n\t\t\t\t\t['files[index.html]']: getSection('html'),\r\n\t\t\t\t\t['files['+sections['css'].filename+']']: getSection('css'),\r\n\t\t\t\t\t['files['+sections['js'].filename+']']: getSection('js'),\r\n\t\t\t\t\t'private': true,\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t)\r\n\t}\r\n\twriteSectionSummary(sectionName,i18n) {\r\n\t\tconst This=this\r\n\t\tconst $summary=$(\"<summary>\"+i18n('code-output.section.'+sectionName)+\"</summary>\")\r\n\t\t$summary.append(\r\n\t\t\t\" \",\r\n\t\t\t$(\"<select>\").append(\r\n\t\t\t\t(sectionName=='html'\r\n\t\t\t\t\t? ['full','body']\r\n\t\t\t\t\t: ['embed','paste','file']\r\n\t\t\t\t).map(mode=>\r\n\t\t\t\t\t$(\"<option>\").val(mode).html(i18n('code-output.mode.'+mode))\r\n\t\t\t\t)\r\n\t\t\t).val(this.sectionModes[sectionName]).change(function(){\r\n\t\t\t\tThis.sectionModes[sectionName]=this.value\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t// doesn't work in IE\r\n\t\t\t//$(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n\t\t\t//\t// yes I want a button, but download attr is only available for links\r\n\t\t\t//\t$(this).attr('href',getHtmlDataUri(\r\n\t\t\t//\t\tsection.get(this.formatting).join(\"\\n\")\r\n\t\t\t//\t))\r\n\t\t\t//})\r\n\t\t\tthis.$saveButtons[sectionName]=$(\"<button type='button'>\"+i18n('code-output.save')+\"</button>\").click(function(){\r\n\t\t\t\tconst section=This.code.extractSections(This.sectionModes)[sectionName]\r\n\t\t\t\t// http://stackoverflow.com/a/24354303\r\n\t\t\t\tconst blob=new Blob(\r\n\t\t\t\t\t[section.get(This.formatting).join(\"\\n\")],\r\n\t\t\t\t\t{type:section.mimeType}\r\n\t\t\t\t)\r\n\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob,section.filename)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst $a=$(\"<a>\")\r\n\t\t\t\t\t\t.attr('download',section.filename)\r\n\t\t\t\t\t\t.attr('href',URL.createObjectURL(blob))\r\n\t\t\t\t\t\t.appendTo('body')\r\n\t\t\t\t\t$a.get(0).click()\r\n\t\t\t\t\t$a.remove()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t)\r\n\t\treturn $summary\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput\r\n","'use strict'\r\n\r\nclass CodeSection {\r\n\tconstructor(filename,mimeType,lines) {\r\n\t\tthis.filename=filename\r\n\t\tthis.mimeType=mimeType\r\n\t\tthis.lines=lines\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.lines.get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.lines.getHtml(formatting)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeSection\r\n","'use strict'\r\n\r\nconst detailsSupported=('open' in document.createElement('details')) // http://thenewcode.com/680/Feature-Detection-and-Styling-For-The-HTML5-details-Element\r\n\r\nmodule.exports=function(){ // to be called in .each()\r\n\tif (detailsSupported) return\r\n\tconst $details=$(this)\r\n\tconst toggleOpen=()=>{\r\n\t\tif (!$details.attr('open')) {\r\n\t\t\t$details.attr('open','')\r\n\t\t} else {\r\n\t\t\t$details.removeAttr('open')\r\n\t\t}\r\n\t}\r\n\tconst keyCodeEnter=13\r\n\tconst keyCodeSpace=32\r\n\tconst handleEvent=ev=>$(ev.target).closest('summary, :input, a[href]').is('summary') // check if event target is not an input/link, also check its ancestors (jQuery doesn't include <option> in :input selector)\r\n\t$details.addClass('polyfill').children('summary').attr('tabindex',0).click(function(ev){\r\n\t\tif (handleEvent(ev)) {\r\n\t\t\ttoggleOpen()\r\n\t\t}\r\n\t}).keydown(function(ev){\r\n\t\tif (handleEvent(ev) && (ev.keyCode==keyCodeEnter || ev.keyCode==keyCodeSpace)) {\r\n\t\t\ttoggleOpen()\r\n\t\t\treturn false\r\n\t\t}\r\n\t})\r\n}\r\n","// assumes string is dot-separated, like this: \"some.html.id\"\r\nvar capitalize=require('./capitalize')\r\nmodule.exports=function(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('')\r\n}\r\n","// assumes string is lowercase\r\nmodule.exports=function(s){\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1)\r\n}\r\n","// no options\r\nmodule.exports=function(func,wait){\r\n\tvar timeoutId=null\r\n\tvar debounced=function(){\r\n\t\tclearTimeout(timeoutId)\r\n\t\ttimeoutId=setTimeout(function(){\r\n\t\t\ttimeoutId=null\r\n\t\t\tfunc()\r\n\t\t},wait)\r\n\t}\r\n\tdebounced.flush=function(){\r\n\t\tif (timeoutId) {\r\n\t\t\ttimeoutId=null\r\n\t\t\tfunc()\r\n\t\t}\r\n\t}\r\n\treturn debounced\r\n}\r\n","module.exports=function(s){\r\n\tvar entityMap={\r\n\t\t'&': '&amp;',\r\n\t\t'<': '&lt;',\r\n\t\t'>': '&gt;',\r\n\t\t'\"': '&quot;',\r\n\t\t\"'\": '&#39;',\r\n\t\t// lodash also escapes `\r\n\t}\r\n\treturn String(s).replace(/[&<>\"']/g,m=>entityMap[m])\r\n}\r\n","module.exports=function(s,n){\r\n\treturn Array(n+1).join(s)\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbers=require('./format-numbers')\r\n\r\nconst formatNumber=(number,precision)=>formatNumbers     ([number],precision)[0]\r\nformatNumber.html =(number,precision)=>formatNumbers.html([number],precision)[0]\r\nformatNumber.js   =(number,precision)=>formatNumbers.js  ([number],precision)[0]\r\nformatNumber.glsl =(number,precision)=>formatNumbers.glsl([number],precision)[0]\r\n\r\nmodule.exports=formatNumber\r\n","'use strict'\r\n\r\nconst formatNumbersInternal=(numbers,precision,keepDot,noPlus)=>{\r\n\tlet maxPrecision=0\r\n\tif (keepDot) {\r\n\t\tmaxPrecision=1\r\n\t}\r\n\tlet hasNegative=false\r\n\tfor (let i in numbers) {\r\n\t\tlet p\r\n\t\tif (precision!==undefined) {\r\n\t\t\tp=precision\r\n\t\t} else if (numbers[i].precision!==undefined) {\r\n\t\t\tp=numbers[i].precision\r\n\t\t} else {\r\n\t\t\tthrow new Error('formatNumbers received no precision')\r\n\t\t}\r\n\t\tconst number=Number(numbers[i])\r\n\t\tlet s=number.toFixed(p)\r\n\t\tif (Number(s)<0) { // protects against negative zero\r\n\t\t\thasNegative=true\r\n\t\t}\r\n\t\tif (p>0) {\r\n\t\t\tp-=s.match(/0*$/)[0].length\r\n\t\t}\r\n\t\tif (p>maxPrecision) {\r\n\t\t\tmaxPrecision=p\r\n\t\t}\r\n\t}\r\n\tconst ss=Array.isArray(numbers)?[]:{}\r\n\tfor (let i in numbers) {\r\n\t\tconst number=Number(numbers[i])\r\n\t\tlet s=number.toFixed(maxPrecision)\r\n\t\tif (Number(s)>=0 && s.charAt(0)=='-') {  // protects against negative zero\r\n\t\t\ts=s.slice(1)\r\n\t\t}\r\n\t\tif (!noPlus && hasNegative && number>0) {\r\n\t\t\ts='+'+s\r\n\t\t}\r\n\t\tss[i]=s\r\n\t}\r\n\treturn ss\r\n}\r\n\r\nconst formatNumbers=(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.html =(number,precision)=>formatNumbersInternal(number,precision,false,true)\r\nformatNumbers.js   =(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.glsl =(number,precision)=>formatNumbersInternal(number,precision,true)\r\n\r\nmodule.exports=formatNumbers\r\n","'use strict'\r\n\r\nclass GroupOptionOutput {\r\n\tconstructor(option,writeOption,i18n,generateId) {\r\n\t\tthis.option=option\r\n\t\tthis.$output=option.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\toption.entries.map(writeOption)\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=GroupOptionOutput\r\n","'use strict'\r\n\r\nmodule.exports=function(inStrings){\r\n\tconst strings={}\r\n\tconst expandRegexp=/^([^{]*)\\{([^}]*)\\}(.*)$/\r\n\tfunction expandIdAndString(id,string) {\r\n\t\tlet match\r\n\t\tif (match=expandRegexp.exec(id)) {\r\n\t\t\tconst idStart=match[1]\r\n\t\t\tconst idMids=match[2].split(',')\r\n\t\t\tconst idEnd=match[3]\r\n\t\t\tif (match=expandRegexp.exec(string)) {\r\n\t\t\t\tconst stringStart=match[1]\r\n\t\t\t\tconst stringMidsStr=match[2]\r\n\t\t\t\tconst stringMids=stringMidsStr.split(',')\r\n\t\t\t\tconst stringEnd=match[3]\r\n\t\t\t\tidMids.forEach((idMid,i)=>{\r\n\t\t\t\t\tconst stringMid=stringMids[i]\r\n\t\t\t\t\tif (stringMidsStr!='') {\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+stringMid+stringEnd)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+idMid+stringEnd)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tidMids.forEach(idMid=>{\r\n\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,string)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tstrings[id]=string\r\n\t\t}\r\n\t}\r\n\tfor (let id in inStrings) {\r\n\t\texpandIdAndString(id,inStrings[id])\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tfor (let id in strings) {\r\n\t\tstrings[id]=strings[id].replace(/\\[\\[(.*?)\\]\\]/g,(match,p1)=>{\r\n\t\t\tlet link,text;\r\n\t\t\tconst i=p1.indexOf('|');\r\n\t\t\tif (i<0) {\r\n\t\t\t\tlink=p1;\r\n\t\t\t\ttext=p1;\r\n\t\t\t} else {\r\n\t\t\t\tlink=p1.slice(0,i);\r\n\t\t\t\ttext=p1.slice(i+1);\r\n\t\t\t}\r\n\t\t\treturn \"<a href='https://\"+lang+\".wikipedia.org/wiki/\"+link.replace(/ /g,'_')+\"'>\"+text+\"</a>\";\r\n\t\t});\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\n\r\nmodule.exports=langStrings=>lang=>{\r\n\tconst defaultLang='en'\r\n\tlang=lang||defaultLang\r\n\tlang=lang.split('-')[0]  // get primary language subtag\r\n\tlet strings=langStrings[lang]\r\n\tif (strings===undefined) {\r\n\t\tlang=defaultLang\r\n\t\tstrings=langStrings[lang]\r\n\t}\r\n\tconst i18n=function(id){\r\n\t\tif (strings[id]!==undefined) {\r\n\t\t\treturn strings[id]\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"undefined string \"+id)\r\n\t\t}\r\n\t}\r\n\ti18n.lang=lang\r\n\ti18n.has=id=>strings[id]!==undefined\r\n\tif (lang=='en') {\r\n\t\ti18n.number=function(n){\r\n\t\t\treturn String(n).replace('-','−')\r\n\t\t}\r\n\t\ti18n.pluralSuffix=function(n){\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns.indexOf('.')<0) {\r\n\t\t\t\tconst nn=Number(n)\r\n\t\t\t\tif (Math.abs(nn)==1) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn '2'\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (lang=='ru') {\r\n\t\ti18n.number=function(n){\r\n\t\t\treturn String(n).replace('-','−').replace('.',',')\r\n\t\t}\r\n\t\ti18n.pluralSuffix=function(n){\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns.indexOf('.')<0) {\r\n\t\t\t\tconst teen=ns.slice(-2,-1)==='1'\r\n\t\t\t\tif (ns.slice(-1)==='1' && !teen) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else if ('234'.indexOf(ns.slice(-1))>=0 && !teen) {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '5'\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn '2'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\ti18n.plural=function(n,id){\r\n\t\treturn this(id+'.'+this.pluralSuffix(n))\r\n\t}\r\n\ti18n.numberWithUnits=function(n,unit,abbrFn){\r\n\t\tif (abbrFn===undefined) { // codegen needs its own fn\r\n\t\t\tabbrFn=(abbr,expansion)=>\"<abbr title='\"+escape(expansion)+\"'>\"+abbr+\"</abbr>\" // expansion is html for stuff like s^(-1)\r\n\t\t}\r\n\t\tlet s=this.number(n)\r\n\t\tif (unit!==undefined) {\r\n\t\t\tif (unit.length==1 && /^\\W/.test(unit)) {\r\n\t\t\t\ts+=unit\r\n\t\t\t} else {\r\n\t\t\t\ts+=' ' // nbsp\r\n\t\t\t\tlet abbr\r\n\t\t\t\tif (unit=='1/second') {\r\n\t\t\t\t\tabbr=i18n('units.second.a')+\"<sup>−1</sup>\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tabbr=i18n('units.'+unit+'.a')\r\n\t\t\t\t}\r\n\t\t\t\tconst expansion=this.plural(n,'units.'+unit)\r\n\t\t\t\ts+=abbrFn(abbr,expansion)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn s\r\n\t}\r\n\treturn i18n\r\n}\r\n","'use strict'\r\n\r\nconst repeat=require('./fake-lodash/repeat')\r\nconst Lines=require('./lines')\r\n\r\nclass IndentLines extends Lines {\r\n\tconstructor(data,level) {\r\n\t\tsuper(data)\r\n\t\tif (level!==undefined) {\r\n\t\t\tthis.level=level\r\n\t\t} else {\r\n\t\t\tthis.level=1\r\n\t\t}\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst indentStr=repeat(indent,this.level)\r\n\t\treturn super.doGet(formatting,html).map(s=>indentStr+s)\r\n\t}\r\n}\r\n\r\nmodule.exports=IndentLines\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass InterleaveLines extends Lines {\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet first=true\r\n\t\tconst fp=()=>{\r\n\t\t\tif (first) {\r\n\t\t\t\tfirst=false\r\n\t\t\t} else {\r\n\t\t\t\tout.push('')\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (subOut.length>0) {\r\n\t\t\t\t\tfp()\r\n\t\t\t\t\tout.push(...subOut)\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tfp()\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=InterleaveLines\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\n\r\nclass JsLines extends Lines {\r\n\tprocessStringInGet(s,formatting) {\r\n\t\tif (formatting.jsSemicolons) {\r\n\t\t\treturn s.replace(/^;/,'')\r\n\t\t} else {\r\n\t\t\treturn s.replace(/;$/,'')\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=JsLines\r\n","'use strict'\r\n\r\n/*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst repeat=require('./fake-lodash/repeat')\r\n\r\nconst TO={} // TODO Symbol\r\n\r\nclass Lines {\r\n\t// lines private interface:\r\n\tconstructor(data) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError(\"attempted to construct Lines with non-array data argument\")\r\n\t\t}\r\n\t\tthis.data=data\r\n\t}\r\n\tisDataEmpty() {\r\n\t\tfor (let i=0;i<this.data.length;i++) {\r\n\t\t\tconst item=this.data[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tif (!item.isEmpty()) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\tprocessStringInGet(s,formatting) {\r\n\t\treturn s\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet addTo=false\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item===TO) {\r\n\t\t\t\taddTo=true\r\n\t\t\t} else if (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (addTo && subOut.length>0) {\r\n\t\t\t\t\tout.push(out.pop()+subOut.shift())\r\n\t\t\t\t}\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t\taddTo=false\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tlet s=this.processStringInGet(item,formatting)\r\n\t\t\t\tif (formatting.indent!==undefined && formatting.indent!='\\t') {\r\n\t\t\t\t\ts=s.replace(/^(\\t)+/,match=>repeat(formatting.indent,match.length))\r\n\t\t\t\t}\r\n\t\t\t\ts=(html ? escape(s) : s)\r\n\t\t\t\tif (addTo) {\r\n\t\t\t\t\tout.push(out.pop()+s)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout.push(s)\r\n\t\t\t\t}\r\n\t\t\t\taddTo=false\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n\r\n\t// lines public interface:\r\n\tstatic b() {\r\n\t\tconst data=[]\r\n\t\tconst makeLines=()=>new this(data,...arguments)\r\n\t\tconst a=function(){\r\n\t\t\treturn a.a(...arguments)\r\n\t\t}\r\n\t\ta.a=function(){\r\n\t\t\tdata.push(...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.t=function(){\r\n\t\t\tdata.push(TO,...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.e=makeLines\r\n\t\ta.ae=function(){\r\n\t\t\treturn this.a(...arguments).e()\r\n\t\t}\r\n\t\treturn a\r\n\t}\r\n\tstatic ba() {\r\n\t\treturn this.b().a(...arguments)\r\n\t}\r\n\tstatic be() {\r\n\t\treturn this.b().e()\r\n\t}\r\n\tstatic bae() {\r\n\t\treturn this.b().a(...arguments).e()\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tget(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,false)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,true)\r\n\t}\r\n\tcount() {\r\n\t\treturn this.doGet({},false).length // can be faster b/c don't need to output stuff\r\n\t}\r\n\r\n\t// TODO make HtmlLines\r\n\tstatic html(strings/*,...values*/) {\r\n\t\t// html template tag\r\n\t\t// usage example for attributes: Lines.html`<input type=text value=${value}>`\r\n\t\t// usage example for elements: Lines.html`<option>${option}</option>`\r\n\t\treturn strings.reduce((r,s,i)=>{\r\n\t\t\tlet v=arguments[i]\r\n\t\t\tswitch (r.slice(-1)) {\r\n\t\t\tcase '=':\r\n\t\t\t\tif (v===false) {\r\n\t\t\t\t\treturn r.replace(/\\s+[a-zA-Z0-9-]+=$/,'')+s // TODO more permitting attr name regexp\r\n\t\t\t\t} else if (v===true) {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t}\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;')\r\n\t\t\t\tif (v=='') {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t} else if (!/[\\s\"'=<>`]/.test(v)) {\r\n\t\t\t\t\treturn r+v+s\r\n\t\t\t\t} else if (!/'/.test(v)) {\r\n\t\t\t\t\treturn r+\"'\"+v+\"'\"+s\r\n\t\t\t\t} else {\r\n\t\t\t\t\tv=v.replace(/\"/g,'&quot;')\r\n\t\t\t\t\treturn r+'\"'+v+'\"'+s\r\n\t\t\t\t}\r\n\t\t\tcase '>':\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;').replace(/</g,'&lt;')\r\n\t\t\t\treturn r+v+s\r\n\t\t\t}\r\n\t\t\tthrow new Error(\"invalid character before substitution\")\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=Lines\r\n","'use strict'\r\n\r\nconst WrapLines=require('./wrap-lines')\r\n\r\nclass NoseWrapLines extends WrapLines {\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tif (this.isEmpty()) {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\treturn super.doGet(formatting,html)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=NoseWrapLines\r\n","'use strict'\r\n\r\n/*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\r\n\r\nconst Option={}\r\n\r\n// abstract classes\r\n\r\nOption.Base = class {\r\n\tstatic make(name) {\r\n\t\tlet nScalars=0, nArrays=0, nObjects=0\r\n\t\tlet scalarArg, arrayArg=[], objectArg={}\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tlet arg=arguments[i]\r\n\t\t\tif (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\r\n\t\t\t\tif (nScalars++==0) scalarArg=arg\r\n\t\t\t} else if (Array.isArray(arg)) {\r\n\t\t\t\tif (nArrays++==0) arrayArg=arg\r\n\t\t\t} else if (arg instanceof Object) {\r\n\t\t\t\tif (nObjects++==0) objectArg=arg\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst optionClass=this\r\n\t\tconst settings=this.collectArgs(scalarArg,arrayArg,objectArg)\r\n\t\treturn function(data,parent,visibilityManager,makeEntry){\r\n\t\t\treturn new optionClass(name,settings,data,parent,visibilityManager,makeEntry)\r\n\t\t}\r\n\t}\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn settings\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tthis.parent=parent\r\n\t\tthis.name=name\r\n\t\tthis.fullName=name\r\n\t\tif (parent && parent.fullName!==null) {\r\n\t\t\tthis.fullName=parent.fullName+'.'+name\r\n\t\t}\r\n\t\tthis.updateCallbacks=[]\r\n\t\tthis._$=null\r\n\t\t// visibility and callbacks\r\n\t\tthis.isVisible=()=>true\r\n\t\tif (visibilityManager) {\r\n\t\t\tvisibilityManager.register(this)\r\n\t\t\tif (settings.visibilityData!==undefined) {\r\n\t\t\t\tif (settings.visibilityDataLogic!='or') {\r\n\t\t\t\t\tthis.isVisible=()=>{\r\n\t\t\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\t\t\tconst value=visibilityManager.options[testName].value\r\n\t\t\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)<0) {\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isVisible=()=>{\r\n\t\t\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\t\t\tconst value=visibilityManager.options[testName].value\r\n\t\t\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)>=0) {\r\n\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\tvisibilityManager.declareAffectedBy(this,testName)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $() {\r\n\t\treturn this._$\r\n\t}\r\n\tset $($) {\r\n\t\tthis._$=$\r\n\t\tthis.updateVisibility()\r\n\t}\r\n\tupdateVisibility() {\r\n\t\tif (this.$) this.$.toggle(this.isVisible())\r\n\t}\r\n\tupdate() {\r\n\t\tthis.updateCallbacks.forEach(updateCallback=>{\r\n\t\t\tupdateCallback()\r\n\t\t})\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.update()\r\n\t\t}\r\n\t}\r\n\taddUpdateCallback(updateCallback) {\r\n\t\tthis.updateCallbacks.push(updateCallback)\r\n\t}\r\n\tshortenExport(data) { // used by parent\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\treturn data.value\r\n\t\t} else {\r\n\t\t\treturn data\r\n\t\t}\r\n\t}\r\n\tshortenExportAssign(data,parentData,name) {\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\tparentData[name]=data.value\r\n\t\t} else if (dataKeys.length>0) {\r\n\t\t\tparentData[name]=data\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Input = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.defaultValue===undefined) settings.defaultValue=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.defaultValue=settings.defaultValue\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdata=data.value\r\n\t\t}\r\n\t\tif (data!==undefined) {\r\n\t\t\tthis._value=data\r\n\t\t} else {\r\n\t\t\tthis._value=this.defaultValue\r\n\t\t}\r\n\t}\r\n\tget value() {\r\n\t\treturn this._value\r\n\t}\r\n\tset value(value) {\r\n\t\tthis._value=value\r\n\t\tthis.update()\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value\r\n\t\treturn data\r\n\t}\r\n}\r\n\r\nOption.Boolean = class extends Option.Input {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn super.collectArgs(!!scalarArg,arrayArg,settings)\r\n\t}\r\n\tfix() {\r\n\t\treturn this.value\r\n\t}\r\n}\r\n\r\nOption.NonBoolean = class extends Option.Input {\r\n\tfix() {\r\n\t\tconst value=this.value\r\n\t\treturn { // can't use fixed value in boolean context\r\n\t\t\tname: this.name,\r\n\t\t\tvalue,\r\n\t\t\tvalueOf() { return value },\r\n\t\t\ttoString() { return String(value) },\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Factor = class extends Option.NonBoolean {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableValues===undefined) settings.availableValues=arrayArg\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableValues[0]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableValues=settings.availableValues\r\n\t}\r\n}\r\n\r\nOption.Number = class extends Option.NonBoolean { // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableMin===undefined) settings.availableMin=arrayArg[0]\r\n\t\tif (settings.availableMax===undefined) settings.availableMax=arrayArg[1]\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableMin\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableMin=settings.availableMin\r\n\t\tthis.availableMax=settings.availableMax\r\n\t\tthis.unit=settings.unit\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tfixed.precision=this.precision\r\n\t\tfixed.unit=this.unit\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.Collection = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.entries=settings.descriptions.map(x=>{\r\n\t\t\tconst subName=x[1]\r\n\t\t\tlet subData\r\n\t\t\tif (typeof data == 'object') subData=data[subName]\r\n\t\t\treturn makeEntry(x,subData,this,visibilityManager) // nested option\r\n\t\t})\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tentry.shortenExportAssign(entry.export(),data,entry.name)\r\n\t\t})\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixedEntries=[]\r\n\t\tconst fixed={\r\n\t\t\tname: this.name,\r\n\t\t\tentries: fixedEntries,\r\n\t\t}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tfixedEntries.push(fixed[entry.name]=entry.fix())\r\n\t\t})\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.Void = class extends Option.Base { // useful as array entry w/o settings\r\n\texport() {\r\n\t\treturn {}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Checkbox = class extends Option.Boolean {}\r\n\r\nOption.Select = class extends Option.Factor {}\r\n\r\nOption.Text = class extends Option.Factor {}\r\n\r\nOption.Int = class extends Option.Number {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n}\r\n\r\nOption.Float = class extends Option.Number {\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Root = class extends Option.Collection {}\r\n\r\nOption.Group = class extends Option.Collection {}\r\n\r\nOption.Array = class extends Option.Base { // TODO consider extending Collection\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\tif (settings.typePropertyName===undefined) settings.typePropertyName=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableConstructors=new Map\r\n\t\tif (visibilityManager) visibilityManager.enterArray()\r\n\t\tsettings.descriptions.forEach(x=>{ // TODO test array inside array\r\n\t\t\tconst type=x[1]\r\n\t\t\tconst ctor=subData=>makeEntry(x,subData,this,visibilityManager)\r\n\t\t\tthis.availableConstructors.set(type,ctor)\r\n\t\t})\r\n\t\tif (visibilityManager) visibilityManager.exitArray()\r\n\t\tif (settings.typePropertyName!==undefined) {\r\n\t\t\tthis.typePropertyName=settings.typePropertyName\r\n\t\t} else {\r\n\t\t\tthis.typePropertyName='type'\r\n\t\t}\r\n\t\t// populate array entries from data:\r\n\t\tthis._entries=[]\r\n\t\tlet subDatas=[]\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tsubDatas=data\r\n\t\t} else if (typeof data == 'object') {\r\n\t\t\tsubDatas=data.value\r\n\t\t}\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\tfor (let i=0;i<subDatas.length;i++) {\r\n\t\t\tconst subData=subDatas[i]\r\n\t\t\tlet subType=defaultType\r\n\t\t\tif (typeof subData == 'object' && subData[this.typePropertyName]!==undefined) {\r\n\t\t\t\tsubType=subData[this.typePropertyName]\r\n\t\t\t}\r\n\t\t\tlet subCtor=this.availableConstructors.get(subType)\r\n\t\t\tif (subCtor) {\r\n\t\t\t\tthis._entries.push(subCtor(subData))\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget availableTypes() {\r\n\t\tconst types=[]\r\n\t\tthis.availableConstructors.forEach((_,type)=>{\r\n\t\t\ttypes.push(type)\r\n\t\t})\r\n\t\treturn types\r\n\t}\r\n\tget entries() {\r\n\t\treturn this._entries\r\n\t}\r\n\tset entries(entries) {\r\n\t\tthis._entries=entries\r\n\t\tthis.update()\r\n\t}\r\n\tmakeEntry(type,data) {\r\n\t\treturn this.availableConstructors.get(type)(data)\r\n\t}\r\n\texport() {\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\treturn {\r\n\t\t\tvalue: this._entries.map(entry=>{\r\n\t\t\t\tconst subData=entry.export()\r\n\t\t\t\tconst subType=entry.name\r\n\t\t\t\tif (subType!=defaultType) subData[this.typePropertyName]=subType\r\n\t\t\t\treturn entry.shortenExport(subData)\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t\tentries: this._entries.map(entry=>{\r\n\t\t\t\tconst subFixed=entry.fix()\r\n\t\t\t\tif (typeof subFixed == 'object') subFixed[this.typePropertyName]=entry.name\r\n\t\t\t\treturn subFixed\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='options-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'reset': \"Reset\",\r\n\t\t\t'drag': \"Drag\",\r\n\t\t\t'drag.tip': \"Drag or press ↑/↓ while in focus to reorder items\",\r\n\t\t\t'delete': \"Delete\",\r\n\t\t\t'delete.tip': \"Delete item\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'reset': \"Сбросить\",\r\n\t\t\t'drag': \"Перетащить\",\r\n\t\t\t'drag.tip': \"Перетаскивайте или нажимайте ↑/↓, пока элемент в фокусе, чтобы изменить порядок элементов\",\r\n\t\t\t'delete': \"Удалить\",\r\n\t\t\t'delete.tip': \"Удалить элемент\",\r\n\t\t}\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbers=require('./format-numbers')\r\nconst writeTip=require('./tip')\r\nconst Option=require('./option-classes')\r\nconst ArrayOptionOutput=require('./array-option-output')\r\nconst GroupOptionOutput=require('./group-option-output')\r\n\r\nclass OptionsOutput {\r\n\tconstructor(options,generateId,i18n) {\r\n\t\tconst optionClassWriters=new Map\r\n\t\tthis.setOptionClassWriters(optionClassWriters)\r\n\t\tfunction writeOption(option) {\r\n\t\t\tlet optionProto=option\r\n\t\t\twhile (optionProto=Object.getPrototypeOf(optionProto)) {\r\n\t\t\t\tconst optionClassWriter=optionClassWriters.get(optionProto.constructor)\r\n\t\t\t\tif (optionClassWriter) {\r\n\t\t\t\t\treturn optionClassWriter(option,writeOption,i18n,generateId)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// public prop:\r\n\t\tthis.$output=writeOption(options.root)\r\n\t}\r\n\tgetLeadLabel(id,i18n,option) {\r\n\t\treturn \"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label><span class='space'> </span>\"\r\n\t}\r\n\t// override this fn for custom writers\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\toptionClassWriters.set(Option.Root,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='options-output'>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Group,function(){\r\n\t\t\treturn new GroupOptionOutput(...arguments).$output\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Void,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\")\r\n\t\t\t\t.html(i18n('options.'+option.fullName))\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Checkbox,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\").append(\r\n\t\t\t\t$(\"<input type='checkbox' id='\"+id+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.value)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.value=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\"</label>\"\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst valueId=value=>'options.'+option.fullName+'.'+value\r\n\t\t\tconst valueInfoId=value=>'options-info.'+option.fullName+'.'+value\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $select\r\n\t\t\toption.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$select=$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>\r\n\t\t\t\t\t\t$(\"<option>\").val(availableValue).html(i18n(valueId(availableValue)))\r\n\t\t\t\t\t)\r\n\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\toption.value=this.value\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tif (option.availableValues.some(availableValue=>i18n.has(valueInfoId(availableValue)))) {\r\n\t\t\t\tconst $tip=writeTip('info',\"\")\r\n\t\t\t\toption.$.append(\" \",$tip)\r\n\t\t\t\tconst handler=function(){\r\n\t\t\t\t\tif (i18n.has(valueInfoId(this.value))) {\r\n\t\t\t\t\t\t$tip.find('.tip-content').html(i18n(valueInfoId(this.value)))\r\n\t\t\t\t\t\t$tip.css('display','') // $tip.show() won't work right with inline-block\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$tip.css('display','none')\r\n\t\t\t\t\t\t$tip.find('.tip-content').empty()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\thandler.call($select[0])\r\n\t\t\t\t$select.change(handler)\r\n\t\t\t}\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Text,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst listId=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$(\"<input type='text' id='\"+id+\"' list='\"+listId+\"' />\")\r\n\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\toption.value=this.value\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<datalist id='\"+listId+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>$(\"<option>\").text(availableValue))\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Number,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\tconst setInputAttrsAndListeners=($input,getOtherInput)=>setInputAttrs($input)\r\n\t\t\t\t.val(option.value)\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\tconst $that=getOtherInput()\r\n\t\t\t\t\t\t$that.val(this.value)\r\n\t\t\t\t\t\toption.value=parseFloat(this.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $sliderInput,$numberInput\r\n\t\t\tlet $rangeMinInput,$rangeMaxInput\r\n\t\t\tconst fmt=formatNumbers({\r\n\t\t\t\tmin: option.availableMin,\r\n\t\t\t\tmax: option.availableMax\r\n\t\t\t},option.precision)\r\n\t\t\toption.$=$(\"<div class='option'>\").append(\r\n\t\t\t\tthis.getLeadLabel(id,i18n,option),\r\n\t\t\t\t$(\"<span class='nowrap'>\").append(\r\n\t\t\t\t\t\"<span class='min'>\"+i18n.numberWithUnits(fmt.min,option.unit)+\"</span> \",\r\n\t\t\t\t\t$sliderInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t\t$(\"<input type='range' id='\"+id+\"'>\"),\r\n\t\t\t\t\t\t()=>$numberInput\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\" <span class='max'>\"+i18n.numberWithUnits(fmt.max,option.unit)+\"</span>\"\r\n\t\t\t\t),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$numberInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='number' required>\"),\r\n\t\t\t\t\t()=>$sliderInput\r\n\t\t\t\t),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t$sliderInput.val(option.defaultValue).change()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tconst infoId='options-info.'+option.fullName\r\n\t\t\tif (i18n.has(infoId)) {\r\n\t\t\t\toption.$.append(\" \",writeTip('info',i18n(infoId)))\r\n\t\t\t}\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Array,function(){\r\n\t\t\treturn new ArrayOptionOutput(...arguments).$output\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nclass OptionVisibilityManager {\r\n\tconstructor() {\r\n\t\tthis.options={}\r\n\t\tthis.affects={}\r\n\t\tthis.inArray=0\r\n\t}\r\n\tregister(option) {\r\n\t\tif (!this.inArray) {\r\n\t\t\tthis.options[option.fullName]=option\r\n\t\t\toption.addUpdateCallback(()=>{\r\n\t\t\t\tthis.updateVisibilityAffectedBy(option.fullName)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tdeclareAffectedBy(option,byFullName) {\r\n\t\tif (this.affects[byFullName]===undefined) {\r\n\t\t\tthis.affects[byFullName]=[]\r\n\t\t}\r\n\t\tthis.affects[byFullName].push(option)\r\n\t}\r\n\tupdateVisibilityAffectedBy(byFullName) {\r\n\t\tif (this.affects[byFullName]!==undefined) {\r\n\t\t\tthis.affects[byFullName].forEach(option=>{\r\n\t\t\t\toption.updateVisibility()\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tenterArray() {\r\n\t\tthis.inArray+=1\r\n\t}\r\n\texitArray() {\r\n\t\tthis.inArray-=1\r\n\t}\r\n}\r\n\r\nclass Options {\r\n\tconstructor(data) { // data = imported values, import is done in ctor to avoid calling updateCallback later\r\n\t\tconst Option=this.optionClasses\r\n\t\tconst makeEntry=(description,data,parent,visibilityManager)=>{\r\n\t\t\tconst className=description[0]\r\n\t\t\tif (Option[className]===undefined) {\r\n\t\t\t\tthrow new Error(`invalid option type '${className}'`)\r\n\t\t\t}\r\n\t\t\tconst makeArgs=description.slice(1)\r\n\t\t\treturn Option[className].make(...makeArgs)(\r\n\t\t\t\tdata,parent,visibilityManager,makeEntry\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.root=Option.Root.make(null,this.entriesDescription)(\r\n\t\t\tdata,null,new OptionVisibilityManager,makeEntry\r\n\t\t)\r\n\t}\r\n\t// methods to be redefined by subclasses\r\n\t// TODO make them static?\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn []\r\n\t}\r\n\t// public methods\r\n\taddUpdateCallback(updateCallback) {\r\n\t\tthis.root.addUpdateCallback(updateCallback)\r\n\t}\r\n\texport() {\r\n\t\treturn this.root.shortenExport(this.root.export())\r\n\t}\r\n\tfix() {\r\n\t\treturn this.root.fix()\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nmodule.exports=(tipClass,tipContent)=>{\r\n\tconst $tip=$(`<span class='tip-${tipClass}' tabindex='0'><span class='tip-content'>${tipContent}</span></span>`)\r\n\tlet popupTimeoutId=null\r\n\tlet popupLevel=0\r\n\tconst handlePopup=(dLevel,delay)=>{\r\n\t\tif (delay===undefined) {\r\n\t\t\tdelay=200\r\n\t\t}\r\n\t\tif (dLevel==+1 && popupLevel==0) {\r\n\t\t\tclearTimeout(popupTimeoutId)\r\n\t\t\tpopupTimeoutId=setTimeout(()=>{ // sort of hoverintent, simple delay will do b/c tip icon is small\r\n\t\t\t\t$tip.addClass('open')\r\n\t\t\t},delay)\r\n\t\t} else if (dLevel==-1 && popupLevel==1) {\r\n\t\t\tclearTimeout(popupTimeoutId)\r\n\t\t\tpopupTimeoutId=setTimeout(()=>{\r\n\t\t\t\t$tip.removeClass('open')\r\n\t\t\t},delay)\r\n\t\t}\r\n\t\tpopupLevel+=dLevel\r\n\t}\r\n\t$tip.mouseenter(function(){\r\n\t\thandlePopup(+1)\r\n\t}).focusin(function(){\r\n\t\thandlePopup(+1,0) // need immediate popup on focusin\r\n\t}).on('mouseleave focusout',function(){\r\n\t\thandlePopup(-1)\r\n\t})\r\n\treturn $tip\r\n}\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\nconst NoseWrapLines=require('./nose-wrap-lines')\r\nconst CodeSection=require('./code-section')\r\n\r\nclass WebCode {\r\n\t// public:\r\n\tget filename() {\r\n\t\treturn this.basename+'.html'\r\n\t}\r\n\tget mimeType() {\r\n\t\treturn 'text/html'\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.getLines().get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.getLines().getHtml(formatting)\r\n\t}\r\n\textractSections(sectionModes) {\r\n\t\tif (sectionModes===undefined) {\r\n\t\t\tsectionModes={}\r\n\t\t}\r\n\t\tlet stylePlaceLines=NoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines)\r\n\t\tlet styleExtractLines=Lines.be()\r\n\t\tif (sectionModes.css=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tstylePlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tstylePlaceLines=Lines.bae(\"<!-- <style> \"+this.getSectionPasteComment('css')+\" </style> -->\")\r\n\t\t\t}\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t} else if (sectionModes.css=='file') {\r\n\t\t\tstylePlaceLines=Lines.bae(Lines.html`<link rel=stylesheet href=${this.basename+'.css'}>`)\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t}\r\n\t\tlet scriptPlaceLines=NoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\tlet scriptExtractLines=Lines.be()\r\n\t\tif (sectionModes.js=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tscriptPlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tscriptPlaceLines=Lines.bae(\"<!-- <script> \"+this.getSectionPasteComment('js')+\" </script> -->\")\r\n\t\t\t}\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t} else if (sectionModes.js=='file') {\r\n\t\t\tscriptPlaceLines=Lines.bae(Lines.html`<script src=${this.basename+'.js'}></script>`)\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t}\r\n\t\tlet htmlExtractLines\r\n\t\tif (sectionModes.html=='body') {\r\n\t\t\thtmlExtractLines=this.getBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t} else {\r\n\t\t\thtmlExtractLines=this.getFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t}\r\n\t\tconst type=sectionName=>'text/'+(sectionName=='js'?'javascript':sectionName)\r\n\t\treturn {\r\n\t\t\thtml: new CodeSection(this.filename,type('html'),htmlExtractLines),\r\n\t\t\tcss:  new CodeSection(this.basename+'.css',type('css'),styleExtractLines),\r\n\t\t\tjs:   new CodeSection(this.basename+'.js',type('js'),scriptExtractLines),\r\n\t\t}\r\n\t}\r\n\t// get title()\r\n\r\n\t// private:\r\n\tgetLines() {\r\n\t\treturn this.getFullHtmlSectionLines(\r\n\t\t\tNoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines),\r\n\t\t\tNoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\t)\r\n\t}\r\n\tgetFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\tconst a=Lines.b()\r\n\t\ta(\"<!DOCTYPE html>\")\r\n\t\tif (this.lang!==null) {\r\n\t\t\ta(Lines.html`<html lang=${this.lang}>`)\r\n\t\t} else {\r\n\t\t\ta(\"<html>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"<head>\",\r\n\t\t\t\"<meta charset=utf-8>\"\r\n\t\t)\r\n\t\tif (this.title!==null) {\r\n\t\t\ta(\"<title>\"+this.title+\"</title>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\t\"</head>\",\r\n\t\t\t\"<body>\",\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines,\r\n\t\t\t\"</body>\",\r\n\t\t\t\"</html>\"\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n\tgetBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\treturn Lines.bae(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines\r\n\t\t)\r\n\t}\r\n\tget cachedStyleLines()  { if (!this._styleLines)  this._styleLines =this.styleLines;  return this._styleLines  }\r\n\tget cachedHeadLines()   { if (!this._headLines)   this._headLines  =this.headLines;   return this._headLines   }\r\n\tget cachedBodyLines()   { if (!this._bodyLines)   this._bodyLines  =this.bodyLines;   return this._bodyLines   }\r\n\tget cachedScriptLines() { if (!this._scriptLines) this._scriptLines=this.scriptLines; return this._scriptLines }\r\n\r\n\t// to be redefined in subclasses:\r\n\tget basename() { // filename base\r\n\t\treturn 'source'\r\n\t}\r\n\tget lang() { // language tag for <html lang=xx> or null to skip it - likely read from i18n\r\n\t\treturn null\r\n\t}\r\n\tget title() { // page title or null to skip it\r\n\t\treturn null\r\n\t}\r\n\tget styleLines() { // contents of <style>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget headLines() { // contents of <head> following <style>, goes to <body> in html body mode\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget bodyLines() { // contents of <body> preceding <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget scriptLines() { // contents of <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetSectionPasteComment(sectionName) { // section placeholder comment in paste mode - likely to be overridden with i18n\r\n\t\treturn sectionName+\" goes here\"\r\n\t}\r\n}\r\n\r\nmodule.exports=WebCode\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass WrapLines extends Lines {\r\n\tconstructor(data) {\r\n\t\tsuper(data)\r\n\t\tthis.wrappers=[]\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tthis.wrappers.push(arguments[i])\r\n\t\t}\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn false\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst out=[]\r\n\t\tlet i=0\r\n\t\tconst pushWrapper=()=>{\r\n\t\t\tconst item=this.wrappers[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\tpushWrapper()\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut.map(s=>indent+s))\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(indent+s)\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.wrappers.length==2) {\r\n\t\t\tpushWrapper()\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=WrapLines\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Feature=require('./feature')\r\nconst CallVector=require('./call-vector')\r\n\r\nclass Background extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.isSolid=(options.type=='solid')\r\n\t\tif (this.isSolid) {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tnew CallVector('background.color',options.color.entries,'gl.clearColor',[0,0,0,0])\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.isSolid) {\r\n\t\t\ta(\"gl.clear(gl.COLOR_BUFFER_BIT);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Background\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass CallVector extends Vector {\r\n\tconstructor(name,values,calledFn,calledFnDefaultArgs) {\r\n\t\tsuper(name,values)\r\n\t\tthis.calledFn=calledFn\r\n\t\tthis.calledFnDefaultArgs=calledFnDefaultArgs\r\n\t}\r\n\t// private:\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet nValueSliders=0\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tnValueSliders+=component.value.input=='slider'\r\n\t\t})\r\n\t\tif (this.modeConstant && this.components.every((component,i)=>component.value==this.calledFnDefaultArgs[i])) {\r\n\t\t\t// equal to default values, don't do anything\r\n\t\t} else if (nValueSliders<=1) {\r\n\t\t\ta(this.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\")\r\n\t\t} else if (this.components.every(component=>component.value.input=='slider')) {\r\n\t\t\tlet obj=this.calledFn\r\n\t\t\tconst dotIndex=obj.lastIndexOf('.')\r\n\t\t\tif (dotIndex>=0) {\r\n\t\t\t\tobj=obj.slice(0,dotIndex)\r\n\t\t\t}\r\n\t\t\tconst suffixArray=\"[\"+this.components.map(component=>\"'\"+component.suffix+\"'\").join(\",\")+\"]\"\r\n\t\t\ta(\r\n\t\t\t\tthis.calledFn+\".apply(\"+obj+\",\"+suffixArray+\".map(function(c){\",\r\n\t\t\t\t\"\treturn parseFloat(document.getElementById('\"+this.name+\".'+c).value);\",\r\n\t\t\t\t\"}));\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(this.calledFn+\"(\")\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i>0) {\r\n\t\t\t\t\ta.t(\",\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\ta(\r\n\t\t\t\t\");\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tentry.post(\r\n\t\t\tthis.calledFn+\"(\"+this.components.map(componentValue).join(\",\")+\");\"\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CallVector\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Listener=require('./listener-classes')\r\nconst Feature=require('./feature')\r\nconst IntFeature=require('./int-feature')\r\n\r\nclass Canvas extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.width=options.width\r\n\t\tthis.height=options.height\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('canvas.width' ,options.width),\r\n\t\t\tnew IntFeature('canvas.height',options.height)\r\n\t\t)\r\n\t}\r\n\tgetHtmlCanvasLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\t\"<div>\",\r\n\t\t\tLines.html`\t<canvas id=myCanvas width=${this.width} height=${this.height}></canvas>`,\r\n\t\t\t\"</div>\"\r\n\t\t)\r\n\t}\r\n\tgetGlslVertexDeclarationLines() {\r\n\t\tif (this.hasInputs()) {\r\n\t\t\treturn Lines.bae(\"uniform float aspect;\")\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tgetGlslVertexOutputLines() {\r\n\t\tconst needAspectConstant=!this.hasInputs() && Number(this.width)!=Number(this.height)\r\n\t\tif (needAspectConstant) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float aspect=\"+this.width+\".0/\"+this.height+\".0;\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tprovidesAspect() {\r\n\t\treturn this.hasInputs() || Number(this.width)!=Number(this.height)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tconst canvasUpdater=()=>{\r\n\t\t\ta(\r\n\t\t\t\t\"function updateAspect() {\",\r\n\t\t\t\t\"\tgl.viewport(0,0,canvas.width,canvas.height);\",\r\n\t\t\t\t\"\tgl.uniform1f(aspectLoc,canvas.width/canvas.height);\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"updateAspect();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst canvasListener=wh=>{\r\n\t\t\tif (this[wh].input=='slider') {\r\n\t\t\t\tconst listener=new Listener.Slider('canvas.'+wh)\r\n\t\t\t\tlistener.enter()\r\n\t\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t\t.post(\"canvas.\"+wh+\"=parseInt(this.value);\")\r\n\t\t\t\t\t.post(\"updateAspect();\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.hasInputs()) {\r\n\t\t\ta(\"var aspectLoc=gl.getUniformLocation(program,'aspect');\")\r\n\t\t\tcanvasUpdater()\r\n\t\t\tcanvasListener('width')\r\n\t\t\tcanvasListener('height')\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Canvas\r\n","'use strict'\r\n\r\nconst Shape=require('./shape-classes')\r\nconst FeatureContext=require('./feature-context')\r\nconst Canvas=require('./canvas')\r\nconst Background=require('./background')\r\nconst Transforms=require('./transforms')\r\nconst Illumination=require('./illumination')\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst BaseWebCode=require('crnx-base/web-code')\r\n\r\nclass Code extends BaseWebCode {\r\n\tconstructor(options,i18n) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.i18n=i18n\r\n\t\tthis.featureContext=new FeatureContext(options.debug)\r\n\t\tthis.canvas=new Canvas(options.canvas)\r\n\t\tthis.background=new Background(options.background)\r\n\t\tthis.transforms=new Transforms(options.transforms)\r\n\t\tthis.illumination=new Illumination(options.material,options.light)\r\n\t\tconst makeShape=()=>{\r\n\t\t\treturn new Shape[String(options.shape.type)](\r\n\t\t\t\toptions.shape,\r\n\t\t\t\toptions.light.type!='off',\r\n\t\t\t\toptions.material.scope=='vertex',\r\n\t\t\t\toptions.material.scope=='face',\r\n\t\t\t\tthis.illumination.getColorAttrs()\r\n\t\t\t)\r\n\t\t}\r\n\t\tthis.shape=makeShape()\r\n\t\tthis.features=[\r\n\t\t\tthis.canvas,\r\n\t\t\tthis.background,\r\n\t\t\tthis.transforms,\r\n\t\t\tthis.illumination,\r\n\t\t\tthis.shape,\r\n\t\t]\r\n\t\tthis.featureNames=[\r\n\t\t\t'canvas',\r\n\t\t\t'background',\r\n\t\t\t'transforms',\r\n\t\t\t'illumination',\r\n\t\t\t'shape',\r\n\t\t]\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(this.featureContext)\r\n\t\t})\r\n\t}\r\n\tget basename() {\r\n\t\treturn 'webgl'\r\n\t}\r\n\tget lang() {\r\n\t\treturn 'en'\r\n\t}\r\n\tget title() {\r\n\t\treturn \"WebGL example - Generated code\"\r\n\t}\r\n\tget styleLines() {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.featureContext.hasSliders) {\r\n\t\t\ta(\r\n\t\t\t\t\"label {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 15em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".min {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".max {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: left;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tget headLines() {\r\n\t\tconst getVertexShaderLines=()=>{\r\n\t\t\tconst needTransformedPosition=this.illumination.wantsTransformedPosition(this.transforms.eyeAtInfinity)\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\tthis.canvas.getGlslVertexDeclarationLines(),\r\n\t\t\t\tthis.transforms.getGlslVertexDeclarationLines(this.shape.dim==2),\r\n\t\t\t\tthis.illumination.getGlslVertexDeclarationLines(this.transforms.eyeAtInfinity,this.shape.dim>2),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.canvas.getGlslVertexOutputLines(),\r\n\t\t\t\t\tthis.transforms.getGlslVertexOutputLines(this.shape.dim==2,this.canvas.providesAspect(),needTransformedPosition),\r\n\t\t\t\t\tthis.illumination.getGlslVertexOutputLines(this.transforms.eyeAtInfinity,this.shape.hasNormals,this.transforms.getGlslVertexNormalTransformLines())\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst getFragmentShaderLines=()=>{\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"precision mediump float;\",\r\n\t\t\t\tthis.illumination.getGlslFragmentDeclarationLines(this.transforms.eyeAtInfinity),\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\"void main() {\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.illumination.getGlslFragmentOutputLines(this.transforms.eyeAtInfinity,this.shape.twoSided)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn Lines.bae(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myVertexShader type=x-shader/x-vertex>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetVertexShaderLines()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\t\"<script id=myFragmentShader type=x-shader/x-fragment>\",\r\n\t\t\t\t\"</script>\"\r\n\t\t\t).ae(\r\n\t\t\t\tgetFragmentShaderLines()\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\tget bodyLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\tthis.canvas.getHtmlCanvasLines(),\r\n\t\t\tNoseWrapLines.b(\r\n\t\t\t\t\"<ul>\",\r\n\t\t\t\t\"</ul>\"\r\n\t\t\t).ae(\r\n\t\t\t\t...this.features.map(feature=>feature.getHtmlControlMessageLines(this.i18n))\r\n\t\t\t),\r\n\t\t\t...this.features.map(feature=>feature.getHtmlInputLines(this.i18n))\r\n\t\t)\r\n\t}\r\n\tget scriptLines() {\r\n\t\tconst getMakeProgramLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"var vertexShader=gl.createShader(gl.VERTEX_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(vertexShader,vertexShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(vertexShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);\",\r\n\t\t\t\t\"gl.shaderSource(fragmentShader,fragmentShaderSrc);\",\r\n\t\t\t\t\"gl.compileShader(fragmentShader);\"\r\n\t\t\t)\r\n\t\t\tif (this.options.debugShaders) {\r\n\t\t\t\ta(\"if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));\")\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var program=gl.createProgram();\",\r\n\t\t\t\t\"gl.attachShader(program,vertexShader);\",\r\n\t\t\t\t\"gl.attachShader(program,fragmentShader);\",\r\n\t\t\t\t\"gl.linkProgram(program);\",\r\n\t\t\t\t\"return program;\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInitLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function makeProgram(vertexShaderSrc,fragmentShaderSrc) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tgetMakeProgramLines()\r\n\t\t\t\t),\r\n\t\t\t\t\"var canvas=document.getElementById('myCanvas');\",\r\n\t\t\t\t\"var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');\",\r\n\t\t\t\t\"var program=makeProgram(\",\r\n\t\t\t\t\"\tdocument.getElementById('myVertexShader').text,\",\r\n\t\t\t\t\"\tdocument.getElementById('myFragmentShader').text\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.useProgram(program);\"\r\n\t\t\t)\r\n\t\t\tconst addWithCommentIfNotEmpty=(featureLines,comment)=>{\r\n\t\t\t\tif (featureLines.count()>0) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\",\r\n\t\t\t\t\t\t\"// \"+comment, // TODO i18n\r\n\t\t\t\t\t\tfeatureLines\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.features.forEach((feature,i)=>{\r\n\t\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\t\tfeature.getJsInitLines(this.featureContext),\r\n\t\t\t\t\t\"init \"+this.featureNames[i]\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\taddWithCommentIfNotEmpty(\r\n\t\t\t\tthis.featureContext.getJsAfterInitLines(),\r\n\t\t\t\t\"init mousemove listener\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsInnerLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasClampFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function clamp(v,min,max) {\",\r\n\t\t\t\t\t\"\treturn Math.min(Math.max(v,min),max);\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.hasWrapFn) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"function wrap(v,maxAbs) {\",\r\n\t\t\t\t\t\"\tv%=maxAbs*2;\",\r\n\t\t\t\t\t\"\tif (Math.abs(v)<=maxAbs) return v;\",\r\n\t\t\t\t\t\"\treturn v-(v>0?1:-1)*maxAbs*2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.featureContext.pollsGamepad) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var gamepad;\",\r\n\t\t\t\t\t\"var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);\",\r\n\t\t\t\t\t\"for (var i=0;i<gamepads.length;i++) {\",\r\n\t\t\t\t\t\"\tif (gamepads[i]) {\",\r\n\t\t\t\t\t\"\t\tgamepad=gamepads[i];\",\r\n\t\t\t\t\t\"\t\tbreak;\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t...this.features.map(feature=>feature.getJsLoopLines(this.featureContext))\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst getJsLoopLines=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.featureContext.hasStartTime && this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t\ta(\"var prevTime=startTime;\")\r\n\t\t\t} else if (this.featureContext.hasStartTime) {\r\n\t\t\t\ta(\"var startTime=performance.now();\")\r\n\t\t\t} else if (this.featureContext.hasPrevTime) {\r\n\t\t\t\ta(\"var prevTime=performance.now();\")\r\n\t\t\t}\r\n\t\t\t// wrap inner render lines in function if needed\r\n\t\t\tif (this.featureContext.isAnimated) {\r\n\t\t\t\tif (this.featureContext.hasTime) {\r\n\t\t\t\t\ta(\"function renderFrame(time) {\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"function renderFrame() {\")\r\n\t\t\t\t}\r\n\t\t\t\ta(IndentLines.bae(getJsInnerLoopLines()))\r\n\t\t\t\tif (this.featureContext.hasPrevTime) {\r\n\t\t\t\t\ta(\"\tprevTime=time;\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\trequestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"requestAnimationFrame(renderFrame);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.featureContext.hasInputs) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var frameId=null;\",\r\n\t\t\t\t\t\"function renderFrame() {\",\r\n\t\t\t\t\tIndentLines.bae(getJsInnerLoopLines()),\r\n\t\t\t\t\t\"\tframeId=null;\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"function scheduleFrame() {\",\r\n\t\t\t\t\t\"\tif (frameId===null) {\",\r\n\t\t\t\t\t\"\t\tframeId=requestAnimationFrame(renderFrame);\",\r\n\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"scheduleFrame();\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(getJsInnerLoopLines())\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\treturn InterleaveLines.bae(\r\n\t\t\tgetJsInitLines(),\r\n\t\t\tgetJsLoopLines()\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=Code","var colorgenCounter=0;\r\n\r\nvar SingleColorgen=function(weight,noise,baseColors){\r\n\tthis.weight=weight;\r\n\tthis.noise=noise;\r\n\tif (noise===undefined) this.noise=0.4;\r\n\tthis.baseColors=baseColors||this.defaultBaseColors;\r\n\tthis.colorgenNumber=colorgenCounter++;\r\n\tthis.nextIndex=0;\r\n};\r\nSingleColorgen.prototype.defaultBaseColors=[\r\n\t[1.0, 0.0, 0.0], // TODO 'cube' color order, when cube is not ugly\r\n\t[0.0, 1.0, 0.0],\r\n\t[0.0, 0.0, 1.0],\r\n\t[1.0, 1.0, 0.0],\r\n\t[1.0, 0.0, 1.0],\r\n\t[0.0, 1.0, 1.0],\r\n];\r\nSingleColorgen.prototype.getNextColorString=function(){\r\n\tvar baseColor=this.baseColors[this.nextIndex];\r\n\tthis.nextIndex=(this.nextIndex+1)%this.baseColors.length;\r\n\treturn baseColor.map(function(ci,i){\r\n\t\tvar s=Math.sin(this.colorgenNumber*9000+this.nextIndex*400+i*100);\r\n\t\tvar co=(ci*(1-this.noise)+s*s*this.noise)*this.weight;\r\n\t\treturn \" \"+co.toFixed(1)+\",\";\r\n\t},this).join(\"\");\r\n};\r\n\r\nvar Colorgen=function(colorAttrs,noise,baseColors){\r\n\tthis.colorAttrs=colorAttrs;\r\n\tthis.singleColorgens=this.colorAttrs.map(function(attr){\r\n\t\treturn new SingleColorgen(attr.weight,noise,baseColors);\r\n\t});\r\n};\r\nColorgen.prototype.getHeaderString=function(){\r\n\treturn this.colorAttrs.map(function(){\r\n\t\treturn \"    r    g    b\";\r\n\t}).join(\"\");\r\n};\r\nColorgen.prototype.getNextColorString=function(){\r\n\treturn this.singleColorgens.map(function(singleColorgen){\r\n\t\treturn singleColorgen.getNextColorString();\r\n\t}).join(\"\");\r\n};\r\n\r\nmodule.exports=Colorgen;\r\n","'use strict'\r\n\r\nconst Listener=require('./listener-classes')\r\n\r\nclass FeatureContext {\r\n\tconstructor(debugOptions) {\r\n\t\tthis.debugOptions=debugOptions\r\n\t\tthis.canvasMousemoveListener=new Listener.CanvasMousemove()\r\n\t\t//// to be set by features:\r\n\t\t// for html:\r\n\t\tthis.hasSliders=false\r\n\t\t// for js:\r\n\t\tthis.hasInputs=false // must have renderFrame()\r\n\t\tthis.hasStartTime=false\r\n\t\tthis.hasPrevTime=false\r\n\t\tthis.pollsGamepad=false\r\n\t\tthis.hasClampFn=false\r\n\t\tthis.hasWrapFn=false\r\n\t}\r\n\tget hasTime() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime\r\n\t}\r\n\tget isAnimated() {\r\n\t\treturn this.hasStartTime || this.hasPrevTime || this.pollsGamepad\r\n\t}\r\n\tgetJsAfterInitLines() {\r\n\t\treturn this.canvasMousemoveListener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n\tgetListenerLines(listener) {\r\n\t\treturn listener.write(!this.isAnimated,this.debugOptions.inputs)\r\n\t}\r\n}\r\n\r\nmodule.exports=FeatureContext\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\n\r\nclass Feature {\r\n\tconstructor() {\r\n\t\tthis.features=[]\r\n\t}\r\n\t// private:\r\n\tgetRecursiveLines(method,args) {\r\n\t\treturn Lines.bae(...this.features.map(feature=>feature[method](...args)))\r\n\t}\r\n\t// methods to be redefined:\r\n\thasInputs() {\r\n\t\treturn this.features.some(feature=>feature.hasInputs())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(featureContext)\r\n\t\t})\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlInputLines',arguments)\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\treturn this.getRecursiveLines('getHtmlControlMessageLines',arguments)\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsInitLines',arguments)\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\treturn this.getRecursiveLines('getJsLoopLines',arguments)\r\n\t}\r\n}\r\n\r\nmodule.exports=Feature\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Vector=require('./vector')\r\n\r\nclass GlslVector extends Vector {\r\n\tconstructor(name,values,wrapRange) {\r\n\t\tsuper(name,values,wrapRange)\r\n\t}\r\n\t// public:\r\n\tgetGlslDeclarationLines() {\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn Lines.be()\r\n\t\t} else if (this.modeFloats) {\r\n\t\t\tconst a=Lines.b()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"uniform float \"+component.varName+\";\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn a.e()\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"uniform vec\"+this.nVars+\" \"+this.varName+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslValue() {\r\n\t\treturn this.getGlslComponentsValue(this.components.map(component=>component.suffix).join(''))\r\n\t}\r\n\tgetGlslComponentsValue(selectedComponents) {\r\n\t\tconst numbers={}\r\n\t\tconst results=[] // [[isConstant,componentName]]\r\n\t\tfor (let j=0;j<selectedComponents.length;j++) {\r\n\t\t\tconst c=selectedComponents.charAt(j)\r\n\t\t\tif (!this.componentsBySuffix[c].variable) {\r\n\t\t\t\tnumbers[c]=this.componentsBySuffix[c].value\r\n\t\t\t\tresults.push([true,c])\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector && results.length>0) {\r\n\t\t\t\t\tconst prevResult=results.pop()\r\n\t\t\t\t\tif (prevResult[0]) {\r\n\t\t\t\t\t\tresults.push(prevResult,[false,c]) // prev is constant, don't merge\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresults.push([prevResult[0],prevResult[1]+c]) // merge\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresults.push([false,c])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst fmt=formatNumbers.glsl(numbers)\r\n\t\tconst allSuffixString=this.components.map(component=>component.suffix).slice(0,this.nVars).join('')\r\n\t\tconst allSameConstant=()=>{\r\n\t\t\tif (!results[0][0]) return false\r\n\t\t\tconst cmp=fmt[results[0][1]]\r\n\t\t\treturn results.every(result=>(result[0] && fmt[result[1]]==cmp))\r\n\t\t}\r\n\t\tconst showResult=result=>{\r\n\t\t\tif (result[0]) {\r\n\t\t\t\treturn fmt[result[1]]\r\n\t\t\t} else {\r\n\t\t\t\tif (this.modeVector) {\r\n\t\t\t\t\tif (result[1]==allSuffixString) {\r\n\t\t\t\t\t\treturn this.varName\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn this.varName+\".\"+result[1]\r\n\t\t\t\t\t}\r\n \t\t\t\t} else {\r\n\t\t\t\t\treturn this.componentsBySuffix[result[1]].varName\r\n \t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (results.length==1) {\r\n\t\t\tif (this.modeVector && selectedComponents==allSuffixString) {\r\n\t\t\t\treturn this.varName\r\n\t\t\t} else {\r\n\t\t\t\treturn showResult(results[0])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (allSameConstant()) {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+showResult(results[0])+\")\" // see OpenGL ES SL section 5.4.2\r\n\t\t\t} else {\r\n\t\t\t\treturn \"vec\"+selectedComponents.length+\"(\"+results.map(showResult).join(\",\")+\")\"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tgetGlslMapDeclarationLines(mapName,mapFn) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"vec\"+this.components.length+\" \"+mapName+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"float \"+mapName+this.components[0].suffix+\"=\"+mapFn(this.getGlslValue())+\";\"\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetGlslMapComponentValue(mapName,selectedComponent) {\r\n\t\tif (this.components.length>1) {\r\n\t\t\treturn mapName+\".\"+selectedComponent\r\n\t\t} else {\r\n\t\t\treturn mapName+selectedComponent\r\n\t\t}\r\n\t}\r\n\t// private:\r\n\tgetJsDeclarationLines() {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeConstant) {\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tif (this.modeFloats) {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"var \"+component.varNameLoc+\"=gl.getUniformLocation(program,'\"+component.varName+\"');\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\ta(\"var \"+this.varName+\"Loc=gl.getUniformLocation(program,'\"+this.varName+\"');\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsUpdateLines(componentValue) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.modeVector) {\r\n\t\t\ta(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc\")\r\n\t\t\tif (this.components.every(component=>component.value.input!='slider')) { // all values are short, no getElement... queries\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\",\"+componentValue(component))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta.t(\");\")\r\n\t\t\t} else {\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\tif (component.variable) {\r\n\t\t\t\t\t\ta.t(\r\n\t\t\t\t\t\t\t\",\",\r\n\t\t\t\t\t\t\t\"\t\"+componentValue(component)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ta(\");\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.variable) {\r\n\t\t\t\t\ta(\"gl.uniform1f(\"+component.varNameLoc+\",\"+componentValue(component)+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\taddPostToListenerEntryForComponent(entry,component) {\r\n\t\tif (this.modeVector) {\r\n\t\t\t// written at the end as a vector\r\n\t\t} else {\r\n\t\t\tentry.post(\"gl.uniform1f(\"+component.varNameLoc+\",\"+component.varName+\");\")\r\n\t\t}\r\n\t}\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {\r\n\t\tif (this.modeVector) {\r\n\t\t\tconst vs=[]\r\n\t\t\tthis.components.forEach((component,i)=>{\r\n\t\t\t\tif (i<this.nVars) {\r\n\t\t\t\t\tvs.push(component.varName)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tentry.post(\"gl.uniform\"+this.nVars+\"f(\"+this.varName+\"Loc,\"+vs.join(\",\")+\");\")\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=GlslVector\r\n","'use strict'\r\n\r\nconst langStrings={\r\n\ten:{\r\n\t\t'options.canvas': \"Canvas\",\r\n\t\t'options.canvas.{width,height}': \"Canvas {}\",\r\n\r\n\t\t'options.background': \"Background\",\r\n\t\t'options.background.type': \"Background type\",\r\n\t\t'options.background.type.none': \"none (transparent)\",\r\n\t\t'options.background.type.solid': \"solid color\",\r\n\t\t'options.background.color': \"Background color\",\r\n\t\t'options.background.color.{r,g,b,a}': 'Background color {red,green,blue,alpha} component',\r\n\t\t'options.background.color.{r,g,b,a}.speed': 'Background color {red,green,blue,alpha} speed',\r\n\r\n\t\t'options.material': \"Material\",\r\n\t\t'options.material.scope': \"Set material color for objects\",\r\n\t\t'options.material.scope.global': \"entire scene\",\r\n\t\t'options.material.scope.vertex': \"shape vertices\",\r\n\t\t'options.material.scope.face': \"shape faces\",\r\n\t\t'options.material.data': \"For each object have\",\r\n\t\t'options.material.data.one': \"one color\",\r\n\t\t'options.material.data.sda': \"specular/diffuse/ambient colors\",\r\n\t\t'options.material.color': \"Material color\",\r\n\t\t'options.material.color.{r,g,b,a}': \"Material color {red,green,blue,alpha} component\",\r\n\t\t'options.material.color.{r,g,b,a}.speed': \"Material color {red,green,blue,alpha} speed\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color': \"Material {} color\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}': \"{Specular,Diffuse,Ambient} color {red,green,blue} component\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed': \"Material {} color {red,green,blue,alpha} speed\",\r\n\t\t'options-info.material.data.sda': \"for use with Phong/Blinn–Phong shading models selected by <em>light type</em>\",\r\n\r\n\t\t'options.light': \"Light\",\r\n\t\t'options.light.type': \"Light type\",\r\n\t\t'options.light.type.off': \"off\",\r\n\t\t'options.light.type.phong': \"on with Phong reflections\",\r\n\t\t'options.light.type.blinn': \"on with Blinn–Phong reflections\",\r\n\t\t'options.light.direction': \"Light direction\",\r\n\t\t'options.light.direction.{x,y,z}': \"Light direction {} component\",\r\n\t\t'options.light.direction.{x,y,z}.speed': \"Light direction {} speed\",\r\n\t\t'options-info.light.type.phong': \"[[Shading#Directional_lighting|directional light]] with [[Phong reflection model]]\",\r\n\t\t'options-info.light.type.blinn': \"[[Shading#Directional_lighting|directional light]] with [[Blinn–Phong shading model|Blinn–Phong reflection model]]\",\r\n\r\n\t\t'options.shape': \"Shape\",\r\n\t\t'options.shape.type': \"Shape to draw\",\r\n\t\t'options.shape.type.square': \"square\",\r\n\t\t'options.shape.type.triangle': \"triangle\",\r\n\t\t'options.shape.type.gasket': \"Sierpinski gasket\",\r\n\t\t'options.shape.type.cube': \"cube\",\r\n\t\t'options.shape.type.hat': \"Mexican hat function\",\r\n\t\t'options.shape.type.terrain': \"diamond-square fractal terrain\",\r\n\t\t'options.shape.elements': \"Element array\",\r\n\t\t'options.shape.elements.0': \"not used\",\r\n\t\t'options.shape.elements.{8,16,32}': \"with {}-bit index\",\r\n\t\t'options.shape.lod': \"Shape detail level\", // recursion depth for fractal shapes\r\n\t\t'options-info.shape.type.gasket': \"[[Sierpinski triangle]]\",\r\n\t\t'options-info.shape.type.hat': \"[[Mexican hat wavelet]]\",\r\n\t\t'options-info.shape.type.terrain': \"generated with the [[Diamond-square algorithm|diamond-square algorithm]]\",\r\n\t\t'options-info.shape.elements.{8,16}': \"choosing 8- or 16-bit index may limit available shape detail levels\",\r\n\r\n\t\t'options.transforms': \"Transforms\",\r\n\t\t'options.transforms.projection': \"Projection\",\r\n\t\t'options.transforms.projection.ortho': \"orthogonal\",\r\n\t\t'options.transforms.projection.perspective': \"perspective\",\r\n\t\t'options.transforms.model': \"Model transform\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.add': \"Add rotation around {} axis\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}': \"Angle of rotation around {} axis\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.speed': \"Speed of rotation around {} axis\",\r\n\t\t'options-info.transforms.projection.ortho': \"[[Orthographic projection|orthographic projection]]\",\r\n\t\t'options-info.transforms.projection.perspective': \"[[Transformation_matrix#Perspective_projection|perspective projection]]\",\r\n\r\n\t\t'options.debug': \"Debug options\",\r\n\t\t'options.debug.shaders': \"Log shader compilation errors\",\r\n\t\t'options.debug.arrays': \"Log allocated array sizes\",\r\n\t\t'options.debug.inputs': \"Log input values\",\r\n\t\t'options.debug.animations': \"Log animated values\",\r\n\r\n\t\t'options-output.inputs': \"Input method\",\r\n\t\t'options-output.inputs.constant': \"none\",\r\n\t\t'options-output.inputs.slider': \"slider\",\r\n\t\t'options-output.inputs.mousemove{x,y}': \"mouse {} axis\",\r\n\t\t'options-output.inputs.gamepad{0,1,2,3}': \"gamepad {} axis\",\r\n\t\t'options-output.range': \"with range\",\r\n\t\t'options-output.addSpeed': \"Add speed\",\r\n\r\n\t\t'controls.type.mousemove{x,y}': \"Move the mouse pointer {horizontally,vertically} over the canvas\",\r\n\t\t'controls.to': \"to update\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2}': \"pixel{,s}\",\r\n\t\t'units.°/second.a': \"°/s\",\r\n\t\t'units.°/second.{1,2}': \"degree{,s} per second\",\r\n\t\t'units.second.a': \"s\",\r\n\t\t'units.1/second.{1,2}': \"unit{,s} per second\",\r\n\t},\r\n\tru:{\r\n\t\t'options.canvas': \"Элемент <code>canvas</code>\",\r\n\t\t'options.canvas.{width,height}': \"{Ширина,Высота} элемента <code>canvas</code>\",\r\n\r\n\t\t'options.background': \"Фон\",\r\n\t\t'options.background.type': \"Тип фона\",\r\n\t\t'options.background.type.none': \"прозрачный\",\r\n\t\t'options.background.type.solid': \"закрашенный\",\r\n\t\t'options.background.color': \"Цвет фона\",\r\n\t\t'options.background.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал фона',\r\n\t\t'options.background.color.{r,g,b,a}.speed': 'Скорость {красного ,зелёного ,синего ,альфа-}канала фона',\r\n\r\n\t\t'options.material': \"Материал\",\r\n\t\t'options.material.scope': \"Задавать цвета данных объектов\",\r\n\t\t'options.material.scope.global': \"всей сцены\",\r\n\t\t'options.material.scope.vertex': \"вершин фигур\",\r\n\t\t'options.material.scope.face': \"граней фигур\",\r\n\t\t'options.material.data': \"Задавать для каждого объекта\",\r\n\t\t'options.material.data.one': \"один цвет\",\r\n\t\t'options.material.data.sda': \"бликовую/рассеянную/фоновую составляющие\",\r\n\t\t'options.material.color': \"Цвет материала\",\r\n\t\t'options.material.color.{r,g,b,a}': \"{Красный ,Зелёный ,Синий ,Альфа-}канал материала\",\r\n\t\t'options.material.color.{r,g,b,a}.speed': \"Скорость {красного ,зелёного ,синего ,альфа-}канала материала\",\r\n\t\t'options.material.{specular,diffuse,ambient}Color': \"{Бликовая,Рассеянная,Фоновая} составляющая цвета материала\",\r\n\t\t'options.material.specularColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал бликовой составляющей\",\r\n\t\t'options.material.diffuseColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал рассеянной составляющей\",\r\n\t\t'options.material.ambientColor.{r,g,b}': \"{Красный,Зелёный,Синий} канал фоновой составляющей\",\r\n\t\t'options.material.specularColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала бликовой составляющей\",\r\n\t\t'options.material.diffuseColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала рассеянной составляющей\",\r\n\t\t'options.material.ambientColor.{r,g,b}.speed': \"Скорость {красного,зелёного,синего} канала фоновой составляющей\",\r\n\t\t'options-info.material.data.sda': \"для использования с моделями освещения Фонга/Блинна-Фонга, задаваемыми <em>типом света</em>\",\r\n\r\n\t\t'options.light': \"Свет\",\r\n\t\t'options.light.type': \"Тип света\",\r\n\t\t'options.light.type.off': \"отключен\",\r\n\t\t'options.light.type.phong': \"включен с отражениями по Фонгу\",\r\n\t\t'options.light.type.blinn': \"включен с отражениями по Блинну-Фонгу\",\r\n\t\t'options.light.direction': \"Направление света\",\r\n\t\t'options.light.direction.{x,y,z}': \"{}-компонент направления света\",\r\n\t\t'options.light.direction.{x,y,z}.speed': \"скорость {}-компонента направления света\",\r\n\t\t'options-info.light.type.phong': \"направленный свет с [[Затенение_по_Фонгу#.D0.9C.D0.BE.D0.B4.D0.B5.D0.BB.D1.8C_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F|моделью освещения Фонга]]\",\r\n\t\t'options-info.light.type.blinn': \"направленный свет с моделью освещения Блинна-Фонга\",\r\n\r\n\t\t'options.shape': \"Фигура\",\r\n\t\t'options.shape.type': \"Рисовать фигуру\",\r\n\t\t'options.shape.type.square': \"квадрат\",\r\n\t\t'options.shape.type.triangle': \"треугольник\",\r\n\t\t'options.shape.type.gasket': \"салфетка Серпинского\",\r\n\t\t'options.shape.type.cube': \"куб\",\r\n\t\t'options.shape.type.hat': \"Mexican hat function\",\r\n\t\t'options.shape.type.terrain': \"фрактальный ландшафт\",\r\n\t\t'options.shape.elements': \"Element array\",\r\n\t\t'options.shape.elements.0': \"не используется\",\r\n\t\t'options.shape.elements.{8,16,32}': \"с {}-битным индексом\",\r\n\t\t'options.shape.lod': \"Уровень детализации\", // recursion depth for fractal shapes\r\n\t\t'options-info.shape.type.gasket': \"[[Треугольник Серпинского|треугольник Серпинского]]\",\r\n\t\t'options-info.shape.type.terrain': \"сгенерирован [[Алгоритм Diamond-Square|алгоритмом diamond-square]]\",\r\n\t\t'options-info.shape.elements.{8,16}': \"выбор 8- или 16-битного индекса может ограничить доступные уровни детализации\",\r\n\r\n\t\t'options.transforms': \"Преобразования\",\r\n\t\t'options.transforms.projection': \"Проекция\",\r\n\t\t'options.transforms.projection.ortho': \"ортогональная\",\r\n\t\t'options.transforms.projection.perspective': \"перспективная\",\r\n\t\t'options.transforms.model': \"Преобразование модели\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.add': \"Добавить вращение вокруг оси {}\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}': \"Угол поворота вокруг оси {}\",\r\n\t\t'options.transforms.model.rotate.{x,y,z}.speed': \"Скорость поворота вокруг оси {}\",\r\n\r\n\t\t'options.debug': \"Отладка\",\r\n\t\t'options.debug.shaders': \"Выводить ошибки компиляции шейдеров\",\r\n\t\t'options.debug.arrays': \"Выводить размеры выделенных массивов\",\r\n\t\t'options.debug.inputs': \"Выводить значения вводов\",\r\n\t\t'options.debug.animations': \"Выводить анимированные значения\",\r\n\r\n\t\t'options-output.inputs': \"Способ ввода\",\r\n\t\t'options-output.inputs.constant': \"нет\",\r\n\t\t'options-output.inputs.slider': \"ползунок\",\r\n\t\t'options-output.inputs.mousemove{x,y}': \"ось {} мыши\",\r\n\t\t'options-output.inputs.gamepad{0,1,2,3}': \"ось {} геймпада\",\r\n\t\t'options-output.range': \"с диапазоном\",\r\n\t\t'options-output.addSpeed': \"Добавить скорость\",\r\n\r\n\t\t'controls.type.mousemove{x,y}': \"Перемещайте указатель мыши над элементом <code>canvas</code> в {горизонтальном,вертикальном} направлении,\",\r\n\t\t'controls.to': \"чтобы изменить\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2,5}': \"пиксел{ь,я,ей}\",\r\n\t\t'units.°/second.a': \"°/с\",\r\n\t\t'units.°/second.{1,2,5}': \"градус{,а,ов} в секунду\",\r\n\t\t'units.second.a': \"с\",\r\n\t\t'units.1/second.{1,2,5}': \"единиц{а,ы,} в секунду\",\r\n\t}\r\n}\r\n\r\nfor (let lang in langStrings) {\r\n\tlet strings=langStrings[lang]\r\n\tstrings=require('crnx-base/i18n-expand-curly')(strings)\r\n\tstrings=require('crnx-base/i18n-link-wikipedia')(lang)(strings)\r\n\tstrings=require('crnx-base/options-output-i18n')(lang)(strings)\r\n\tstrings=require('crnx-base/code-output-i18n')(lang)(strings)\r\n\tlangStrings[lang]=strings\r\n}\r\n\r\nmodule.exports=require('crnx-base/i18n')(langStrings)\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Illumination extends Feature {\r\n\tconstructor(material,light) {\r\n\t\tsuper()\r\n\t\tthis.material=material\r\n\t\tthis.light=light\r\n\t\t// possible options checks:\r\n\t\t// material.scope=='global': constant or user input -> uniform\r\n\t\t// material.scope!='global': colors in model data -> attribute\r\n\t\t// material.data=='one': one color\r\n\t\t// material.data!='one': s/d/a colors\r\n\t\t// light.type=='off'\r\n\t\t// light.type!='off'\r\n\t\t// light.type=='blinn'\r\n\t\tif (material.scope=='global') {\r\n\t\t\tif (material.data=='one') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.colorVector=new GlslVector('material.color',material.color.entries)\r\n\t\t\t\t)\r\n\t\t\t} else if (light.type!='off') {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.specularColorVector=new GlslVector('material.specularColor',material.specularColor.entries),\r\n\t\t\t\t\tthis.diffuseColorVector =new GlslVector('material.diffuseColor' ,material.diffuseColor.entries),\r\n\t\t\t\t\tthis.ambientColorVector =new GlslVector('material.ambientColor' ,material.ambientColor.entries)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tthis.features.push(\r\n\t\t\t\t\tthis.ambientColorVector=new GlslVector('material.ambientColor',[\r\n\t\t\t\t\t\t...material.ambientColor.entries, Option.LiveFloat.make('a',[0,1,-1,+1],1)().fix()\r\n\t\t\t\t\t])\r\n\t\t\t\t)\r\n\t\t\t\t// TODO consider extendind .specularColor and .diffuseColor, b/c they would be present if vertex scope is chosen\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (light.type!='off') {\r\n\t\t\tthis.features.push(\r\n\t\t\t\tthis.lightDirectionVector=new GlslVector('light.direction',light.direction.entries)\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tgetColorAttrs() {\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"color\",enabled:true,weight:1.0}\r\n\t\t\t\t]\r\n\t\t\t} else {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{name:\"specularColor\",enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"diffuseColor\" ,enabled:this.light.type!='off',weight:0.4},\r\n\t\t\t\t\t{name:\"ambientColor\" ,enabled:true                  ,weight:0.2}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\twantsTransformedPosition(eyeAtInfinity) {\r\n\t\treturn !eyeAtInfinity && this.light.type!='off' && this.material.data!='one'\r\n\t}\r\n\tgetGlslVertexDeclarationLines(eyeAtInfinity,hasNormalAttr) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta(\"attribute vec3 normal;\")\r\n\t\t\t}\r\n\t\t\ta(\"varying vec3 interpolatedNormal;\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"attribute vec4 color;\")\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"attribute vec4 ambientColor;\")\r\n\t\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"attribute vec3 specularColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 diffuseColor;\",\r\n\t\t\t\t\t\t\"attribute vec3 ambientColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(eyeAtInfinity,hasNormalAttr,normalTransformLines) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"interpolatedView=-transformedPosition.xyz;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\"interpolatedNormal=\")\r\n\t\t\tif (hasNormalAttr) {\r\n\t\t\t\ta.t(\"normal\")\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\"vec3(0.0,0.0,1.0)\")\r\n\t\t\t}\r\n\t\t\ta.t(normalTransformLines)\r\n\t\t\ta.t(\";\")\r\n\t\t}\r\n\t\tif (this.material.scope!='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\"interpolatedColor=color;\")\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type=='off') {\r\n\t\t\t\t\ta(\"interpolatedColor=ambientColor;\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"interpolatedSpecularColor=specularColor;\",\r\n\t\t\t\t\t\t\"interpolatedDiffuseColor=diffuseColor;\",\r\n\t\t\t\t\t\t\"interpolatedAmbientColor=ambientColor;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentDeclarationLines(eyeAtInfinity) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\ta(\"varying vec3 interpolatedView;\")\r\n\t\t}\r\n\t\tif (this.light.type!='off') {\r\n\t\t\ta(\r\n\t\t\t\tthis.lightDirectionVector.getGlslDeclarationLines(),\r\n\t\t\t\t\"varying vec3 interpolatedNormal;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(this.colorVector.getGlslDeclarationLines())\r\n\t\t\t} else {\r\n\t\t\t\tif (this.light.type!='off') {\r\n\t\t\t\t\ta(this.specularColorVector.getGlslDeclarationLines())\r\n\t\t\t\t\ta(this.diffuseColorVector.getGlslDeclarationLines())\r\n\t\t\t\t}\r\n\t\t\t\ta(this.ambientColorVector.getGlslDeclarationLines())\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.material.data=='one' || this.light.type=='off') {\r\n\t\t\t\ta(\"varying vec4 interpolatedColor;\")\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"varying vec3 interpolatedSpecularColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedDiffuseColor;\",\r\n\t\t\t\t\t\"varying vec3 interpolatedAmbientColor;\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslFragmentOutputLines(eyeAtInfinity,twoSided) {\r\n\t\tconst a=Lines.b()\r\n\t\tlet colorRGB,colorA,colorRGBA\r\n\t\tif (this.material.scope=='global') {\r\n\t\t\tconst vector=(this.material.data=='one'\r\n\t\t\t\t? this.colorVector\r\n\t\t\t\t: this.ambientColorVector\r\n\t\t\t)\r\n\t\t\tcolorRGB =()=>vector.getGlslComponentsValue('rgb')\r\n\t\t\tcolorA   =()=>vector.getGlslComponentsValue('a')\r\n\t\t\tcolorRGBA=()=>vector.getGlslValue()\r\n\t\t} else {\r\n\t\t\tcolorRGB =()=>\"interpolatedColor.rgb\" // TODO don't pass it as vec4 if light is on\r\n\t\t\tcolorA   =()=>\"interpolatedColor.a\"\r\n\t\t\tcolorRGBA=()=>\"interpolatedColor\"\r\n\t\t}\r\n\t\tif (this.light.type=='off') {\r\n\t\t\ta(\"gl_FragColor=\"+colorRGBA()+\";\")\r\n\t\t} else {\r\n\t\t\ta(\"vec3 N=normalize(interpolatedNormal);\")\r\n\t\t\tif (twoSided) {\r\n\t\t\t\ta(\"if (!gl_FrontFacing) N=-N;\")\r\n\t\t\t}\r\n\t\t\ta(\"vec3 L=normalize(\"+this.lightDirectionVector.getGlslValue()+\");\")\r\n\t\t\tif (this.material.data=='one') {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"gl_FragColor=vec4(\"+colorRGB()+\"*max(0.0,dot(L,N)),\"+colorA()+\");\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tif (this.wantsTransformedPosition(eyeAtInfinity)) {\r\n\t\t\t\t\ta(\"vec3 V=normalize(interpolatedView);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 V=vec3(0.0,0.0,1.0);\")\r\n\t\t\t\t}\r\n\t\t\t\tlet specularDotArgs=\"H,N\"\r\n\t\t\t\tlet shininessCorrection=\"\"\r\n\t\t\t\tif (this.light.type=='blinn') {\r\n\t\t\t\t\ta(\"vec3 H=normalize(L+V);\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"vec3 R=reflect(-L,N);\")\r\n\t\t\t\t\tspecularDotArgs=\"R,V\"\r\n\t\t\t\t\tshininessCorrection=\"/4.0\"\r\n\t\t\t\t}\r\n\t\t\t\ta(\"float shininess=100.0;\")\r\n\t\t\t\ta(\r\n\t\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\t\"gl_FragColor=vec4(\",\r\n\t\t\t\t\t\t\",1.0);\"\r\n\t\t\t\t\t).ae(this.material.scope=='global'\r\n\t\t\t\t\t\t? Lines.bae(\r\n\t\t\t\t\t\t\t\"+\"+this.specularColorVector.getGlslValue()+\"*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+\"+this.diffuseColorVector.getGlslValue()+\"*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+\"+this.ambientColorVector.getGlslValue()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: Lines.bae(\r\n\t\t\t\t\t\t\t\"+interpolatedSpecularColor*pow(max(0.0,dot(\"+specularDotArgs+\")),shininess\"+shininessCorrection+\")\",\r\n\t\t\t\t\t\t\t\"+interpolatedDiffuseColor*max(0.0,dot(L,N))\",\r\n\t\t\t\t\t\t\t\"+interpolatedAmbientColor\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Illumination\r\n","'use strict'\r\n\r\nclass Base {\r\n\tconstructor(str) {\r\n\t\tthis._str=str\r\n\t}\r\n\ttoString() {\r\n\t\treturn this._str\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this._str\r\n\t}\r\n}\r\n\r\nclass Constant extends Base {\r\n}\r\n\r\nclass Variable extends Base {\r\n}\r\n\r\nclass Slider extends Variable {\r\n}\r\n\r\nclass MouseMove extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=str.slice(-1)\r\n\t}\r\n}\r\n\r\nclass Gamepad extends Variable {\r\n\tconstructor(str) {\r\n\t\tsuper(str)\r\n\t\tthis.axis=Number(str.slice(-1))\r\n\t}\r\n}\r\n\r\nfunction createFromString(str) {\r\n\treturn new {\r\n\t\t'constant':   Constant,\r\n\t\t'slider':     Slider,\r\n\t\t'mousemovex': MouseMove,\r\n\t\t'mousemovey': MouseMove,\r\n\t\t'gamepad0':   Gamepad,\r\n\t\t'gamepad1':   Gamepad,\r\n\t\t'gamepad2':   Gamepad,\r\n\t\t'gamepad3':   Gamepad,\r\n\t}[str](str)\r\n}\r\n\r\nexports.Base=Base\r\nexports.Constant=Constant\r\nexports.Variable=Variable\r\nexports.Slider=Slider\r\nexports.MouseMove=MouseMove\r\nexports.Gamepad=Gamepad\r\nexports.createFromString=createFromString\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Lines=require('crnx-base/lines')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass IntFeature extends NumericFeature {\r\n\tconstructor(name,value) {\r\n\t\tsuper()\r\n\t\tthis.name=name\r\n\t\tthis.value=value\r\n\t}\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.value.input!='constant'\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tif (this.value.input!='constant') {\r\n\t\t\tfeatureContext.hasInputs=true\r\n\t\t}\r\n\t\tif (this.value.input=='slider') {\r\n\t\t\tfeatureContext.hasSliders=true\r\n\t\t}\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\ta(this.getHtmlControlMessageForValue(i18n,this.value,this.name))\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\ta(\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tthis.value,\r\n\t\t\t\t'options.'+this.name,\r\n\t\t\t\tthis.name,\r\n\t\t\t\tfalse\r\n\t\t\t)\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=IntFeature\r\n","'use strict'\r\n\r\nconst capitalize=require('crnx-base/fake-lodash/capitalize')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\n\r\nclass Base {\r\n\tconstructor() {\r\n\t\tthis.entries=[]\r\n\t}\r\n\tenter() {\r\n\t\tconst entry={\r\n\t\t\tpre: [],\r\n\t\t\tcond: null,\r\n\t\t\tlog: [],\r\n\t\t\tpost: [],\r\n\t\t}\r\n\t\tthis.entries.push(entry)\r\n\t\tfunction makePushArgs(where){\r\n\t\t\treturn function(){\r\n\t\t\t\twhere.push(...arguments)\r\n\t\t\t\treturn proxy\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst proxy={\r\n\t\t\tpre: makePushArgs(entry.pre),\r\n\t\t\tcond: function(cond){\r\n\t\t\t\tentry.cond=cond\r\n\t\t\t\treturn proxy\r\n\t\t\t},\r\n\t\t\tlog: makePushArgs(entry.log),\r\n\t\t\tpost: makePushArgs(entry.post),\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn []\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"\"\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn lines\r\n\t}\r\n\twrite(haveToUpdateCanvas,haveToLogInput) {\r\n\t\tconst statementsGraph={}\r\n\t\tconst statementsRoot=[]\r\n\t\tlet statementsPrev=null\r\n\t\tconst WHITE=0\r\n\t\tconst GRAY=1\r\n\t\tconst BLACK=2\r\n\t\tconst addStatement=(statement,cond)=>{\r\n\t\t\tlet vertex\r\n\t\t\tif (statement in statementsGraph) {\r\n\t\t\t\tvertex=statementsGraph[statement]\r\n\t\t\t} else {\r\n\t\t\t\tvertex=statementsGraph[statement]={\r\n\t\t\t\t\tprevs: [],\r\n\t\t\t\t\tconds: [],\r\n\t\t\t\t\tmark: WHITE,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\tif (cond===null) {\r\n\t\t\t\t\tvertex.conds=null\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvertex.conds.push(cond)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tvertex.prevs.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=statement\r\n\t\t}\r\n\t\tconst closeEntryStatements=()=>{\r\n\t\t\tif (statementsPrev!==null) {\r\n\t\t\t\tstatementsRoot.push(statementsPrev)\r\n\t\t\t}\r\n\t\t\tstatementsPrev=null\r\n\t\t}\r\n\t\tconst getStatements=()=>{\r\n\t\t\tconst statements=[]\r\n\t\t\tlet currentCond=null\r\n\t\t\tconst writeStatement=(statement,vertex)=>{\r\n\t\t\t\tlet newCond=null\r\n\t\t\t\tif (vertex.conds!==null) {\r\n\t\t\t\t\tnewCond=vertex.conds.join(' || ')\r\n\t\t\t\t}\r\n\t\t\t\tif (newCond!=currentCond) {\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"}\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentCond=newCond\r\n\t\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\t\tstatements.push(\"if (\"+currentCond+\") {\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (currentCond!==null) {\r\n\t\t\t\t\tstatements.push('\\t'+statement)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatements.push(statement)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst recVertex=(statement,vertex)=>{\r\n\t\t\t\tvertex.mark=GRAY\r\n\t\t\t\trecPrevs(vertex.prevs)\r\n\t\t\t\tvertex.mark=BLACK\r\n\t\t\t\twriteStatement(statement,vertex)\r\n\t\t\t}\r\n\t\t\tconst recPrevs=(prevs)=>{\r\n\t\t\t\tprevs.forEach((statement)=>{\r\n\t\t\t\t\tif (statementsGraph[statement].mark==WHITE) {\r\n\t\t\t\t\t\trecVertex(statement,statementsGraph[statement])\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\trecPrevs(statementsRoot)\r\n\t\t\tif (currentCond!==null) {\r\n\t\t\t\tstatements.push(\"}\")\r\n\t\t\t}\r\n\t\t\treturn statements\r\n\t\t}\r\n\t\tthis.entries.forEach((entry)=>{\r\n\t\t\tentry.pre.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,null)\r\n\t\t\t})\r\n\t\t\tif (haveToLogInput) {\r\n\t\t\t\tentry.log.forEach(statement=>{\r\n\t\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tentry.post.forEach(statement=>{\r\n\t\t\t\taddStatement(statement,entry.cond)\r\n\t\t\t})\r\n\t\t\tif (haveToUpdateCanvas) {\r\n\t\t\t\taddStatement(\"scheduleFrame();\",entry.cond)\r\n\t\t\t}\r\n\t\t\tcloseEntryStatements()\r\n\t\t})\r\n\t\tconst br=this.bracketListener()\r\n\t\tlet statements=getStatements()\r\n\t\tif (statements.length>0) {\r\n\t\t\tstatements=[...this.prependedStatements(),...statements]\r\n\t\t}\r\n\t\tif (statements.length==1) {\r\n\t\t\tconst match=/^(\\w+)\\(\\);$/.exec(statements[0])\r\n\t\t\tif (match) {\r\n\t\t\t\treturn this.wrapCall(\r\n\t\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\tbr[0]+match[1]+br[1]\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t// TODO what if no match?\r\n\t\t}\r\n\t\tif (statements.length>0) {\r\n\t\t\treturn this.wrapCall(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(br[0]+\"function(\"+this.bracketFnArg()+\"){\"),\r\n\t\t\t\t\tJsLines.bae(\"}\"+br[1])\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tJsLines.bae(...statements)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Slider extends Base {\r\n\tconstructor(id) {\r\n\t\tsuper()\r\n\t\tthis.id=id\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"document.getElementById('\"+this.id+\"').addEventListener('change',\",\");\"]\r\n\t}\r\n}\r\n\r\nclass MultipleSlider extends Base {\r\n\tconstructor(query) {\r\n\t\tsuper()\r\n\t\tthis.query=query\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"el.addEventListener('change',\",\");\"]\r\n\t}\r\n\twrapCall(lines) {\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\";[].forEach.call(document.querySelectorAll('\"+this.query+\"'),function(el){\"),\r\n\t\t\tJsLines.bae(\"});\")\r\n\t\t).ae(lines)\r\n\t}\r\n}\r\n\r\nclass CanvasMousemove extends Base {\r\n\tenter() {\r\n\t\tconst proxy=super.enter()\r\n\t\tconst floatHelper=(minMaxFlag,varFlag,inputType,varName,minValue,maxValue)=>{\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\tlet dest\r\n\t\t\tif (minValue==0 && maxValue==1) {\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=\"\r\n\t\t\t} else {\r\n\t\t\t\tproxy.pre(\"var min\"+VarName+\"=\"+minValue+\";\")\r\n\t\t\t\tproxy.pre(\"var max\"+VarName+\"=\"+maxValue+\";\")\r\n\t\t\t\tdest=(varFlag?\"var \":\"\")+varName+\"=min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\")*\"\r\n\t\t\t}\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\tdest+\"(ev.clientX-rect.left)/(rect.width-1);\",\r\n\t\t\t\tdest+\"(rect.bottom-1-ev.clientY)/(rect.height-1);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tproxy.prexy=function(inputType,xStatement,yStatement){\r\n\t\t\tif (inputType.axis=='x') {\r\n\t\t\t\treturn proxy.pre(xStatement)\r\n\t\t\t} else if (inputType.axis=='y') {\r\n\t\t\t\treturn proxy.pre(yStatement)\r\n\t\t\t}\r\n\t\t\treturn proxy\r\n\t\t}\r\n\t\tproxy.minMaxFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,false,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.minMaxVarFloat=function(inputType,varName,minValue,maxValue){\r\n\t\t\treturn floatHelper(true,true,inputType,varName,minValue,maxValue)\r\n\t\t}\r\n\t\tproxy.newVarInt=function(inputType,varName){\r\n\t\t\tconst VarName=capitalize(varName)\r\n\t\t\treturn proxy.prexy(\r\n\t\t\t\tinputType,\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(ev.clientX-rect.left)/rect.width);\",\r\n\t\t\t\t\"var new\"+VarName+\"=Math.floor(min\"+VarName+\"+(max\"+VarName+\"-min\"+VarName+\"+1)*(rect.bottom-1-ev.clientY)/rect.height);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn proxy\r\n\t}\r\n\tbracketListener() {\r\n\t\treturn [\"canvas.addEventListener('mousemove',\",\");\"]\r\n\t}\r\n\tbracketFnArg() {\r\n\t\treturn \"ev\"\r\n\t}\r\n\tprependedStatements() {\r\n\t\treturn [\r\n\t\t\t\"var rect=this.getBoundingClientRect();\",\r\n\t\t]\r\n\t}\r\n}\r\n\r\nexports.Slider=Slider\r\nexports.MultipleSlider=MultipleSlider\r\nexports.CanvasMousemove=CanvasMousemove\r\n","'use strict'\r\n\r\nlet idCounter=0\r\nfunction generateId() {\r\n\treturn 'webgl-starter-id-'+(idCounter++)\r\n}\r\n\r\nconst i18ns=require('./i18n')\r\nconst Options=require('./options')\r\nconst Code=require('./code')\r\nconst OptionsOutput=require('./options-output')\r\nconst CodeOutput=require('crnx-base/code-output')\r\n\r\n$(function(){\r\n\t$('.webgl-starter').each(function(){\r\n\t\tconst $container=$(this)\r\n\t\tconst lang=$container.closest('[lang]').attr('lang')\r\n\t\tconst i18n=i18ns(lang)\r\n\t\tconst options=new Options()\r\n\t\tconst codeOutput=new CodeOutput(()=>new Code(options.fix(),i18n),i18n)\r\n\t\toptions.addUpdateCallback(codeOutput.update)\r\n\t\tconst optionsOutput=new OptionsOutput(options,generateId,i18n)\r\n\t\t$container.empty().append(\r\n\t\t\toptionsOutput.$output,\r\n\t\t\tcodeOutput.$output\r\n\t\t)\r\n\t})\r\n})\r\n","'use strict'\r\n\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\n\r\nclass NumericFeature extends Feature {\r\n\t// private:\r\n\tgetHtmlControlMessageForValue(i18n,value,name) {\r\n\t\tif (value.input instanceof Input.MouseMove) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\t\"<li>\"+i18n('controls.type.'+value.input)+\" \"+i18n('controls.to')+\" <strong>\"+i18n('options.'+name)+\"</strong></li>\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn Lines.be()\r\n\t\t}\r\n\t}\r\n\tgetHtmlSliderLines(i18n,value,opName,htmlName,step) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (value.input=='slider') {\r\n\t\t\tconst fmtAttrs=formatNumbers.html({ min:value.min, max:value.max, value:value.value },value.precision)\r\n\t\t\tconst fmtLabels=formatNumbers({ min:value.min, max:value.max },value.precision)\r\n\t\t\tconst minMax=n=>i18n.numberWithUnits(n,value.unit,(a,e)=>Lines.html`<abbr title=${e}>`+a+`</abbr>`)\r\n\t\t\ta(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\tLines.html`\t<label for=${htmlName}>`+i18n(opName)+`</label>`,\r\n\t\t\t\t\"\t<span class=min>\"+minMax(fmtLabels.min)+\"</span>\",\r\n\t\t\t\tLines.html`\t<input type=range id=${htmlName} min=${fmtAttrs.min} max=${fmtAttrs.max} value=${fmtAttrs.value} step=${step}>`,\r\n\t\t\t\t\"\t<span class=max>\"+minMax(fmtLabels.max)+\"</span>\",\r\n\t\t\t\t\"</div>\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=NumericFeature\r\n","'use strict'\r\n\r\nconst Input=require('./input-classes')\r\nconst Option=Object.create(require('crnx-base/option-classes'))\r\n\r\nclass FixedLiveNumber {\r\n\tconstructor(src,setToDefault) {\r\n\t\tif (!setToDefault) {\r\n\t\t\tthis.value=src.value\r\n\t\t\tthis.min=src.min\r\n\t\t\tthis.max=src.max\r\n\t\t\tthis.input=Input.createFromString(src.input)\r\n\t\t} else {\r\n\t\t\tthis.value=src.defaultValue\r\n\t\t\tthis.min=src.availableMin\r\n\t\t\tthis.max=src.availableMax\r\n\t\t\tthis.input=Input.createFromString('constant')\r\n\t\t}\r\n\t\tthis.precision=src.precision\r\n\t\tthis.unit=src.unit\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value\r\n\t}\r\n\ttoString() {\r\n\t\treturn String(this.value)\r\n\t}\r\n}\r\n\r\n// abstract classes\r\n\r\nOption.LiveNumber = class extends Option.Number {\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tlet dataValue,dataMin,dataMax,dataInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value\r\n\t\t\tdataMin  =data.min\r\n\t\t\tdataMax  =data.max\r\n\t\t\tdataInput=data.input\r\n\t\t} else {\r\n\t\t\tdataValue=data\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._min=(dataMin!==undefined)?dataMin:this.availableMin\r\n\t\tthis._max=(dataMax!==undefined)?dataMax:this.availableMax\r\n\t\tthis._input=(dataInput!==undefined)?dataInput:'constant'\r\n\t\tthis._$range=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tif (this._$range) this._$range.toggle(this._input!='constant')\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.update()\r\n\t}\r\n\tget min() {\r\n\t\treturn this._min\r\n\t}\r\n\tset min(min) {\r\n\t\tthis._min=min\r\n\t\tthis.update()\r\n\t}\r\n\tget max() {\r\n\t\treturn this._max\r\n\t}\r\n\tset max(max) {\r\n\t\tthis._max=max\r\n\t\tthis.update()\r\n\t}\r\n\tget $range() {\r\n\t\treturn this._$range\r\n\t}\r\n\tset $range($range) {\r\n\t\tthis._$range=$range\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texportHelper(src) {\r\n\t\tconst data={}\r\n\t\tif (src.value!=src.defaultValue) data.value=src.value\r\n\t\tif (src.min!=src.availableMin) data.min=src.min\r\n\t\tif (src.max!=src.availableMax) data.max=src.max\r\n\t\tif (src.input!='constant') data.input=src.input\r\n\t\treturn data\r\n\t}\r\n\texport() {\r\n\t\treturn this.exportHelper(this)\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=new FixedLiveNumber(this)\r\n\t\tfixed.name=this.name\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.LiveInt = class extends Option.LiveNumber {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey']\r\n\t}\r\n}\r\n\r\nOption.CanvasLiveInt = class extends Option.LiveInt {\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider']\r\n\t}\r\n}\r\n\r\nOption.LiveFloat = class extends Option.LiveNumber {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.speed===undefined) settings.speed={}\r\n\t\tif (settings.speed.availableMin===undefined) settings.speed.availableMin=arrayArg[2]\r\n\t\tif (settings.speed.availableMax===undefined) settings.speed.availableMax=arrayArg[3]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,parent,visibilityManager,makeEntry) {\r\n\t\tlet dataSpeedValue,dataSpeedMin,dataSpeedMax,dataSpeedInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tif (typeof data.speed == 'object') {\r\n\t\t\t\tdataSpeedValue=data.speed.value\r\n\t\t\t\tdataSpeedMin  =data.speed.min\r\n\t\t\t\tdataSpeedMax  =data.speed.max\r\n\t\t\t\tdataSpeedInput=data.speed.input\r\n\t\t\t} else {\r\n\t\t\t\tdataSpeedValue=data.speed\r\n\t\t\t}\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._speedAvailableMin=settings.speed.availableMin\r\n\t\tthis._speedAvailableMax=settings.speed.availableMax\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._speedValue=(dataSpeedValue!==undefined)?dataSpeedValue:0\r\n\t\tthis._speedMin=(dataSpeedMin!==undefined)?dataSpeedMin:this._speedAvailableMin\r\n\t\tthis._speedMax=(dataSpeedMax!==undefined)?dataSpeedMax:this._speedAvailableMax\r\n\t\tthis._speedInput=(dataSpeedInput!==undefined)?dataSpeedInput:'constant'\r\n\t\tthis._addSpeed=!(\r\n\t\t\tthis._speedValue==0 &&\r\n\t\t\tthis._speedMin==this._speedAvailableMin &&\r\n\t\t\tthis._speedMax==this._speedAvailableMax &&\r\n\t\t\tthis._speedInput=='constant'\r\n\t\t)\r\n\t\tthis._speed$=null\r\n\t\tthis._speed$range=null\r\n\t\tthis._$addSpeed=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tsuper.updateInternalVisibility()\r\n\t\tif (this._speed$range) this._speed$range.toggle(this._speedInput!='constant')\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this._input)<0\r\n\t\tif (this._speed$) this._speed$.toggle(\r\n\t\t\tthis._addSpeed && notGamepad\r\n\t\t)\r\n\t\tif (this._$addSpeed) this._$addSpeed.toggle(notGamepad)\r\n\t}\r\n\tget addSpeed() {\r\n\t\treturn this._addSpeed\r\n\t}\r\n\tset addSpeed(addSpeed) {\r\n\t\tthis._addSpeed=addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.update()\r\n\t}\r\n\tget availableInputTypes() {\r\n\t\treturn ['constant','slider','mousemovex','mousemovey','gamepad0','gamepad1','gamepad2','gamepad3']\r\n\t}\r\n\tget speed() {\r\n\t\tconst option=this\r\n\t\treturn {\r\n\t\t\tget fullName() {\r\n\t\t\t\treturn option.fullName+'.speed'\r\n\t\t\t},\r\n\t\t\tget defaultValue() {\r\n\t\t\t\treturn 0\r\n\t\t\t},\r\n\t\t\tget value() {\r\n\t\t\t\treturn option._speedValue\r\n\t\t\t},\r\n\t\t\tset value(value) {\r\n\t\t\t\toption._speedValue=value\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget input() {\r\n\t\t\t\treturn option._speedInput\r\n\t\t\t},\r\n\t\t\tset input(input) {\r\n\t\t\t\toption._speedInput=input\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget availableMin() {\r\n\t\t\t\treturn option._speedAvailableMin\r\n\t\t\t},\r\n\t\t\tget availableMax() {\r\n\t\t\t\treturn option._speedAvailableMax\r\n\t\t\t},\r\n\t\t\tget min() {\r\n\t\t\t\treturn option._speedMin\r\n\t\t\t},\r\n\t\t\tset min(min) {\r\n\t\t\t\toption._speedMin=min\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget max() {\r\n\t\t\t\treturn option._speedMax\r\n\t\t\t},\r\n\t\t\tset max(max) {\r\n\t\t\t\toption._speedMax=max\r\n\t\t\t\toption.update()\r\n\t\t\t},\r\n\t\t\tget precision() {\r\n\t\t\t\treturn option.precision\r\n\t\t\t},\r\n\t\t\tget unit() {\r\n\t\t\t\tif (option.unit!==undefined) {\r\n\t\t\t\t\treturn option.unit+'/second'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '1/second'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget availableInputTypes() {\r\n\t\t\t\treturn option.availableInputTypes\r\n\t\t\t},\r\n\t\t\tget $() {\r\n\t\t\t\treturn option._speed$\r\n\t\t\t},\r\n\t\t\tset $($) {\r\n\t\t\t\toption._speed$=$\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t},\r\n\t\t\tget $range() {\r\n\t\t\t\treturn option._speed$range\r\n\t\t\t},\r\n\t\t\tset $range($range) {\r\n\t\t\t\toption._speed$range=$range\r\n\t\t\t\toption.updateInternalVisibility()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $addSpeed() {\r\n\t\treturn this._$addSpeed\r\n\t}\r\n\tset $addSpeed($addSpeed) {\r\n\t\tthis._$addSpeed=$addSpeed\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texport() {\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tconst data=this.exportHelper(this)\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tthis.shortenExportAssign(this.exportHelper(this.speed),data,'speed')\r\n\t\t}\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tconst notGamepad=['gamepad0','gamepad1','gamepad2','gamepad3'].indexOf(this.input)<0\r\n\t\tif (notGamepad && this.addSpeed) {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed)\r\n\t\t} else {\r\n\t\t\tfixed.speed=new FixedLiveNumber(this.speed,true)\r\n\t\t}\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.LiveColor = class extends Option.Group {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.componentDefaultValues===undefined) settings.componentDefaultValues=arrayArg\r\n\t\tconst cs='rgba'\r\n\t\tsettings.descriptions=settings.componentDefaultValues.map((defaultValue,i)=>{\r\n\t\t\tconst c=cs.charAt(i)\r\n\t\t\treturn ['LiveFloat',c,[0,1,-1,+1],defaultValue]\r\n\t\t})\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst BaseOptionsOutput=require('crnx-base/options-output')\r\n\r\nclass OptionsOutput extends BaseOptionsOutput {\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\tsuper.setOptionClassWriters(optionClassWriters)\r\n\t\tconst baseSelectWriter=optionClassWriters.get(Option.Select)\r\n\t\toptionClassWriters.set(Option.LiveNumber,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst writeSubOption=option=>{\r\n\t\t\t\tconst p=option.precision\r\n\t\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\t\tconst writeMinMaxInput=minOrMax=>setInputAttrs($(\"<input type='number' required>\"))\r\n\t\t\t\t\t.val(option[minOrMax])\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\t\toption[minOrMax]=parseFloat(this.value)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\tconst id=generateId()\r\n\t\t\t\tlet $inputSelect,$rangeMinInput,$rangeMaxInput\r\n\t\t\t\tconst $output=optionClassWriters.get(Option.Number)(option,writeOption,i18n,generateId)\r\n\t\t\t\t$output.find('button').before(\r\n\t\t\t\t\t$(\"<label class='nowrap'>\").append(\r\n\t\t\t\t\t\ti18n('options-output.inputs')+\": \",\r\n\t\t\t\t\t\t$inputSelect=$(\"<select>\").append(\r\n\t\t\t\t\t\t\toption.availableInputTypes.map(availableInputType=>\r\n\t\t\t\t\t\t\t\t$(\"<option>\").val(availableInputType).html(i18n('options-output.inputs.'+availableInputType))\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t).val(option.input).change(function(){\r\n\t\t\t\t\t\t\toption.input=this.value\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\" \",\r\n\t\t\t\t\toption.$range=$(\"<span class='range'>\").append(\r\n\t\t\t\t\t\ti18n('options-output.range')+\" \",\r\n\t\t\t\t\t\t$(\"<span class='nowrap'>\").append(\r\n\t\t\t\t\t\t\t$rangeMinInput=writeMinMaxInput('min'),\r\n\t\t\t\t\t\t\t\" .. \",\r\n\t\t\t\t\t\t\t$rangeMaxInput=writeMinMaxInput('max')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\" \"\r\n\t\t\t\t).click(function(){\r\n\t\t\t\t\t$inputSelect.val('constant').change()\r\n\t\t\t\t\t$rangeMinInput.val(option.availableMin).change()\r\n\t\t\t\t\t$rangeMaxInput.val(option.availableMax).change()\r\n\t\t\t\t})\r\n\t\t\t\treturn $output\r\n\t\t\t}\r\n\t\t\tif (option instanceof Option.LiveFloat) {\r\n\t\t\t\treturn option.$=$(\"<div>\").append(\r\n\t\t\t\t\twriteSubOption(option).append(\r\n\t\t\t\t\t\t\" \",\r\n\t\t\t\t\t\toption.$addSpeed=$(\"<label class='nowrap'>\").append(\r\n\t\t\t\t\t\t\t$(\"<input type='checkbox'>\")\r\n\t\t\t\t\t\t\t\t.prop('checked',option.addSpeed)\r\n\t\t\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\t\t\toption.addSpeed=this.checked\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\" \"+i18n('options-output.addSpeed')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t),\r\n\t\t\t\t\toption.speed.$=writeSubOption(option.speed)\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\treturn option.$=writeSubOption(option)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nconst BaseOptions=require('crnx-base/options')\r\n\r\nclass Options extends BaseOptions {\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn [\r\n\t\t\t['Group','canvas',[\r\n\t\t\t\t['CanvasLiveInt','width' ,[1,1024],512,{ unit: 'pixel' }],\r\n\t\t\t\t['CanvasLiveInt','height',[1,1024],512,{ unit: 'pixel' }],\r\n\t\t\t]],\r\n\t\t\t['Group','background',[\r\n\t\t\t\t['Select','type',['none','solid']],\r\n\t\t\t\t['LiveColor','color',[1,1,1,1],{\r\n\t\t\t\t\tvisibilityData: {'background.type':'solid'},\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','material',[\r\n\t\t\t\t['Select','scope',['global','vertex','face']], // partly related to shape\r\n\t\t\t\t['Select','data',['one','sda']], // partly related to shape\r\n\t\t\t\t['LiveColor','color',[1,0,0,1],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'one'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','specularColor',[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'},\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','diffuseColor' ,[0.4,0.4,0.4],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t\t['LiveColor','ambientColor' ,[0.2,0.2,0.2],{\r\n\t\t\t\t\tvisibilityData: {'material.scope':'global','material.data':'sda'}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','light',[\r\n\t\t\t\t['Select','type',['off','phong','blinn']],\r\n\t\t\t\t['Group','direction',[\r\n\t\t\t\t\t['LiveFloat','x',[-4,+4,-4,+4],-1],\r\n\t\t\t\t\t['LiveFloat','y',[-4,+4,-4,+4],+1],\r\n\t\t\t\t\t['LiveFloat','z',[-4,+4,-4,+4],+1],\r\n\t\t\t\t],{\r\n\t\t\t\t\tvisibilityData: {'light.type':['phong','blinn']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','shape',[\r\n\t\t\t\t['Select','type',['square','triangle','gasket','cube','hat','terrain']],\r\n\t\t\t\t['Select','elements',['0','8','16','32']],\r\n\t\t\t\t['LiveInt','lod',[0,10],6,{\r\n\t\t\t\t\tvisibilityData: {'shape.type':['gasket','hat','terrain']}\r\n\t\t\t\t}],\r\n\t\t\t]],\r\n\t\t\t['Group','transforms',[\r\n\t\t\t\t['Select','projection',['ortho','perspective']],\r\n\t\t\t\t['Array','model',[\r\n\t\t\t\t\t['LiveFloat','rotate.x',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t\t['LiveFloat','rotate.y',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t\t['LiveFloat','rotate.z',[-180,+180,-360,+360],0,{ unit: '°' }],\r\n\t\t\t\t]],\r\n\t\t\t]],\r\n\t\t\t['Group','debug',[\r\n\t\t\t\t['Checkbox','shaders',true],\r\n\t\t\t\t['Checkbox','arrays'],\r\n\t\t\t\t['Checkbox','inputs'], // TODO hide if no inputs?\r\n\t\t\t\t['Checkbox','animations'],\r\n\t\t\t]],\r\n\t\t]\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nexports.square=require('./shapes/square')\r\nexports.triangle=require('./shapes/triangle')\r\nexports.gasket=require('./shapes/gasket')\r\nexports.cube=require('./shapes/cube')\r\nexports.hat=require('./shapes/hat')\r\nexports.terrain=require('./shapes/terrain')\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Cube extends Shape {\r\n\tget dim() { return 3 }\r\n\tget twoSided() { return false }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(\r\n\t\t\tthis.colorAttrs,\r\n\t\t\t0, // TODO remove 'clean' colors after bilinear interp is implemented\r\n\t\t\tthis.hasColorsPerFace?undefined:[\r\n\t\t\t\t[0.0, 0.0, 0.0],\r\n\t\t\t\t[1.0, 0.0, 0.0],\r\n\t\t\t\t[0.0, 1.0, 0.0],\r\n\t\t\t\t[1.0, 1.0, 0.0],\r\n\t\t\t\t[0.0, 0.0, 1.0],\r\n\t\t\t\t[1.0, 0.0, 1.0],\r\n\t\t\t\t[0.0, 1.0, 1.0],\r\n\t\t\t\t[1.0, 1.0, 1.0],\r\n\t\t\t]\r\n\t\t)\r\n\t\tconst nCubeVertices=8\r\n\t\tconst cubeColors=[]\r\n\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\tcubeColors.push(colorgen.getNextColorString())\r\n\t\t}\r\n\t\tconst cubeVertexPositions=[\r\n\t\t\t\"-0.5,-0.5,-0.5,\",\r\n\t\t\t\"+0.5,-0.5,-0.5,\",\r\n\t\t\t\"-0.5,+0.5,-0.5,\",\r\n\t\t\t\"+0.5,+0.5,-0.5,\",\r\n\t\t\t\"-0.5,-0.5,+0.5,\",\r\n\t\t\t\"+0.5,-0.5,+0.5,\",\r\n\t\t\t\"-0.5,+0.5,+0.5,\",\r\n\t\t\t\"+0.5,+0.5,+0.5,\",\r\n\t\t]\r\n\t\tconst nCubeFaces=6\r\n\t\tconst cubeFaceNames=[\r\n\t\t\t\"left\",\r\n\t\t\t\"right\",\r\n\t\t\t\"bottom\",\r\n\t\t\t\"top\",\r\n\t\t\t\"back\",\r\n\t\t\t\"front\",\r\n\t\t]\r\n\t\tconst cubeFaceNormals=[\r\n\t\t\t\"-1.0, 0.0, 0.0,\",\r\n\t\t\t\"+1.0, 0.0, 0.0,\",\r\n\t\t\t\" 0.0,-1.0, 0.0,\",\r\n\t\t\t\" 0.0,+1.0, 0.0,\",\r\n\t\t\t\" 0.0, 0.0,-1.0,\",\r\n\t\t\t\" 0.0, 0.0,+1.0,\",\r\n\t\t]\r\n\t\tconst cubeFaceVertices=[\r\n\t\t\t[4, 6, 0, 2],\r\n\t\t\t[1, 3, 5, 7],\r\n\t\t\t[0, 1, 4, 5],\r\n\t\t\t[2, 6, 3, 7],\r\n\t\t\t[0, 2, 1, 3],\r\n\t\t\t[5, 7, 4, 6],\r\n\t\t]\r\n\t\tconst quadToTriangleMap=[0, 1, 2, 2, 1, 3]\r\n\t\tconst vertexCtor=JsLines.b()\r\n\t\tvertexCtor(\"// x    y    z\")\r\n\t\tif (this.hasNormals) {\r\n\t\t\tvertexCtor.t(\"  n.x  n.y  n.z\")\r\n\t\t}\r\n\t\tvertexCtor.t(colorgen.getHeaderString())\r\n\t\tconst appendVertex=(iFace,iVertex,firstInFace)=>{\r\n\t\t\tvertexCtor(cubeVertexPositions[iVertex])\r\n\t\t\tif (this.hasNormals) {\r\n\t\t\t\tvertexCtor.t(cubeFaceNormals[iFace])\r\n\t\t\t}\r\n\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iVertex])\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\tvertexCtor.t(cubeColors[iFace])\r\n\t\t\t}\r\n\t\t\tif (firstInFace) {\r\n\t\t\t\tvertexCtor.t(\" // \"+cubeFaceNames[iFace]+\" face\")\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst wrapVertices=()=>WrapLines.b(\r\n\t\t\tJsLines.bae(\"var vertices=new Float32Array([\"),\r\n\t\t\tJsLines.bae(\"]);\")\r\n\t\t).ae(\r\n\t\t\tvertexCtor.e()\r\n\t\t)\r\n\t\tif (!this.usesElements()) {\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tquadToTriangleMap.forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,cubeFaceVertices[i][j],k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t\"var nVertices=36;\",\r\n\t\t\t\twrapVertices()\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace || this.hasNormals) {\r\n\t\t\t// elements, face data\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\tcubeFaceVertices[i].forEach(function(j,k){\r\n\t\t\t\t\tappendVertex(i,j,k==0)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([\",\r\n\t\t\t\t\"\t 0,  1,  2,  2,  1,  3, // left face\",\r\n\t\t\t\t\"\t 4,  5,  6,  6,  5,  7, // right face\",\r\n\t\t\t\t\"\t 8,  9, 10, 10,  9, 11, // bottom face\",\r\n\t\t\t\t\"\t12, 13, 14, 14, 13, 15, // top face\",\r\n\t\t\t\t\"\t16, 17, 18, 18, 17, 19, // back face\",\r\n\t\t\t\t\"\t20, 21, 22, 22, 21, 23, // front face\",\r\n\t\t\t\t\"]);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\t// elements, no face data\r\n\t\t\tfor (let i=0;i<nCubeVertices;i++) {\r\n\t\t\t\tvertexCtor(cubeVertexPositions[i])\r\n\t\t\t\tif (this.hasColorsPerVertex) {\r\n\t\t\t\t\tvertexCtor.t(cubeColors[i])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst elementCtor=JsLines.b()\r\n\t\t\tfor (let i=0;i<nCubeFaces;i++) {\r\n\t\t\t\telementCtor(\"\")\r\n\t\t\t\tquadToTriangleMap.forEach(function(j){\r\n\t\t\t\t\telementCtor.t(cubeFaceVertices[i][j]+\", \")\r\n\t\t\t\t})\r\n\t\t\t\telementCtor.t(\"// \"+cubeFaceNames[i]+\" face\")\r\n\t\t\t}\r\n\t\t\tconst wrapElements=()=>WrapLines.b(\r\n\t\t\t\tJsLines.bae(\"var elements=new \"+this.getElementIndexJsArray()+\"([\"),\r\n\t\t\t\tJsLines.bae(\"]);\")\r\n\t\t\t).ae(\r\n\t\t\t\telementCtor.e()\r\n\t\t\t)\r\n\t\t\treturn new Lines(\r\n\t\t\t\twrapVertices(),\r\n\t\t\t\t\"var nElements=36;\",\r\n\t\t\t\twrapElements()\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Cube\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Gasket extends LodShape {\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"(Math.pow(3,\"+lodSymbol+\"+1)+3)/2\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow(3,\"+lodSymbol+\")*3\"\r\n\t}\r\n\twriteStoreShape() {\r\n\t\tconst writePushVertex=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[0];\",\r\n\t\t\t\t\"vertices[nextIndexIntoVertices++]=p[1];\"\r\n\t\t\t)\r\n\t\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\"colors[nextIndexIntoColors]\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"colors[nextElement%colors.length]\")\r\n\t\t\t\t}\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\".forEach(function(cc){\",\r\n\t\t\t\t\t\"\tvertices[nextIndexIntoVertices++]=cc;\",\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"return nextElement++;\")\r\n\t\t\t} else if (this.hasColorsPerVertex) {\r\n\t\t\t\ta(\"nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\")\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeTriangle=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"if (depth<=0) {\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tpushVertex(p2);\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.hasColorsPerFace) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p0));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p1));\",\r\n\t\t\t\t\t\t\"\tpushElement(pushVertex(p2));\",\r\n\t\t\t\t\t\t\"\tnextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"\tif (es[0]===null) es[0]=pushVertex(p0);\",\r\n\t\t\t\t\t\t\"\tif (es[1]===null) es[1]=pushVertex(p1);\",\r\n\t\t\t\t\t\t\"\tif (es[2]===null) es[2]=pushVertex(p2);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[0]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[1]);\",\r\n\t\t\t\t\t\t\"\tpushElement(es[2]);\",\r\n\t\t\t\t\t\t\"\treturn es;\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"} else {\",\r\n\t\t\t\t\"\tvar p01=mix(p0,p1);\",\r\n\t\t\t\t\"\tvar p12=mix(p1,p2);\",\r\n\t\t\t\t\"\tvar p20=mix(p2,p0);\"\r\n\t\t\t)\r\n\t\t\tif (!this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\ttriangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\ttriangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12);\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"\tvar es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);\",\r\n\t\t\t\t\t\"\tvar es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);\",\r\n\t\t\t\t\t\"\tvar es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);\",\r\n\t\t\t\t\t\"\treturn [es0[0],es1[0],es2[0]];\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst writeInitialTriangleCall=()=>{\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\ta(\r\n\t\t\t\t\"shapeLod,\",\r\n\t\t\t\t\"[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],\",\r\n\t\t\t\t\"[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements() && !this.hasColorsPerFace) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\",\",\"[null,null,null]\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var nextIndexIntoVertices=0;\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"var nextIndexIntoElements=0;\")\r\n\t\t\ta(\"var nextElement=0;\")\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(\"// p = position, cc = color component, e = element, es = elements\")\r\n\t\t\ta(this.writeColorData())\r\n\t\t\tif (!this.usesElements() || this.hasColorsPerFace) {\r\n\t\t\t\ta(\"var nextIndexIntoColors=0;\")\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\"// p = position, e = element, es = elements\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"function pushVertex(p) {\"),\r\n\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t).ae(\r\n\t\t\t\twritePushVertex()\r\n\t\t\t)\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function pushElement(e) {\",\r\n\t\t\t\t\"\telements[nextIndexIntoElements++]=e;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"function mix(pa,pb) {\",\r\n\t\t\t\"\treturn [\",\r\n\t\t\t\"\t\t(pa[0]+pb[0])/2,\",\r\n\t\t\t\"\t\t(pa[1]+pb[1])/2,\",\r\n\t\t\t\"\t];\",\r\n\t\t\t\"}\",\r\n\t\t\t((!this.usesElements() || this.hasColorsPerFace)\r\n\t\t\t\t? WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t\t: WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function triangle(depth,p0,p1,p2,es) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\twriteTriangle()\r\n\t\t\t),\r\n\t\t\tWrapLines.b(\r\n\t\t\t\tJsLines.bae(\"triangle(\"),\r\n\t\t\t\tJsLines.bae(\");\")\r\n\t\t\t).ae(\r\n\t\t\t\twriteInitialTriangleCall()\r\n\t\t\t)\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Gasket\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Hat extends Mesh {\r\n\twriteMeshInit() {\r\n\t\treturn JsLines.bae(\r\n\t\t\t\"var xyRange=4;\",\r\n\t\t\t\"var xyScale=1/(4*Math.sqrt(2));\"\r\n\t\t)\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst a=JsLines.b()\r\n\t\tlet iv=0\r\n\t\ta(\r\n\t\t\t\"var r2=(x*x+y*y)/2;\",\r\n\t\t\t\"var A=Math.exp(-r2)/Math.PI;\",\r\n\t\t\t\"var z=A*(1-r2);\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=x*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=y*xyScale;\",\r\n\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=z;\"\r\n\t\t)\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Hat\r\n","'use strict'\r\n\r\nconst Input=require('../input-classes')\r\nconst Option=require('../option-classes')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst Listener=require('../listener-classes')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\nconst IntFeature=require('../int-feature')\r\n\r\nclass LodShape extends Shape {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs)\r\n\t\tconst maxLod=this.getMaxPossibleLod(options.lod.max)\r\n\t\tconst cap=v=>Math.min(maxLod,v)\r\n\t\tthis.lod=Option.LiveInt.make('lod',[0,10],6)({\r\n\t\t\tvalue: cap(options.lod.value),\r\n\t\t\tmin:   cap(options.lod.min),\r\n\t\t\tmax:   cap(options.lod.max),\r\n\t\t\tinput: String(options.lod.input),\r\n\t\t}).fix()\r\n\t\tthis.features.push(\r\n\t\t\tnew IntFeature('shape.lod',this.lod)\r\n\t\t)\r\n\t}\r\n\tgetMaxPossibleLod(requestedMaxLod) { // due to element index type\r\n\t\tif (!this.usesElements() || this.elementIndexBits>=31) { // 1<<31 is a negative number, can't compare with it\r\n\t\t\treturn requestedMaxLod // no need to limit lod if elements are not used or index type is large enough\r\n\t\t}\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst indexLimit=1<<this.elementIndexBits\r\n\t\tfor (let m=requestedMaxLod;m>=0;m--) {\r\n\t\t\tlet n=eval(nVerticesFn(m))\r\n\t\t\tif (n<=indexLimit) {\r\n\t\t\t\treturn m\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO fail here\r\n\t}\r\n\twriteColorData() {\r\n\t\tconst a=JsLines.b()\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tfor (let i=0;i<4;i++) {\r\n\t\t\ta(\"[\"+colorgen.getNextColorString().slice(1,-1)+\"],\")\r\n\t\t}\r\n\t\treturn WrapLines.b(\r\n\t\t\tJsLines.bae(\"var colors=[\"),\r\n\t\t\tJsLines.bae(\"];\")\r\n\t\t).ae(a.e())\r\n\t}\r\n\t// abstract getDistinctVertexCount(lodSymbol) {} // # of distinct vertices where one vertex can be shared between different faces and output primitives\r\n\t// abstract getFaceVertexCount(lodSymbol) {} // # of distinct (vertex,face) pairs that still can be shared between output primitives\r\n\t// abstract getTotalVertexCount(lodSymbol) {} // # of vertices in output primitives = # of elements when element arrays are in use\r\n\t// abstract writeStoreShape() {}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\tconst nVerticesFn = this.hasColorsPerFace\r\n\t\t\t? this.getFaceVertexCount\r\n\t\t\t: this.getDistinctVertexCount\r\n\t\tconst a=JsLines.b()\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\r\n\t\t\t\t\"var minShapeLod=\"+this.lod.min+\";\",\r\n\t\t\t\t\"var maxShapeLod=\"+this.lod.max+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+nVerticesFn(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nMaxElements=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nMaxElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices,nElements;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"\tnElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nMaxVertices=\"+this.getTotalVertexCount(\"maxShapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nMaxVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"var shapeLod,nVertices;\",\r\n\t\t\t\t\t\"function storeShape(newShapeLod) {\",\r\n\t\t\t\t\t\"\tshapeLod=newShapeLod;\",\r\n\t\t\t\t\t\"\tnVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var shapeLod=\"+this.lod+\";\"\r\n\t\t\t)\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+nVerticesFn(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\t\"var nElements=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"(nElements);\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var nVertices=\"+this.getTotalVertexCount(\"shapeLod\")+\";\",\r\n\t\t\t\t\t\"var vertices=new Float32Array(nVertices*\"+this.getNumbersPerVertex()+\");\",\r\n\t\t\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\t\t\t\"function storeShape() {\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta(\r\n\t\t\tIndentLines.bae(this.writeStoreShape()),\r\n\t\t\tIndentLines.bae(this.writeBufferData()),\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (this.lod.input!='constant') {\r\n\t\t\ta(\"storeShape(\"+this.lod+\");\")\r\n\t\t} else {\r\n\t\t\ta(\"storeShape();\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.lod.input=='slider') {\r\n\t\t\tvar listener=new Listener.Slider('shape.lod')\r\n\t\t\tlistener.enter()\r\n\t\t\t\t.log(\"console.log(this.id,'input value:',parseInt(this.value));\")\r\n\t\t\t\t.post(\"storeShape(parseInt(this.value));\")\r\n\t\t\ta(\r\n\t\t\t\tfeatureContext.getListenerLines(listener)\r\n\t\t\t)\r\n\t\t} else if (this.lod.input instanceof Input.MouseMove) {\r\n\t\t\tfeatureContext.canvasMousemoveListener.enter()\r\n\t\t\t\t.newVarInt(this.lod.input,'shapeLod')\r\n\t\t\t\t.cond(\"newShapeLod!=shapeLod\")\r\n\t\t\t\t.log(\"console.log('shapeLod input value:',newShapeLod);\")\r\n\t\t\t\t.post(\"storeShape(newShapeLod);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=LodShape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst IndentLines=require('crnx-base/indent-lines')\r\nconst LodShape=require('./lodshape')\r\n\r\nclass Mesh extends LodShape {\r\n\tget dim() { return 3 }\r\n\tgetDistinctVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\")+1,2)\"\r\n\t}\r\n\tgetFaceVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*4\"\r\n\t}\r\n\tgetTotalVertexCount(lodSymbol) {\r\n\t\treturn \"Math.pow((1<<\"+lodSymbol+\"),2)*6\"\r\n\t}\r\n\twriteMeshVertexColors(iv) {\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\treturn JsLines.bae(\r\n\t\t\t\t((!this.usesElements() && !this.hasColorsPerFace)\r\n\t\t\t\t\t?\"var ic=((i+di)&1)*2+((j+dj)&1);\"\r\n\t\t\t\t\t:\"var ic=(i&1)*2+(j&1);\"\r\n\t\t\t\t),\r\n\t\t\t\t\"colors[ic].forEach(function(cc,icc){\",\r\n\t\t\t\t\"\tvertices[vertexOffset+\"+iv+\"+icc]=cc;\",\r\n\t\t\t\t\"});\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn JsLines.be()\r\n\t\t}\r\n\t}\r\n\t// abstract writeMeshInit() {}\r\n\t// abstract writeMeshVertex() {}\r\n\twriteStoreShape() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"var res=(1<<shapeLod);\")\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*6+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j,k) {\",\r\n\t\t\t\t\"\treturn (i*res+j)*4+k;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"function vertexElement(i,j) {\",\r\n\t\t\t\t\"\treturn i*(res+1)+j;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"function normalize(v) {\",\r\n\t\t\t\t\"\tvar l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);\",\r\n\t\t\t\t\"\treturn [v[0]/l,v[1]/l,v[2]/l];\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.hasColorsPerVertex || this.hasColorsPerFace) {\r\n\t\t\ta(this.writeColorData())\r\n\t\t}\r\n\t\ta(this.writeMeshInit())\r\n\t\tif (!this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (var i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (var j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<6;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else if (this.hasColorsPerFace) {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tfor (var k=0;k<4;k++) {\",\r\n\t\t\t\t\"\t\t\tvar di=[0,0,1,1][k];\",\r\n\t\t\t\t\"\t\t\tvar dj=[0,1,0,1][k];\",\r\n\t\t\t\t\"\t\t\tvar y=(i+di)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar x=(j+dj)/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\t\tvar vertexOffset=vertexElement(i,j,k)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(3).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t\t}\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i,j,0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i,j,2);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i,j,1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i,j,3);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(\r\n\t\t\t\t\"var i,j;\",\r\n\t\t\t\t\"for (i=0;i<=res;i++) {\",\r\n\t\t\t\t\"\tvar y=i/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\tfor (j=0;j<=res;j++) {\",\r\n\t\t\t\t\"\t\tvar x=j/res*xyRange*2-xyRange;\",\r\n\t\t\t\t\"\t\tvar vertexOffset=vertexElement(i,j)*\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\tIndentLines.b(2).ae(this.writeMeshVertex()),\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"for (i=0;i<res;i++) {\",\r\n\t\t\t\t\"\tfor (j=0;j<res;j++) {\",\r\n\t\t\t\t\"\t\tvar elementOffset=(i*res+j)*6;\",\r\n\t\t\t\t\"\t\telements[elementOffset+0]=vertexElement(i+0,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+1]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+2]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+3]=vertexElement(i+1,j+0);\",\r\n\t\t\t\t\"\t\telements[elementOffset+4]=vertexElement(i+0,j+1);\",\r\n\t\t\t\t\"\t\telements[elementOffset+5]=vertexElement(i+1,j+1);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Mesh\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Feature=require('../feature')\r\n\r\nclass Shape extends Feature {\r\n\tconstructor(options,hasReflections,hasColorsPerVertex,hasColorsPerFace,colorAttrs) {\r\n\t\tsuper()\r\n\t\tthis.elementIndexBits=parseInt(options.elements) // 0 if don't want element arrays; 8, 16 or 32 bits per element index, limits lod of shape\r\n\t\tthis.hasNormals=(hasReflections && this.dim==3) // true = need normals, unless shape is flat\r\n\t\tthis.hasColorsPerVertex=hasColorsPerVertex // TODO support for both hasColorsPerVertex and hasColorsPerFace == true\r\n\t\tthis.hasColorsPerFace=hasColorsPerFace\r\n\t\tthis.colorAttrs=colorAttrs // array of color attribute structs {name,enabled,weight}\r\n\t}\r\n\tget dim() { return 2 }\r\n\tget twoSided() { return true } // triangles can be viewed from both sides\r\n\tget glPrimitive() { return 'TRIANGLES' }\r\n\tusesElements() { // TODO convert to getter\r\n\t\treturn this.elementIndexBits>0\r\n\t}\r\n\tgetNumbersPerVertex() {\r\n\t\treturn this.dim+(this.hasNormals?3:0)+this.colorAttrs.length*3\r\n\t}\r\n\tgetElementIndexJsArray() {\r\n\t\treturn \"Uint\"+this.elementIndexBits+\"Array\"\r\n\t}\r\n\tgetElementIndexGlType() {\r\n\t\tif (this.elementIndexBits==8) {\r\n\t\t\treturn \"gl.UNSIGNED_BYTE\" // not recommended by ms [https://msdn.microsoft.com/en-us/library/dn798776%28v=vs.85%29.aspx]\r\n\t\t} else if (this.elementIndexBits==16) {\r\n\t\t\treturn \"gl.UNSIGNED_SHORT\" // mozilla examples use this\r\n\t\t} else if (this.elementIndexBits==32) {\r\n\t\t\treturn \"gl.UNSIGNED_INT\" // needs extension\r\n\t\t}\r\n\t}\r\n\twriteDebug(debugArrays) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (debugArrays) {\r\n\t\t\ta(\"console.log('vertex array byte length:',vertices.byteLength);\")\r\n\t\t\tif (this.usesElements()) {\r\n\t\t\t\ta(\"console.log('element array byte length:',elements.byteLength);\")\r\n\t\t\t\ta(\"console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);\")\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteBufferData() {\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\"gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteArraysAndBufferData(debugArrays) {\r\n\t\treturn JsLines.bae(\r\n\t\t\tthis.writeArrays(),\r\n\t\t\tthis.writeDebug(debugArrays),\r\n\t\t\tthis.writeBufferData()\r\n\t\t)\r\n\t}\r\n\t// public:\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst writeVertexAttribArrays=(attrs)=>{\r\n\t\t\tconst cmpSize=attrs[0][0]\r\n\t\t\tconst allSameSize=attrs.every((attr)=>{\r\n\t\t\t\tvar size=attr[0]\r\n\t\t\t\treturn size==cmpSize\r\n\t\t\t})\r\n\t\t\tlet allEnabled=true\r\n\t\t\tconst arrayLines=JsLines.bae(...attrs.map(attr=>{\r\n\t\t\t\tconst size=attr[0], name=attr[1], enabled=attr[2]\r\n\t\t\t\tif (enabled) {\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"'\"+name+\"',\"\r\n\t\t\t\t\t\t: \"[\"+size+\",'\"+name+\"'],\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tallEnabled=false\r\n\t\t\t\t\treturn (allSameSize\r\n\t\t\t\t\t\t? \"null,\"\r\n\t\t\t\t\t\t: \"[\"+size+\",null],\"\r\n\t\t\t\t\t)+\" // attribute \"+name+\" disabled\"\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t\tlet foreachEnableLines=JsLines.bae(\r\n\t\t\t\t\"var attrLoc=gl.getAttribLocation(program,attrName);\",\r\n\t\t\t\t\"gl.vertexAttribPointer(\",\r\n\t\t\t\t\"\tattrLoc,attrSize,gl.FLOAT,false,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferStride,\",\r\n\t\t\t\t\"\tFloat32Array.BYTES_PER_ELEMENT*bufferOffset\",\r\n\t\t\t\t\");\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(attrLoc);\"\r\n\t\t\t)\r\n\t\t\tif (!allEnabled) {\r\n\t\t\t\tforeachEnableLines=WrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"if (name!==null) {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tforeachEnableLines\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tconst foreachLines=JsLines.bae(\r\n\t\t\t\t...allSameSize?[\r\n\t\t\t\t\t\"var attrSize=\"+cmpSize+\";\"\r\n\t\t\t\t]:[\r\n\t\t\t\t\t\"var attrSize=attr[0];\",\r\n\t\t\t\t\t\"var attrName=attr[1];\"\r\n\t\t\t\t],\r\n\t\t\t\tforeachEnableLines,\r\n\t\t\t\t\"bufferOffset+=attrSize;\"\r\n\t\t\t)\r\n\t\t\treturn WrapLines.b(\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"var bufferStride=\"+this.getNumbersPerVertex()+\";\",\r\n\t\t\t\t\t\"var bufferOffset=0;\",\r\n\t\t\t\t\t\";[\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"].forEach(function(\"+(allSameSize?\"attrName\":\"attr\")+\"){\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\tarrayLines,\r\n\t\t\t\tforeachLines\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\tif (this.elementIndexBits==32) {\r\n\t\t\ta(\"gl.getExtension('OES_element_index_uint');\") // TODO check if null is returned and don't allow more elements\r\n\t\t}\r\n\t\tif (this.dim>2) {\r\n\t\t\ta(\"gl.enable(gl.DEPTH_TEST);\")\r\n\t\t}\r\n\t\ta(\"gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());\")\r\n\t\t}\r\n\t\ta(this.writeArraysAndBufferData(featureContext.debugOptions.arrays))\r\n\t\tif (!this.hasNormals && this.colorAttrs.length<=0) {\r\n\t\t\ta(\r\n\t\t\t\t\"var positionLoc=gl.getAttribLocation(program,'position');\",\r\n\t\t\t\t\"gl.vertexAttribPointer(positionLoc,\"+this.dim+\",gl.FLOAT,false,0,0);\",\r\n\t\t\t\t\"gl.enableVertexAttribArray(positionLoc);\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta(writeVertexAttribArrays([\r\n\t\t\t\t[this.dim,'position',true],\r\n\t\t\t\t...this.hasNormals?[[3,'normal',true]]:[],\r\n\t\t\t\t...this.colorAttrs.map(attr=>[3,attr.name,attr.enabled])\r\n\t\t\t]))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\"gl.drawElements(gl.\"+this.glPrimitive+\",nElements,\"+this.getElementIndexGlType()+\",0);\")\r\n\t\t} else {\r\n\t\t\ta(\"gl.drawArrays(gl.\"+this.glPrimitive+\",0,nVertices);\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Shape\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Square extends Shape {\r\n\tget glPrimitive() { return 'TRIANGLE_FAN' }\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=4;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t// x    y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,-0.5,\"+writeColorData(),\r\n\t\t\t\"\t+0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"\t-0.5,+0.5,\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=4;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2,3]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Square\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Mesh=require('./mesh')\r\n\r\nclass Terrain extends Mesh {\r\n\twriteMeshInit() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"var xyRange=1/Math.sqrt(2);\",\r\n\t\t\t\"var zRange=xyRange;\",\r\n\t\t\t\"var mask=res-1;\",\r\n\t\t\t\"function zOffset(i,j) {\",\r\n\t\t\t\"\treturn vertexElement(i,j\"+(noFaces?\"\":\",0\")+\")*\"+this.getNumbersPerVertex()+\"+2;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"function noise(depth) {\",\r\n\t\t\t\"\tvar r=zRange/Math.pow(2,shapeLod-depth-1);\",\r\n\t\t\t\"\treturn Math.random()*2*r-r;\",\r\n\t\t\t\"}\",\r\n\t\t\t\"vertices[2]=0.0;\",\r\n\t\t\t\"var i0,i1,i2,i3;\",\r\n\t\t\t\"var j0,j1,j2,j3;\",\r\n\t\t\t\"for (var depth=shapeLod-1;depth>=0;depth--) {\",\r\n\t\t\t\"\tvar d=1<<depth;\",\r\n\t\t\t\"\t// diamond step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti1=i2-d;\",\r\n\t\t\t\"\t\t\tj1=j2-d;\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"\t// square step\",\r\n\t\t\t\"\tfor (i2=d;i2<res;i2+=2*d) {\",\r\n\t\t\t\"\t\tfor (j2=d;j2<res;j2+=2*d) {\",\r\n\t\t\t\"\t\t\ti0=(i2-2*d)&mask;\",\r\n\t\t\t\"\t\t\tj0=(j2-2*d)&mask;\",\r\n\t\t\t\"\t\t\ti1=(i2-d);\",\r\n\t\t\t\"\t\t\tj1=(j2-d);\",\r\n\t\t\t\"\t\t\ti3=(i2+d)&mask;\",\r\n\t\t\t\"\t\t\tj3=(j2+d)&mask;\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i2,j1)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t\tvertices[zOffset(i1,j2)]=(\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+\",\r\n\t\t\t\"\t\t\t\tvertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]\",\r\n\t\t\t\"\t\t\t)/4+noise(depth);\",\r\n\t\t\t\"\t\t}\",\r\n\t\t\t\"\t}\",\r\n\t\t\t\"}\"\r\n\t\t)\r\n\t\tif (noFaces) {\r\n\t\t\ta(\r\n\t\t\t\t\"for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];\",\r\n\t\t\t\t\"for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];\",\r\n\t\t\t\t\"vertices[zOffset(res,res)]=vertices[zOffset(0,0)];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\twriteMeshVertex() {\r\n\t\tconst noFaces=(this.usesElements() && !this.hasColorsPerFace)\r\n\t\tconst a=JsLines.b()\r\n\t\ta(\r\n\t\t\t\"vertices[vertexOffset+0]=x;\",\r\n\t\t\t\"vertices[vertexOffset+1]=y;\",\r\n\t\t\t(noFaces\r\n\t\t\t\t?\"// vertices[vertexOffset+2] already written\"\r\n\t\t\t\t:\"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];\"\r\n\t\t\t)\r\n\t\t)\r\n\t\tlet iv=3\r\n\t\tif (this.hasNormals) {\r\n\t\t\ta(\r\n\t\t\t\t\"var d=4*xyRange/res;\",\r\n\t\t\t\t\"var normal=normalize([\",\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t(noFaces\r\n\t\t\t\t\t?\"\t(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,\"\r\n\t\t\t\t\t:\"\t(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,\"\r\n\t\t\t\t),\r\n\t\t\t\t\"1]);\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[0];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[1];\",\r\n\t\t\t\t\"vertices[vertexOffset+\"+(iv++)+\"]=normal[2];\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(this.writeMeshVertexColors(iv))\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Terrain\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Colorgen=require('../colorgen')\r\nconst Shape=require('./shape')\r\n\r\nclass Triangle extends Shape {\r\n\twriteArrays() {\r\n\t\tconst colorgen=new Colorgen(this.colorAttrs,0)\r\n\t\tlet colorDataForFace\r\n\t\tconst writeColorData=()=>{\r\n\t\t\tif (this.hasColorsPerFace && !this.hasColorsPerVertex) {\r\n\t\t\t\tif (colorDataForFace===undefined) {\r\n\t\t\t\t\tcolorDataForFace=colorgen.getNextColorString()\r\n\t\t\t\t}\r\n\t\t\t\treturn colorDataForFace\r\n\t\t\t} else {\r\n\t\t\t\treturn colorgen.getNextColorString()\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst a=JsLines.ba(\r\n\t\t\t\"var nVertices=3;\",\r\n\t\t\t\"var vertices=new Float32Array([\",\r\n\t\t\t\"\t//                   x                      y\"+colorgen.getHeaderString(),\r\n\t\t\t\"\t-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"\t-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),\"+writeColorData(),\r\n\t\t\t\"]);\"\r\n\t\t)\r\n\t\tif (this.usesElements()) {\r\n\t\t\ta(\r\n\t\t\t\t\"var nElements=3;\",\r\n\t\t\t\t\"var elements=new \"+this.getElementIndexJsArray()+\"([0,1,2]);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Triangle\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\nconst GlslVector=require('./glsl-vector')\r\n\r\nclass Transforms extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t\tthis.rotateVectorEntries=[] // [{vector,suffix}] like features, but vectors have additional methods that don't follow feature interfaces\r\n\t\tthis.transformSequence=new Array(options.model.entries.length) // [{vector,component,suffix}]\r\n\t\tconst possibleComponents=['x','y','z']\r\n\t\tconst rotate=[[],[],[]]\r\n\t\toptions.model.entries.forEach((tr,iTr)=>{\r\n\t\t\tconst trData={\r\n\t\t\t\ttransform: tr,\r\n\t\t\t\tindex: iTr,\r\n\t\t\t}\r\n\t\t\tif (tr.type=='rotate.x') {\r\n\t\t\t\trotate[0].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.y') {\r\n\t\t\t\trotate[1].push(trData)\r\n\t\t\t} else if (tr.type=='rotate.z') {\r\n\t\t\t\trotate[2].push(trData)\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst nLayers=Math.max.apply(null,rotate.map(r=>r.length))\r\n\t\tfor (let i=0;i<nLayers;i++) {\r\n\t\t\tlet isInGap=false\r\n\t\t\tlet isStraight=true\r\n\t\t\tlet lastStraightIndex=-1\r\n\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\tif (isInGap) {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tisStraight=false\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tlastStraightIndex=j\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisInGap=true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst suffix=(nLayers>1?String(i):'')\r\n\t\t\tconst makeVector=(values,names)=>{\r\n\t\t\t\tconst vector=new GlslVector('rotate'+(nLayers>1?'.'+i:''),values,180)\r\n\t\t\t\tvector.i18nId='transforms.model.rotate'\r\n\t\t\t\tthis.features.push(vector)\r\n\t\t\t\tthis.rotateVectorEntries.push({\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t})\r\n\t\t\t\treturn vector\r\n\t\t\t}\r\n\t\t\tconst storeSequenceElement=(vector,j)=>{\r\n\t\t\t\tthis.transformSequence[rotate[j][i].index]={\r\n\t\t\t\t\tvector,\r\n\t\t\t\t\tcomponent: possibleComponents[j],\r\n\t\t\t\t\tsuffix,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (isStraight) {\r\n\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\trotate.slice(0,lastStraightIndex+1).map(r=>r[i].transform),\r\n\t\t\t\t\tpossibleComponents.slice(0,lastStraightIndex+1)\r\n\t\t\t\t)\r\n\t\t\t\tfor (let j=0;j<=lastStraightIndex;j++) {\r\n\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (let j=0;j<3;j++) {\r\n\t\t\t\t\tconst has=i<rotate[j].length\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tconst vector=makeVector(\r\n\t\t\t\t\t\t\t[rotate[j][i].transform],\r\n\t\t\t\t\t\t\tpossibleComponents.slice(j,j+1)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\tstoreSequenceElement(vector,j)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget eyeAtInfinity() {\r\n\t\treturn this.options.projection=='ortho'\r\n\t}\r\n\t// private:\r\n\tuse2dTransform(flatShape) { // has flat shape and exactly one z rotation TODO multiple z rotations\r\n\t\treturn flatShape && this.options.model.entries.length==1 && this.options.model.entries[0].type=='rotate.z'\r\n\t}\r\n\tgetTransformMatricesLines(dim) { // dim==3 for normal transform, dim==4 for position transform\r\n\t\tconst a=Lines.ba(\"\")\r\n\t\tconst maxSuffixLength=1 // TODO calculate it\r\n\t\tconst width=4+maxSuffixLength // 1(sign)+3(c.x)+(max suffix length)\r\n\t\tconst pad=e=>{ // TODO (fake-)lodash pad\r\n\t\t\tif (e.length<width) {\r\n\t\t\t\treturn (\"          \"+e).slice(-width)\r\n\t\t\t} else {\r\n\t\t\t\treturn e\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst mat=(rows,comment)=>{\r\n\t\t\ta.t(\"*mat\"+dim+\"( // \"+comment)\r\n\t\t\trows.forEach((row,i)=>{\r\n\t\t\t\tif (i>=dim) return\r\n\t\t\t\ta(\"\t\")\r\n\t\t\t\trow.forEach((e,j)=>{\r\n\t\t\t\t\tif (j>=dim) return\r\n\t\t\t\t\ta.t(pad(e))\r\n\t\t\t\t\tif (i<dim-1 || j<dim-1) a.t(\",\")\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\ta(\")\")\r\n\t\t}\r\n\t\tthis.transformSequence.forEach(ts=>{\r\n\t\t\tif (!ts) return\r\n\t\t\tconst c=ts.vector.getGlslMapComponentValue('c'+ts.suffix,ts.component)\r\n\t\t\tconst s=ts.vector.getGlslMapComponentValue('s'+ts.suffix,ts.component)\r\n\t\t\tif (ts.component=='x') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    c,\"-\"+s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",    s,    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around x axis\")\r\n\t\t\t} else if (ts.component=='y') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"0.0\",    s,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"-\"+s,\"0.0\",    c,\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around y axis\")\r\n\t\t\t} else if (ts.component=='z') {\r\n\t\t\t\tmat([\r\n\t\t\t\t\t[    c,\"-\"+s,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[    s,    c,\"0.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"0.0\"],\r\n\t\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t\t],\"rotate around z axis\")\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (dim==4 && this.options.projection=='perspective') {\r\n\t\t\tmat([\r\n\t\t\t\t[\"1.0\",\"0.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"1.0\",\"0.0\",\"0.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"1.0\",\"-(near+far)/2.0\"],\r\n\t\t\t\t[\"0.0\",\"0.0\",\"0.0\",\"1.0\"],\r\n\t\t\t],\"move center of coords inside view\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\t// public:\r\n\tgetGlslVertexDeclarationLines(flatShape) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(rve.vector.getGlslDeclarationLines())\r\n\t\t})\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta(\"attribute vec2 position;\")\r\n\t\t} else {\r\n\t\t\ta(\"attribute vec4 position;\")\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexOutputLines(flatShape,receivesAspect,needTransformedPosition) {\r\n\t\tconst a=Lines.b()\r\n\t\tthis.rotateVectorEntries.forEach(rve=>{\r\n\t\t\ta(\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('c'+rve.suffix,v=>`cos(radians(${v}))`),\r\n\t\t\t\trve.vector.getGlslMapDeclarationLines('s'+rve.suffix,v=>`sin(radians(${v}))`)\r\n\t\t\t)\r\n\t\t})\r\n\t\tif (this.options.projection=='perspective') {\r\n\t\t\ta(\r\n\t\t\t\t\"float fovy=45.0;\",\r\n\t\t\t\t\"float near=1.0/tan(radians(fovy)/2.0);\",\r\n\t\t\t\t\"float far=near+2.0;\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta(\"vec4 transformedPosition=\")\r\n\t\t} else {\r\n\t\t\ta(\"gl_Position=\")\r\n\t\t}\r\n\t\tif (this.use2dTransform(flatShape)) {\r\n\t\t\ta.t(\r\n\t\t\t\t\"vec4(position*mat2(\",\r\n\t\t\t\t\"\tcz, -sz,\",\r\n\t\t\t\t\"\tsz,  cz\",\r\n\t\t\t\t\"),0,1)\"\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\ta.t(\"position\")\r\n\t\t\ta.t(this.getTransformMatricesLines(4))\r\n\t\t}\r\n\t\tif (needTransformedPosition) {\r\n\t\t\ta.t(\";\")\r\n\t\t\ta(\"gl_Position=transformedPosition\")\r\n\t\t}\r\n\t\tif (this.options.projection=='ortho') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\"*vec4(1.0/aspect,1.0,-1.0,1.0)\") // correct aspect ratio and make coords right-handed\r\n\t\t\t} else if (!flatShape) {\r\n\t\t\t\ta.t(\"*vec4(1.0,1.0,-1.0,1.0)\") // make coords right-handed for 3d shapes\r\n\t\t\t}\r\n\t\t} else if (this.options.projection=='perspective') {\r\n\t\t\tif (receivesAspect) {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear/aspect, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,         0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\ta.t(\r\n\t\t\t\t\t\"*mat4(\",\r\n\t\t\t\t\t\"\tnear, 0.0,  0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  near, 0.0,                   0.0,\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),\",\r\n\t\t\t\t\t\"\t0.0,  0.0,  -1.0,                  0.0\",\r\n\t\t\t\t\t\")\"\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.t(\";\")\r\n\t\treturn a.e()\r\n\t}\r\n\tgetGlslVertexNormalTransformLines() {\r\n\t\treturn this.getTransformMatricesLines(3)\r\n\t}\r\n}\r\n\r\nmodule.exports=Transforms\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\n\r\nclass VectorComponent {\r\n\tconstructor(value,vectorName,wrapRange) {\r\n\t\tthis.value=value // value from options.fix()\r\n\t\tthis.vectorName=vectorName\r\n\t\tthis.wrapRange=wrapRange // if defined and components min/max == -/+ this value, use wrap() instead of clamp()\r\n\t}\r\n\tget suffix() {\r\n\t\tconst dotIndex=this.value.name.lastIndexOf('.')\r\n\t\tif (dotIndex<0) {\r\n\t\t\treturn this.value.name\r\n\t\t} else {\r\n\t\t\treturn this.value.name.slice(dotIndex+1)\r\n\t\t}\r\n\t}\r\n\tget name() { return this.vectorName+'.'+this.suffix }\r\n\tget varName() { return camelCase(this.name) }\r\n\tget varNameLoc() { return this.varName+'Loc' }\r\n\tget varNameSpeed() { return this.varName+'Speed' }\r\n\tget varNameInput() { return this.varName+'Input' }\r\n\tget minVarName() { return camelCase('min.'+this.name) }\r\n\tget maxVarName() { return camelCase('max.'+this.name) }\r\n\tget variable() {\r\n\t\treturn this.value.input!='constant' || this.hasSpeed()\r\n\t}\r\n\thasSpeed() {\r\n\t\treturn this.value.speed!=0 || this.value.speed.input!='constant'\r\n\t}\r\n\thasInput() {\r\n\t\treturn this.value.input!='constant' || this.value.speed.input!='constant'\r\n\t}\r\n\thasInputClass(inputClass) {\r\n\t\treturn this.value.input instanceof inputClass || this.value.speed.input instanceof inputClass\r\n\t}\r\n\tusesStartTime() {\r\n\t\treturn (this.value.input=='constant' && this.value.speed!=0) && this.value.speed.input=='constant'\r\n\t}\r\n\tusesPrevTime() {\r\n\t\treturn (this.value.input!='constant' && this.value.speed!=0) || this.value.speed.input!='constant'\r\n\t}\r\n\tget wrapReady() {\r\n\t\treturn this.wrapRange && this.value.min==-this.wrapRange && this.value.max==+this.wrapRange\r\n\t}\r\n\tget wrapped() {\r\n\t\treturn this.hasSpeed() && this.wrapReady && this.value.input=='slider' // need to wrap only if input with state is used\r\n\t}\r\n\tget clamped() {\r\n\t\treturn !this.wrapped && this.value.speed.input!='constant' && !this.wrapReady\r\n\t}\r\n\tget capped() {\r\n\t\treturn !this.wrapped && !this.clamped && this.hasSpeed() && !this.wrapReady\r\n\t}\r\n}\r\n\r\nmodule.exports=VectorComponent\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\nconst formatNumber=require('crnx-base/format-number')\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Input=require('./input-classes')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst Listener=require('./listener-classes')\r\nconst VectorComponent=require('./vector-component')\r\nconst NumericFeature=require('./numeric-feature')\r\n\r\nclass Vector extends NumericFeature {\r\n\tconstructor(name,values,wrapRange) {\r\n\t\tsuper()\r\n\t\tthis.name=name // name with dots like \"material.color\", transformed into \"materialColor\" for js var names\r\n\t\tthis.components=[]\r\n\t\tthis.componentsBySuffix={}\r\n\t\tvalues.forEach(v=>{\r\n\t\t\tconst component=new VectorComponent(v,name,wrapRange)\r\n\t\t\tthis.components.push(component)\r\n\t\t\tthis.componentsBySuffix[component.suffix]=component\r\n\t\t})\r\n\t\t// { TODO extra ctor args\r\n\t\tthis.i18nId=name\r\n\t\t// }\r\n\t\tthis.nVars=0\r\n\t\tthis.modeConstant=true // all vector components are constants\r\n\t\tthis.modeFloats=false // one/some vector components are variable, such components get their own glsl vars\r\n\t\tthis.components.forEach((component,i)=>{\r\n\t\t\tif (component.variable) {\r\n\t\t\t\tthis.modeConstant=false\r\n\t\t\t\tif (this.nVars++!=i) {\r\n\t\t\t\t\tthis.modeFloats=true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.nVars==1) {\r\n\t\t\tthis.modeFloats=true\r\n\t\t}\r\n\t\tthis.modeVector=(!this.modeConstant && !this.modeFloats) // first consecutive components are variable, packed into one glsl vector\r\n\t}\r\n\tget varName() { // js/glsl var name\r\n\t\treturn camelCase(this.name)\r\n\t}\r\n\tget updateFnName() {\r\n\t\treturn camelCase('update.'+this.name)\r\n\t}\r\n\t// fns that can be mapped over components:\r\n\tmakeInitialComponentValue() {\r\n\t\tconst numbers={}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (component.value.input=='slider') {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else {\r\n\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst fmt=formatNumbers.js(numbers)\r\n\t\treturn component=>{\r\n\t\t\tif (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\" // b/c slider could be init'd to a value different than the default\r\n\t\t\t} else {\r\n\t\t\t\treturn fmt[component.value.name]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tmakeUpdatedComponentValue() {\r\n\t\tconst numbers={}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (\r\n\t\t\t\tcomponent.value.speed!=0 || component.value.speed.input!='constant' ||\r\n\t\t\t\tcomponent.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad\r\n\t\t\t) {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else if (component.value.input=='slider') {\r\n\t\t\t\t// don't need formatted number for this case\r\n\t\t\t} else {\r\n\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst fmt=formatNumbers.js(numbers)\r\n\t\treturn component=>{\r\n\t\t\tif (\r\n\t\t\t\tcomponent.value.speed!=0 || component.value.speed.input!='constant' ||\r\n\t\t\t\tcomponent.value.input instanceof Input.MouseMove || component.value.input instanceof Input.Gamepad\r\n\t\t\t) {\r\n\t\t\t\treturn component.varName\r\n\t\t\t} else if (component.value.input=='slider') {\r\n\t\t\t\treturn \"parseFloat(document.getElementById('\"+component.name+\"').value)\"\r\n\t\t\t} else {\r\n\t\t\t\treturn fmt[component.value.name]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// abstract fns:\r\n\tgetJsDeclarationLines() { return JsLines.be() } // Locs etc\r\n\tgetJsUpdateLines(componentValue) { return JsLines.be() }\r\n\taddPostToListenerEntryForComponent(entry,component) {} // do necessary entry.post()\r\n\taddPostToListenerEntryAfterComponents(entry,componentValue) {} // TODO check if we need componentValue - GlslVector doesn't use it\r\n\t// public:\r\n\thasInputs() {\r\n\t\treturn super.hasInputs() || this.components.some(component=>component.hasInput())\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tsuper.requestFeatureContext(featureContext)\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tif (component.hasInput()) featureContext.hasInputs=true\r\n\t\t\tif (component.hasInputClass(Input.Slider)) featureContext.hasSliders=true\r\n\t\t\tif (component.hasInputClass(Input.Gamepad)) featureContext.pollsGamepad=true\r\n\t\t\tif (component.usesStartTime()) featureContext.hasStartTime=true\r\n\t\t\tif (component.usesPrevTime()) featureContext.hasPrevTime=true\r\n\t\t\tif (component.wrapped) featureContext.hasWrapFn=true\r\n\t\t\tif (component.clamped) featureContext.hasClampFn=true\r\n\t\t})\r\n\t}\r\n\tgetHtmlControlMessageLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlControlMessageLines(i18n))\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\ta(\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value,this.i18nId+'.'+component.suffix),\r\n\t\t\t\tthis.getHtmlControlMessageForValue(i18n,component.value.speed,this.i18nId+'.'+component.suffix+'.speed')\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn a.e()\r\n\t}\r\n\tgetHtmlInputLines(i18n) {\r\n\t\tconst a=Lines.ba(super.getHtmlInputLines(i18n))\r\n\t\tthis.components.forEach(component=>a(\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tcomponent.value,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix,\r\n\t\t\t\tcomponent.name,\r\n\t\t\t\t'any'\r\n\t\t\t),\r\n\t\t\tthis.getHtmlSliderLines(\r\n\t\t\t\ti18n,\r\n\t\t\t\tcomponent.value.speed,\r\n\t\t\t\t'options.'+this.i18nId+'.'+component.suffix+'.speed',\r\n\t\t\t\tcomponent.name+'.speed',\r\n\t\t\t\t'any'\r\n\t\t\t)\r\n\t\t))\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext) {\r\n\t\tconst getSliderListenerLines=(doUpdate)=>{\r\n\t\t\tconst getManyListenersLines=()=>{\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\tconst writeListener=(v,htmlName)=>{\r\n\t\t\t\t\tif (v.input!='slider') return\r\n\t\t\t\t\tconst listener=new Listener.Slider(htmlName)\r\n\t\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\ta(featureContext.getListenerLines(listener))\r\n\t\t\t\t}\r\n\t\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\t\twriteListener(component.value,component.name)\r\n\t\t\t\t\twriteListener(component.value.speed,component.name+'.speed')\r\n\t\t\t\t})\r\n\t\t\t\treturn a.e()\r\n\t\t\t}\r\n\t\t\tconst getOneListenerLines=()=>{\r\n\t\t\t\tconst listener=new Listener.MultipleSlider(\"[id^=\\\"\"+this.name+\".\\\"]\") // will also handle speed sliders, but it's ok\r\n\t\t\t\tconst entry=listener.enter()\r\n\t\t\t\tentry.log(\"console.log(this.id,'input value:',parseFloat(this.value));\")\r\n\t\t\t\tif (doUpdate) {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t\treturn featureContext.getListenerLines(listener)\r\n\t\t\t}\r\n\t\t\tconst manyListenersLines=getManyListenersLines()\r\n\t\t\tconst oneListenerLines=getOneListenerLines()\r\n\t\t\treturn manyListenersLines.count()<=oneListenerLines.count() ? manyListenersLines : oneListenerLines\r\n\t\t}\r\n\t\tconst a=JsLines.ba(super.getJsInitLines(featureContext))\r\n\t\ta(this.getJsDeclarationLines())\r\n\t\tif (this.modeConstant) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tconst someSpeeds=this.components.some(component=>component.hasSpeed())\r\n\t\tconst someValueSliders=this.components.some(component=>component.value.input=='slider')\r\n\t\tconst someGamepads=this.components.some(component=>component.hasInputClass(Input.Gamepad))\r\n\t\tconst writeVarLines=()=>{\r\n\t\t\tlet fmt, sfmt\r\n\t\t\tconst numbers={}, snumbers={}\r\n\t\t\tconst writes=[], swrites=[]\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (\r\n\t\t\t\t\t(component.value.input instanceof Input.MouseMove && (someValueSliders || someSpeeds || someGamepads)) || // mouse input required elsewhere\r\n\t\t\t\t\t(component.value.speed.input!='constant' && component.value.input!='slider') // variable speed and no value input capable of storing the state\r\n\t\t\t\t) {\r\n\t\t\t\t\tnumbers[component.value.name]=component.value\r\n\t\t\t\t\twrites.push(component)\r\n\t\t\t\t}\r\n\t\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tsnumbers[component.value.name]=component.value.speed\r\n\t\t\t\t\tswrites.push(component)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tfmt=formatNumbers.js(numbers)\r\n\t\t\tsfmt=formatNumbers.js(snumbers)\r\n\t\t\twrites.forEach(component=>a(\"var \"+component.varName+\"=\"+fmt[component.value.name]+\";\"))\r\n\t\t\tswrites.forEach(component=>a(\"var \"+component.varNameSpeed+\"=\"+sfmt[component.value.name]+\";\"))\r\n\t\t}\r\n\t\twriteVarLines()\r\n\t\tif (!someSpeeds && someValueSliders && !someGamepads) {\r\n\t\t\ta(\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tJsLines.bae(\"function \"+this.updateFnName+\"() {\"),\r\n\t\t\t\t\tJsLines.bae(\"}\")\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.getJsUpdateLines(this.makeUpdatedComponentValue())\r\n\t\t\t\t),\r\n\t\t\t\tthis.updateFnName+\"();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\ta(getSliderListenerLines(!someSpeeds && !someGamepads))\r\n\t\tif (this.components.some(component=>(component.value.input instanceof Input.MouseMove))) {\r\n\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\ta(this.getJsUpdateLines(this.makeInitialComponentValue()))\r\n\t\t\t}\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tif (component.value.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tconst fmt=formatNumbers.js({\r\n\t\t\t\t\t\tmin:component.value.min,\r\n\t\t\t\t\t\tmax:component.value.max,\r\n\t\t\t\t\t},component.value.precision)\r\n\t\t\t\t\t;((!someSpeeds && !someValueSliders && !someGamepads) ? entry.minMaxVarFloat : entry.minMaxFloat)(\r\n\t\t\t\t\t\tcomponent.value.input,component.varName,fmt.min,fmt.max\r\n\t\t\t\t\t)\r\n\t\t\t\t\tentry.log(\"console.log('\"+component.name+\" input value:',\"+component.varName+\");\")\r\n\t\t\t\t\tif (!someSpeeds && !someValueSliders && !someGamepads) {\r\n\t\t\t\t\t\tthis.addPostToListenerEntryForComponent(entry,component)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (!someSpeeds && !someGamepads) {\r\n\t\t\t\tif (!someValueSliders) {\r\n\t\t\t\t\tthis.addPostToListenerEntryAfterComponents(entry,this.makeUpdatedComponentValue())\r\n\t\t\t\t} else {\r\n\t\t\t\t\tentry.post(this.updateFnName+\"();\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.components.some(component=>(component.value.speed.input instanceof Input.MouseMove))) {\r\n\t\t\tconst entry=featureContext.canvasMousemoveListener.enter()\r\n\t\t\tthis.components.forEach(component=>{\r\n\t\t\t\tconst fmt=formatNumbers.js({\r\n\t\t\t\t\tmin:component.value.speed.min,\r\n\t\t\t\t\tmax:component.value.speed.max,\r\n\t\t\t\t},component.value.speed.precision)\r\n\t\t\t\tif (component.value.speed.input instanceof Input.MouseMove) {\r\n\t\t\t\t\tentry.minMaxFloat(component.value.speed.input,component.varNameSpeed,fmt.min,fmt.max)\r\n\t\t\t\t\t\t.log(\"console.log('\"+component.name+\".speed input value:',\"+component.varNameSpeed+\");\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopLines(featureContext) {\r\n\t\tconst a=JsLines.ba(super.getJsLoopLines(featureContext))\r\n\t\tconst add=(s)=>{\r\n\t\t\tconst c=s.charAt(0)\r\n\t\t\tif (c=='-' || c=='+') {\r\n\t\t\t\treturn s\r\n\t\t\t} else {\r\n\t\t\t\treturn \"+\"+s\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet needUpdate=false\r\n\t\tconst writeGamepad=(component,v,dotSuffix,varSuffix)=>{\r\n\t\t\tif (v.input instanceof Input.Gamepad) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tconst fmt=formatNumbers.js({min:v.min,max:v.max,value:v.value},v.precision)\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var \"+component.minVarName+varSuffix+\"=\"+fmt.min+\";\",\r\n\t\t\t\t\t\"var \"+component.maxVarName+varSuffix+\"=\"+fmt.max+\";\",\r\n\t\t\t\t\t\"var \"+component.varName+varSuffix+\"=\"+fmt.value+\";\",\r\n\t\t\t\t\t\"if (gamepad && gamepad.axes.length>\"+v.input.axis+\") {\",\r\n\t\t\t\t\t\"\t\"+component.varName+varSuffix+\"=\"+component.minVarName+varSuffix+\"+(\"+component.maxVarName+varSuffix+\"-\"+component.minVarName+varSuffix+\")*(gamepad.axes[\"+v.input.axis+\"]+1)/2;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t)\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.inputs) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+dotSuffix+\" input value:',\"+component.varName+varSuffix+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.components.forEach(component=>{\r\n\t\t\tconst v=component.value\r\n\t\t\twriteGamepad(component,v,'','')\r\n\t\t\twriteGamepad(component,v.speed,'.speed','Speed')\r\n\t\t\tif (component.hasSpeed()) {\r\n\t\t\t\tneedUpdate=true\r\n\t\t\t\tlet addSpeed\r\n\t\t\t\tif (v.speed.input=='slider') {\r\n\t\t\t\t\taddSpeed=\"+parseFloat(document.getElementById('\"+component.name+\".speed').value)\"\r\n\t\t\t\t} else if (v.speed.input instanceof Input.MouseMove || v.speed.input instanceof Input.Gamepad) {\r\n\t\t\t\t\taddSpeed=\"+\"+component.varNameSpeed\r\n\t\t\t\t} else {\r\n\t\t\t\t\taddSpeed=add(formatNumber.js(v.speed))\r\n\t\t\t\t}\r\n\t\t\t\tlet limitFn=(x,dx)=>{\r\n\t\t\t\t\tif (x==component.varName) {\r\n\t\t\t\t\t\treturn dx.charAt(0)+\"=\"+dx.slice(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"=\"+x+dx\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (component.wrapped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=wrap(\"+x+dx+\",\"+formatNumber.js(v.max,v.precision)+\")\"\r\n\t\t\t\t} else if (component.clamped) {\r\n\t\t\t\t\tconst fmt=formatNumbers.js({min:v.min,max:v.max},v.precision)\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=clamp(\"+x+dx+\",\"+fmt.min+\",\"+fmt.max+\")\"\r\n\t\t\t\t} else if (component.capped) {\r\n\t\t\t\t\tlimitFn=(x,dx)=>\"=Math.\"+(v.speed<0?\"max\":\"min\")+\"(\"+x+dx+\",\"+formatNumber.js(v.speed<0?v.min:v.max,v.precision)+\")\"\r\n\t\t\t\t}\r\n\t\t\t\tconst incrementLine=(base,dt)=>component.varName+limitFn(base,addSpeed+\"*\"+dt+\"/1000\")+\";\"\r\n\t\t\t\tif (v.input=='slider') {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"var \"+component.varNameInput+\"=document.getElementById('\"+component.name+\"');\",\r\n\t\t\t\t\t\t\"var \"+incrementLine(\"parseFloat(\"+component.varNameInput+\".value)\",\"(time-prevTime)\"),\r\n\t\t\t\t\t\tcomponent.varNameInput+\".value=\"+component.varName+\";\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (v.input instanceof Input.MouseMove || v.speed.input!='constant') {\r\n\t\t\t\t\ta(incrementLine(component.varName,\"(time-prevTime)\"))\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"var \"+incrementLine(formatNumber.js(v),\"(time-startTime)\"))\r\n\t\t\t\t}\r\n\t\t\t\tif (featureContext && featureContext.debugOptions.animations) { // TODO always pass featureContext\r\n\t\t\t\t\ta(\"console.log('\"+component.name+\" animation value:',\"+component.varName+\");\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (needUpdate) {\r\n\t\t\ta(this.getJsUpdateLines(this.makeUpdatedComponentValue()))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Vector\r\n"],"sourceRoot":"."}