!function(){var babelHelpers={"typeof":function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},createClass:function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),classCallCheck:function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},possibleConstructorReturn:function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},inherits:function(e,t){function n(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var a=n[r],s=Object.getOwnPropertyDescriptor(t,a);s&&s.configurable&&void 0===e[a]&&Object.defineProperty(e,a,s)}return e}if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&n(e,t)}};!function e(t,n,r){function a(i,o){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(s)return s(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[i]={exports:{}};t[i][0].call(p.exports,function(e){var n=t[i][1][e];return a(n?n:e)},p,p.exports,e,t,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){"use strict";var r=(e("./lines.js"),e("./feature.js")),a=e("./call-vector.js"),s=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this));return r.isSolid="solid"==n.type,r.isSolid&&r.features.push(new a("background.color",n.color,"gl.clearColor",[0,0,0,0])),r}return babelHelpers.inherits(t,e),t.prototype.getJsLoopLines=function(t){var n=e.prototype.getJsLoopLines.call(this,t);return this.isSolid&&n.a("gl.clear(gl.COLOR_BUFFER_BIT);"),n},t}(r);t.exports=s},{"./call-vector.js":4,"./feature.js":9,"./lines.js":16}],2:[function(e,t,n){"use strict";var r=function(){function e(t,n,r,a,s){babelHelpers.classCallCheck(this,e),this.name=t,this.isVisible=r,this.updateCallback=a,this.fullName=s,this._$=null}return e.prototype.updateVisibility=function(){this.$&&this.$.toggle(this.isVisible())},babelHelpers.createClass(e,[{key:"$",get:function(){return this._$},set:function(e){this._$=e,this.updateVisibility()}}]),e}(),a=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i));return void 0!==l?u.defaultValue=l:u.defaultValue=o[0],void 0!==r?u._value=r:u._value=u.defaultValue,u}return babelHelpers.inherits(t,e),t.prototype["export"]=function(){return this.value!=this.defaultValue?this.value:null},t.prototype.fix=function(){return this.value},babelHelpers.createClass(t,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.updateCallback()}}]),t}(r),s=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i,o,l));return u.availableValues=o,u}return babelHelpers.inherits(t,e),t}(a),i=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i,o,l));return u.availableMin=o[0],u.availableMax=o[1],u}return babelHelpers.inherits(t,e),t}(a),o=function(e){function t(n,r,a,s,i,o){babelHelpers.classCallCheck(this,t);var l=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i));return l.entries=o,l}return babelHelpers.inherits(t,e),t.prototype["export"]=function(){var e={};return this.entries.forEach(function(t){var n=t["export"]();null!==n&&(e[t.name]=n)}),Object.keys(e).length>0?e:null},t.prototype.fixFromIterateOver=function(e){var t=function(t){return function(n,r){return t.call(e,function(e){return n.apply(r,e)})}},n={length:e.length,map:t([].map),every:t([].every),some:t([].some),forEach:t([].forEach)};return e.forEach(function(e){n[e[1]]=e[0]}),n},t.prototype.fix=function(){var e=this.entries.map(function(e,t){return[e.fix(),e.name,t]});return this.fixFromIterateOver(e)},t}(r),l=function(e){function t(n,r,a,s,i,o,l){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i,o,!!l))}return babelHelpers.inherits(t,e),t}(a),u=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(s),p=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(o),c=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(o),h=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=babelHelpers.possibleConstructorReturn(this,e.call(this,n,void 0,a,s,i));if(u.availableTypes=o,u.availableConstructors=l,u._entries=[],"object"==("undefined"==typeof r?"undefined":babelHelpers["typeof"](r)))for(var p in r){var c=r[p],h=void 0,f=void 0;"string"==typeof c?h=c:"object"==("undefined"==typeof c?"undefined":babelHelpers["typeof"](c))&&(h=c.type,f=c.value),l[h]&&u._entries.push(l[h](f))}return u}return babelHelpers.inherits(t,e),t.prototype.addEntry=function(e){var t=this.availableConstructors[e]();return this._entries.push(t),this.updateCallback(),t},t.prototype["export"]=function(){return this._entries.map(function(e){var t=e["export"]();return null!==t?{type:e.name,value:t}:e.name})},t.prototype.fix=function(){return this._entries.map(function(e){return{type:e.name,value:e.fix()}})},babelHelpers.createClass(t,[{key:"entries",get:function(){return this._entries},set:function(e){this._entries=e,this.updateCallback()}}]),t}(r);n.Base=r,n.Input=a,n.Checkbox=l,n.FactorInput=s,n.RangeInput=i,n.Collection=o,n.Select=u,n.Root=p,n.Group=c,n.Array=h},{}],3:[function(e,t,n){"use strict";var r=function(){function t(e){var n=this;babelHelpers.classCallCheck(this,t),this.updateCallback=null;var r=function(){n.updateCallback&&n.updateCallback()},a=this.optionClasses,s={},i={},o=function(e,t,n){var s=e[0];if(void 0===a[s])throw new Error("invalid option type '"+s+"'");for(var i=e[1],o=t+i,l=e.slice(2),u=[],p=void 0,c=0,h=0,f=0;f<l.length;f++){var d=l[f];if("string"==typeof d||"number"==typeof d||"boolean"==typeof d){if(0!=c)throw new Error("too many scalar arguments");p=d,c++}else{if(!Array.isArray(d))throw new Error("unknown argument type");if(0!=h)throw new Error("too many array arguments");u=d,h++}}var m=[null,i,n,function(){return!0},r,o,u,p],v=new(Function.prototype.bind.apply(a[s],m));return v},l=function u(e,t,r){var l=e[0];if(void 0===a[l])throw new Error("invalid option type '"+l+"'");for(var p=e[1],c=t+p,h=e.slice(2),f=[],d=void 0,m={},v=0,g=0,b=0,y=0;y<h.length;y++){var x=h[y];if("string"==typeof x||"number"==typeof x||"boolean"==typeof x){if(0!=v)throw new Error("too many scalar arguments");d=x,v++}else if(Array.isArray(x)){if(0!=g)throw new Error("too many array arguments");"Array"==l?(d={},x.forEach(function(e){var t=e[1];f.push(t),d[t]=function(t){return o(e,c+".",t)}})):f=x.map(function(e){if(Array.isArray(e)){var t=e[1],n=void 0;return"object"==("undefined"==typeof r?"undefined":babelHelpers["typeof"](r))&&(n=r[t]),u(e,c+".",n)}return e}),g++}else{if(!(x instanceof Object))throw new Error("unknown argument type");if(0!=b)throw new Error("too many array arguments");m=x,b++}}var C=function(){for(var e in m){var t=s[e].value;if(m[e].indexOf(t)<0)return!1}return!0},j=function(){void 0!==i[c]&&i[c].forEach(function(e){e.updateVisibility()}),n.updateCallback&&n.updateCallback()},w=[null,p,r,C,j,c,f,d],L=new(Function.prototype.bind.apply(a[l],w));s[c]=L;for(var k in m)void 0===i[k]&&(i[k]=[]),i[k].push(L);return L};this.root=new a.Root(null,e,function(){return!0},r,null,this.entriesDescription.map(function(t){var n=t[1],r=void 0;return"object"==("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&(r=e[n]),l(t,"",r)}))}return t.prototype["export"]=function(){var e=this.root["export"]();return null!==e?e:{}},t.prototype.fix=function(){return this.root.fix()},babelHelpers.createClass(t,[{key:"optionClasses",get:function(){return e("./option-classes.js")}},{key:"entriesDescription",get:function(){return[]}}]),t}();t.exports=r},{"./option-classes.js":2}],4:[function(e,t,n){"use strict";var r=(e("./fixed-options-helpers.js"),e("./lines.js")),a=e("./vector.js"),s=function(e){function t(n,r,a,s){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r));return i.calledFn=a,i.calledFnDefaultArgs=s,i}return babelHelpers.inherits(t,e),t.prototype.getJsUpdateLines=function(e){var t=this,n=new r,a=0;if(this.components.forEach(function(e){a+="slider"==e.value.input}),this.modeConstant&&this.components.every(function(e,n){return e.value==t.calledFnDefaultArgs[n]}));else if(1>=a)n.a(this.calledFn+"("+this.components.map(e).join(",")+");");else if(this.components.every(function(e){return"slider"==e.value.input})){var s=this.calledFn,i=s.lastIndexOf(".");i>=0&&(s=s.slice(0,i));var o="["+this.components.map(function(e){return"'"+e.suffix+"'"}).join(",")+"]";n.a(this.calledFn+".apply("+s+","+o+".map(function(c){","	return parseFloat(document.getElementById('"+this.name+".'+c).value);","}));")}else n.a(this.calledFn+"("),this.components.forEach(function(t,r){r>0&&n.t(","),n.a("	"+e(t))}),n.a(");");return n},t.prototype.addPostToListenerEntryAfterComponents=function(e,t){e.post(this.calledFn+"("+this.components.map(t).join(",")+");")},t}(a);t.exports=s},{"./fixed-options-helpers.js":10,"./lines.js":16,"./vector.js":34}],5:[function(e,t,n){"use strict";var r=e("./lines.js"),a=e("./listener-classes.js"),s=e("./feature.js"),i=e("./int-feature.js"),o=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this));return r.width=n.width,r.height=n.height,r.features.push(new i("canvas.width",n.width),new i("canvas.height",n.height)),r}return babelHelpers.inherits(t,e),t.prototype.getHtmlCanvasLines=function(){return new r("<div>","	<canvas id='myCanvas' width='"+this.width+"' height='"+this.height+"'></canvas>","</div>")},t.prototype.getGlslVertexDeclarationLines=function(){return this.hasInputs()?new r("uniform float aspect;"):new r},t.prototype.getGlslVertexOutputLines=function(){var e=!this.hasInputs()&&Number(this.width)!=Number(this.height);return e?new r("float aspect="+this.width+".0/"+this.height+".0;"):new r},t.prototype.providesAspect=function(){return this.hasInputs()||Number(this.width)!=Number(this.height)},t.prototype.getJsInitLines=function(t){var n=this,r=e.prototype.getJsInitLines.call(this,t),s=function(){r.a("function updateAspect() {","	gl.viewport(0,0,canvas.width,canvas.height);","	gl.uniform1f(aspectLoc,canvas.width/canvas.height);","}","updateAspect();")},i=function(e){if("slider"==n[e].input){var s=new a.Slider("canvas."+e);s.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("canvas."+e+"=parseInt(this.value);").post("updateAspect();"),r.a(t.getListenerLines(s))}};return this.hasInputs()&&(r.a("var aspectLoc=gl.getUniformLocation(program,'aspect');"),s(),i("width"),i("height")),r},t}(s);t.exports=o},{"./feature.js":9,"./int-feature.js":15,"./lines.js":16,"./listener-classes.js":17}],6:[function(e,t,n){"use strict";var r=e("./lines.js"),a=e("./shape-classes.js"),s=e("./feature-context.js"),i=e("./canvas.js"),o=e("./background.js"),l=e("./transforms.js"),u=e("./illumination.js");t.exports=function(e,t){function n(){var t=e.shape.type.charAt(0).toUpperCase()+e.shape.type.slice(1);return new a[t](e.shape,"off"!=e.light.type,"vertex"==e.material.scope,"face"==e.material.scope,C.getColorAttrs())}function p(){var e=new r;return g.hasSliders&&e.a("label {","	display: inline-block;","	width: 15em;","	text-align: right;","}",".min {","	display: inline-block;","	width: 4em;","	text-align: right;","}",".max {","	display: inline-block;","	width: 4em;","	text-align: left;","}"),e.wrapIfNotEmpty("<style>","</style>")}function c(){var e=C.wantsTransformedPosition(x.eyeAtInfinity);return new r(b.getGlslVertexDeclarationLines(),x.getGlslVertexDeclarationLines(2==j.dim),C.getGlslVertexDeclarationLines(x.eyeAtInfinity,j.dim>2),new r(b.getGlslVertexOutputLines(),x.getGlslVertexOutputLines(2==j.dim,b.providesAspect(),e),C.getGlslVertexOutputLines(x.eyeAtInfinity,j.hasNormals,x.getGlslVertexNormalTransformLines())).wrap("void main() {","}"))}function h(){return new r("precision mediump float;",C.getGlslFragmentDeclarationLines(x.eyeAtInfinity),C.getGlslFragmentOutputLines(x.eyeAtInfinity,j.twoSided).wrap("void main() {","}"))}function f(){var e=new r;return w.forEach(function(n){e.a(n.getHtmlControlMessageLines(t))}),e.wrapIfNotEmpty("<ul>","</ul>")}function d(){var e=new r;return w.forEach(function(n){e.a(n.getHtmlInputLines(t))}),e}function m(){function t(){var t=new r;return t.a("var vertexShader=gl.createShader(gl.VERTEX_SHADER);","gl.shaderSource(vertexShader,vertexShaderSrc);","gl.compileShader(vertexShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));"),t.a("var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);","gl.shaderSource(fragmentShader,fragmentShaderSrc);","gl.compileShader(fragmentShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));"),t.a("var program=gl.createProgram();","gl.attachShader(program,vertexShader);","gl.attachShader(program,fragmentShader);","gl.linkProgram(program);","return program;"),t.wrap("function makeProgram(vertexShaderSrc,fragmentShaderSrc) {","}")}var n=new r;n.a(t(),"var canvas=document.getElementById('myCanvas');","var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');"),n.a("var program=makeProgram(","	document.getElementById('myVertexShader').text,","	document.getElementById('myFragmentShader').text",");","gl.useProgram(program);");var a=function(e,t){e.data.length>0&&n.a("","// "+t,e)};return w.forEach(function(e,t){a(e.getJsInitLines(g),"init "+L[t])}),a(g.getJsAfterInitLines(),"init mousemove listener"),n}function v(){var e=new r;g.hasClampFn&&e.a("function clamp(v,min,max) {","	return Math.min(Math.max(v,min),max);","}"),g.hasWrapFn&&e.a("function wrap(v,maxAbs) {","	v%=maxAbs*2;","	if (Math.abs(v)<=maxAbs) return v;","	return v-(v>0?1:-1)*maxAbs*2;","}"),g.pollsGamepad&&e.a("var gamepad;","var gamepads=(navigator.getGamepads ? navigator.getGamepads() : []);","for (var i=0;i<gamepads.length;i++) {","	if (gamepads[i]) {","		gamepad=gamepads[i];","		break;","	}","}"),w.forEach(function(t){e.a(t.getJsLoopLines(g))});var t=new r;return g.hasStartTime&&g.hasPrevTime?t.a("var startTime=performance.now();","var prevTime=startTime;"):g.hasStartTime?t.a("var startTime=performance.now();"):g.hasPrevTime&&t.a("var prevTime=performance.now();"),g.isAnimated?(g.hasTime?t.a("function renderFrame(time) {"):t.a("function renderFrame() {"),t.a(e.indent()),g.hasPrevTime&&t.a("	prevTime=time;"),t.a("	requestAnimationFrame(renderFrame);","}","requestAnimationFrame(renderFrame);")):g.hasInputs?t.a("var frameId=null;","function renderFrame() {",e.indent(),"	frameId=null;","}","function scheduleFrame() {","	if (frameId===null) {","		frameId=requestAnimationFrame(renderFrame);","	}","}","scheduleFrame();"):t.a(e),t}var g=new s(e.debug),b=new i(e.canvas),y=new o(e.background),x=new l(e.transforms),C=new u(e.material,e.light),j=n(),w=[b,y,x,C,j],L=["canvas","background","transforms","illumination","shape"];w.forEach(function(e){e.requestFeatureContext(g)});var k=new r;k.interleave(m(),v()).wrap("<script>","</script>");var S=new r;return S.a("<!DOCTYPE html>","<html lang='en'>","<head>","<meta charset='utf-8' />","<title>Generated code</title>",p(),"<script id='myVertexShader' type='x-shader/x-vertex'>",c().indent(),"</script>","<script id='myFragmentShader' type='x-shader/x-fragment'>",h().indent(),"</script>","</head>","<body>",b.getHtmlCanvasLines(),f(),d(),k,"</body>","</html>"),S.join("tab"==e.formatting.indent?"	":Array(parseInt(e.formatting.indent)+1).join(" "))}},{"./background.js":1,"./canvas.js":5,"./feature-context.js":8,"./illumination.js":13,"./lines.js":16,"./shape-classes.js":22,"./transforms.js":32}],7:[function(e,t,n){"use strict";var r=0,a=function(e,t,n){this.weight=e,this.noise=t,void 0===t&&(this.noise=.4),this.baseColors=n||this.defaultBaseColors,this.colorgenNumber=r++,this.nextIndex=0};a.prototype.defaultBaseColors=[[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1]],a.prototype.getNextColorString=function(){var e=this.baseColors[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.baseColors.length,e.map(function(e,t){var n=Math.sin(9e3*this.colorgenNumber+400*this.nextIndex+100*t),r=(e*(1-this.noise)+n*n*this.noise)*this.weight;return" "+r.toFixed(1)+","},this).join("")};var s=function(e,t,n){this.colorAttrs=e,this.singleColorgens=this.colorAttrs.map(function(e){return new a(e.weight,t,n)})};s.prototype.getHeaderString=function(){return this.colorAttrs.map(function(){return"    r    g    b"}).join("")},s.prototype.getNextColorString=function(){return this.singleColorgens.map(function(e){return e.getNextColorString()}).join("")},t.exports=s},{}],8:[function(e,t,n){"use strict";var r=e("./listener-classes.js"),a=function(){function e(t){babelHelpers.classCallCheck(this,e),this.debugOptions=t,this.canvasMousemoveListener=new r.CanvasMousemove,this.hasSliders=!1,this.hasInputs=!1,this.hasStartTime=!1,this.hasPrevTime=!1,this.pollsGamepad=!1,this.hasClampFn=!1,this.hasWrapFn=!1}return e.prototype.getJsAfterInitLines=function(){return this.canvasMousemoveListener.write(!this.isAnimated,this.debugOptions.inputs)},e.prototype.getListenerLines=function(e){return e.write(!this.isAnimated,this.debugOptions.inputs)},babelHelpers.createClass(e,[{key:"hasTime",get:function(){return this.hasStartTime||this.hasPrevTime}},{key:"isAnimated",get:function(){return this.hasStartTime||this.hasPrevTime||this.pollsGamepad}}]),e}();t.exports=a},{"./listener-classes.js":17}],9:[function(e,t,n){"use strict";var r=e("./lines.js"),a=function(){function e(){babelHelpers.classCallCheck(this,e),this.features=[]}return e.prototype.getRecursiveLines=function(e,t){var n=new r;return this.features.forEach(function(r){n.a(r[e].apply(r,t))}),n},e.prototype.hasInputs=function(){return this.features.some(function(e){return e.hasInputs()})},e.prototype.requestFeatureContext=function(e){this.features.forEach(function(t){t.requestFeatureContext(e)})},e.prototype.getHtmlInputLines=function(e){return this.getRecursiveLines("getHtmlInputLines",arguments)},e.prototype.getHtmlControlMessageLines=function(e){return this.getRecursiveLines("getHtmlControlMessageLines",arguments)},e.prototype.getJsInitLines=function(e){return this.getRecursiveLines("getJsInitLines",arguments)},e.prototype.getJsLoopLines=function(e){return this.getRecursiveLines("getJsLoopLines",arguments)},e}();t.exports=a},{"./lines.js":16}],10:[function(e,t,n){"use strict";function r(e,t,n){var r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"entriesDescription",get:function(){return n}}]),t}(t),a=new r,s=e,i=a.fix(),o=s.map(function(e,t,n){return[e,t,n]}).concat(i.map(function(e,t,n){return[e,t,n+s.length]}));return a.root.fixFromIterateOver(o)}function a(e,t,n){var r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"entriesDescription",get:function(){return[]}}]),t}(n),a=new r,s=e.map(function(e,n){return[e,t[n],n]});return a.root.fixFromIterateOver(s)}function s(e){var t=e.availableMin>=0&&e.availableMax>=0,n=Math.max(String(Math.abs(e.availableMin)).split(".")[0].length,String(Math.abs(e.availableMax)).split(".")[0].length),r=String(e.step).split("."),a=r.length>1?r[1].length:0,s=n+a+(a>0),i="          ",o=function(e){return(i+e.toFixed(a)).slice(-s)};return t?function(e){return o(e)}:function(e){return(0>=e?0>e?"-":" ":"+")+o(Math.abs(e))}}function i(e){return s(e)(e)}function o(e,t){var n=new Number(Math.min(t,e));return n.min=e.min,n.max=Math.min(t,e.max),n.input=e.input,n.availableMin=e.availableMin,n.availableMax=e.availableMax,n.step=e.step,n}n.extendCollection=r,n.makeCollection=a,n.makeFormatNumber=s,n.formatNumber=i,n.capNumber=o},{}],11:[function(e,t,n){"use strict";var r=e("./fixed-options-helpers.js"),a=e("./lines.js"),s=e("./vector.js"),i=function(e){function t(n,r,a){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a))}return babelHelpers.inherits(t,e),t.prototype.getGlslDeclarationLines=function(){var e=this;if(this.modeConstant)return new a;if(!this.modeFloats)return new a("uniform vec"+this.nVars+" "+this.varName+";");var t=function(){var t=new a;return e.components.forEach(function(e){e.variable&&t.a("uniform float "+e.varName+";")}),{v:t}}();return"object"===("undefined"==typeof t?"undefined":babelHelpers["typeof"](t))?t.v:void 0},t.prototype.getGlslValue=function(){return this.getGlslComponentsValue(this.components.map(function(e){return e.suffix}).join(""))},t.prototype.getGlslComponentsValue=function(e){for(var t=this,n=this.components.map(function(e){return e.suffix}).slice(0,this.nVars).join(""),a=[],s=function(e){return e[0]?r.formatNumber(t.componentsBySuffix[e[1]].value):t.modeVector?e[1]==n?t.varName:t.varName+"."+e[1]:t.componentsBySuffix[e[1]].varName},i=function(){if(!a[0][0])return!1;var e=r.formatNumber(t.componentsBySuffix[a[0][1]].value);return a.every(function(n){return n[0]&&r.formatNumber(t.componentsBySuffix[n[1]].value)==e})},o=0;o<e.length;o++){var l=e.charAt(o);if(this.componentsBySuffix[l].variable)if(this.modeVector&&a.length>0){var u=a.pop();u[0]?a.push(u,[!1,l]):a.push([u[0],u[1]+l])}else a.push([!1,l]);else a.push([!0,l])}return 1==a.length?this.modeVector&&e==n?this.varName:s(a[0]):i()?"vec"+e.length+"("+s(a[0])+")":"vec"+e.length+"("+a.map(s).join(",")+")"},t.prototype.getGlslMapDeclarationLines=function(e,t){return new a(this.components.length>1?"vec"+this.components.length+" "+e+"="+t(this.getGlslValue())+";":"float "+e+this.components[0].suffix+"="+t(this.getGlslValue())+";")},t.prototype.getGlslMapComponentValue=function(e,t){return this.components.length>1?e+"."+t:e+t},t.prototype.getJsDeclarationLines=function(){var e=new a;return this.modeConstant?e:(this.modeFloats?this.components.forEach(function(t){t.variable&&e.a("var "+t.varNameLoc+"=gl.getUniformLocation(program,'"+t.varName+"');")}):e.a("var "+this.varName+"Loc=gl.getUniformLocation(program,'"+this.varName+"');"),e)},t.prototype.getJsUpdateLines=function(e){var t=new a;return this.modeVector?(t.a("gl.uniform"+this.nVars+"f("+this.varName+"Loc"),this.components.every(function(e){return"slider"!=e.value.input})?(this.components.forEach(function(n){n.variable&&t.t(","+e(n))}),t.t(");")):(this.components.forEach(function(n){n.variable&&t.t(",","	"+e(n))}),t.a(");"))):this.components.forEach(function(n){n.variable&&t.a("gl.uniform1f("+n.varNameLoc+","+e(n)+");")}),t},t.prototype.addPostToListenerEntryForComponent=function(e,t){this.modeVector||e.post("gl.uniform1f("+t.varNameLoc+","+t.varName+");")},t.prototype.addPostToListenerEntryAfterComponents=function(e,t){var n=this;this.modeVector&&!function(){var t=[];n.components.forEach(function(e,r){r<n.nVars&&t.push(e.varName)}),e.post("gl.uniform"+n.nVars+"f("+n.varName+"Loc,"+t.join(",")+");")}()},t}(s);t.exports=i},{"./fixed-options-helpers.js":10,"./lines.js":16,"./vector.js":34}],12:[function(e,t,n){"use strict";function r(e){return e.toString().replace("-","−")}function a(e,t){return 1==e?t:t+"s"}function s(e,t){var n=void 0;(n=p.exec(e))?!function(){var e=n[1],r=n[2].split(","),a=n[3];"string"==typeof t&&(n=p.exec(t))?!function(){var t=n[1],i=n[2].split(","),o=n[3];r.forEach(function(n,r){var l=i[r];s(e+n+a,t+l+o)})}():r.forEach(function(n){s(e+n+a,t)})}():u[e]=t}var i=function(e){return r(e)},o=function(e){return r(e)+" <abbr title='"+a(e,"pixel")+"'>px</abbr>"},l={"message.hljs":"<a href='https://highlightjs.org/'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.","message.elements":"choosing 8- or 16-bit index may limit available shape detail levels","options.canvas":"Canvas","options.canvas.{width,height}":"Canvas {width,height}","options.canvas.{width,height}.value":o,"options.background":"Background","options.background.type":"Background type","options.background.type.none":"none (transparent)","options.background.type.solid":"solid color","options.background.color":"Background color","options.background.color.{r,g,b,a}":"Background color {red,green,blue,alpha} component","options.background.color.{r,g,b,a}.value":i,"options.background.color.{r,g,b,a}.speed":"Background color {red,green,blue,alpha} speed","options.background.color.{r,g,b,a}.speed.value":i,"options.material":"Material","options.material.scope":"Set material color for objects","options.material.scope.global":"entire scene","options.material.scope.vertex":"shape vertices","options.material.scope.face":"shape faces","options.material.data":"For each object have","options.material.data.one":"one color","options.material.data.sda":"specular/diffuse/ambient colors","options.material.color":"Material color","options.material.color.{r,g,b,a}":"Material color {red,green,blue,alpha} component","options.material.color.{r,g,b,a}.value":i,"options.material.color.{r,g,b,a}.speed":"Material color {red,green,blue,alpha} speed","options.material.color.{r,g,b,a}.speed.value":i,"options.material.{specular,diffuse,ambient}Color":"Material {specular,diffuse,ambient} color","options.material.{specular,diffuse,ambient}Color.{r,g,b}":"{Specular,Diffuse,Ambient} color {red,green,blue} component","options.material.{specular,diffuse,ambient}Color.{r,g,b}.value":i,"options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed":"Material {specular,diffuse,ambient} color {red,green,blue,alpha} speed","options.material.{specular,diffuse,ambient}Color.{r,g,b}.speed.value":i,"options.light":"Light","options.light.type":"Light type","options.light.type.off":"off","options.light.type.phong":"on with Phong reflections","options.light.type.blinn":"on with Blinn–Phong reflections","options.light.direction":"Light direction","options.light.direction.{x,y,z}":"Light direction {x,y,z} component","options.light.direction.{x,y,z}.value":i,"options.light.direction.{x,y,z}.speed":"Light direction {x,y,z} speed","options.light.direction.{x,y,z}.speed.value":i,"options.shape":"Shape","options.shape.type":"Shape to draw","options.shape.type.square":"square","options.shape.type.triangle":"triangle","options.shape.type.gasket":"Sierpinski gasket","options.shape.type.cube":"cube","options.shape.type.hat":"Mexican hat function","options.shape.type.terrain":"diamond-square fractal terrain","options.shape.elements":"Element array","options.shape.elements.0":"not used","options.shape.elements.{8,16,32}":"with {8,16,32}-bit index","options.shape.lod":"Shape detail level","options.shape.lod.value":i,"options.transforms":"Transforms","options.transforms.projection":"Projection","options.transforms.projection.ortho":"orthogonal","options.transforms.projection.perspective":"perspective","options.transforms.model":"Model transform","options.transforms.model.rotate.{x,y,z}.add":"Add rotation around {x,y,z} axis","options.transforms.model.rotate.{x,y,z}":"Angle of rotation around {x,y,z} axis","options.transforms.model.rotate.{x,y,z}.value":i,"options.transforms.model.rotate.{x,y,z}.speed":"Speed of rotation around {x,y,z} axis","options.transforms.model.rotate.{x,y,z}.speed.value":i,"options.debug":"Debug options","options.debug.shaders":"Log shader compilation errors","options.debug.arrays":"Log allocated array sizes","options.debug.inputs":"Log input values","options.debug.animations":"Log animated values","options.formatting":"Code formatting options","options.formatting.indent":"Indent","options.formatting.indent.tab":"tab","options.formatting.indent.{2,4,8}":"{2,4,8} spaces","ui.inputs":"Input method","ui.inputs.constant":"none","ui.inputs.slider":"slider","ui.inputs.mousemove{x,y}":"mouse {x,y} axis","ui.inputs.gamepad{0,1,2,3}":"gamepad {0,1,2,3} axis","ui.range":"with range","ui.reset":"Reset","ui.addSpeed":"Add speed","ui.drag":"Drag or press up/down while in focus to reorder transforms","ui.delete":"Delete transform","controls.type.mousemovex":"Move the mouse pointer horizontally over the canvas","controls.type.mousemovey":"Move the mouse pointer vertically over the canvas","controls.to":"to update"},u={},p=/^([^{]*)\{([^}]*)\}(.*)$/;for(var c in l)s(c,l[c]);t.exports=function(e,t){if(void 0===u[e])throw new Error("undefined string "+e);return"string"==typeof u[e]?u[e]:u[e](t)}},{}],13:[function(e,t,n){"use strict";var r=e("./options.js"),a=e("./fixed-options-helpers.js"),s=e("./lines.js"),i=e("./feature.js"),o=e("./glsl-vector.js"),l=function(e){function t(n,s){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this));if(i.material=n,i.light=s,"global"==n.scope)if("one"==n.data)i.features.push(i.colorVector=new o("material.color",n.color));else if("off"!=s.type)i.features.push(i.specularColorVector=new o("material.specularColor",n.specularColor),i.diffuseColorVector=new o("material.diffuseColor",n.diffuseColor),i.ambientColorVector=new o("material.ambientColor",n.ambientColor));else{var l=a.extendCollection(n.ambientColor,r,[["LiveFloat","a",[0,1],1]]);i.features.push(i.ambientColorVector=new o("material.ambientColor",l))}return"off"!=s.type&&i.features.push(i.lightDirectionVector=new o("light.direction",s.direction)),i}return babelHelpers.inherits(t,e),t.prototype.getColorAttrs=function(){return"global"==this.material.scope?[]:"one"==this.material.data?[{name:"color",enabled:!0,weight:1}]:[{name:"specularColor",enabled:"off"!=this.light.type,weight:.4},{name:"diffuseColor",enabled:"off"!=this.light.type,weight:.4},{name:"ambientColor",enabled:!0,weight:.2}]},t.prototype.wantsTransformedPosition=function(e){return!e&&"off"!=this.light.type&&"one"!=this.material.data},t.prototype.getGlslVertexDeclarationLines=function(e,t){var n=new s;return this.wantsTransformedPosition(e)&&n.a("varying vec3 interpolatedView;"),"off"!=this.light.type&&(t&&n.a("attribute vec3 normal;"),n.a("varying vec3 interpolatedNormal;")),"global"!=this.material.scope&&("one"==this.material.data?(n.a("attribute vec4 color;"),n.a("varying vec4 interpolatedColor;")):"off"==this.light.type?(n.a("attribute vec4 ambientColor;"),n.a("varying vec4 interpolatedColor;")):n.a("attribute vec3 specularColor;","attribute vec3 diffuseColor;","attribute vec3 ambientColor;","varying vec3 interpolatedSpecularColor;","varying vec3 interpolatedDiffuseColor;","varying vec3 interpolatedAmbientColor;")),n},t.prototype.getGlslVertexOutputLines=function(e,t,n){var r=new s;return this.wantsTransformedPosition(e)&&r.a("interpolatedView=-transformedPosition.xyz;"),"off"!=this.light.type&&(r.a("interpolatedNormal="),t?r.t("normal"):r.t("vec3(0.0,0.0,1.0)"),r.t(n),r.t(";")),"global"!=this.material.scope&&("one"==this.material.data?r.a("interpolatedColor=color;"):"off"==this.light.type?r.a("interpolatedColor=ambientColor;"):r.a("interpolatedSpecularColor=specularColor;","interpolatedDiffuseColor=diffuseColor;","interpolatedAmbientColor=ambientColor;")),
r},t.prototype.getGlslFragmentDeclarationLines=function(e){var t=new s;return this.wantsTransformedPosition(e)&&t.a("varying vec3 interpolatedView;"),"off"!=this.light.type&&t.a(this.lightDirectionVector.getGlslDeclarationLines(),"varying vec3 interpolatedNormal;"),"global"==this.material.scope?"one"==this.material.data?t.a(this.colorVector.getGlslDeclarationLines()):("off"!=this.light.type&&(t.a(this.specularColorVector.getGlslDeclarationLines()),t.a(this.diffuseColorVector.getGlslDeclarationLines())),t.a(this.ambientColorVector.getGlslDeclarationLines())):"one"==this.material.data||"off"==this.light.type?t.a("varying vec4 interpolatedColor;"):t.a("varying vec3 interpolatedSpecularColor;","varying vec3 interpolatedDiffuseColor;","varying vec3 interpolatedAmbientColor;"),t},t.prototype.getGlslFragmentOutputLines=function(e,t){var n=this,r=new s,a=void 0,i=void 0,o=void 0;if("global"==this.material.scope?!function(){var e="one"==n.material.data?n.colorVector:n.ambientColorVector;a=function(){return e.getGlslComponentsValue("rgb")},i=function(){return e.getGlslComponentsValue("a")},o=function(){return e.getGlslValue()}}():(a=function(){return"interpolatedColor.rgb"},i=function(){return"interpolatedColor.a"},o=function(){return"interpolatedColor"}),"off"==this.light.type)r.a("gl_FragColor="+o()+";");else if(r.a("vec3 N=normalize(interpolatedNormal);"),t&&r.a("if (!gl_FrontFacing) N=-N;"),r.a("vec3 L=normalize("+this.lightDirectionVector.getGlslValue()+");"),"one"==this.material.data)r.a("gl_FragColor=vec4("+a()+"*max(0.0,dot(L,N)),"+i()+");");else{this.wantsTransformedPosition(e)?r.a("vec3 V=normalize(interpolatedView);"):r.a("vec3 V=vec3(0.0,0.0,1.0);");var l="H,N",u="";"blinn"==this.light.type?r.a("vec3 H=normalize(L+V);"):(r.a("vec3 R=reflect(-L,N);"),l="R,V",u="/4.0"),r.a("float shininess=100.0;"),r.a(("global"==this.material.scope?new s("+"+this.specularColorVector.getGlslValue()+"*pow(max(0.0,dot("+l+")),shininess"+u+")","+"+this.diffuseColorVector.getGlslValue()+"*max(0.0,dot(L,N))","+"+this.ambientColorVector.getGlslValue()):new s("+interpolatedSpecularColor*pow(max(0.0,dot("+l+")),shininess"+u+")","+interpolatedDiffuseColor*max(0.0,dot(L,N))","+interpolatedAmbientColor")).wrap("gl_FragColor=vec4(",",1.0);"))}return r},t}(i);t.exports=l},{"./feature.js":9,"./fixed-options-helpers.js":10,"./glsl-vector.js":11,"./lines.js":16,"./options.js":21}],14:[function(e,t,n){"use strict";function r(e){return new{constant:s,slider:o,mousemovex:l,mousemovey:l,gamepad0:u,gamepad1:u,gamepad2:u,gamepad3:u}[e](e)}var a=function(){function e(t){babelHelpers.classCallCheck(this,e),this._str=t}return e.prototype.toString=function(){return this._str},e.prototype.valueOf=function(){return this._str},e}(),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(a),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(a),o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t}(i),l=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this,n));return r.axis=n.slice(-1),r}return babelHelpers.inherits(t,e),t}(i),u=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this,n));return r.axis=Number(n.slice(-1)),r}return babelHelpers.inherits(t,e),t}(i);n.Base=a,n.Constant=s,n.Variable=i,n.Slider=o,n.MouseMove=l,n.Gamepad=u,n.createFromString=r},{}],15:[function(e,t,n){"use strict";var r=e("./numeric-feature.js"),a=function(e){function t(n,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,e.call(this));return a.name=n,a.value=r,a}return babelHelpers.inherits(t,e),t.prototype.hasInputs=function(){return e.prototype.hasInputs.call(this)||"constant"!=this.value.input},t.prototype.requestFeatureContext=function(t){e.prototype.requestFeatureContext.call(this,t),"constant"!=this.value.input&&(t.hasInputs=!0),"slider"==this.value.input&&(t.hasSliders=!0)},t.prototype.getHtmlControlMessageLines=function(t){var n=e.prototype.getHtmlControlMessageLines.call(this,t);return n.a(this.getHtmlControlMessageForValue(t,this.value,this.name)),n},t.prototype.getHtmlInputLines=function(t){var n=e.prototype.getHtmlInputLines.call(this,t),r=this.value;return"slider"==r.input&&n.a("<div>","	<label for='"+this.name+"'>"+t("options."+this.name)+":</label>","	<span class='min'>"+t("options."+this.name+".value",r.min)+"</span>","	<input type='range' id='"+this.name+"' min='"+r.min+"' max='"+r.max+"' value='"+r+"' />","	<span class='max'>"+t("options."+this.name+".value",r.max)+"</span>","</div>"),n},t}(r);t.exports=a},{"./numeric-feature.js":19}],16:[function(e,t,n){"use strict";var r=function(){this.data=[],this.addFlattenedArgs(this.flattenArgs(arguments))};r.prototype.flattenArgs=function(e){for(var t=[],n=0;n<e.length;n++)"string"==typeof e[n]?t.push(e[n]):Array.isArray(e[n])?Array.prototype.push.apply(t,e[n]):e[n]instanceof r&&Array.prototype.push.apply(t,e[n].data);return t},r.prototype.addFlattenedArgs=function(e){Array.prototype.push.apply(this.data,e)},r.prototype.a=function(){return this.addFlattenedArgs(this.flattenArgs(arguments)),this},r.prototype.t=function(){var e=this.data.pop(),t=this.flattenArgs(arguments);return t[0]=e+t[0],this.addFlattenedArgs(t),this},r.prototype.indent=function(e){return void 0===e&&(e=1),this.data=this.data.map(function(t){return Array(e+1).join("	")+t}),this},r.prototype.isEmpty=function(){return this.data.length<=0},r.prototype.interleave=function(){for(var e=!0,t=0;t<arguments.length;t++){var n=this.flattenArgs([arguments[t]]);n.length>0&&(e?e=!1:this.data.push(""),this.addFlattenedArgs(n))}return this},r.prototype.wrap=function(e,t){return this.indent(),this.data.unshift(e),this.data.push(t),this},r.prototype.wrapIfNotEmpty=function(e,t){return this.isEmpty()||this.wrap(e,t),this},r.prototype.join=function(e){return this.data.map(function(t){return t.replace(/^(\t)+/,function(t){return Array(t.length+1).join(e)})}).join("\n")},t.exports=r},{}],17:[function(e,t,n){"use strict";var r=e("./lines.js"),a=function(){function e(){babelHelpers.classCallCheck(this,e),this.entries=[]}return e.prototype.enter=function(){function e(e){return function(){for(var t=0;t<arguments.length;t++)e.push(arguments[t]);return n}}var t={pre:[],cond:null,log:[],post:[]};this.entries.push(t);var n={pre:e(t.pre),cond:function(e){return t.cond=e,n},log:e(t.log),post:e(t.post)};return n},e.prototype.innerPrependedLines=function(){return[]},e.prototype.bracketFnArg=function(){return""},e.prototype.wrapCall=function(e){return e},e.prototype.write=function(e,t){var n={},a=[],s=null,i=0,o=1,l=2,u=function(e,t){var r=void 0;r=e in n?n[e]:n[e]={prevs:[],conds:[],mark:i},null!==r.conds&&(null===t?r.conds=null:r.conds.push(t)),null!==s&&r.prevs.push(s),s=e},p=function(){null!==s&&a.push(s),s=null},c=function(){var e=[],t=null,s=function(n,r){var a=null;null!==r.conds&&(a=r.conds.join(" || ")),a!=t&&(null!==t&&e.push("}"),t=a,null!==t&&e.push("if ("+t+") {")),null!==t?e.push("	"+n):e.push(n)},u=function(e,t){t.mark=o,p(t.prevs),t.mark=l,s(e,t)},p=function(e){e.forEach(function(e){n[e].mark==i&&u(e,n[e])})};return p(a),null!==t&&e.push("}"),new r(e)};this.entries.forEach(function(n){n.pre.forEach(function(e){u(e,null)}),t&&n.log.forEach(function(e){u(e,n.cond)}),n.post.forEach(function(e){u(e,n.cond)}),e&&u("scheduleFrame();",n.cond),p()});var h=this.bracketListener(),f=c();if(f.isEmpty()||(f=new r(this.innerPrependedLines(),f)),1==f.data.length){var d=/^(\w+)\(\);$/.exec(f.data[0]);if(d)return this.wrapCall(new r(h[0]+d[1]+h[1]))}return f.data.length?this.wrapCall(f.wrap(h[0]+"function("+this.bracketFnArg()+"){","}"+h[1])):new r},e}(),s=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this));return r.id=n,r}return babelHelpers.inherits(t,e),t.prototype.bracketListener=function(){return["document.getElementById('"+this.id+"').addEventListener('change',",");"]},t}(a),i=function(e){function t(n){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this));return r.query=n,r}return babelHelpers.inherits(t,e),t.prototype.wrapCall=function(e){return e.wrap("[].forEach.call(document.querySelectorAll('"+this.query+"'),function(el){","});")},t.prototype.bracketListener=function(){return["el.addEventListener('change',",");"]},t}(a),o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.enter=function(){var t=e.prototype.enter.call(this),n=function(e,n,r,a,s,i){var o=a.charAt(0).toUpperCase()+a.slice(1),l=void 0;return 0==s&&1==i?l=(n?"var ":"")+a+"=":(t.pre("var min"+o+"="+s+";"),t.pre("var max"+o+"="+i+";"),l=(n?"var ":"")+a+"=min"+o+"+(max"+o+"-min"+o+")*"),t.prexy(r,l+"(ev.clientX-rect.left)/(rect.width-1);",l+"(rect.bottom-1-ev.clientY)/(rect.height-1);")};return t.prexy=function(e,n,r){return"x"==e.axis?t.pre(n):"y"==e.axis?t.pre(r):t},t.minMaxFloat=function(e,t,r,a){return n(!0,!1,e,t,r,a)},t.minMaxVarFloat=function(e,t,r,a){return n(!0,!0,e,t,r,a)},t.newVarInt=function(e,n){var r=n.charAt(0).toUpperCase()+n.slice(1);return t.prexy(e,"var new"+r+"=Math.floor(min"+r+"+(max"+r+"-min"+r+"+1)*(ev.clientX-rect.left)/rect.width);","var new"+r+"=Math.floor(min"+r+"+(max"+r+"-min"+r+"+1)*(rect.bottom-1-ev.clientY)/rect.height);")},t},t.prototype.bracketListener=function(){return["canvas.addEventListener('mousemove',",");"]},t.prototype.bracketFnArg=function(){return"ev"},t.prototype.innerPrependedLines=function(){return["var rect=this.getBoundingClientRect();"]},t}(a);n.Slider=s,n.MultipleSlider=i,n.CanvasMousemove=o},{"./lines.js":16}],18:[function(e,t,n){"use strict";function r(){return"webgl-starter-id-"+s++}function a(e){return"data:text/html;charset=utf-8,"+encodeURIComponent(e)}var s=0,i=e("./i18n.js"),o=e("./option-classes.js"),l=e("./options.js"),u=e("./code.js");$(function(){$(".webgl-starter").each(function(){function e(){clearTimeout(d),d=setTimeout(function(){c.text(u(h.fix(),i)),window.hljs&&hljs.highlightBlock(c[0])},f)}function t(e){if(e instanceof o.Root)return e.$=$("<div>").append(e.entries.map(t));if(e instanceof o.Group)return e.$=$("<fieldset>").append("<legend>"+i("options."+e.fullName)+"</legend>").append(e.entries.map(t));if(e instanceof o.Checkbox){var n=r();return e.$=$("<div>").append($("<input type='checkbox' id='"+n+"'>").prop("checked",e.value).change(function(){e.value=$(this).prop("checked")})).append(" <label for='"+n+"'>"+i("options."+e.fullName)+"</label>")}if(e instanceof o.Select){var n=r();return e.$=$("<div>").append("<label for='"+n+"'>"+i("options."+e.fullName)+":</label>").append(" ").append($("<select id='"+n+"'>").append(e.availableValues.map(function(t){return $("<option>").val(t).html(i("options."+e.fullName+"."+t))})).val(e.value).change(function(){e.value=this.value})),"elements"==e.name&&e.$.append(" "+i("message.elements")),e.$}if(e instanceof o.LiveNumber){var a=function(e){var t=function(t){return t.attr("min",e.availableMin).attr("max",e.availableMax).attr("step",e.step)},n=function(n,r){return t(n).val(e.value).on("input change",function(){if(this.checkValidity()){var t=r();t.val(this.value),e.value=parseFloat(this.value)}})},a=function(n){return t($("<input type='number' required>")).val(e[n]).on("input change",function(){this.checkValidity()&&(e[n]=parseFloat(this.value))})},s=r(),o=r(),l=void 0,u=void 0,p=void 0,c=void 0,h=void 0;return $("<div>").append("<label for='"+s+"'>"+i("options."+e.fullName)+":</label>").append(" <span class='min'>"+i("options."+e.fullName+".value",e.availableMin)+"</span> ").append(l=n($("<input type='range' id='"+s+"'>"),function(){return u})).append(" <span class='max'>"+i("options."+e.fullName+".value",e.availableMax)+"</span> ").append(u=n($("<input type='number' required>"),function(){return l})).append(" <label for='"+o+"'>"+i("ui.inputs")+":</label> ").append(p=$("<select id='"+o+"'>").append(e.availableInputTypes.map(function(e){return $("<option>").val(e).html(i("ui.inputs."+e))})).val(e.input).change(function(){e.input=this.value})).append(" ").append(e.$range=$("<span class='range'>").append(i("ui.range")+" ").append(c=a("min")).append(" .. ").append(h=a("max"))).append(" ").append($("<button type='button'>"+i("ui.reset")+"</button>").click(function(){l.val(e.defaultValue).change(),p.val("constant").change(),c.val(e.availableMin).change(),h.val(e.availableMax).change()}))};return e.$=a(e),e instanceof o.LiveFloat&&(e.$.append(e.$addSpeed=$("<label> "+i("ui.addSpeed")+"</label>").prepend($("<input type='checkbox'>").prop("checked",e.addSpeed).change(function(){e.addSpeed=this.checked}))),e.$.append(" ").append(e.speed.$=a(e.speed))),e.$}if(e instanceof o.Array){var s=function(){var n=null,r=void 0,a=function(){e.entries=r.children().map(function(){return $(this).data("option")}).get()},s=function(e){return $("<div class='draggable-with-handle'>").data("option",e).append($("<div draggable='true' tabindex='0' title='"+i("ui.drag")+"'>").on("dragstart",function(e){n=$(this).parent(),e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("Text",name),e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(n[0],0,0),setTimeout(function(){n.addClass("ghost")},0)}).keydown(function(e){var t=$(this),n=t.parent();return 38==e.keyCode?(n.prev().before(n),t.focus(),a(),!1):40==e.keyCode?(n.next().after(n),t.focus(),a(),!1):void 0})).append(t(e)).append($("<div tabindex='0' class='delete' title='"+i("ui.delete")+"'>×</div>").click(function(){$(this).parent().remove(),a()}).keydown(function(e){return 13==e.keyCode||32==e.keyCode?($(this).parent().remove(),a(),!1):void 0})).on("dragover",function(e){e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move";var t=$(this);n&&(t.nextAll().is(n)?(t.before(n),a()):t.prevAll().is(n)&&(t.after(n),a()))}).on("drop",function(e){e.preventDefault()}).on("dragend",function(e){e.preventDefault(),n&&(n.removeClass("ghost"),n=null)})};e.$=$("<fieldset>").append("<legend>"+i("options."+e.fullName)+"</legend>").append(r=$("<div>").append(e.entries.map(s)));var o=$("<div>");return e.availableTypes.forEach(function(t,n){n&&o.append(" "),o.append($("<button type='button'>").html(i("options."+e.fullName+"."+t+".add")).click(function(){var n=e.addEntry(t);r.append(s(n))}))}),e.$.append(o),{v:e.$}}();if("object"===("undefined"==typeof s?"undefined":babelHelpers["typeof"](s)))return s.v}}function n(){return $("<div>").append($("<a download='source.html'><button type='button'>Save source code</button></a>").click(function(){$(this).attr("href",a(c.text()))})).append(" ").append($("<button type='button'>Run in new window</button>").click(function(){window.open(a(c.text()),"generatedCode")})).append(" these buttons don't work in Internet Explorer, copy-paste the code manually")}var s=$(this),p=void 0,c=void 0,h=new l,f=200,d=null;h.updateCallback=e,s.empty().append(p=t(h.root)),s.append(n()).append($("<pre>").append(c=$("<code>").text(u(h.fix(),i)))),window.hljs?hljs.highlightBlock(c[0]):s.append("<p>"+i("message.hljs")+"</p>"),s.append(n())})})},{"./code.js":6,"./i18n.js":12,"./option-classes.js":20,"./options.js":21}],19:[function(e,t,n){"use strict";var r=e("./input-classes.js"),a=e("./lines.js"),s=e("./feature.js"),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.getHtmlControlMessageForValue=function(e,t,n){return t.input instanceof r.MouseMove?new a("<li>"+e("controls.type."+t.input)+" "+e("controls.to")+" <strong>"+e("options."+n)+"</strong></li>"):new a},t}(s);t.exports=i},{"./feature.js":9,"./input-classes.js":14,"./lines.js":16}],20:[function(e,t,n){"use strict";var r=e("./input-classes.js"),a=e("./base/option-classes.js"),s=a.RangeInput,i=a.Group,o=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=void 0,p=void 0,c=void 0,h=void 0;"object"==("undefined"==typeof r?"undefined":babelHelpers["typeof"](r))?(u=r.value,p=r.min,c=r.max,h=r.input):u=r;var f=babelHelpers.possibleConstructorReturn(this,e.call(this,n,u,a,s,i,o,l));return f._min=void 0!==p?p:f.availableMin,f._max=void 0!==c?c:f.availableMax,f._input=void 0!==h?h:"constant",f._$range=null,f}return babelHelpers.inherits(t,e),t.prototype.updateInternalVisibility=function(){this._$range&&this._$range.toggle("constant"!=this._input)},t.prototype.exportHelper=function(e,t){return e.min!=e.availableMin&&(t.min=e.min),e.max!=e.availableMax&&(t.max=e.max),"constant"!=e.input&&(t.input=e.input),Object.keys(t).length>0?(e.value!=e.defaultValue&&(t.value=e.value),t):e.value!=e.defaultValue?e.value:null},t.prototype["export"]=function(){return this.exportHelper(this,{})},t.prototype.fixToDefaultHelper=function(e){var t=new Number(e.defaultValue);return t.min=e.availableMin,t.max=e.availableMax,t.input=r.createFromString("constant"),t.availableMin=e.availableMin,t.availableMax=e.availableMax,t.step=e.step,t},t.prototype.fixHelper=function(e){var t=new Number(e.value);return t.min=e.min,t.max=e.max,t.input=r.createFromString(e.input),t.availableMin=e.availableMin,t.availableMax=e.availableMax,t.step=e.step,t},t.prototype.fix=function(){return this.fixHelper(this)},babelHelpers.createClass(t,[{key:"input",get:function(){return this._input},set:function(e){this._input=e,this.updateInternalVisibility(),this.updateCallback()}},{key:"min",get:function(){return this._min},set:function(e){this._min=e,this.updateCallback()}},{key:"max",get:function(){return this._max},set:function(e){this._max=e,this.updateCallback()}},{key:"$range",get:function(){return this._$range},set:function(e){this._$range=e,this.updateInternalVisibility()}}]),t}(s),l=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"step",get:function(){return 1}},{key:"availableInputTypes",get:function(){return["constant","slider","mousemovex","mousemovey"]}}]),t}(o),u=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"availableInputTypes",get:function(){return["constant","slider"]}}]),t}(l),p=function(e){function t(n,r,a,s,i,o,l){babelHelpers.classCallCheck(this,t);var u=void 0,p=void 0,c=void 0,h=void 0;"object"==("undefined"==typeof r?"undefined":babelHelpers["typeof"](r))&&("object"==babelHelpers["typeof"](r.speed)?(u=r.speed.value,p=r.speed.min,c=r.speed.max,h=r.speed.input):u=r.speed);var f=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r,a,s,i,o,l));return f._speedValue=void 0!==u?u:0,f._speedAvailableMin=o[2],f._speedMin=void 0!==p?p:f._speedAvailableMin,f._speedAvailableMax=o[3],f._speedMax=void 0!==c?c:f._speedAvailableMax,f._speedInput=void 0!==h?h:"constant",f._addSpeed=!(0==f._speedValue&&f._speedMin==f._speedAvailableMin&&f._speedMax==f._speedAvailableMax&&"constant"==f._speedInput),f._speed$=null,f._$addSpeed=null,f}return babelHelpers.inherits(t,e),t.prototype.updateInternalVisibility=function(){e.prototype.updateInternalVisibility.call(this);var t=["gamepad0","gamepad1","gamepad2","gamepad3"].indexOf(this._input)<0;this._speed$&&this._speed$.toggle(this._addSpeed&&t),this._$addSpeed&&this._$addSpeed.toggle(t)},t.prototype["export"]=function(){var e=["gamepad0","gamepad1","gamepad2","gamepad3"].indexOf(this.input)<0,t={},n=null;return e&&this.addSpeed&&(n=this.exportHelper(this.speed,{})),null!==n&&(t.speed=n),this.exportHelper(this,t)},t.prototype.fix=function(){var e=["gamepad0","gamepad1","gamepad2","gamepad3"].indexOf(this.input)<0,t=this.fixHelper(this);return e&&this.addSpeed?t.speed=this.fixHelper(this.speed):t.speed=this.fixToDefaultHelper(this.speed),t},babelHelpers.createClass(t,[{key:"addSpeed",get:function(){return this._addSpeed},set:function(e){this._addSpeed=e,this.updateInternalVisibility(),this.updateCallback()}},{key:"step",get:function(){return this.availableMax>=100?"0.1":this.availableMax>=10?"0.01":"0.001"}},{key:"availableInputTypes",get:function(){return["constant","slider","mousemovex","mousemovey","gamepad0","gamepad1","gamepad2","gamepad3"]}},{key:"speed",get:function(){var e=this;return{get fullName(){return e.fullName+".speed"},get defaultValue(){return 0},get value(){return e._speedValue},set value(t){e._speedValue=t,e.updateCallback()},get input(){return e._speedInput},set input(t){e._speedInput=t,e.updateCallback()},get availableMin(){return e._speedAvailableMin},get availableMax(){return e._speedAvailableMax},get min(){return e._speedMin},set min(t){e._speedMin=t,e.updateCallback()},get max(){return e._speedMax},set max(t){e._speedMax=t,e.updateCallback()},get step(){return e.step},get availableInputTypes(){return e.availableInputTypes},get $(){return e._speed$},set $(t){e._speed$=t,e.updateInternalVisibility()}}}},{key:"$addSpeed",get:function(){return this._$addSpeed},set:function(e){this._$addSpeed=e,this.updateInternalVisibility()}}]),t}(o),c=function(e){function t(n,r,a,s,i,o){babelHelpers.classCallCheck(this,t);var l="rgba";return babelHelpers.possibleConstructorReturn(this,e.call(this,n,void 0,a,s,i,o.map(function(e,t){var n=l.charAt(t),a=void 0;return"object"==("undefined"==typeof r?"undefined":babelHelpers["typeof"](r))&&(a=r[n]),new p(n,a,function(){return!0},s,i+"."+n,[0,1,-1,1],e)})))}return babelHelpers.inherits(t,e),t}(i);t.exports={};for(var h in a)t.exports[h]=a[h];t.exports.LiveNumber=o,t.exports.LiveInt=l,t.exports.CanvasLiveInt=u,t.exports.LiveFloat=p,t.exports.LiveColor=c},{"./base/option-classes.js":2,"./input-classes.js":14}],21:[function(e,t,n){"use strict";var r=e("./base/options.js"),a=function(t){function n(){return babelHelpers.classCallCheck(this,n),babelHelpers.possibleConstructorReturn(this,t.apply(this,arguments))}return babelHelpers.inherits(n,t),babelHelpers.createClass(n,[{key:"optionClasses",get:function(){return e("./option-classes.js")}},{key:"entriesDescription",get:function(){return[["Group","canvas",[["CanvasLiveInt","width",[1,1024],512],["CanvasLiveInt","height",[1,1024],512]]],["Group","background",[["Select","type",["none","solid"]],["LiveColor","color",[1,1,1,1],{"background.type":"solid"}]]],["Group","material",[["Select","scope",["global","vertex","face"]],["Select","data",["one","sda"]],["LiveColor","color",[1,0,0,1],{"material.scope":"global","material.data":"one"}],["LiveColor","specularColor",[.4,.4,.4],{"material.scope":"global","material.data":"sda"}],["LiveColor","diffuseColor",[.4,.4,.4],{"material.scope":"global","material.data":"sda"}],["LiveColor","ambientColor",[.2,.2,.2],{"material.scope":"global","material.data":"sda"}]]],["Group","light",[["Select","type",["off","phong","blinn"]],["Group","direction",[["LiveFloat","x",[-4,4,-4,4],-1],["LiveFloat","y",[-4,4,-4,4],1],["LiveFloat","z",[-4,4,-4,4],1]],{"light.type":["phong","blinn"]}]]],["Group","shape",[["Select","type",["square","triangle","gasket","cube","hat","terrain"]],["Select","elements",["0","8","16","32"]],["LiveInt","lod",[0,10],6,{"shape.type":["gasket","hat","terrain"]}]]],["Group","transforms",[["Select","projection",["ortho","perspective"]],["Array","model",[["LiveFloat","rotate.x",[-180,180,-360,360],0],["LiveFloat","rotate.y",[-180,180,-360,360],0],["LiveFloat","rotate.z",[-180,180,-360,360],0]]]]],["Group","debug",[["Checkbox","shaders",!0],["Checkbox","arrays"],["Checkbox","inputs"],["Checkbox","animations"]]],["Group","formatting",[["Select","indent",["tab","2","4","8"]]]]]}}]),n}(r);t.exports=a},{"./base/options.js":3,"./option-classes.js":20}],22:[function(e,t,n){"use strict";n.Square=e("./shapes/square.js"),n.Triangle=e("./shapes/triangle.js"),n.Gasket=e("./shapes/gasket.js"),n.Cube=e("./shapes/cube.js"),n.Hat=e("./shapes/hat.js"),n.Terrain=e("./shapes/terrain.js")},{"./shapes/cube.js":23,"./shapes/gasket.js":24,"./shapes/hat.js":25,"./shapes/square.js":29,"./shapes/terrain.js":30,"./shapes/triangle.js":31}],23:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("../colorgen.js"),s=e("./shape.js"),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.writeArrays=function(){for(var e=this,t=new a(this.colorAttrs,0,this.hasColorsPerFace?void 0:[[0,0,0],[1,0,0],[0,1,0],[1,1,0],[0,0,1],[1,0,1],[0,1,1],[1,1,1]]),n=8,s=[],i=0;n>i;i++)s.push(t.getNextColorString());var o=["-0.5,-0.5,-0.5,","+0.5,-0.5,-0.5,","-0.5,+0.5,-0.5,","+0.5,+0.5,-0.5,","-0.5,-0.5,+0.5,","+0.5,-0.5,+0.5,","-0.5,+0.5,+0.5,","+0.5,+0.5,+0.5,"],l=6,u=["left","right","bottom","top","back","front"],p=["-1.0, 0.0, 0.0,","+1.0, 0.0, 0.0,"," 0.0,-1.0, 0.0,"," 0.0,+1.0, 0.0,"," 0.0, 0.0,-1.0,"," 0.0, 0.0,+1.0,"],c=[[4,6,0,2],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[5,7,4,6]],h=[0,1,2,2,1,3],f=new r;f.a("// x    y    z"),this.hasNormals&&f.t("  n.x  n.y  n.z"),f.t(t.getHeaderString());var d=function(t,n,r){f.a(o[n]),e.hasNormals&&f.t(p[t]),e.hasColorsPerVertex?f.t(s[n]):e.hasColorsPerFace&&f.t(s[t]),r&&f.t(" // "+u[t]+" face")};if(!this.usesElements()){for(var m=function(e){h.forEach(function(t,n){d(e,c[e][t],0==n)})},i=0;l>i;i++)m(i);return new r("var nVertices=36;",f.wrap("var vertices=new Float32Array([","]);"))}if(this.hasColorsPerFace||this.hasNormals){for(var v=function(e){c[e].forEach(function(t,n){d(e,t,0==n)})},i=0;l>i;i++)v(i);return new r(f.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;","var elements=new "+this.getElementIndexJsArray()+"([","	 0,  1,  2,  2,  1,  3, // left face","	 4,  5,  6,  6,  5,  7, // right face","	 8,  9, 10, 10,  9, 11, // bottom face","	12, 13, 14, 14, 13, 15, // top face","	16, 17, 18, 18, 17, 19, // back face","	20, 21, 22, 22, 21, 23, // front face","]);")}var g=function(){for(var t=0;n>t;t++)f.a(o[t]),e.hasColorsPerVertex&&f.t(s[t]);for(var a=new r,i=function(e){a.a(""),h.forEach(function(t){a.t(c[e][t]+", ")}),a.t("// "+u[e]+" face")},t=0;l>t;t++)i(t);return{v:new r(f.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;",a.wrap("var elements=new "+e.getElementIndexJsArray()+"([","]);"))}}();return"object"===("undefined"==typeof g?"undefined":babelHelpers["typeof"](g))?g.v:void 0},babelHelpers.createClass(t,[{key:"dim",get:function(){return 3}},{key:"twoSided",get:function(){return!1}}]),t}(s);t.exports=i},{"../colorgen.js":7,"../lines.js":16,"./shape.js":28}],24:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("./lodshape.js"),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.getDistinctVertexCount=function(e){return"(Math.pow(3,"+e+"+1)+3)/2"},t.prototype.getFaceVertexCount=function(e){return"Math.pow(3,"+e+")*3"},t.prototype.getTotalVertexCount=function(e){return"Math.pow(3,"+e+")*3"},t.prototype.writeStoreShape=function(){var e=this,t=function(){var t=new r;return t.a("vertices[nextIndexIntoVertices++]=p[0];","vertices[nextIndexIntoVertices++]=p[1];"),(e.hasColorsPerVertex||e.hasColorsPerFace)&&(!e.usesElements()||e.hasColorsPerFace?t.a("colors[nextIndexIntoColors]"):t.a("colors[nextElement%colors.length]"),t.t(".forEach(function(cc){","	vertices[nextIndexIntoVertices++]=cc;","});")),e.usesElements()?t.a("return nextElement++;"):e.hasColorsPerVertex&&t.a("nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"),t.wrap("function pushVertex(p) {","}")},n=function(){var t=new r;return t.a("if (depth<=0) {"),e.usesElements()?e.hasColorsPerFace?t.a("	pushElement(pushVertex(p0));","	pushElement(pushVertex(p1));","	pushElement(pushVertex(p2));","	nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"):t.a("	if (es[0]===null) es[0]=pushVertex(p0);","	if (es[1]===null) es[1]=pushVertex(p1);","	if (es[2]===null) es[2]=pushVertex(p2);","	pushElement(es[0]);","	pushElement(es[1]);","	pushElement(es[2]);","	return es;"):e.hasColorsPerFace?t.a("	pushVertex(p0);","	pushVertex(p1);","	pushVertex(p2);","	nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"):t.a("	pushVertex(p0);","	pushVertex(p1);","	pushVertex(p2);"),t.a("} else {","	var p01=mix(p0,p1);","	var p12=mix(p1,p2);","	var p20=mix(p2,p0);"),e.usesElements()?e.hasColorsPerFace?t.a("	var es0=triangle(depth-1,p0,p01,p20);","	var es1=triangle(depth-1,p1,p12,p01);","	var es2=triangle(depth-1,p2,p20,p12);"):t.a("	var es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);","	var es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);","	var es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);","	return [es0[0],es1[0],es2[0]];"):t.a("	triangle(depth-1,p0,p01,p20);","	triangle(depth-1,p1,p12,p01);","	triangle(depth-1,p2,p20,p12);"),t.a("}"),!e.usesElements()||e.hasColorsPerFace?t.wrap("function triangle(depth,p0,p1,p2) {","}"):t.wrap("function triangle(depth,p0,p1,p2,es) {","}")},a=function(){var t=new r;return t.a("shapeLod,","[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],","[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],","[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]"),e.usesElements()&&!e.hasColorsPerFace&&t.t(",","[null,null,null]"),t.wrap("triangle(",");")},s=new r;return s.a("var nextIndexIntoVertices=0;"),this.usesElements()&&s.a("var nextIndexIntoElements=0;","var nextElement=0;"),this.hasColorsPerVertex||this.hasColorsPerFace?(s.a("// p = position, cc = color component, e = element, es = elements"),s.a(this.writeColorData()),(!this.usesElements()||this.hasColorsPerFace)&&s.a("var nextIndexIntoColors=0;")):s.a("// p = position, e = element, es = elements"),s.a(t()),this.usesElements()&&s.a("function pushElement(e) {","	elements[nextIndexIntoElements++]=e;","}"),s.a("function mix(pa,pb) {","	return [","		(pa[0]+pb[0])/2,","		(pa[1]+pb[1])/2,","	];","}",n(),a()),s},t}(a);t.exports=s},{"../lines.js":16,"./lodshape.js":26}],25:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("./mesh.js"),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.writeMeshInit=function(){return new r("var xyRange=4;","var xyScale=1/(4*Math.sqrt(2));")},t.prototype.writeMeshVertex=function(){var e=new r,t=0;return e.a("var r2=(x*x+y*y)/2;","var A=Math.exp(-r2)/Math.PI;","var z=A*(1-r2);","vertices[vertexOffset+"+t++ +"]=x*xyScale;","vertices[vertexOffset+"+t++ +"]=y*xyScale;","vertices[vertexOffset+"+t++ +"]=z;"),this.hasNormals&&e.a("var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);","vertices[vertexOffset+"+t++ +"]=normal[0];","vertices[vertexOffset+"+t++ +"]=normal[1];","vertices[vertexOffset+"+t++ +"]=normal[2];"),e.a(this.writeMeshVertexColors(t)),e},t}(a);t.exports=s},{"../lines.js":16,"./mesh.js":27}],26:[function(require,module,exports){"use strict";var fixOptHelp=require("../fixed-options-helpers.js"),Input=require("../input-classes.js"),Lines=require("../lines.js"),Listener=require("../listener-classes.js"),Colorgen=require("../colorgen.js"),Shape=require("./shape.js"),IntFeature=require("../int-feature.js"),LodShape=function(_Shape){function LodShape(e,t,n,r,a){babelHelpers.classCallCheck(this,LodShape);var s=babelHelpers.possibleConstructorReturn(this,_Shape.call(this,e,t,n,r,a));return s.lod=fixOptHelp.capNumber(e.lod,s.getMaxPossibleLod(e.lod.max)),s.features.push(new IntFeature("shape.lod",s.lod)),
s}return babelHelpers.inherits(LodShape,_Shape),LodShape.prototype.getMaxPossibleLod=function getMaxPossibleLod(requestedMaxLod){if(!this.usesElements()||this.elementIndexBits>=31)return requestedMaxLod;for(var nVerticesFn=this.hasColorsPerFace?this.getFaceVertexCount:this.getDistinctVertexCount,indexLimit=1<<this.elementIndexBits,m=requestedMaxLod;m>=0;m--){var n=eval(nVerticesFn(m));if(indexLimit>=n)return m}},LodShape.prototype.writeColorData=function(){for(var e=new Lines,t=new Colorgen(this.colorAttrs,0),n=0;4>n;n++)e.a("["+t.getNextColorString().slice(1,-1)+"],");return e.wrap("var colors=[","];")},LodShape.prototype.writeArraysAndBufferData=function(e){var t=this.hasColorsPerFace?this.getFaceVertexCount:this.getDistinctVertexCount,n=new Lines;return"constant"!=this.lod.input?(n.a("var minShapeLod="+this.lod.min+";","var maxShapeLod="+this.lod.max+";"),this.usesElements()?n.a("var nMaxVertices="+t("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");","var nMaxElements="+this.getTotalVertexCount("maxShapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nMaxElements);",this.writeDebug(e),"var shapeLod,nVertices,nElements;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+t("shapeLod")+";","	nElements="+this.getTotalVertexCount("shapeLod")+";"):n.a("var nMaxVertices="+this.getTotalVertexCount("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"var shapeLod,nVertices;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+this.getTotalVertexCount("shapeLod")+";")):(n.a("var shapeLod="+this.lod+";"),this.usesElements()?n.a("var nVertices="+t("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");","var nElements="+this.getTotalVertexCount("shapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nElements);",this.writeDebug(e),"function storeShape() {"):n.a("var nVertices="+this.getTotalVertexCount("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"function storeShape() {")),n.a(this.writeStoreShape().indent(),this.writeBufferData().indent(),"}"),"constant"!=this.lod.input?n.a("storeShape("+this.lod+");"):n.a("storeShape();"),n},LodShape.prototype.getJsInitLines=function(e){var t=_Shape.prototype.getJsInitLines.call(this,e);if("slider"==this.lod.input){var n=new Listener.Slider("shape.lod");n.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("storeShape(parseInt(this.value));"),t.a(e.getListenerLines(n))}else this.lod.input instanceof Input.MouseMove&&e.canvasMousemoveListener.enter().newVarInt(this.lod.input,"shapeLod").cond("newShapeLod!=shapeLod").log("console.log('shapeLod input value:',newShapeLod);").post("storeShape(newShapeLod);");return t},LodShape}(Shape);module.exports=LodShape},{"../colorgen.js":7,"../fixed-options-helpers.js":10,"../input-classes.js":14,"../int-feature.js":15,"../lines.js":16,"../listener-classes.js":17,"./shape.js":28}],27:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("./lodshape.js"),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.getDistinctVertexCount=function(e){return"Math.pow((1<<"+e+")+1,2)"},t.prototype.getFaceVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*4"},t.prototype.getTotalVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*6"},t.prototype.writeMeshVertexColors=function(e){return this.hasColorsPerVertex||this.hasColorsPerFace?new r(this.usesElements()||this.hasColorsPerFace?"var ic=(i&1)*2+(j&1);":"var ic=((i+di)&1)*2+((j+dj)&1);","colors[ic].forEach(function(cc,icc){","	vertices[vertexOffset+"+e+"+icc]=cc;","});"):new r},t.prototype.writeStoreShape=function(){var e=new r;return e.a("var res=(1<<shapeLod);"),this.usesElements()?this.hasColorsPerFace?e.a("function vertexElement(i,j,k) {","	return (i*res+j)*4+k;","}"):e.a("function vertexElement(i,j) {","	return i*(res+1)+j;","}"):e.a("function vertexElement(i,j,k) {","	return (i*res+j)*6+k;","}"),this.hasNormals&&e.a("function normalize(v) {","	var l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);","	return [v[0]/l,v[1]/l,v[2]/l];","}"),(this.hasColorsPerVertex||this.hasColorsPerFace)&&e.a(this.writeColorData()),e.a(this.writeMeshInit()),this.usesElements()?this.hasColorsPerFace?e.a("var i,j;","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		for (var k=0;k<4;k++) {","			var di=[0,0,1,1][k];","			var dj=[0,1,0,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(3),"		}","	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i,j,0);","		elements[elementOffset+1]=vertexElement(i,j,1);","		elements[elementOffset+2]=vertexElement(i,j,2);","		elements[elementOffset+3]=vertexElement(i,j,2);","		elements[elementOffset+4]=vertexElement(i,j,1);","		elements[elementOffset+5]=vertexElement(i,j,3);","	}","}"):e.a("var i,j;","for (i=0;i<=res;i++) {","	var y=i/res*xyRange*2-xyRange;","	for (j=0;j<=res;j++) {","		var x=j/res*xyRange*2-xyRange;","		var vertexOffset=vertexElement(i,j)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(2),"	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i+0,j+0);","		elements[elementOffset+1]=vertexElement(i+0,j+1);","		elements[elementOffset+2]=vertexElement(i+1,j+0);","		elements[elementOffset+3]=vertexElement(i+1,j+0);","		elements[elementOffset+4]=vertexElement(i+0,j+1);","		elements[elementOffset+5]=vertexElement(i+1,j+1);","	}","}"):e.a("for (var i=0;i<res;i++) {","	for (var j=0;j<res;j++) {","		for (var k=0;k<6;k++) {","			var di=[0,0,1,1,0,1][k];","			var dj=[0,1,0,0,1,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(3),"		}","	}","}"),e},babelHelpers.createClass(t,[{key:"dim",get:function(){return 3}}]),t}(a);t.exports=s},{"../lines.js":16,"./lodshape.js":26}],28:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("../feature.js"),s=function(e){function t(n,r,a,s,i){babelHelpers.classCallCheck(this,t);var o=babelHelpers.possibleConstructorReturn(this,e.call(this));return o.elementIndexBits=parseInt(n.elements),o.hasNormals=r&&3==o.dim,o.hasColorsPerVertex=a,o.hasColorsPerFace=s,o.colorAttrs=i,o}return babelHelpers.inherits(t,e),t.prototype.usesElements=function(){return this.elementIndexBits>0},t.prototype.getNumbersPerVertex=function(){return this.dim+(this.hasNormals?3:0)+3*this.colorAttrs.length},t.prototype.getElementIndexJsArray=function(){return"Uint"+this.elementIndexBits+"Array"},t.prototype.getElementIndexGlType=function(){return 8==this.elementIndexBits?"gl.UNSIGNED_BYTE":16==this.elementIndexBits?"gl.UNSIGNED_SHORT":32==this.elementIndexBits?"gl.UNSIGNED_INT":void 0},t.prototype.writeDebug=function(e){var t=new r;return e&&(t.a("console.log('vertex array byte length:',vertices.byteLength);"),this.usesElements()&&(t.a("console.log('element array byte length:',elements.byteLength);"),t.a("console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);"))),t},t.prototype.writeBufferData=function(){var e=new r;return e.a("gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);"),this.usesElements()&&e.a("gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);"),e},t.prototype.writeArraysAndBufferData=function(e){return new r(this.writeArrays(),this.writeDebug(e),this.writeBufferData())},t.prototype.getJsInitLines=function(t){var n=this,a=e.prototype.getJsInitLines.call(this,t);32==this.elementIndexBits&&a.a("gl.getExtension('OES_element_index_uint');"),this.dim>2&&a.a("gl.enable(gl.DEPTH_TEST);"),a.a("gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());"),this.usesElements()&&a.a("gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());"),a.a(this.writeArraysAndBufferData(t.debugOptions.arrays));var s=function(e){var t=e[0][0],s=e.every(function(e){var n=e[0];return n==t}),i=!0,o=new r;e.forEach(function(e){var t=e[0],n=e[1],r=e[2];r?o.a(s?"'"+n+"',":"["+t+",'"+n+"'],"):(o.a(s?"null,":"["+t+",null],"),o.t(" // attribute "+n+" disabled"),i=!1)});var l=new r("var attrLoc=gl.getAttribLocation(program,attrName);","gl.vertexAttribPointer(","	attrLoc,attrSize,gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*bufferStride,","	Float32Array.BYTES_PER_ELEMENT*bufferOffset",");","gl.enableVertexAttribArray(attrLoc);");i||l.wrap("if (name!==null) {","}");var u=new r;s?u.a("var attrSize="+t+";"):u.a("var attrSize=attr[0];","var attrName=attr[1];"),u.a(l,"bufferOffset+=attrSize;"),a.a("var bufferStride="+n.getNumbersPerVertex()+";","var bufferOffset=0;",o.wrap("[","]")),a.t(u.wrap(".forEach(function("+(s?"attrName":"attr")+"){","});"))};return!this.hasNormals&&this.colorAttrs.length<=0?a.a("var positionLoc=gl.getAttribLocation(program,'position');","gl.vertexAttribPointer(positionLoc,"+this.dim+",gl.FLOAT,false,0,0);","gl.enableVertexAttribArray(positionLoc);"):s([[this.dim,"position",!0]].concat(this.hasNormals?[[3,"normal",!0]]:[],this.colorAttrs.map(function(e){return[3,e.name,e.enabled]}))),a},t.prototype.getJsLoopLines=function(t){var n=e.prototype.getJsLoopLines.call(this,t);return this.usesElements()?n.a("gl.drawElements(gl."+this.glPrimitive+",nElements,"+this.getElementIndexGlType()+",0);"):n.a("gl.drawArrays(gl."+this.glPrimitive+",0,nVertices);"),n},babelHelpers.createClass(t,[{key:"dim",get:function(){return 2}},{key:"twoSided",get:function(){return!0}},{key:"glPrimitive",get:function(){return"TRIANGLES"}}]),t}(a);t.exports=s},{"../feature.js":9,"../lines.js":16}],29:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("../colorgen.js"),s=e("./shape.js"),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.writeArrays=function(){var e=this,t=new a(this.colorAttrs,0),n=void 0,s=function(){return e.hasColorsPerFace&&!e.hasColorsPerVertex?(void 0===n&&(n=t.getNextColorString()),n):t.getNextColorString()},i=new r("var nVertices=4;","var vertices=new Float32Array([","	// x    y"+t.getHeaderString(),"	-0.5,-0.5,"+s(),"	+0.5,-0.5,"+s(),"	+0.5,+0.5,"+s(),"	-0.5,+0.5,"+s(),"]);");return this.usesElements()&&i.a("var nElements=4;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2,3]);"),i},babelHelpers.createClass(t,[{key:"glPrimitive",get:function(){return"TRIANGLE_FAN"}}]),t}(s);t.exports=i},{"../colorgen.js":7,"../lines.js":16,"./shape.js":28}],30:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("./mesh.js"),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.writeMeshInit=function(){var e=this.usesElements()&&!this.hasColorsPerFace,t=new r;return t.a("var xyRange=1/Math.sqrt(2);","var zRange=xyRange;","var mask=res-1;","function zOffset(i,j) {","	return vertexElement(i,j"+(e?"":",0")+")*"+this.getNumbersPerVertex()+"+2;","}","function noise(depth) {","	var r=zRange/Math.pow(2,shapeLod-depth-1);","	return Math.random()*2*r-r;","}","vertices[2]=0.0;","var i0,i1,i2,i3;","var j0,j1,j2,j3;","for (var depth=shapeLod-1;depth>=0;depth--) {","	var d=1<<depth;","	// diamond step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i1=i2-d;","			j1=j2-d;","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j2)]=(","				vertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+","				vertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]","			)/4+noise(depth);","		}","	}","	// square step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i0=(i2-2*d)&mask;","			j0=(j2-2*d)&mask;","			i1=(i2-d);","			j1=(j2-d);","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j1)]=(","				vertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]","			)/4+noise(depth);","			vertices[zOffset(i1,j2)]=(","				vertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]","			)/4+noise(depth);","		}","	}","}"),e&&t.a("for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];","for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];","vertices[zOffset(res,res)]=vertices[zOffset(0,0)];"),t},t.prototype.writeMeshVertex=function(){var e=this.usesElements()&&!this.hasColorsPerFace,t=new r;t.a("vertices[vertexOffset+0]=x;","vertices[vertexOffset+1]=y;",e?"// vertices[vertexOffset+2] already written":"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];");var n=3;return this.hasNormals&&t.a("var d=4*xyRange/res;","var normal=normalize([",e?"	(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,":"	(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,",e?"	(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,":"	(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,","1]);","vertices[vertexOffset+"+n++ +"]=normal[0];","vertices[vertexOffset+"+n++ +"]=normal[1];","vertices[vertexOffset+"+n++ +"]=normal[2];"),t.a(this.writeMeshVertexColors(n)),t},t}(a);t.exports=s},{"../lines.js":16,"./mesh.js":27}],31:[function(e,t,n){"use strict";var r=e("../lines.js"),a=e("../colorgen.js"),s=e("./shape.js"),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,e.apply(this,arguments))}return babelHelpers.inherits(t,e),t.prototype.writeArrays=function(){var e=this,t=new a(this.colorAttrs,0),n=void 0,s=function(){return e.hasColorsPerFace&&!e.hasColorsPerVertex?(void 0===n&&(n=t.getNextColorString()),n):t.getNextColorString()},i=new r("var nVertices=3;","var vertices=new Float32Array([","	//                   x                      y"+t.getHeaderString(),"	-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),"+s(),"	-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),"+s(),"	-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),"+s(),"]);");return this.usesElements()&&i.a("var nElements=3;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2]);"),i},t}(s);t.exports=i},{"../colorgen.js":7,"../lines.js":16,"./shape.js":28}],32:[function(e,t,n){"use strict";var r=e("./options.js"),a=e("./fixed-options-helpers.js"),s=e("./lines.js"),i=e("./feature.js"),o=e("./glsl-vector.js"),l=function(e){function t(n){babelHelpers.classCallCheck(this,t);var s=babelHelpers.possibleConstructorReturn(this,e.call(this));s.options=n,s.rotateVectorEntries=[],s.transformSequence=new Array(n.model.length);var i=["x","y","z"],l=[[],[],[]];n.model.forEach(function(e,t){var n={transform:e.value,index:t};"rotate.x"==e.type?l[0].push(n):"rotate.y"==e.type?l[1].push(n):"rotate.z"==e.type&&l[2].push(n)});for(var u=Math.max.apply(null,l.map(function(e){return e.length})),p=function(e){for(var t=!1,n=!0,p=-1,c=0;3>c;c++){var h=e<l[c].length;if(t){if(h){n=!1;break}}else h?p=c:t=!0}var f=u>1?String(e):"",d=function(t,n){var i=new o("rotate"+(u>1?"."+e:""),a.makeCollection(t,n,r),!0);return i.i18nId="transforms.model.rotate",s.features.push(i),s.rotateVectorEntries.push({vector:i,suffix:f}),i},m=function(t,n){s.transformSequence[l[n][e].index]={vector:t,component:i[n],suffix:f}};if(n)for(var v=d(l.slice(0,p+1).map(function(t){return t[e].transform}),i.slice(0,p+1)),c=0;p>=c;c++)m(v,c);else for(var c=0;3>c;c++){var h=e<l[c].length;if(h){var v=d([l[c][e].transform],i.slice(c,c+1));m(v,c)}}},c=0;u>c;c++)p(c);return s}return babelHelpers.inherits(t,e),t.prototype.use2dTransform=function(e){return e&&1==this.options.model.length&&"rotate.z"==this.options.model[0].type},t.prototype.getTransformMatricesLines=function(e){var t=new s(""),n=1,r=4+n,a=function(e){return e.length<r?("          "+e).slice(-r):e},i=function(n,r){t.t("*mat"+e+"( // "+r),n.forEach(function(n,r){r>=e||(t.a("	"),n.forEach(function(n,s){s>=e||(t.t(a(n)),(e-1>r||e-1>s)&&t.t(","))}))}),t.a(")")};return this.transformSequence.forEach(function(e){if(e){var t=e.vector.getGlslMapComponentValue("c"+e.suffix,e.component),n=e.vector.getGlslMapComponentValue("s"+e.suffix,e.component);"x"==e.component?i([["1.0","0.0","0.0","0.0"],["0.0",t,"-"+n,"0.0"],["0.0",n,t,"0.0"],["0.0","0.0","0.0","1.0"]],"rotate around x axis"):"y"==e.component?i([[t,"0.0",n,"0.0"],["0.0","1.0","0.0","0.0"],["-"+n,"0.0",t,"0.0"],["0.0","0.0","0.0","1.0"]],"rotate around y axis"):"z"==e.component&&i([[t,"-"+n,"0.0","0.0"],[n,t,"0.0","0.0"],["0.0","0.0","1.0","0.0"],["0.0","0.0","0.0","1.0"]],"rotate around z axis")}}),4==e&&"perspective"==this.options.projection&&i([["1.0","0.0","0.0","0.0"],["0.0","1.0","0.0","0.0"],["0.0","0.0","1.0","-(near+far)/2.0"],["0.0","0.0","0.0","1.0"]],"move center of coords inside view"),t},t.prototype.getGlslVertexDeclarationLines=function(e){var t=new s;return this.rotateVectorEntries.forEach(function(e){t.a(e.vector.getGlslDeclarationLines())}),this.use2dTransform(e)?t.a("attribute vec2 position;"):t.a("attribute vec4 position;"),t},t.prototype.getGlslVertexOutputLines=function(e,t,n){var r=new s;return this.rotateVectorEntries.forEach(function(e){r.a(e.vector.getGlslMapDeclarationLines("c"+e.suffix,function(e){return"cos(radians("+e+"))"}),e.vector.getGlslMapDeclarationLines("s"+e.suffix,function(e){return"sin(radians("+e+"))"}))}),"perspective"==this.options.projection&&r.a("float fovy=45.0;","float near=1.0/tan(radians(fovy)/2.0);","float far=near+2.0;"),n?r.a("vec4 transformedPosition="):r.a("gl_Position="),this.use2dTransform(e)?r.t("vec4(position*mat2(","	cz, -sz,","	sz,  cz","),0,1)"):(r.t("position"),r.t(this.getTransformMatricesLines(4))),n&&(r.t(";"),r.a("gl_Position=transformedPosition")),"ortho"==this.options.projection?t?r.t("*vec4(1.0/aspect,1.0,-1.0,1.0)"):e||r.t("*vec4(1.0,1.0,-1.0,1.0)"):"perspective"==this.options.projection&&(t?r.t("*mat4(","	near/aspect, 0.0,  0.0,                   0.0,","	0.0,         near, 0.0,                   0.0,","	0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,         0.0,  -1.0,                  0.0",")"):r.t("*mat4(","	near, 0.0,  0.0,                   0.0,","	0.0,  near, 0.0,                   0.0,","	0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,  0.0,  -1.0,                  0.0",")")),r.t(";"),r},t.prototype.getGlslVertexNormalTransformLines=function(){return this.getTransformMatricesLines(3)},babelHelpers.createClass(t,[{key:"eyeAtInfinity",get:function(){return"ortho"==this.options.projection}}]),t}(i);t.exports=l},{"./feature.js":9,"./fixed-options-helpers.js":10,"./glsl-vector.js":11,"./lines.js":16,"./options.js":21}],33:[function(e,t,n){"use strict";function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e){return e.split(".").map(function(e,t){return t>0?r(e):e}).join("")}var s=function(){function e(t,n,r,a){babelHelpers.classCallCheck(this,e),this.value=t,this.vectorName=n,this.suffix=r,this.wrapMode=!!a}return e.prototype.hasSpeed=function(){return 0!=this.value.speed||"constant"!=this.value.speed.input},e.prototype.hasInput=function(){return"constant"!=this.value.input||"constant"!=this.value.speed.input},e.prototype.hasInputClass=function(e){return this.value.input instanceof e||this.value.speed.input instanceof e},e.prototype.usesStartTime=function(){return"constant"==this.value.input&&0!=this.value.speed&&"constant"==this.value.speed.input},e.prototype.usesPrevTime=function(){return"constant"!=this.value.input&&0!=this.value.speed||"constant"!=this.value.speed.input},babelHelpers.createClass(e,[{key:"name",get:function(){return this.vectorName+"."+this.suffix}},{key:"varName",get:function(){return a(this.name)}},{key:"varNameLoc",get:function(){return this.varName+"Loc"}},{key:"varNameSpeed",get:function(){return this.varName+"Speed"}},{key:"varNameInput",get:function(){return this.varName+"Input"}},{key:"minVarName",get:function(){return a("min."+this.name)}},{key:"maxVarName",get:function(){return a("max."+this.name)}},{key:"variable",get:function(){return"constant"!=this.value.input||this.hasSpeed()}},{key:"wrapReady",get:function(){return this.wrapMode&&this.value.min==this.value.availableMin&&this.value.max==this.value.availableMax&&this.value.min==-this.value.max}},{key:"wrapped",get:function(){return this.hasSpeed()&&this.wrapReady&&"slider"==this.value.input}},{key:"clamped",get:function(){return!this.wrapped&&"constant"!=this.value.speed.input&&!this.wrapReady}},{key:"capped",get:function(){return!this.wrapped&&!this.clamped&&this.hasSpeed()&&!this.wrapReady}}]),e}();t.exports=s},{}],34:[function(e,t,n){"use strict";function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e){return e.split(".").map(function(e,t){return t>0?r(e):e}).join("")}var s=e("./fixed-options-helpers.js"),i=e("./input-classes.js"),o=e("./lines.js"),l=e("./listener-classes.js"),u=e("./vector-component.js"),p=e("./numeric-feature.js"),c=function(e){function t(n,r,a){babelHelpers.classCallCheck(this,t);var s=babelHelpers.possibleConstructorReturn(this,e.call(this));return s.name=n,s.components=[],s.componentsBySuffix={},r.forEach(function(e,t){var r=new u(e,n,t,a);s.components.push(r),s.componentsBySuffix[t]=r}),s.i18nId=n,s.nVars=0,s.modeConstant=!0,s.modeFloats=!1,s.components.forEach(function(e,t){e.variable&&(s.modeConstant=!1,s.nVars++!=t&&(s.modeFloats=!0))}),1==s.nVars&&(s.modeFloats=!0),s.modeVector=!s.modeConstant&&!s.modeFloats,s}return babelHelpers.inherits(t,e),t.prototype.makeInitialComponentValue=function(){return function(e){return"slider"==e.value.input?"parseFloat(document.getElementById('"+e.name+"').value)":s.formatNumber(e.value)}},t.prototype.makeUpdatedComponentValue=function(){return function(e){return 0!=e.value.speed||"constant"!=e.value.speed.input||e.value.input instanceof i.MouseMove||e.value.input instanceof i.Gamepad?e.varName:"slider"==e.value.input?"parseFloat(document.getElementById('"+e.name+"').value)":s.formatNumber(e.value)}},t.prototype.getJsDeclarationLines=function(){return new o},t.prototype.getJsUpdateLines=function(e){return new o},t.prototype.addPostToListenerEntryForComponent=function(e,t){},t.prototype.addPostToListenerEntryAfterComponents=function(e,t){},t.prototype.hasInputs=function(){return e.prototype.hasInputs.call(this)||this.components.some(function(e){return e.hasInput()})},t.prototype.requestFeatureContext=function(t){e.prototype.requestFeatureContext.call(this,t),this.components.forEach(function(e){e.hasInput()&&(t.hasInputs=!0),e.hasInputClass(i.Slider)&&(t.hasSliders=!0),e.hasInputClass(i.Gamepad)&&(t.pollsGamepad=!0),e.usesStartTime()&&(t.hasStartTime=!0),e.usesPrevTime()&&(t.hasPrevTime=!0),e.wrapped&&(t.hasWrapFn=!0),e.clamped&&(t.hasClampFn=!0)})},t.prototype.getHtmlControlMessageLines=function(t){var n=this,r=e.prototype.getHtmlControlMessageLines.call(this,t);return this.components.forEach(function(e){r.a(n.getHtmlControlMessageForValue(t,e.value,n.i18nId+"."+e.suffix),n.getHtmlControlMessageForValue(t,e.value.speed,n.i18nId+"."+e.suffix+".speed"))}),r},t.prototype.getHtmlInputLines=function(t){var n=this,r=e.prototype.getHtmlInputLines.call(this,t),a=function(e,n,a){if("slider"==e.input){var i=s.makeFormatNumber(e);r.a("<div>","	<label for='"+a+"'>"+t(n)+":</label>","	<span class='min'>"+t(n+".value",e.min)+"</span>","	<input type='range' id='"+a+"' min='"+i(e.min)+"' max='"+i(e.max)+"' value='"+i(e)+"' step='any' />","	<span class='max'>"+t(n+".value",e.max)+"</span>","</div>")}};return this.components.forEach(function(e){a(e.value,"options."+n.i18nId+"."+e.suffix,e.name),a(e.value.speed,"options."+n.i18nId+"."+e.suffix+".speed",e.name+".speed")}),r},t.prototype.getJsInitLines=function(t){var n=this,r=function(e){var r=function(){var r=new o,a=function(a,s){if("slider"==a.input){var i=new l.Slider(s),o=i.enter();o.log("console.log(this.id,'input value:',parseFloat(this.value));"),e&&o.post(n.updateFnName+"();"),r.a(t.getListenerLines(i))}};return n.components.forEach(function(e){a(e.value,e.name),a(e.value.speed,e.name+".speed")}),r},a=function(){var r=new l.MultipleSlider('[id^="'+n.name+'."]'),a=r.enter();return a.log("console.log(this.id,'input value:',parseFloat(this.value));"),e&&a.post(n.updateFnName+"();"),new o(t.getListenerLines(r))},s=r(),i=a();return s.data.length<=i.data.length?s:i},a=e.prototype.getJsInitLines.call(this,t);if(a.a(this.getJsDeclarationLines()),this.modeConstant)return a.a(this.getJsUpdateLines(this.makeInitialComponentValue())),a;var u=this.components.some(function(e){return e.hasSpeed()}),p=this.components.some(function(e){return"slider"==e.value.input}),c=this.components.some(function(e){return e.hasInputClass(i.Gamepad)});return this.components.forEach(function(e){(e.value.input instanceof i.MouseMove&&(p||u||c)||"constant"!=e.value.speed.input&&"slider"!=e.value.input)&&a.a("var "+e.varName+"="+s.formatNumber(e.value)+";"),e.value.speed.input instanceof i.MouseMove&&a.a("var "+e.varNameSpeed+"="+s.formatNumber(e.value.speed)+";")}),u||!p||c||a.a(this.getJsUpdateLines(this.makeUpdatedComponentValue()).wrap("function "+this.updateFnName+"() {","}"),this.updateFnName+"();"),a.a(r(!u&&!c)),this.components.some(function(e){return e.value.input instanceof i.MouseMove})&&!function(){u||p||c||a.a(n.getJsUpdateLines(n.makeInitialComponentValue()));var e=t.canvasMousemoveListener.enter();n.components.forEach(function(t){if(t.value.input instanceof i.MouseMove){var r=s.makeFormatNumber(t.value);(u||p||c?e.minMaxFloat:e.minMaxVarFloat)(t.value.input,t.varName,r(t.value.min),r(t.value.max)),e.log("console.log('"+t.name+" input value:',"+t.varName+");"),u||p||c||n.addPostToListenerEntryForComponent(e,t)}}),u||c||(p?e.post(n.updateFnName+"();"):n.addPostToListenerEntryAfterComponents(e,n.makeUpdatedComponentValue()))}(),this.components.some(function(e){return e.value.speed.input instanceof i.MouseMove})&&!function(){var e=t.canvasMousemoveListener.enter();n.components.forEach(function(t){var n=s.makeFormatNumber(t.value.speed);t.value.speed.input instanceof i.MouseMove&&e.minMaxFloat(t.value.speed.input,t.varNameSpeed,n(t.value.speed.min),n(t.value.speed.max)).log("console.log('"+t.name+".speed input value:',"+t.varNameSpeed+");")})}(),a},t.prototype.getJsLoopLines=function(t){var n=e.prototype.getJsLoopLines.call(this,t),r=function(e){var t=e.charAt(0);return"-"==t||"+"==t?e:"+"+e},a=!1,o=function(e,r,o,l){if(r.input instanceof i.Gamepad){a=!0;var u=s.makeFormatNumber(r);n.a("var "+e.minVarName+l+"="+u(r.min)+";","var "+e.maxVarName+l+"="+u(r.max)+";","var "+e.varName+l+"="+u(r)+";","if (gamepad && gamepad.axes.length>"+r.input.axis+") {","	"+e.varName+l+"="+e.minVarName+l+"+("+e.maxVarName+l+"-"+e.minVarName+l+")*(gamepad.axes["+r.input.axis+"]+1)/2;","}"),t&&t.debugOptions.inputs&&n.a("console.log('"+e.name+o+" input value:',"+e.varName+l+");")}};return this.components.forEach(function(e){var l=e.value;o(e,l,"",""),o(e,l.speed,".speed","Speed"),e.hasSpeed()&&!function(){a=!0;var o=s.makeFormatNumber(l),u=s.makeFormatNumber(l.speed),p=void 0;p="slider"==l.speed.input?"+parseFloat(document.getElementById('"+e.name+".speed').value)":l.speed.input instanceof i.MouseMove||l.speed.input instanceof i.Gamepad?"+"+e.varNameSpeed:r(u(l.speed));var c=function(t,n){return t==e.varName?n.charAt(0)+"="+n.slice(1):"="+t+n};e.wrapped?c=function(e,t){return"=wrap("+e+t+","+o(l.max)+")"}:e.clamped?c=function(e,t){return"=clamp("+e+t+","+o(l.min)+","+o(l.max)+")"}:e.capped&&(c=function(e,t){return"=Math."+(l.speed<0?"max":"min")+"("+e+t+","+o(l.speed<0?l.min:l.max)+")"});var h=function(t,n){return e.varName+c(t,p+"*"+n+"/1000")+";"};"slider"==l.input?n.a("var "+e.varNameInput+"=document.getElementById('"+e.name+"');","var "+h("parseFloat("+e.varNameInput+".value)","(time-prevTime)"),e.varNameInput+".value="+e.varName+";"):l.input instanceof i.MouseMove||"constant"!=l.speed.input?n.a(h(e.varName,"(time-prevTime)")):n.a("var "+h(o(l),"(time-startTime)")),t&&t.debugOptions.animations&&n.a("console.log('"+e.name+" animation value:',"+e.varName+");")}()}),a&&n.a(this.getJsUpdateLines(this.makeUpdatedComponentValue())),n},babelHelpers.createClass(t,[{key:"varName",get:function(){return a(this.name)}},{key:"updateFnName",get:function(){return a("update."+this.name)}}]),t}(p);t.exports=c},{"./fixed-options-helpers.js":10,"./input-classes.js":14,"./lines.js":16,"./listener-classes.js":17,"./numeric-feature.js":19,"./vector-component.js":33}]},{},[18])}();
//# sourceMappingURL=webgl-starter.js.map