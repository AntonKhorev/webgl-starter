!function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){var r=e("./lines.js"),o=e("./vector.js"),a=function(e,t,n,r,a,i){o.call(this,e,t,n,r),this.calledFn=a,this.calledFnDefaultArgs=i};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.getJsInitLines=function(){return this.nSliders>0||this.values.every(function(e,t){return e==this.calledFnDefaultArgs[t]},this)?new r:new r(this.calledFn+"("+this.values.map(this.formatValue).join(",")+");")},a.prototype.writeJsInterfaceGlslLines=function(){return new r},a.prototype.writeJsInterfaceUpdateFnLines=function(){var e=new r;if(this.nSliders<=1)e.a(this.calledFn+"("+this.components.map(this.componentValue,this).join(",")+");");else if(this.nSliders==this.components.length){var t=this.calledFn,n=t.lastIndexOf(".");n>=0&&(t=t.slice(0,n)),e.a(this.calledFn+".apply("+t+",["+this.components.map(function(e){return"'"+e+"'"}).join(",")+"].map(function(c){","	return parseFloat(document.getElementById('"+this.optName+".'+c).value);","}));")}else e.a(this.calledFn+"("),this.components.forEach(function(t,n){n>0&&e.t(","),e.a("	"+this.componentValue(t,n))},this),e.a(");");return e},a.prototype.addPostToEntryForComponent=function(e,t){},a.prototype.addPostToEntryAfterComponents=function(e){0==this.nSliders?e.post(this.calledFn+"("+this.components.map(this.componentValue,this).join(",")+");"):e.post(this.updateFnName()+"();")},t.exports=a},{"./lines.js":7,"./vector.js":21}],2:[function(e,t,n){var r=e("./lines.js"),o=e("./listeners.js"),a=e("./shapes.js"),i=e("./call-vector.js"),s=(e("./glsl-vector.js"),e("./illumination.js"));t.exports=function(e,t){function n(t){return parseInt(e[t])}function l(t){return e[t].toFixed(3)}function p(t){return["mousemovex","mousemovey"].indexOf(e[t+".input"])>=0}function c(){var t=e.shape.charAt(0).toUpperCase()+e.shape.slice(1),r=void 0;return void 0!==e.shapeLod&&(r={value:n("shapeLod"),changes:"constant"!=e["shapeLod.input"],min:n("shapeLod.min"),max:n("shapeLod.max")}),new a[t](parseInt(e.elements),"off"!=e.light,"vertex"==e.materialScope,"face"==e.materialScope,b.getColorAttrs(),r)}function u(){var t=new r;return e.hasSliderInputs()&&t.a("label {","	display: inline-block;","	width: 15em;","	text-align: right;","}",".min {","	display: inline-block;","	width: 3em;","	text-align: right;","}",".max {","	display: inline-block;","	width: 3em;","	text-align: left;","}"),t.wrapIfNotEmpty("<style>","</style>")}function h(){function t(){var t=new r;["x","y","z"].forEach(function(n){var r=n.toUpperCase(),o="rotate."+n,a="rotate"+r;e.needsTransform(o)&&(e.needsUniform("rotate."+n)?t.a("float c"+n+"=cos(radians("+a+"));","float s"+n+"=sin(radians("+a+"));"):t.a("float c"+n+"=cos(radians("+l(o)+"));","float s"+n+"=sin(radians("+l(o)+"));"))}),i&&t.a("float aspect="+n("canvas.width")+".0/"+n("canvas.height")+".0;"),"perspective"==e.projection&&t.a("float fovy=45.0;","float near=1.0/tan(radians(fovy)/2.0);","float far=near+2.0;"),p?t.a("vec4 transformedPosition="):t.a("gl_Position="),o?t.t("vec4(position*mat2(","	cz, -sz,","	sz,  cz","),0,1)"):(t.t("position"),e.transformOrder.forEach(function(n){e.needsTransform(n)&&t.t({"rotate.x":["*mat4(","	1.0, 0.0, 0.0, 0.0,","	0.0,  cx, -sx, 0.0,","	0.0,  sx,  cx, 0.0,","	0.0, 0.0, 0.0, 1.0",")"],"rotate.y":["*mat4(","	 cy, 0.0,  sy, 0.0,","	0.0, 1.0, 0.0, 0.0,","	-sy, 0.0,  cy, 0.0,","	0.0, 0.0, 0.0, 1.0",")"],"rotate.z":["*mat4(","	 cz, -sz, 0.0, 0.0,","	 sz,  cz, 0.0, 0.0,","	0.0, 0.0, 1.0, 0.0,","	0.0, 0.0, 0.0, 1.0",")"]}[n])}),"perspective"==e.projection&&t.t("*mat4( // move center of coords inside view","	1.0, 0.0, 0.0, 0.0,","	0.0, 1.0, 0.0, 0.0,","	0.0, 0.0, 1.0, -(near+far)/2.0,","	0.0, 0.0, 0.0, 1.0",")")),p&&(t.t(";"),t.a("gl_Position=transformedPosition")),"ortho"==e.projection?a||i?t.t("*vec4(1.0/aspect,1.0,-1.0,1.0)"):w.dim>2&&t.t("*vec4(1.0,1.0,-1.0,1.0)"):"perspective"==e.projection&&(a||i?t.t("*mat4(","	near/aspect, 0.0,  0.0,                   0.0,","	0.0,         near, 0.0,                   0.0,","	0.0,         0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,         0.0,  -1.0,                  0.0",")"):t.t("*mat4(","	near, 0.0,  0.0,                   0.0,","	0.0,  near, 0.0,                   0.0,","	0.0,  0.0,  (near+far)/(near-far), 2.0*near*far/(near-far),","	0.0,  0.0,  -1.0,                  0.0",")")),t.t(";");var c=function(){var t=new r("");return e.transformOrder.forEach(function(n){e.needsTransform(n)&&t.t({"rotate.x":["*mat3(","	1.0, 0.0, 0.0,","	0.0,  cx, -sx,","	0.0,  sx,  cx",")"],"rotate.y":["*mat3(","	 cy, 0.0,  sy,","	0.0, 1.0, 0.0,","	-sy, 0.0,  cy",")"],"rotate.z":["*mat3(","	 cz, -sz, 0.0,","	 sz,  cz, 0.0,","	0.0, 0.0, 1.0",")"]}[n])}),t};return t.a(b.getGlslVertexOutputLines(s,w.hasNormals,c())),t}var o=2==w.dim&&!e.needsTransform("rotate.x")&&!e.needsTransform("rotate.y")&&e.needsTransform("rotate.z"),a=e.hasInputsFor("canvas"),i=!a&&e["canvas.width"]!=e["canvas.height"],s="ortho"==e.projection,p=b.wantsTransformedPosition(s),c=new r;return a&&c.a("uniform float aspect;"),["x","y","z"].forEach(function(t){var n=t.toUpperCase(),r="rotate."+t,o="rotate"+n;e.needsUniform(r)&&c.a("uniform float "+o+";")}),o?c.a("attribute vec2 position;"):c.a("attribute vec4 position;"),c.a(b.getGlslVertexDeclarationLines(s,w.dim>2),"void main() {",t().indent(),"}"),c}function m(){var t=new r,n="ortho"==e.projection;return t.a("precision mediump float;"),t.a(b.getGlslFragmentDeclarationLines(n),b.getGlslFragmentOutputLines(n,w.twoSided).wrap("void main() {","}")),t}function f(){function n(n){n.filter(function(e){return p(e.name)}).forEach(function(n){o.a("<li>"+t("controls.type."+e[n.name+".input"])+" "+t("controls.to")+" <strong>"+t("options."+n.name)+"</strong></li>")})}var o=new r;return n(e.inputOptions),n(e.transformOptions),o.wrapIfNotEmpty("<ul>","</ul>")}function d(){function o(r){r.filter(function(t){return"slider"==e[t.name+".input"]}).forEach(function(r){a.a("<div>","	<label for='"+r.name+"'>"+t("options."+r.name)+":</label>"),"shapeLod"!=r.name?(a.a("	<span class='min'>"+r.getMinLabel(e[r.name+".min"])+"</span> "),1==r.getStep()?a.t("<input type='range' id='"+r.name+"' min='"+n(r.name+".min")+"' max='"+n(r.name+".max")+"' value='"+n(r.name)+"' />"):a.t("<input type='range' id='"+r.name+"' min='"+l(r.name+".min")+"' max='"+l(r.name+".max")+"' step='"+r.getStep()+"' value='"+l(r.name)+"' />"),a.t(" <span class='max'>"+r.getMaxLabel(e[r.name+".max"])+"</span>")):(a.a("	<span class='min'>"+r.getMinLabel(w.lod.min)+"</span> "),a.t("<input type='range' id='"+r.name+"' min='"+w.lod.min+"' max='"+w.lod.max+"' value='"+w.lod.value+"' />"),a.t(" <span class='max'>"+r.getMaxLabel(w.lod.max)+"</span>")),a.t("</div>")})}var a=new r;return o(e.inputOptions),o(e.transformOptions),a}function v(){var t=new r;return t.a("var vertexShader=gl.createShader(gl.VERTEX_SHADER);","gl.shaderSource(vertexShader,vertexShaderSrc);","gl.compileShader(vertexShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vertexShader));"),t.a("var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);","gl.shaderSource(fragmentShader,fragmentShaderSrc);","gl.compileShader(fragmentShader);"),e.debugShaders&&t.a("if (!gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fragmentShader));"),t.a("var program=gl.createProgram();","gl.attachShader(program,vertexShader);","gl.attachShader(program,fragmentShader);","gl.linkProgram(program);","return program;"),t.wrap("function makeProgram(vertexShaderSrc,fragmentShaderSrc) {","}")}function g(){var t=new r;return t.a("var canvas=document.getElementById('myCanvas');","var gl=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');"),"32"==e.elements&&t.a("gl.getExtension('OES_element_index_uint');"),"solid"==e.background&&t.a(C.getJsInitLines()),w.dim>2&&t.a("gl.enable(gl.DEPTH_TEST);"),t.a("var program=makeProgram(","	document.getElementById('myVertexShader').text,","	document.getElementById('myFragmentShader').text",");","gl.useProgram(program);"),t}function y(){function t(e){s.a(e.write.apply(e,i))}function n(){s.a("function updateAspect() {","	gl.viewport(0,0,canvas.width,canvas.height);","	gl.uniform1f(aspectLoc,canvas.width/canvas.height);","}","updateAspect();")}function a(n){var r="canvas."+n;if("slider"==e[r+".input"]){var a=new o.SliderListener(r);a.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("canvas."+n+"=parseInt(this.value);").post("updateAspect();"),t(a)}}var i=[!e.isAnimated(),e.debugInputs],s=new r,c=new o.CanvasMousemoveListener;if(e.hasInputsFor("canvas")&&(s.a("var aspectLoc=gl.getUniformLocation(program,'aspect');"),n(),a("width"),a("height")),"solid"==e.background&&s.a(C.getJsInterfaceLines(i,c)),s.a(b.getJsInterfaceLines(i,c)),"slider"==e["shapeLod.input"]){var u=new o.SliderListener("shapeLod");u.enter().log("console.log(this.id,'input value:',parseInt(this.value));").post("storeShape(parseInt(this.value));"),t(u)}else p("shapeLod")&&c.enter().newVarInt(e["shapeLod.input"],"shapeLod").cond("newShapeLod!=shapeLod").log("console.log('shapeLod input value:',newShapeLod);").post("storeShape(newShapeLod);");return["x","y","z"].forEach(function(n){var r=n.toUpperCase(),a="rotate."+n,i="rotate"+r,u="updateRotate"+r;if("slider"==e[a+".input"]){var h=new o.SliderListener(a),m=h.enter().log("console.log(this.id,'input value:',parseFloat(this.value));");0==e[a+".speed"]&&"constant"==e[a+".speed.input"]&&(s.a("var "+i+"Loc=gl.getUniformLocation(program,'"+i+"');","function "+u+"() {","	gl.uniform1f("+i+"Loc,parseFloat(document.getElementById('"+a+"').value));","};",u+"();"),m.post(u+"();")),t(h)}else p(a)&&(0==e[a+".speed"]&&"constant"==e[a+".speed.input"]?(s.a("var "+i+"Loc=gl.getUniformLocation(program,'"+i+"');","gl.uniform1f("+i+"Loc,"+l(a)+");"),c.enter().minMaxVarFloat(e[a+".input"],i,"-180","+180").log("console.log('"+a+" input value:',"+i+");").post("gl.uniform1f("+i+"Loc,"+i+");")):c.enter().state("var "+i+"="+l(a)+";").minMaxFloat(e[a+".input"],i,"-180","+180").log("console.log('"+a+" input value:',"+i+");"));if("slider"==e[a+".speed.input"]){var h=new o.SliderListener(a+".speed");h.enter().log("console.log(this.id,'input value:',parseFloat(this.value));"),t(h)}else p(a+".speed")&&c.enter().state("var "+i+"Speed="+l(a+".speed")+";").minMaxFloat(e[a+".speed.input"],i+"Speed","-360","+360").log("console.log('"+a+".speed input value:',"+i+"Speed);")}),t(c),s}function x(){function t(){function t(){var t=new r;return["x","y","z"].forEach(function(r){var i=r.toUpperCase(),s="rotate."+r,p="rotate"+i;(0!=e[s+".speed"]||"constant"!=e[s+".speed.input"])&&("constant"==e[s+".speed.input"]&&"constant"==e[s+".input"]?(n=!0,t.a("var "+p+"="+(e[s]?l(s)+"+":"")+l(s+".speed")+"*(time-startTime)/1000;")):(o=!0,"slider"==e[s+".input"]&&t.a("var "+p+"Input=document.getElementById('"+s+"');","var "+p+"=parseFloat("+p+"Input.value);"),"slider"==e[s+".speed.input"]&&t.a("var "+p+"SpeedInput=document.getElementById('"+s+".speed');","var "+p+"Speed=parseFloat("+p+"SpeedInput.value);"),t.a(p+"+="+("constant"==e[s+".speed.input"]?l(s+".speed"):p+"Speed")+"*(time-prevTime)/1000;"),"slider"==e[s+".input"]&&(a=!0,t.a(p+"=wrap("+p+",180);",p+"Input.value="+p+";"))),t.a("gl.uniform1f("+p+"Loc,"+p+");"))}),t}var a=!1,i=t(),s=new r;return a&&s.a("function wrap(v,maxAbsV) {","	v%=maxAbsV*2;","	if (Math.abs(v)<=maxAbsV) return v;","	return v-(v>0?1:-1)*maxAbsV*2;","}"),"solid"==e.background&&s.a("gl.clear(gl.COLOR_BUFFER_BIT);"),s.a(i,w.writeDraw()),s}var n=!1,o=!1,a=new r,i=t();return e.isAnimated()&&(["x","y","z"].forEach(function(t){var n=t.toUpperCase(),r="rotate."+t,o="rotate"+n;e.needsUniform(r)&&("slider"!=e[r+".input"]&&!p(r)||0!=e[r+".speed"]||"constant"!=e[r+".speed.input"])&&a.a("var "+o+"Loc=gl.getUniformLocation(program,'"+o+"');"),"constant"!=e[r+".speed.input"]&&"constant"==e[r+".input"]&&a.a("var "+o+"="+l(r)+";")}),n&&o?a.a("var startTime=performance.now();","var prevTime=startTime;"):n?a.a("var startTime=performance.now();"):o&&a.a("var prevTime=performance.now();")),e.isAnimated()?(a.a("function renderFrame(time) {",i.indent()),o&&a.a("	prevTime=time;"),a.a("	requestAnimationFrame(renderFrame);","}","requestAnimationFrame(renderFrame);")):e.hasInputs()?a.a("var frameId=null;","function renderFrame() {",i.indent(),"	frameId=null;","}","function scheduleFrame() {","	if (frameId===null) {","		frameId=requestAnimationFrame(renderFrame);","	}","}","scheduleFrame();"):a.a(i),a}var b=new s(e),w=c();if("solid"==e.background)var C=new i("backgroundColor","backgroundColor","rgba",e,"gl.clearColor",[0,0,0,0]);var j=new r;j.interleave(v(),g(),w.writeInit(e.debugArrays),y(),x()).wrap("<script>","</script>");var S=new r;return S.a("<!DOCTYPE html>","<html lang='en'>","<head>","<meta charset='utf-8' />","<title>Generated code</title>",u(),"<script id='myVertexShader' type='x-shader/x-vertex'>",h().indent(),"</script>","<script id='myFragmentShader' type='x-shader/x-fragment'>",m().indent(),"</script>","</head>","<body>","<div>","	<canvas id='myCanvas' width='"+n("canvas.width")+"' height='"+n("canvas.height")+"'></canvas>","</div>",f(),d(),j,"</body>","</html>"),S.join("tab"==e.indent?"	":Array(parseInt(e.indent)+1).join(" "))}},{"./call-vector.js":1,"./glsl-vector.js":4,"./illumination.js":6,"./lines.js":7,"./listeners.js":8,"./shapes.js":11}],3:[function(e,t,n){var r=0,o=function(e,t,n){this.weight=e,this.noise=t,void 0===t&&(this.noise=.4),this.baseColors=n||this.defaultBaseColors,this.colorgenNumber=r++,this.nextIndex=0};o.prototype.defaultBaseColors=[[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1]],o.prototype.getNextColorString=function(){var e=this.baseColors[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.baseColors.length,e.map(function(e,t){var n=Math.sin(9e3*this.colorgenNumber+400*this.nextIndex+100*t),r=(e*(1-this.noise)+n*n*this.noise)*this.weight;return" "+r.toFixed(1)+","},this).join("")};var a=function(e,t,n){this.colorAttrs=e,this.singleColorgens=this.colorAttrs.map(function(e){return new o(e.weight,t,n)})};a.prototype.getHeaderString=function(){return this.colorAttrs.map(function(){return"    r    g    b"}).join("")},a.prototype.getNextColorString=function(){return this.singleColorgens.map(function(e){return e.getNextColorString()}).join("")},t.exports=a},{}],4:[function(e,t,n){var r=e("./lines.js"),o=e("./vector.js"),a=function(e,t,n,r){o.apply(this,arguments)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.getGlslDeclarationLines=function(){if(this.modeConstant)return new r;if(this.modeFloats){var e=new r;return this.components.forEach(function(t,n){"constant"!=this.inputs[n]&&e.a("uniform float "+this.varNameC(t)+";")},this),e}return new r("uniform vec"+this.nVars+" "+this.varName+";")},a.prototype.getGlslValue=function(){var e="vec"+this.values.length;varComponentMap=function(e,t){return"constant"==this.inputs[t]?this.formatValue(this.values[t]):this.varNameC(e)}.bind(this);var t=this.components.map(varComponentMap);if(this.modeConstant){var n=t.every(function(e){return e==t[0]});return n?e+"("+t[0]+")":e+"("+t.join(",")+")"}if(!this.modeFloats){if(t=t.slice(this.nVars),0==t.length)return this.varName;t.unshift(this.varName)}return e+"("+t.join(",")+")"},a.prototype.getGlslComponentsValue=function(e){for(var t=[],n=function(e){return e[0]?this.formatValue(this.values[e[1]]):this.modeVector?this.varName+"."+e[1]:this.varNameC(e[1])}.bind(this),r=function(){if(!t[0][0])return!1;var e=this.formatValue(this.values[t[0][1]]);return t.every(function(t){return t[0]&&this.formatValue(this.values[t[1]])==e},this)}.bind(this),o=0;o<e.length;o++){var a=e.charAt(o),i=this.components.indexOf(a);"constant"==this.inputs[i]?t.push([!0,i]):this.modeVector&&t.length>0?(prevResult=t.pop(),prevResult[0]?t.push(prevResult,[!1,a]):t.push([prevResult[0],prevResult[1]+a])):t.push([!1,a])}return 1==t.length?this.modeVector&&e==this.components.slice(0,this.nVars).join("")?this.varName:n(t[0]):r()?"vec"+e.length+"("+n(t[0])+")":"vec"+e.length+"("+t.map(n).join(",")+")"},a.prototype.writeJsInterfaceGlslLines=function(){return lines=new r,this.modeFloats?this.components.forEach(function(e,t){"constant"!=this.inputs[t]&&lines.a("var "+this.varNameC(e)+"Loc=gl.getUniformLocation(program,'"+this.varNameC(e)+"');")},this):lines.a("var "+this.varName+"Loc=gl.getUniformLocation(program,'"+this.varName+"');"),0==this.nSliders&&this.modeVector?(lines.a("gl.uniform"+this.nVars+"f("+this.varName+"Loc"),this.components.forEach(function(e,t){"constant"!=this.inputs[t]&&lines.t(","+this.formatValue(this.values[t]))},this),lines.t(");")):0==this.nSliders&&this.components.forEach(function(e,t){"constant"!=this.inputs[t]&&lines.a("gl.uniform1f("+this.varNameC(e)+"Loc,"+this.formatValue(this.values[t])+");")},this),lines},a.prototype.writeJsInterfaceUpdateFnLines=function(){var e=new r;return this.modeFloats?this.components.forEach(function(t,n){"constant"!=this.inputs[n]&&e.a("gl.uniform1f("+this.varNameC(t)+"Loc,"+this.componentValue(t,n)+");")},this):(e.a("gl.uniform"+this.nVars+"f("+this.varName+"Loc"),this.components.forEach(function(t,n){"constant"!=this.inputs[n]&&e.t(",","	"+this.componentValue(t,n))},this),e.a(");")),e},a.prototype.addPostToEntryForComponent=function(e,t){0==this.nSliders&&this.modeVector||(0==this.nSliders?e.post("gl.uniform1f("+this.varNameC(t)+"Loc,"+this.varNameC(t)+");"):e.post(this.updateFnName()+"();"))},a.prototype.addPostToEntryAfterComponents=function(e){if(0==this.nSliders&&this.modeVector){var t=[];this.components.forEach(function(e,n){n<this.nVars&&t.push(this.varNameC(e))},this),e.post("gl.uniform"+this.nVars+"f("+this.varName+"Loc,"+t.join(",")+");")}},t.exports=a},{"./lines.js":7,"./vector.js":21}],5:[function(e,t,n){t.exports=function(e){return{"message.hljs":"<a href='https://highlightjs.org/'>highlight.js</a> (hosted on cdnjs.cloudflare.com) is not loaded. Syntax highlighting is disabled.","message.elements":"choosing 8- or 16-bit index may limit available shape detail levels","options.general":"General options","options.background":"Background","options.background.none":"none (transparent)","options.background.solid":"solid color","options.materialScope":"Set material color for objects","options.materialScope.global":"entire scene","options.materialScope.vertex":"shape vertices","options.materialScope.face":"shape faces","options.materialData":"For each object have","options.materialData.one":"one color","options.materialData.sda":"specular/diffuse/ambient colors","options.shape":"Shape to draw","options.shape.square":"square","options.shape.triangle":"triangle","options.shape.gasket":"Sierpinski gasket","options.shape.cube":"cube","options.shape.hat":"Mexican hat function","options.shape.terrain":"diamond-square fractal terrain","options.elements":"Element array","options.elements.0":"not used","options.elements.8":"with 8-bit index","options.elements.16":"with 16-bit index","options.elements.32":"with 32-bit index","options.light":"Light","options.light.off":"off","options.light.phong":"on with Phong reflections","options.light.blinn":"on with Blinn–Phong reflections","options.projection":"Projection","options.projection.ortho":"orthogonal","options.projection.perspective":"perspective","options.input":"Input options","options.canvas.width":"Canvas width","options.canvas.height":"Canvas height","options.backgroundColor.r":"Background color red component","options.backgroundColor.g":"Background color green component","options.backgroundColor.b":"Background color blue component","options.backgroundColor.a":"Background color alpha component","options.materialColor.r":"Material color red component","options.materialColor.g":"Material color green component","options.materialColor.b":"Material color blue component","options.materialColor.a":"Material color alpha component","options.materialSpecularColor.r":"Specular color red component","options.materialSpecularColor.g":"Specular color green component","options.materialSpecularColor.b":"Specular color blue component","options.materialDiffuseColor.r":"Diffuse color red component","options.materialDiffuseColor.g":"Diffuse color green component","options.materialDiffuseColor.b":"Diffuse color blue component","options.materialAmbientColor.r":"Ambient color red component","options.materialAmbientColor.g":"Ambient color green component","options.materialAmbientColor.b":"Ambient color blue component","options.lightDirection.x":"Light direction x component","options.lightDirection.y":"Light direction y component","options.lightDirection.z":"Light direction z component","options.shapeLod":"Shape detail level","options.*.input":"Input method","options.*.input.constant":"none","options.*.input.slider":"slider","options.*.input.mousemovex":"mouse x axis","options.*.input.mousemovey":"mouse y axis","options.*.input.animated":"animated","options.*.range":"with range","options.transform":"Transforms","options.rotate.x":"Angle of rotation around x axis","options.rotate.x.speed":"Speed of rotation around x axis","options.rotate.y":"Angle of rotation around y axis","options.rotate.y.speed":"Speed of rotation around y axis","options.rotate.z":"Angle of rotation around z axis","options.rotate.z.speed":"Speed of rotation around z axis","options.debug":"Debug options","options.debugShaders":"Log shader compilation errors","options.debugArrays":"Log allocated array sizes","options.debugInputs":"Log input values","options.formatting":"Code formatting options","options.indent":"Indent","options.indent.tab":"tab","options.indent.2":"2 spaces","options.indent.4":"4 spaces","options.indent.8":"8 spaces","controls.type.mousemovex":"Move the mouse pointer horizontally over the canvas","controls.type.mousemovey":"Move the mouse pointer vertically over the canvas","controls.to":"to update"}[e]}},{}],6:[function(e,t,n){var r=e("./lines.js"),o=e("./glsl-vector.js"),a=function(e){if(this.options=e,"global"==e.materialScope)if("one"==e.materialData)this.colorVector=new o("color","materialColor","rgba",e);else if("off"!=e.light)this.specularColorVector=new o("specularColor","materialSpecularColor","rgb",e),this.diffuseColorVector=new o("diffuseColor","materialDiffuseColor","rgb",e),this.ambientColorVector=new o("ambientColor","materialAmbientColor","rgb",e);else{var t=function(){["Specular","Diffuse","Ambient"].forEach(function(e){this["material"+e+"Color.a"]=1,this["material"+e+"Color.a.input"]="constant",this["material"+e+"Color.a.min"]=0,this["material"+e+"Color.a.max"]=1},this)};t.prototype=e;var n=new t;this.specularColorVector=new o("specularColor","materialSpecularColor","rgba",n),this.diffuseColorVector=new o("diffuseColor","materialDiffuseColor","rgba",n),this.ambientColorVector=new o("ambientColor","materialAmbientColor","rgba",n)}"off"!=e.light&&(this.lightDirectionVector=new o("lightDirection","lightDirection","xyz",e))};a.prototype.getColorAttrs=function(){var e=this.options;return"global"==e.materialScope?[]:"one"==e.materialData?[{name:"color",enabled:!0,weight:1}]:[{name:"specularColor",enabled:"off"!=e.light,weight:.4},{name:"diffuseColor",enabled:"off"!=e.light,weight:.4},{name:"ambientColor",enabled:!0,weight:.2}]},a.prototype.wantsTransformedPosition=function(e){var t=this.options;return!e&&"off"!=t.light&&"one"!=t.materialData},a.prototype.getGlslVertexDeclarationLines=function(e,t){var n=this.options,o=new r;return this.wantsTransformedPosition(e)&&o.a("varying vec3 interpolatedView;"),"off"!=n.light&&(t&&o.a("attribute vec3 normal;"),o.a("varying vec3 interpolatedNormal;")),"global"!=n.materialScope&&("one"==n.materialData?(o.a("attribute vec4 color;"),o.a("varying vec4 interpolatedColor;")):"off"==n.light?(o.a("attribute vec4 ambientColor;"),o.a("varying vec4 interpolatedColor;")):o.a("attribute vec3 specularColor;","attribute vec3 diffuseColor;","attribute vec3 ambientColor;","varying vec3 interpolatedSpecularColor;","varying vec3 interpolatedDiffuseColor;","varying vec3 interpolatedAmbientColor;")),o},a.prototype.getGlslVertexOutputLines=function(e,t,n){var o=this.options,a=new r;return this.wantsTransformedPosition(e)&&a.a("interpolatedView=-transformedPosition.xyz;"),"off"!=o.light&&(a.a("interpolatedNormal="),t?a.t("normal"):a.t("vec3(0.0,0.0,1.0)"),a.t(n),a.t(";")),"global"!=o.materialScope&&("one"==o.materialData?a.a("interpolatedColor=color;"):"off"==o.light?a.a("interpolatedColor=ambientColor;"):a.a("interpolatedSpecularColor=specularColor;","interpolatedDiffuseColor=diffuseColor;","interpolatedAmbientColor=ambientColor;")),a},a.prototype.getGlslFragmentDeclarationLines=function(e){var t=this.options,n=new r;return this.wantsTransformedPosition(e)&&n.a("varying vec3 interpolatedView;"),"off"!=t.light&&n.a(this.lightDirectionVector.getGlslDeclarationLines(),"varying vec3 interpolatedNormal;"),"global"==t.materialScope?"one"==t.materialData?n.a(this.colorVector.getGlslDeclarationLines()):("off"!=t.light&&(n.a(this.specularColorVector.getGlslDeclarationLines()),n.a(this.diffuseColorVector.getGlslDeclarationLines())),n.a(this.ambientColorVector.getGlslDeclarationLines())):"one"==t.materialData||"off"==t.light?n.a("varying vec4 interpolatedColor;"):n.a("varying vec3 interpolatedSpecularColor;","varying vec3 interpolatedDiffuseColor;","varying vec3 interpolatedAmbientColor;"),n},a.prototype.getGlslFragmentOutputLines=function(e,t){var n,o,a,i=this.options,s=new r;if("global"==i.materialScope){var l="one"==i.materialData?this.colorVector:this.ambientColorVector;n=l.getGlslComponentsValue("rgb"),o=l.getGlslComponentsValue("a"),a=l.getGlslValue()}else n="interpolatedColor.rgb",o="interpolatedColor.a",a="interpolatedColor";if("off"==i.light)s.a("gl_FragColor="+a+";");else if(s.a("vec3 N=normalize(interpolatedNormal);"),t&&s.a("if (!gl_FrontFacing) N=-N;"),s.a("vec3 L=normalize("+this.lightDirectionVector.getGlslValue()+");"),"one"==i.materialData)s.a("gl_FragColor=vec4("+n+"*max(0.0,dot(L,N)),"+o+");");else{this.wantsTransformedPosition(e)?s.a("vec3 V=normalize(interpolatedView);"):s.a("vec3 V=vec3(0.0,0.0,1.0);");var p="H,N",c="";"blinn"==i.light?s.a("vec3 H=normalize(L+V);"):(s.a("vec3 R=reflect(-L,N);"),p="R,V",c="/4.0"),s.a("float shininess=100.0;"),s.a(("global"==i.materialScope?new r("+"+this.specularColorVector.getGlslValue()+"*pow(max(0.0,dot("+p+")),shininess"+c+")","+"+this.diffuseColorVector.getGlslValue()+"*max(0.0,dot(L,N))","+"+this.ambientColorVector.getGlslValue()):new r("+interpolatedSpecularColor*pow(max(0.0,dot("+p+")),shininess"+c+")","+interpolatedDiffuseColor*max(0.0,dot(L,N))","+interpolatedAmbientColor")).wrap("gl_FragColor=vec4(",",1.0);"))}return s},a.prototype.getJsInterfaceLines=function(e,t){var n=this.options,o=new r;return"global"==n.materialScope&&("one"==n.materialData?o.a(this.colorVector.getJsInterfaceLines(e,t)):("off"!=n.light&&(o.a(this.specularColorVector.getJsInterfaceLines(e,t)),o.a(this.diffuseColorVector.getJsInterfaceLines(e,t))),o.a(this.ambientColorVector.getJsInterfaceLines(e,t)))),"off"!=n.light&&o.a(this.lightDirectionVector.getJsInterfaceLines(e,t)),o},t.exports=a},{"./glsl-vector.js":4,"./lines.js":7}],7:[function(e,t,n){var r=function(){this.data=[],this.addFlattenedArgs(this.flattenArgs(arguments))};r.prototype.flattenArgs=function(e){for(var t=[],n=0;n<e.length;n++)"string"==typeof e[n]?t.push(e[n]):Array.isArray(e[n])?Array.prototype.push.apply(t,e[n]):e[n]instanceof r&&Array.prototype.push.apply(t,e[n].data);return t},r.prototype.addFlattenedArgs=function(e){Array.prototype.push.apply(this.data,e)},r.prototype.a=function(){return this.addFlattenedArgs(this.flattenArgs(arguments)),this},r.prototype.t=function(){var e=this.data.pop(),t=this.flattenArgs(arguments);return t[0]=e+t[0],this.addFlattenedArgs(t),this},r.prototype.indent=function(e){return void 0===e&&(e=1),this.data=this.data.map(function(t){return Array(e+1).join("	")+t}),this},r.prototype.isEmpty=function(){return this.data.length<=0},r.prototype.interleave=function(){for(var e=!0,t=0;t<arguments.length;t++){var n=this.flattenArgs([arguments[t]]);n.length>0&&(e?e=!1:this.data.push(""),this.addFlattenedArgs(n))}return this},r.prototype.wrap=function(e,t){return this.indent(),this.data.unshift(e),this.data.push(t),this},r.prototype.wrapIfNotEmpty=function(e,t){return this.isEmpty()||this.wrap(e,t),this},r.prototype.join=function(e){return this.data.map(function(t){return t.replace(/^(\t)+/,function(t){return Array(t.length+1).join(e)})}).join("\n")},t.exports=r},{}],8:[function(e,t,n){var r=e("./lines.js"),o=function(){this.entries=[]};o.prototype.enter=function(){function e(e){return function(){for(var t=0;t<arguments.length;t++)e.push(arguments[t]);return n}}var t={state:[],pre:[],cond:null,log:[],post:[]};this.entries.push(t);var n={state:e(t.state),pre:e(t.pre),cond:function(e){return t.cond=e,n},log:e(t.log),post:e(t.post)};return n},o.prototype.innerPrependedLines=function(){return[]},o.prototype.bracketFnArg=function(){return""},o.prototype.wrapCall=function(e){return e},o.prototype.write=function(e,t){function n(e,t){var n;n=e in s?s[e]:s[e]={prevs:[],conds:[],mark:c},null!==n.conds&&(null===t?n.conds=null:n.conds.push(t)),null!==p&&n.prevs.push(p),p=e}function o(){null!==p&&l.push(p),p=null}function a(){function e(e,t){var n=null;null!==t.conds&&(n=t.conds.join(" || ")),n!=a&&(null!==a&&o.push("}"),a=n,null!==a&&o.push("if ("+a+") {")),null!==a?o.push("	"+e):o.push(e)}function t(t,r){r.mark=u,n(r.prevs),r.mark=h,e(t,r)}function n(e){e.forEach(function(e){s[e].mark==c&&t(e,s[e])})}var o=[],a=null;return n(l),null!==a&&o.push("}"),new r(o)}var i=new r,s={},l=[],p=null,c=0,u=1,h=2;this.entries.forEach(function(r){i.a(r.state),r.pre.forEach(function(e){n(e,null)}),t&&r.log.forEach(function(e){n(e,r.cond)}),r.post.forEach(function(e){n(e,r.cond)}),e&&n("scheduleFrame();",r.cond),o()});var m=this.bracketListener(),f=a();if(f.isEmpty()||(f=new r(this.innerPrependedLines(),f)),1==f.data.length){var d=/^(\w+)\(\);$/.exec(f.data[0]);if(d)return i.a(this.wrapCall(new r(m[0]+d[1]+m[1])))}return f.data.length?i.a(this.wrapCall(f.wrap(m[0]+"function("+this.bracketFnArg()+"){","}"+m[1]))):i};var a=function(e){o.call(this),this.id=e};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.bracketListener=function(){return["document.getElementById('"+this.id+"').addEventListener('change',",");"]};var i=function(e){o.call(this),this.query=e};i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.wrapCall=function(e){return e.wrap("[].forEach.call(document.querySelectorAll('"+this.query+"'),function(el){","});")},i.prototype.bracketListener=function(){return["el.addEventListener('change',",");"]};var s=function(){o.call(this)};s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.enter=function(){function e(e,n,r,o,a,i){var s=o.charAt(0).toUpperCase()+o.slice(1);if(0==a&&1==i)var l=(n?"var ":"")+o+"=";else{t.pre("var min"+s+"="+a+";"),t.pre("var max"+s+"="+i+";");var l=(n?"var ":"")+o+"=min"+s+"+(max"+s+"-min"+s+")*"}return t.prexy(r,l+"(ev.clientX-rect.left)/(rect.width-1);",l+"(rect.bottom-1-ev.clientY)/(rect.height-1);")}var t=o.prototype.enter.call(this);return t.prexy=function(e,n,r){return"mousemovex"==e?t.pre(n):"mousemovey"==e?t.pre(r):t},t.minMaxFloat=function(t,n,r,o){return e(!0,!1,t,n,r,o)},t.minMaxVarFloat=function(t,n,r,o){return e(!0,!0,t,n,r,o)},t.newVarInt=function(e,n){var r=n.charAt(0).toUpperCase()+n.slice(1);return t.prexy(e,"var new"+r+"=Math.floor(min"+r+"+(max"+r+"-min"+r+"+1)*(ev.clientX-rect.left)/rect.width);","var new"+r+"=Math.floor(min"+r+"+(max"+r+"-min"+r+"+1)*(rect.bottom-1-ev.clientY)/rect.height);");
},t},s.prototype.bracketListener=function(){return["canvas.addEventListener('mousemove',",");"]},s.prototype.bracketFnArg=function(){return"ev"},s.prototype.innerPrependedLines=function(){return["var rect=this.getBoundingClientRect();"]},n.SliderListener=a,n.MultipleSliderListener=i,n.CanvasMousemoveListener=s},{"./lines.js":7}],9:[function(e,t,n){function r(){return"webgl-starter-id-"+a++}function o(e){return"data:text/html;charset=utf-8,"+encodeURIComponent(e)}var a=0,i=e("./i18n.js"),s=e("./options.js"),l=e("./code.js");$(function(){$(".webgl-starter").each(function(){function e(e){g.inputOptions.forEach(function(t){t.isVisibilityAffectedBy(e)&&f.find("[data-option='"+t.name+"']").toggle(t.isVisible(g))})}function t(){clearTimeout(y),y=setTimeout(function(){d.text(l(g.fix(),i)),window.hljs&&hljs.highlightBlock(d[0])},x)}function n(n){var o=r(),a=$("<div>").append("<label for='"+o+"'>"+i("options."+n.name)+":</label>").append(" ").append($("<select id='"+o+"'>").append(n.availableValues.map(function(e){return $("<option>").val(e).html(i("options."+n.name+"."+e))})).val(g[n.name]).change(function(){g[n.name]=this.value,e(n),t()}));return"elements"==n.name&&a.append(" "+i("message.elements")),a}function a(e,n){function o(n){this.checkValidity()&&(n.val(this.value),g[e.name]=parseFloat(this.value),t())}function a(n){return $("<input type='number' required>").attr("min",e.getMin()).attr("max",e.getMax()).attr("step",e.getSetupStep()).val(g[e.name+"."+n]).on("input change",function(){this.checkValidity()&&(g[e.name+"."+n]=parseFloat(this.value),t())})}var s,l,p,c,u,h,m=r(),f=r(),d=$("<div data-option='"+e.name+"'>").append("<label for='"+m+"'>"+i("options."+e.name)+":</label>").append(" <span class='min'>"+e.getMinLabel()+"</span> ").append(s=$("<input type='range' id='"+m+"'>").attr("min",e.getMin()).attr("max",e.getMax()).attr("step",e.getSetupStep()).val(g[e.name]).on("input change",function(){o.call(this,l)})).append(" <span class='max'>"+e.getMaxLabel()+"</span> ").append(l=$("<input type='number' required>").attr("min",e.getMin()).attr("max",e.getMax()).attr("step",e.getSetupStep()).val(g[e.name]).on("input change",function(){o.call(this,s)})).append(" ").append("<label for='"+f+"'>"+i("options.*.input")+":</label> ").append(p=$("<select id='"+f+"'>").append(e.availableInputTypes.map(function(e){return $("<option>").val(e).html(i("options.*.input."+e))})).val(g[e.name+".input"]).change(function(){g[e.name+".input"]=this.value,n&&("constant"==this.value?c.hide():c.show()),t()}));return n&&(d.append(" ").append(c=$("<span class='range'>").append(i("options.*.range")+" ").append(u=a("min")).append(" .. ").append(h=a("max"))),"constant"==p.val()&&c.hide()),d.append(" ").append($("<button type='button'>Reset</button>").click(function(){n&&(u.val(e.getMin()),h.val(e.getMax())),s.val(e.defaultValue).change(),p.val("constant").change()})),d}function p(e){var n=r();return $("<div>").append($("<input type='checkbox' id='"+n+"'>").prop("checked",g[e.name]).change(function(){g[e.name]=$(this).prop("checked"),t()})).append(" <label for='"+n+"'>"+i("options."+e.name)+"</label>")}function c(e,t){var n=null;e.children().prepend($("<div draggable='true' tabindex='0' title='Drag or press up/down while in focus to reorder transforms'>").on("dragstart",function(e){n=$(this).parent(),e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("Text",name),e.originalEvent.dataTransfer.setDragImage&&e.originalEvent.dataTransfer.setDragImage(n[0],0,0),setTimeout(function(){n.addClass("ghost")},0)}).keydown(function(e){var n=$(this),r=n.parent();return 38==e.keyCode?(r.prev().before(r),n.focus(),t(),!1):40==e.keyCode?(r.next().after(r),n.focus(),t(),!1):void 0})).on("dragover",function(e){e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move";var r=$(this);n&&(r.nextAll().is(n)?(r.before(n),t()):r.prevAll().is(n)&&(r.after(n),t()))}).on("drop",function(e){e.preventDefault()}).on("dragend",function(e){e.preventDefault(),n&&(n.removeClass("ghost"),n=null)})}function u(){var e,r=$("<div>").append($("<fieldset>").append("<legend>"+i("options.general")+"</legend>").append(g.generalOptions.map(n))).append($("<fieldset>").append("<legend>"+i("options.input")+"</legend>").append(g.inputOptions.map(function(e){return a(e,!0)}))).append($("<fieldset>").append("<legend>"+i("options.transform")+"</legend>").append(e=$("<div>").append(g.transforms.map(function(e){return $("<div class='transform' data-transform='"+e.name+"'>").append(e.options.map(function(e){return a(e,!1)}))})))).append($("<fieldset>").append("<legend>"+i("options.debug")+"</legend>").append(g.debugOptions.map(p))).append($("<fieldset>").append("<legend>"+i("options.formatting")+"</legend>").append(g.formattingOptions.map(n)));return c(e,function(){g.transformOrder=e.children().map(function(){return $(this).attr("data-transform")}).get(),t()}),r}function h(){g.inputOptions.forEach(function(e){f.find("[data-option='"+e.name+"']").toggle(e.isVisible(g))})}function m(){return $("<div>").append($("<a download='source.html'><button type='button'>Save source code</button></a>").click(function(){$(this).attr("href",o(d.text()))})).append(" ").append($("<button type='button'>Run in new window</button>").click(function(){window.open(o(d.text()),"generatedCode")})).append(" these buttons don't work in Internet Explorer, copy-paste the code manually")}var f,d,v=$(this),g=new s,y=null,x=200;v.empty().append(f=u()),h(),v.append(m()).append($("<pre>").append(d=$("<code>").text(l(g.fix(),i)))),window.hljs?hljs.highlightBlock(d[0]):v.append("<p>"+i("message.hljs")+"</p>"),v.append(m())})})},{"./code.js":2,"./i18n.js":5,"./options.js":10}],10:[function(e,t,n){var r=function(e,t,n,r){this.name=e,this.availableValues=t,void 0===n?this.defaultValue=t[0]:this.defaultValue=n,void 0===r?this.visibilityData={}:this.visibilityData=r};r.prototype.isVisible=function(e){for(var t in this.visibilityData)if(this.visibilityData[t].indexOf(e[t])<0)return!1;return!0},r.prototype.isVisibilityAffectedBy=function(e){return void 0!==this.visibilityData[e.name]};var o=function(e,t,n,o){r.call(this,e,t,n,o)};o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.availableInputTypes=["constant","slider","mousemovex","mousemovey"],o.prototype.getMin=function(){return this.availableValues[0]},o.prototype.getMax=function(){return this.availableValues[1]},o.prototype.getMinLabel=function(e){return void 0===e&&(e=this.getMin()),e.toString().replace("-","−")},o.prototype.getMaxLabel=function(e){return void 0===e&&(e=this.getMax()),e.toString().replace("-","−")};var a=function(e,t,n,r){o.call(this,e,t,n,r)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.getStep=function(){return"any"},a.prototype.getSetupStep=function(){return this.getMax()>=100?"0.1":this.getMax()>=10?"0.01":"0.001"};var i=function(e,t,n,r){o.call(this,e,t,n,r)};i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.getStep=function(){return 1},i.prototype.getSetupStep=function(){return 1};var s=function(e,t,n,r){i.call(this,e,t,n,r)};s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.availableInputTypes=["constant","slider"];var l=function(e,t){r.call(this,e,[!1,!0],t)};l.prototype=Object.create(r.prototype),l.prototype.constructor=l;var p=function(){this.reset()};p.prototype.generalOptions=[new r("background",["none","solid"]),new r("materialScope",["global","vertex","face"]),new r("materialData",["one","sda"]),new r("shape",["square","triangle","gasket","cube","hat","terrain"]),new r("elements",["0","8","16","32"]),new r("light",["off","phong","blinn"]),new r("projection",["ortho","perspective"])],p.prototype.inputOptions=[new s("canvas.width",[1,1024],512),new s("canvas.height",[1,1024],512),new a("backgroundColor.r",[0,1],1,{background:["solid"]}),new a("backgroundColor.g",[0,1],1,{background:["solid"]}),new a("backgroundColor.b",[0,1],1,{background:["solid"]}),new a("backgroundColor.a",[0,1],1,{background:["solid"]}),new a("materialColor.r",[0,1],1,{materialScope:["global"],materialData:["one"]}),new a("materialColor.g",[0,1],0,{materialScope:["global"],materialData:["one"]}),new a("materialColor.b",[0,1],0,{materialScope:["global"],materialData:["one"]}),new a("materialColor.a",[0,1],1,{materialScope:["global"],materialData:["one"]}),new a("materialSpecularColor.r",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialSpecularColor.g",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialSpecularColor.b",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialDiffuseColor.r",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialDiffuseColor.g",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialDiffuseColor.b",[0,1],.4,{materialScope:["global"],materialData:["sda"]}),new a("materialAmbientColor.r",[0,1],.2,{materialScope:["global"],materialData:["sda"]}),new a("materialAmbientColor.g",[0,1],.2,{materialScope:["global"],materialData:["sda"]}),new a("materialAmbientColor.b",[0,1],.2,{materialScope:["global"],materialData:["sda"]}),new a("lightDirection.x",[-4,4],-1,{light:["phong","blinn"]}),new a("lightDirection.y",[-4,4],1,{light:["phong","blinn"]}),new a("lightDirection.z",[-4,4],1,{light:["phong","blinn"]}),new i("shapeLod",[0,10],6,{shape:["gasket","hat","terrain"]})],p.prototype.transformOptions=[],p.prototype.transforms=[],["rotate.x","rotate.y","rotate.z"].forEach(function(e){var t=new a(e,[-180,180],0),n=new a(e+".speed",[-360,360],0);p.prototype.transformOptions.push(t),p.prototype.transformOptions.push(n),p.prototype.transforms.push({name:e,options:[t,n]})}),p.prototype.debugOptions=[new l("debugShaders",!0),new l("debugArrays"),new l("debugInputs")],p.prototype.formattingOptions=[new r("indent",["tab","2","4","8"])],p.prototype.groupNames=["generalOptions","inputOptions","transformOptions","debugOptions","formattingOptions"],p.prototype.reset=function(){this.groupNames.forEach(function(e){this[e].forEach(function(t){this[t.name]=t.defaultValue,("inputOptions"==e||"transformOptions"==e)&&(this[t.name+".input"]="constant",this[t.name+".min"]=t.getMin(),this[t.name+".max"]=t.getMax())},this)},this),this.transformOrder=this.transforms.map(function(e){return e.name})},p.prototype.fix=function(){return new c(this)};var c=function(e){e.groupNames.forEach(function(t){this[t]=[],e[t].forEach(function(n){n.isVisible(e)&&(this[t].push(n),this[n.name]=e[n.name],("inputOptions"==t||"transformOptions"==t)&&(this[n.name+".input"]=e[n.name+".input"],this[n.name+".min"]=e[n.name+".min"],this[n.name+".max"]=e[n.name+".max"]))},this)},this),this.transformOrder=e.transformOrder};c.prototype.getInputOptionsFor=function(e){return this.inputOptions.filter(function(t){return 0===t.name.indexOf(e+".")},this)},c.prototype.getInputsFor=function(e){return this.inputOptions.filter(function(t){return 0===t.name.indexOf(e+".")&&"constant"!=this[t.name+".input"]},this)},c.prototype.getOnlyInputFor=function(e){var t=this.getInputsFor(e);return 1==t.length?t[0]:null},c.prototype.hasInputs=function(){return this.inputOptions.some(function(e){return"constant"!=this[e.name+".input"]},this)||this.transformOptions.some(function(e){return"constant"!=this[e.name+".input"]},this)},c.prototype.hasSliderInputs=function(){return this.inputOptions.some(function(e){return"slider"==this[e.name+".input"]},this)||this.transformOptions.some(function(e){return"slider"==this[e.name+".input"]},this)},c.prototype.hasInputsFor=function(e){return this.getInputsFor(e).length>0},c.prototype.hasAllSliderInputsFor=function(e){return this.getInputOptionsFor(e).every(function(e){return"slider"==this[e.name+".input"]},this)},c.prototype.isAnimated=function(){function e(e,t){return-1!==e.indexOf(t,e.length-t.length)}return this.transformOptions.some(function(t){return e(t.name,".speed")&&(0!=this[t.name]||"constant"!=this[t.name+".input"])},this)},c.prototype.needsUniform=function(e){return"constant"!=this[e+".input"]||0!=this[e+".speed"]||"constant"!=this[e+".speed.input"]},c.prototype.needsTransform=function(e){return this.needsUniform(e)||0!=this[e]},t.exports=p},{}],11:[function(e,t,n){n.Square=e("./shapes/square.js"),n.Triangle=e("./shapes/triangle.js"),n.Gasket=e("./shapes/gasket.js"),n.Cube=e("./shapes/cube.js"),n.Hat=e("./shapes/hat.js"),n.Terrain=e("./shapes/terrain.js")},{"./shapes/cube.js":12,"./shapes/gasket.js":13,"./shapes/hat.js":14,"./shapes/square.js":18,"./shapes/terrain.js":19,"./shapes/triangle.js":20}],12:[function(e,t,n){var r=e("../lines.js"),o=e("../colorgen.js"),a=e("./shape.js"),i=function(e,t,n,r,o){a.apply(this,arguments)};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.dim=3,i.prototype.twoSided=!1,i.prototype.writeArrays=function(){for(var e=new o(this.colorAttrs,0,this.hasColorsPerFace?void 0:[[0,0,0],[1,0,0],[0,1,0],[1,1,0],[0,0,1],[1,0,1],[0,1,1],[1,1,1]]),t=8,n=[],a=0;t>a;a++)n.push(e.getNextColorString());var i=["-0.5,-0.5,-0.5,","+0.5,-0.5,-0.5,","-0.5,+0.5,-0.5,","+0.5,+0.5,-0.5,","-0.5,-0.5,+0.5,","+0.5,-0.5,+0.5,","-0.5,+0.5,+0.5,","+0.5,+0.5,+0.5,"],s=6,l=["left","right","bottom","top","back","front"],p=["-1.0, 0.0, 0.0,","+1.0, 0.0, 0.0,"," 0.0,-1.0, 0.0,"," 0.0,+1.0, 0.0,"," 0.0, 0.0,-1.0,"," 0.0, 0.0,+1.0,"],c=[[4,6,0,2],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[5,7,4,6]],u=[0,1,2,2,1,3],h=new r;h.a("// x    y    z"),this.hasNormals&&h.t("  n.x  n.y  n.z"),h.t(e.getHeaderString());var m=function(e,t,r){h.a(i[t]),this.hasNormals&&h.t(p[e]),this.hasColorsPerVertex?h.t(n[t]):this.hasColorsPerFace&&h.t(n[e]),r&&h.t(" // "+l[e]+" face")}.bind(this);if(this.usesElements()){if(this.hasColorsPerFace||this.hasNormals){for(var a=0;s>a;a++)c[a].forEach(function(e,t){m(a,e,0==t)});return new r(h.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;","var elements=new "+this.getElementIndexJsArray()+"([","	 0,  1,  2,  2,  1,  3, // left face","	 4,  5,  6,  6,  5,  7, // right face","	 8,  9, 10, 10,  9, 11, // bottom face","	12, 13, 14, 14, 13, 15, // top face","	16, 17, 18, 18, 17, 19, // back face","	20, 21, 22, 22, 21, 23, // front face","]);")}for(var a=0;t>a;a++)h.a(i[a]),this.hasColorsPerVertex&&h.t(n[a]);for(var f=new r,a=0;s>a;a++)f.a(""),u.forEach(function(e){f.t(c[a][e]+", ")}),f.t("// "+l[a]+" face");return new r(h.wrap("var vertices=new Float32Array([","]);"),"var nElements=36;",f.wrap("var elements=new "+this.getElementIndexJsArray()+"([","]);"))}for(var a=0;s>a;a++)u.forEach(function(e,t){m(a,c[a][e],0==t)});return new r("var nVertices=36;",h.wrap("var vertices=new Float32Array([","]);"))},t.exports=i},{"../colorgen.js":3,"../lines.js":7,"./shape.js":17}],13:[function(e,t,n){var r=e("../lines.js"),o=e("./lodshape.js"),a=function(e,t,n,r,a,i){o.apply(this,arguments)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.getDistinctVertexCount=function(e){return"(Math.pow(3,"+e+"+1)+3)/2"},a.prototype.getFaceVertexCount=function(e){return"Math.pow(3,"+e+")*3"},a.prototype.getTotalVertexCount=function(e){return"Math.pow(3,"+e+")*3"},a.prototype.writeStoreShape=function(){var e=function(){var e=new r;return e.a("vertices[nextIndexIntoVertices++]=p[0];","vertices[nextIndexIntoVertices++]=p[1];"),(this.hasColorsPerVertex||this.hasColorsPerFace)&&(!this.usesElements()||this.hasColorsPerFace?e.a("colors[nextIndexIntoColors]"):e.a("colors[nextElement%colors.length]"),e.t(".forEach(function(cc){","	vertices[nextIndexIntoVertices++]=cc;","});")),this.usesElements()?e.a("return nextElement++;"):this.hasColorsPerVertex&&e.a("nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"),e.wrap("function pushVertex(p) {","}")}.bind(this),t=function(){var e=new r;return e.a("if (depth<=0) {"),this.usesElements()?this.hasColorsPerFace?e.a("	pushElement(pushVertex(p0));","	pushElement(pushVertex(p1));","	pushElement(pushVertex(p2));","	nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"):e.a("	if (es[0]===null) es[0]=pushVertex(p0);","	if (es[1]===null) es[1]=pushVertex(p1);","	if (es[2]===null) es[2]=pushVertex(p2);","	pushElement(es[0]);","	pushElement(es[1]);","	pushElement(es[2]);","	return es;"):this.hasColorsPerFace?e.a("	pushVertex(p0);","	pushVertex(p1);","	pushVertex(p2);","	nextIndexIntoColors=(nextIndexIntoColors+1)%colors.length;"):e.a("	pushVertex(p0);","	pushVertex(p1);","	pushVertex(p2);"),e.a("} else {","	var p01=mix(p0,p1);","	var p12=mix(p1,p2);","	var p20=mix(p2,p0);"),this.usesElements()?this.hasColorsPerFace?e.a("	var es0=triangle(depth-1,p0,p01,p20);","	var es1=triangle(depth-1,p1,p12,p01);","	var es2=triangle(depth-1,p2,p20,p12);"):e.a("	var es0=triangle(depth-1,p0,p01,p20,[es[0],null,null]);","	var es1=triangle(depth-1,p1,p12,p01,[es[1],null,es0[1]]);","	var es2=triangle(depth-1,p2,p20,p12,[es[2],es0[2],es1[1]]);","	return [es0[0],es1[0],es2[0]];"):e.a("	triangle(depth-1,p0,p01,p20);","	triangle(depth-1,p1,p12,p01);","	triangle(depth-1,p2,p20,p12);"),e.a("}"),!this.usesElements()||this.hasColorsPerFace?e.wrap("function triangle(depth,p0,p1,p2) {","}"):e.wrap("function triangle(depth,p0,p1,p2,es) {","}")}.bind(this),n=function(){var e=new r;return e.a("shapeLod,","[-Math.sin(0/3*Math.PI),Math.cos(0/3*Math.PI)],","[-Math.sin(2/3*Math.PI),Math.cos(2/3*Math.PI)],","[-Math.sin(4/3*Math.PI),Math.cos(4/3*Math.PI)]"),this.usesElements()&&!this.hasColorsPerFace&&e.t(",","[null,null,null]"),e.wrap("triangle(",");")}.bind(this),o=new r;return o.a("var nextIndexIntoVertices=0;"),this.usesElements()&&o.a("var nextIndexIntoElements=0;","var nextElement=0;"),this.hasColorsPerVertex||this.hasColorsPerFace?(o.a("// p = position, cc = color component, e = element, es = elements"),o.a(this.writeColorData()),(!this.usesElements()||this.hasColorsPerFace)&&o.a("var nextIndexIntoColors=0;")):o.a("// p = position, e = element, es = elements"),o.a(e()),this.usesElements()&&o.a("function pushElement(e) {","	elements[nextIndexIntoElements++]=e;","}"),o.a("function mix(pa,pb) {","	return [","		(pa[0]+pb[0])/2,","		(pa[1]+pb[1])/2,","	];","}",t(),n()),o},t.exports=a},{"../lines.js":7,"./lodshape.js":15}],14:[function(e,t,n){var r=e("../lines.js"),o=e("./mesh.js"),a=function(e,t,n,r,a,i){o.apply(this,arguments)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.writeMeshInit=function(){return new r("var xyRange=4;","var xyScale=1/(4*Math.sqrt(2));")},a.prototype.writeMeshVertex=function(){var e=new r,t=0;return e.a("var r2=(x*x+y*y)/2;","var A=Math.exp(-r2)/Math.PI;","var z=A*(1-r2);","vertices[vertexOffset+"+t++ +"]=x*xyScale;","vertices[vertexOffset+"+t++ +"]=y*xyScale;","vertices[vertexOffset+"+t++ +"]=z;"),this.hasNormals&&e.a("var normal=normalize([(z+A)*x/xyScale,(z+A)*y/xyScale,1]);","vertices[vertexOffset+"+t++ +"]=normal[0];","vertices[vertexOffset+"+t++ +"]=normal[1];","vertices[vertexOffset+"+t++ +"]=normal[2];"),e.a(this.writeMeshVertexColors(t)),e},t.exports=a},{"../lines.js":7,"./mesh.js":16}],15:[function(require,module,exports){var Lines=require("../lines.js"),Colorgen=require("../colorgen.js"),Shape=require("./shape.js"),LodShape=function(e,t,n,r,o,a){Shape.call(this,e,t,n,r,o),this.lod=a;var i=this.getMaxPossibleLod();this.lod.value>i&&(this.lod.value=i),this.lod.max>i&&(this.lod.max=i)};LodShape.prototype=Object.create(Shape.prototype),LodShape.prototype.constructor=LodShape,LodShape.prototype.getMaxPossibleLod=function(){if(!this.usesElements()||this.elementIndexBits>=31)return this.lod.max;for(var nVerticesFn=this.hasColorsPerFace?this.getFaceVertexCount:this.getDistinctVertexCount,indexLimit=1<<this.elementIndexBits,m=this.lod.max;m>=0;m--){var n=eval(nVerticesFn(m));if(indexLimit>=n)return m}},LodShape.prototype.writeColorData=function(){for(var e=new Lines,t=new Colorgen(this.colorAttrs,0),n=0;4>n;n++)e.a("["+t.getNextColorString().slice(1,-1)+"],");return e.wrap("var colors=[","];")},LodShape.prototype.writeArraysAndBufferData=function(e){var t=this.hasColorsPerFace?this.getFaceVertexCount:this.getDistinctVertexCount,n=new Lines;return this.lod.changes?(n.a("var minShapeLod="+this.lod.min+";","var maxShapeLod="+this.lod.max+";"),this.usesElements()?n.a("var nMaxVertices="+t("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");","var nMaxElements="+this.getTotalVertexCount("maxShapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nMaxElements);",this.writeDebug(e),"var shapeLod,nVertices,nElements;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+t("shapeLod")+";","	nElements="+this.getTotalVertexCount("shapeLod")+";"):n.a("var nMaxVertices="+this.getTotalVertexCount("maxShapeLod")+";","var vertices=new Float32Array(nMaxVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"var shapeLod,nVertices;","function storeShape(newShapeLod) {","	shapeLod=newShapeLod;","	nVertices="+this.getTotalVertexCount("shapeLod")+";")):(n.a("var shapeLod="+this.lod.value+";"),this.usesElements()?n.a("var nVertices="+t("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");","var nElements="+this.getTotalVertexCount("shapeLod")+";","var elements=new "+this.getElementIndexJsArray()+"(nElements);",this.writeDebug(e),"function storeShape() {"):n.a("var nVertices="+this.getTotalVertexCount("shapeLod")+";","var vertices=new Float32Array(nVertices*"+this.getNumbersPerVertex()+");",this.writeDebug(e),"function storeShape() {")),n.a(this.writeStoreShape().indent(),this.writeBufferData().indent(),"}"),this.lod.changes?n.a("storeShape("+this.lod.value+");"):n.a("storeShape();"),n},module.exports=LodShape},{"../colorgen.js":3,"../lines.js":7,"./shape.js":17}],16:[function(e,t,n){var r=e("../lines.js"),o=e("./lodshape.js"),a=function(e,t,n,r,a,i){o.apply(this,arguments)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.dim=3,a.prototype.getDistinctVertexCount=function(e){return"Math.pow((1<<"+e+")+1,2)"},a.prototype.getFaceVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*4"},a.prototype.getTotalVertexCount=function(e){return"Math.pow((1<<"+e+"),2)*6"},a.prototype.writeMeshVertexColors=function(e){return this.hasColorsPerVertex||this.hasColorsPerFace?new r(this.usesElements()||this.hasColorsPerFace?"var ic=(i&1)*2+(j&1);":"var ic=((i+di)&1)*2+((j+dj)&1);","colors[ic].forEach(function(cc,icc){","	vertices[vertexOffset+"+e+"+icc]=cc;","});"):new r},a.prototype.writeStoreShape=function(){var e=new r;return e.a("var res=(1<<shapeLod);"),this.usesElements()?this.hasColorsPerFace?e.a("function vertexElement(i,j,k) {","	return (i*res+j)*4+k;","}"):e.a("function vertexElement(i,j) {","	return i*(res+1)+j;","}"):e.a("function vertexElement(i,j,k) {","	return (i*res+j)*6+k;","}"),this.hasNormals&&e.a("function normalize(v) {","	var l=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);","	return [v[0]/l,v[1]/l,v[2]/l];","}"),(this.hasColorsPerVertex||this.hasColorsPerFace)&&e.a(this.writeColorData()),e.a(this.writeMeshInit()),this.usesElements()?this.hasColorsPerFace?e.a("var i,j;","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		for (var k=0;k<4;k++) {","			var di=[0,0,1,1][k];","			var dj=[0,1,0,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(3),"		}","	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i,j,0);","		elements[elementOffset+1]=vertexElement(i,j,1);","		elements[elementOffset+2]=vertexElement(i,j,2);","		elements[elementOffset+3]=vertexElement(i,j,2);","		elements[elementOffset+4]=vertexElement(i,j,1);","		elements[elementOffset+5]=vertexElement(i,j,3);","	}","}"):e.a("var i,j;","for (i=0;i<=res;i++) {","	var y=i/res*xyRange*2-xyRange;","	for (j=0;j<=res;j++) {","		var x=j/res*xyRange*2-xyRange;","		var vertexOffset=vertexElement(i,j)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(2),"	}","}","for (i=0;i<res;i++) {","	for (j=0;j<res;j++) {","		var elementOffset=(i*res+j)*6;","		elements[elementOffset+0]=vertexElement(i+0,j+0);","		elements[elementOffset+1]=vertexElement(i+0,j+1);","		elements[elementOffset+2]=vertexElement(i+1,j+0);","		elements[elementOffset+3]=vertexElement(i+1,j+0);","		elements[elementOffset+4]=vertexElement(i+0,j+1);","		elements[elementOffset+5]=vertexElement(i+1,j+1);","	}","}"):e.a("for (var i=0;i<res;i++) {","	for (var j=0;j<res;j++) {","		for (var k=0;k<6;k++) {","			var di=[0,0,1,1,0,1][k];","			var dj=[0,1,0,0,1,1][k];","			var y=(i+di)/res*xyRange*2-xyRange;","			var x=(j+dj)/res*xyRange*2-xyRange;","			var vertexOffset=vertexElement(i,j,k)*"+this.getNumbersPerVertex()+";",this.writeMeshVertex().indent(3),"		}","	}","}"),e},t.exports=a},{"../lines.js":7,"./lodshape.js":15}],17:[function(e,t,n){var r=e("../lines.js"),o=function(e,t,n,r,o){this.elementIndexBits=e,this.hasNormals=t&&3==this.dim,this.hasColorsPerVertex=n,this.hasColorsPerFace=r,this.colorAttrs=o};o.prototype.dim=2,o.prototype.twoSided=!0,o.prototype.glPrimitive="TRIANGLES",o.prototype.usesElements=function(){return this.elementIndexBits>0},o.prototype.getNumbersPerVertex=function(){return this.dim+(this.hasNormals?3:0)+3*this.colorAttrs.length},o.prototype.getElementIndexJsArray=function(){return"Uint"+this.elementIndexBits+"Array"},o.prototype.getElementIndexGlType=function(){return 8==this.elementIndexBits?"gl.UNSIGNED_BYTE":16==this.elementIndexBits?"gl.UNSIGNED_SHORT":32==this.elementIndexBits?"gl.UNSIGNED_INT":void 0},o.prototype.writeDebug=function(e){var t=new r;return e&&(t.a("console.log('vertex array byte length:',vertices.byteLength);"),this.usesElements()&&(t.a("console.log('element array byte length:',elements.byteLength);"),t.a("console.log('vertex+element array byte length:',vertices.byteLength+elements.byteLength);"))),t},o.prototype.writeBufferData=function(){var e=new r;return e.a("gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);"),this.usesElements()&&e.a("gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,elements,gl.STATIC_DRAW);"),e},o.prototype.writeArraysAndBufferData=function(e){return new r(this.writeArrays(),this.writeDebug(e),this.writeBufferData())},o.prototype.writeInit=function(e){var t=new r;t.a("gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer());"),this.usesElements()&&t.a("gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,gl.createBuffer());"),t.a(this.writeArraysAndBufferData(e));var n=function(e){var n=e[0][0],o=e.every(function(e){var t=e[0];return t==n}),a=!0,i=new r;e.forEach(function(e){var t=e[0],n=e[1],r=e[2];r?i.a(o?"'"+n+"',":"["+t+",'"+n+"'],"):(i.a(o?"null,":"["+t+",null],"),i.t(" // attribute "+n+" disabled"),a=!1)});var s=new r("var attrLoc=gl.getAttribLocation(program,attrName);","gl.vertexAttribPointer(","	attrLoc,attrSize,gl.FLOAT,false,","	Float32Array.BYTES_PER_ELEMENT*bufferStride,","	Float32Array.BYTES_PER_ELEMENT*bufferOffset",");","gl.enableVertexAttribArray(attrLoc);");a||s.wrap("if (name!==null) {","}");var l=new r;o?l.a("var attrSize="+n+";"):l.a("var attrSize=attr[0];","var attrName=attr[1];"),l.a(s,"bufferOffset+=attrSize;"),t.a("var bufferStride="+this.getNumbersPerVertex()+";","var bufferOffset=0;",i.wrap("[","]")),t.t(l.wrap(".forEach(function("+(o?"attrName":"attr")+"){","});"))}.bind(this);return!this.hasNormals&&this.colorAttrs.length<=0?t.a("var positionLoc=gl.getAttribLocation(program,'position');","gl.vertexAttribPointer(positionLoc,"+this.dim+",gl.FLOAT,false,0,0);","gl.enableVertexAttribArray(positionLoc);"):n([[this.dim,"position",!0]].concat(this.hasNormals?[[3,"normal",!0]]:[],this.colorAttrs.map(function(e){return[3,e.name,e.enabled]}))),t},o.prototype.writeDraw=function(){return new r(this.usesElements()?"gl.drawElements(gl."+this.glPrimitive+",nElements,"+this.getElementIndexGlType()+",0);":"gl.drawArrays(gl."+this.glPrimitive+",0,nVertices);")},t.exports=o},{"../lines.js":7}],18:[function(e,t,n){var r=e("../lines.js"),o=e("../colorgen.js"),a=e("./shape.js"),i=function(e,t,n,r,o){a.apply(this,arguments)};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.glPrimitive="TRIANGLE_FAN",i.prototype.writeArrays=function(){var e,t=new o(this.colorAttrs,0),n=function(){return this.hasColorsPerFace&&!this.hasColorsPerVertex?(void 0===e&&(e=t.getNextColorString()),e):t.getNextColorString()}.bind(this),a=new r("var nVertices=4;","var vertices=new Float32Array([","	// x    y"+t.getHeaderString(),"	-0.5,-0.5,"+n(),"	+0.5,-0.5,"+n(),"	+0.5,+0.5,"+n(),"	-0.5,+0.5,"+n(),"]);");return this.usesElements()&&a.a("var nElements=4;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2,3]);"),a},t.exports=i},{"../colorgen.js":3,"../lines.js":7,"./shape.js":17}],19:[function(e,t,n){var r=e("../lines.js"),o=e("./mesh.js"),a=function(e,t,n,r,a,i){o.apply(this,arguments)};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.writeMeshInit=function(){var e=this.usesElements()&&!this.hasColorsPerFace,t=new r;return t.a("var xyRange=1/Math.sqrt(2);","var zRange=xyRange;","var mask=res-1;","function zOffset(i,j) {","	return vertexElement(i,j"+(e?"":",0")+")*"+this.getNumbersPerVertex()+"+2;","}","function noise(depth) {","	var r=zRange/Math.pow(2,shapeLod-depth-1);","	return Math.random()*2*r-r;","}","vertices[2]=0.0;","var i0,i1,i2,i3;","var j0,j1,j2,j3;","for (var depth=shapeLod-1;depth>=0;depth--) {","	var d=1<<depth;","	// diamond step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i1=i2-d;","			j1=j2-d;","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j2)]=(","				vertices[zOffset(i1,j1)]+vertices[zOffset(i1,j3)]+","				vertices[zOffset(i3,j1)]+vertices[zOffset(i3,j3)]","			)/4+noise(depth);","		}","	}","	// square step","	for (i2=d;i2<res;i2+=2*d) {","		for (j2=d;j2<res;j2+=2*d) {","			i0=(i2-2*d)&mask;","			j0=(j2-2*d)&mask;","			i1=(i2-d);","			j1=(j2-d);","			i3=(i2+d)&mask;","			j3=(j2+d)&mask;","			vertices[zOffset(i2,j1)]=(","				vertices[zOffset(i2,j0)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i3,j1)]","			)/4+noise(depth);","			vertices[zOffset(i1,j2)]=(","				vertices[zOffset(i0,j2)]+vertices[zOffset(i1,j1)]+","				vertices[zOffset(i2,j2)]+vertices[zOffset(i1,j3)]","			)/4+noise(depth);","		}","	}","}"),e&&t.a("for (i0=0;i0<res;i0++) vertices[zOffset(i0,res)]=vertices[zOffset(i0,0)];","for (j0=0;j0<res;j0++) vertices[zOffset(res,j0)]=vertices[zOffset(0,j0)];","vertices[zOffset(res,res)]=vertices[zOffset(0,0)];"),t},a.prototype.writeMeshVertex=function(){var e=this.usesElements()&&!this.hasColorsPerFace,t=new r;t.a("vertices[vertexOffset+0]=x;","vertices[vertexOffset+1]=y;",e?"// vertices[vertexOffset+2] already written":"vertices[vertexOffset+2]=vertices[zOffset((i+di)&mask,(j+dj)&mask)];");var n=3;return this.hasNormals&&t.a("var d=4*xyRange/res;","var normal=normalize([",e?"	(vertices[zOffset(i,(j-1)&mask)]-vertices[zOffset(i,(j+1)&mask)])/d,":"	(vertices[zOffset((i+di)&mask,(j+dj-1)&mask)]-vertices[zOffset((i+di)&mask,(j+dj+1)&mask)])/d,",e?"	(vertices[zOffset((i-1)&mask,j)]-vertices[zOffset((i+1)&mask,j)])/d,":"	(vertices[zOffset((i+di-1)&mask,(j+dj)&mask)]-vertices[zOffset((i+di+1)&mask,(j+dj)&mask)])/d,","1]);","vertices[vertexOffset+"+n++ +"]=normal[0];","vertices[vertexOffset+"+n++ +"]=normal[1];","vertices[vertexOffset+"+n++ +"]=normal[2];"),t.a(this.writeMeshVertexColors(n)),t},t.exports=a},{"../lines.js":7,"./mesh.js":16}],20:[function(e,t,n){var r=e("../lines.js"),o=e("../colorgen.js"),a=e("./shape.js"),i=function(e,t,n,r,o){a.apply(this,arguments)};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.writeArrays=function(){var e,t=new o(this.colorAttrs,0),n=function(){return this.hasColorsPerFace&&!this.hasColorsPerVertex?(void 0===e&&(e=t.getNextColorString()),e):t.getNextColorString()}.bind(this),a=new r("var nVertices=3;","var vertices=new Float32Array([","	//                   x                      y"+t.getHeaderString(),"	-Math.sin(0/3*Math.PI), Math.cos(0/3*Math.PI),"+n(),"	-Math.sin(2/3*Math.PI), Math.cos(2/3*Math.PI),"+n(),"	-Math.sin(4/3*Math.PI), Math.cos(4/3*Math.PI),"+n(),"]);");
return this.usesElements()&&a.a("var nElements=3;","var elements=new "+this.getElementIndexJsArray()+"([0,1,2]);"),a},t.exports=i},{"../colorgen.js":3,"../lines.js":7,"./shape.js":17}],21:[function(e,t,n){var r=e("./lines.js"),o=e("./listeners.js"),a=function(e,t,n,r){this.varName=e,this.optName=t,this.components=n.split(""),this.values=this.components.map(function(e){return r[t+"."+e]}),this.inputs=this.components.map(function(e){return r[t+"."+e+".input"]}),this.minValues=this.components.map(function(e){return r[t+"."+e+".min"]}),this.maxValues=this.components.map(function(e){return r[t+"."+e+".max"]}),this.nVars=0,this.nSliders=0,this.nMousemoves=0,this.modeConstant=!0,this.modeFloats=!1,this.components.forEach(function(e,n){var o=r[t+"."+e+".input"];"constant"!=o&&(this.modeConstant=!1,this.nVars++!=n&&(this.modeFloats=!0)),this.nSliders+="slider"==o,this.nMousemoves+="mousemovex"==o||"mousemovey"==o},this),1==this.nVars&&(this.modeFloats=!0),this.modeVector=!this.modeConstant&&!this.modeFloats;var o=this.minValues.every(function(e){return e>=0})&&this.maxValues.every(function(e){return e>=0});o?this.formatValue=function(e){return e.toFixed(3)}:this.formatValue=function(e){return(0>=e?0>e?"":" ":"+")+e.toFixed(3)}};a.prototype.updateFnName=function(){function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}return"update"+e(this.varName)},a.prototype.varNameC=function(e){return this.varName+e.toUpperCase()},a.prototype.componentValue=function(e,t){return"constant"==this.inputs[t]?this.formatValue(this.values[t]):"slider"==this.inputs[t]?"parseFloat(document.getElementById('"+this.optName+"."+e+"').value)":"mousemovex"==this.inputs[t]||"mousemovey"==this.inputs[t]?this.varNameC(e):void 0},a.prototype.getJsInterfaceLines=function(e,t){var n=function(){var t=new r;return this.components.forEach(function(n,r){if("slider"==this.inputs[r]){var a=new o.SliderListener(this.optName+"."+n);a.enter().log("console.log(this.id,'input value:',parseFloat(this.value));").post(this.updateFnName()+"();"),t.a(a.write.apply(a,e))}},this),t}.bind(this),a=function(){var t=new o.MultipleSliderListener('[id^="'+this.optName+'."]');return t.enter().log("console.log(this.id,'input value:',parseFloat(this.value));").post(this.updateFnName()+"();"),new r(t.write.apply(t,e))}.bind(this);if(this.modeConstant)return new r;var i=new r,s=n(),l=a();if(i.a(this.writeJsInterfaceGlslLines()),this.nSliders>0&&(this.components.forEach(function(e,t){("mousemovex"==this.inputs[t]||"mousemovey"==this.inputs[t])&&i.a("var "+this.varNameC(e)+"="+this.formatValue(this.values[t])+";")},this),i.a(this.writeJsInterfaceUpdateFnLines().wrap("function "+this.updateFnName()+"() {","}"),this.updateFnName()+"();",s.data.length<=l.data.length?s:l)),this.nMousemoves>0){var p=t.enter();this.components.forEach(function(e,t){("mousemovex"==this.inputs[t]||"mousemovey"==this.inputs[t])&&(0==this.nSliders?p.minMaxVarFloat(this.inputs[t],this.varNameC(e),this.formatValue(this.minValues[t]),this.formatValue(this.maxValues[t])):p.minMaxFloat(this.inputs[t],this.varNameC(e),this.formatValue(this.minValues[t]),this.formatValue(this.maxValues[t])),p.log("console.log('"+this.optName+"."+e+" input value:',"+this.varNameC(e)+");"),this.addPostToEntryForComponent(p,e))},this),this.addPostToEntryAfterComponents(p)}return i},t.exports=a},{"./lines.js":7,"./listeners.js":8}]},{},[9]);
//# sourceMappingURL=webgl-starter.js.map